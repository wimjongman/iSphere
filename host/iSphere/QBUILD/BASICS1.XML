<?xml version="1.0" encoding="ISO-8859-1"?>
     <!-- Embedded DTD for validation -->
     <!DOCTYPE upload [
     <!ELEMENT compile (#PCDATA)>
     <!ATTLIST compile
      condition CDATA #REQUIRED
     >
     <!ELEMENT copysrc (#PCDATA)>
     <!ELEMENT install_instructions (#PCDATA)>
     <!ELEMENT install_program (#PCDATA)>
     <!ELEMENT mbr (copysrc)>
     <!ATTLIST mbr
      mbrname CDATA #REQUIRED
      mbrtype CDATA #REQUIRED
      mbrtext CDATA #REQUIRED
      srcfile CDATA #REQUIRED
      srclib CDATA #REQUIRED
      srclen CDATA #REQUIRED
      srccssid CDATA #REQUIRED
     >
     <!ELEMENT qcmdexc (#PCDATA)>
     <!ATTLIST qcmdexc
      condition CDATA #REQUIRED
      release CDATA #REQUIRED
      dltsplf CDATA #REQUIRED
     >
     <!ELEMENT qrycond (#PCDATA)>
     <!ATTLIST qrycond
      msg CDATA #REQUIRED
      values CDATA #REQUIRED
     >
     <!ELEMENT sendmsg (#PCDATA)>
     <!ATTLIST sendmsg
      sendmsgid CDATA #REQUIRED
      sendmsgtype CDATA #REQUIRED
     >
     <!ELEMENT rtvobjd (#PCDATA)>
     <!ATTLIST rtvobjd
      condition CDATA #REQUIRED
      obj CDATA #REQUIRED
      lib CDATA #REQUIRED
      objtype CDATA #REQUIRED
      rtnlib CDATA #IMPLIED
     >
     <!ELEMENT upload (install_instructions | install_program | qrycond |
                       qcmdexc | sendmsg | mbr | compile | rtvobjd)+>
     <!ATTLIST upload
      appname CDATA #REQUIRED
      appauthor CDATA #REQUIRED
      appblddate CDATA #REQUIRED
     >
     ]>
<upload  appname="BASICS1"  appauthor="Thomas Raddatz"  appblddate=" 5/28/2015">
<install_instructions><![CDATA[
     *----------------------------------------------------------------      ------
     *  1. Upload entire XML to your AS/400 to a source file 112 long, into any mbr
     *     name not in this XML (suggest member name like ABCX or XYZX). The source
     *     file must be in the library where source and objects are to be installed.
     *
     *  2. If you have XMLPREVIEW installed, skip to step 3.
     *
     *     Copy the text between the start tag <install_program> and the end
     *     tag </install_program> into any member name (your choice)
     *     in file QRPGLESRC member type RPGLE.   CRTBNDRPG to compile.
     *     NOTE: You need extract the install program only once, this same program
     *           will install any upload on this page.
     *
     *  3. Call the install program (or execute XmlPrevew) passing these 3 parms.
     *       'your-member-name you uploaded this text into'
     *       'your-source-file-name the member is in'
     *       'your-library-name the source file is in'
     *
     *  The various source members will be extracted and the objects required
     *   for the application will be created in your-library-name.
     *----------------------------------------------------------------      ------
]]>  </install_instructions>
<install_program><![CDATA[
      * /// START OF INSTALL PGM HERE   ************************** ///
      *---------------------------------------------------------------------------------------
      * Parse / Install from xml text into source members and objects.
      * Copyright (C) 2001    Craig Rutledge    <craig_rutledge@mohawkind.com>
      * Martin Rowe    <Martin@dbg400.net>          scripting cmd prompts
      * David George   <webmaster@400times.co.uk>   intellectual input
      * Thomas Raddatz <thomas.raddatz@tools400.de> execute SQL statements
      * Thomas Raddatz <thomas.raddatz@tools400.de> conditions
      * Thomas Raddatz <thomas.raddatz@tools400.de> release
      * Thomas Raddatz <thomas.raddatz@tools400.de> retrieve object description
      *
      * Use xml tags in text to trigger:
      * 1. Parse text into source members (create srcfile & member if required).
      * 2. Compile source into objects.
      * 3. Send installation progress user messages.
      * 4. Execute qcmdexc as required.
      * 5. Execute SQL statements as required.
      *
      * This program is free software, you can redistribute it and/or modify it
      * under the terms of the GNU General Public License as published by
      * the Free Software Foundation.  See GNU General Public License for details
      *---------------------------------------------------------------------------------------
     H DFTACTGRP(*NO) ACTGRP(*CALLER) BNDDIR('QC2LE')
      *---------------------------------------------------------------------------------------
     Fxmlinput  if   f  112        disk    usropn                               uploaded text
     Fqxxxsrc   o    f  112        disk    usropn                               parsed out
      *--------------------------------------------------------------------
      * create parm prototypes
      *--------------------------------------------------------------------
      *  Tokenize String
     D strtok          PR              *          extproc('strtok')
     D  i_string                       *   value  options(*string)
     D  i_token                        *   value  options(*string)
      * retrieve member description
     D qusrmbrd        PR                  ExtPgm('QUSRMBRD')                   MEMBER DESCRIPTION
     D  o_rcvVar                  32767a          options(*varsize)             RECEIVER
     D  i_lenRcvVar                  10i 0 const                                LENGTH OF RECVR
     D  i_format                      8    const                                UPLOAD TYPE
     D  i_qFile                      20    const                                FILE   LIB
     D  i_mbr                        10    const                                MEMBER NAME
     D  i_ovverride                   1    const                                PROCESS OVERIDE
     D  io_errCode                32767a          options(*varsize)             ERROR CODE
      * retrieve object description
     D QUSROBJD...
     D                 PR                         extpgm('QUSROBJD')
     D  o_rcvVar                  65535A          options(*varsize)
     D  i_lenRcvVar                  10I 0 const
     D  i_format                      8A   const
     D  i_qObj                       20A   const
     D  i_type                       10A   const
     D  io_errCode                65535A          options(*nopass: *varsize)    | OptGrp 1
      * send program message
     D qmhsndpm        PR                  ExtPgm('QMHSNDPM')                   SEND MESSAGES
     D  i_msgID                       7a   const                                ID
     D  i_qMsgF                      20a   const                                FILE
     D  i_msgText                 32767a   const  options(*varsize)             TEXT
     D  i_lenMsgText                 10i 0 const                                LENGTH
     D  i_msgType                    10a   const                                TYPE
     D  i_callStackE                 10a   const                                STACK ENTRY
     D  i_callStackC                 10i 0 const                                STACK COUNTER
     D  i_msgKey                      4a   const                                KEY
     D  io_errCode                32767a          options(*varsize)             ERROR CODE
      * execute cl command
     D  qcmdexc        PR                  ExtPgm('QCMDEXC')
     D  i_cmd                        50a   Const
     D  i_lenCmd                     15p 5 Const
      *  Allocate Environment Handle
     D SQLAllocEnv...
     D                 PR                         extproc('SQLAllocEnv')
     D                                     like(SQLRETURN_t )
     D  o_phenv                        *   value
      *  Allocate Connection Handle
     D SQLAllocConnect...
     D                 PR                         extproc('SQLAllocConnect')
     D                                     like(SQLRETURN_t )
     D  i_henv                             value  like(SQLHENV_t   )
     D  o_phdbc                        *   value
      *  Connect to a Data Source
     D SQLConnect...
     D                 PR                         extproc('SQLConnect')
     D                                     like(SQLRETURN_t )
     D  i_hdbc                             value  like(SQLHDBC_t   )
     D  i_szDSN                        *   value  options(*string)
     D  i_cbDSN                            value  like(SQLSMALLINT_t)
     D  i_szUID                        *   value  options(*string)
     D  i_cbUID                            value  like(SQLSMALLINT_t)
     D  i_szAuthStr                    *   value  options(*string)
     D  i_cbAuthStr                        value  like(SQLSMALLINT_t)
      *  Set Connection Option
     D SQLSetConnectOption...
     D                 PR                         extproc('SQLSetConnectOption')
     D                                     like(SQLRETURN_t )
     D  i_hdbc                             value  like(SQLHDBC_t   )
     D  i_fOption                          value  like(SQLSMALLINT_t)
     D  i_vParam                           value  like(SQLPOINTER_t )
      *  Allocate a Statement Handle
     D SQLAllocStmt...
     D                 PR                         extproc('SQLAllocStmt')
     D                                     like(SQLRETURN_t )
     D  i_hdbc                             value  like(SQLHDBC_t   )
     D  o_phstmt                       *   value
      *  Execute a Statement Directly
     D SQLExecDirect...
     D                 PR                         extproc('SQLExecDirect')
     D                                     like(SQLRETURN_t )
     D  i_hstmt                            value  like(SQLHSTMT_t  )
     D  i_szSqlStr                     *   value  options(*string)
     D  i_cbSqlStr                         value  like(SQLINTEGER_t)
      *  Free (or Reset) a Statement Handle
     D SQLFreeStmt...
     D                 PR                         extproc('SQLFreeStmt')
     D                                     like(SQLRETURN_t )
     D  i_hstmt                            value  like(SQLHSTMT_t  )
     D  i_fOption                          value  like(SQLSMALLINT_t)
      *  Disconnect from a Data Source
     D SQLDisconnect...
     D                 PR                         extproc('SQLDisconnect')
     D                                     like(SQLRETURN_t )
     D  i_hdbc                             value  like(SQLHDBC_t   )
      *  Free Connection Handle
     D SQLFreeConnect...
     D                 PR                         extproc('SQLFreeConnect')
     D                                     like(SQLRETURN_t )
     D  i_hdbc                             value  like(SQLHDBC_t   )
      *  Free Environment Handle
     D SQLFreeEnv...
     D                 PR                         extproc('SQLFreeEnv')
     D                                     like(SQLRETURN_t )
     D  i_henv                             value  like(SQLHENV_t   )
      *--------------------------------------------------------------------
     D long_t          S             10I 0                    based(pDummy)
     D short_t         S              5I 0                    based(pDummy)
      *
     D SQLINTEGER_t    S                   like(long_t      ) based(pDummy)
     D SQLSMALLINT_t   S                   like(short_t     ) based(pDummy)
      *
     D PTR_t           S               *                      based(pDummy)
     D SQLPOINTER_t    S                   like(PTR_t       ) based(pDummy)
     D HENV_t          S                   like(long_t      ) based(pDummy)
     D HDBC_t          S                   like(long_t      ) based(pDummy)
     D HSTMT_t         S                   like(long_t      ) based(pDummy)
     D RETCODE_t       S                   like(SQLINTEGER_t) based(pDummy)
      *
     D SQLHENV_t       S                   like(HENV_t      ) based(pDummy)
     D SQLHDBC_t       S                   like(HDBC_t      ) based(pDummy)
     D SQLHSTMT_t      S                   like(HSTMT_t     ) based(pDummy)
     D SQLRETURN_t     S                   like(RETCODE_t   ) based(pDummy)
      *
     D retCode         S                   like(SQLRETURN_t) inz
     D hdbc            S                   like(SQLHDBC_t  ) inz
     D hstmt           S                   like(SQLHSTMT_t ) inz
     D henv            S                   like(SQLHENV_t  ) inz
     D sqlInit         S              1A                     inz(*off)
     D cOptVal         S             10I 0                   inz
      *
     D SQL_NTS         C                   const( -3)
     D SQL_COMMIT_NONE...
     D                 C                   const(  1)
     D SQL_ATTR_COMMIT...
     D                 C                   const(  0)
     D SQL_DROP        C                   const(  1)
      *--------------------------------------------------------------------
      * Read element
      *--------------------------------------------------------------------
     D readElement     PR                        like(bldexc)
     D  i_element                     9A   value varying
      *--------------------------------------------------------------------
      * Define function prototype to double quotes in a string
      *--------------------------------------------------------------------
     D dblQuotes       PR          2048A         varying
     D  i_string                   2048A   value varying
      *--------------------------------------------------------------------
      * Define function prototype to get attribute data from a string
      *--------------------------------------------------------------------
     D getAttrData...
     D                 PR          2000A          varying                       like(string_t)
     D  i_attr                       10a   value
     D  i_string                   2000A   value  varying                       like(string_t)
     D  i_default                  2000A   value  varying                       like(string_t)
      *--------------------------------------------------------------------
      * Define function prototype to check for a condition
      *--------------------------------------------------------------------
     D isCondition...
     D                 PR              n
     D  i_condList                 2000A   value
      *---------------------------------------------------------------------------------------
     D loadConditions...
     D                 PR                  dim(32) like(condition)
     D  i_conditions                128A   value
      *--------------------------------------------------------------------
     D getCurrentRelease...
     D                 PR            10A
      *--------------------------------------------------------------------
     D isRelease...
     D                 PR              n
     D  i_os_release                  6A   value
     D  i_release                    10A   value
      *--------------------------------------------------------------------
     D setTargetRelease...
     D                 PR          2000A          varying
     D  i_keyword                    10A   value  varying
     D  i_string                   2000A   value  varying
     D  i_value                      10A   value  varying
      *--------------------------------------------------------------------
     D setVariable...
     D                 PR
     D  i_fldName                    10A   value  varying
     D  i_value                      64A   value  varying
      *---------------------------------------------------------------------------------------------
     D getVarName...
     D                 PR            11a          varying
     D  i_bldexc                           value  like(bldexc)
     D  i_pos                        10i 0 value
      *---------------------------------------------------------------------------------------------
     D getVarValue...
     D                 PR            64a          varying
     D  i_name                       11a   value  varying
      *---------------------------------------------------------------------------------------------
     D uCase...
     D                 PR          2000A          varying
     D  i_string                   2000A   value  varying
      *--------------------------------------------------------------------
     D vrcvar          s            145
     D qm_msgid        s              7
     D qm_msgtxt       s            500
     D qm_msgq         s             10
     D qm_msgtyp       s             10
     D mbrname         s             10
     D mbrtype         s             10
     D mbrtext         s             50
     D srcfile         s             10
     D srclen          s              5
     D srclenN         s              5  0   inz(0)
     D srccssid        s              5
     D bldexc          s           2000
     D write_flag      s              1n   inz(*off)
     D srcSeqno        s              6s 2 inz(0)
     D aa              s              5u 0 inz(0)
     D ll              s              5u 0 inz(0)
     D qs              c                   ''''
     D qd              c                   '"'
     D errFLag         s              1    inz(*off)
     D cnd_msg         s             42
     D cnd_values      s            110
     D cnd_rtnVal      s             10
     D cnd_array       s                   dim(32) inz like(condition)
     D cnd_ptr         s             10i 0 inz
     D condition       s             10a
     D condList        s           2000a
     D release         s             10a
     D dltsplf         s             10a
     D objd_obj        s             10a
     D objd_lib        s             10a
     D objd_objtype    s             10a
     D objd_rtnlib     s             10a
     D objd0100        ds
     D  od_bytRet              1      4i 0
     D  od_bytAvl              5      8i 0
     D  od_name                9     18a
     D  od_lib                19     28a
     D  od_type               29     38a
     D  od_rtnLib             39     48a
     D fld_array       ds
     D  fld_x                        10i 0 inz
     D  fld_name                     11a   inz dim(64) varying
     D  fld_value                    64a   inz dim(64) varying
     D var_name        s             11a   inz varying
     D var_value       s             64a   inz varying
      * Error return code parm for APIs.
     D errCode         DS
     D  errCode_bytPrv...
     D                               10i 0 inz(%size(errCode))
     D  errCode_bytAvl...
     D                               10i 0 inz(0)
     D  errCode_excID...
     D                                7a   inz
     D  errCode_reserved...
     D                                1a   inz
     D  errCode_escData...
     D                              256a   inz
      * Optional parameters
     D OvrSrcFile      s                   like(i_OvrSrcFile) inz
     D isPreDefCond    s               N   inz(*off)
     D TgtRls          s                   like(i_TgtRls    ) inz
      *
      * Program status data structure.
     D sds            sds
     D  sds_pgmName                  10A
     D  sds_status                    5S 0
     D  sds_prvStat                   5S 0
     D  sds_lastSeq                   8A
     D  sds_lastSubR                  8A
     D  sds_numParm                   3S 0
     D  sds_msgID                     7A
     D  sds_MiInstr                   4A
     D  sds_wrkArea                  30A
     D  sds_lib                      10A
     D  sds_msgText                  80A
      *--------------------------------------------------------------------
     Ixmlinput  ns
     I                                 13   21  xmltag1
     I                                 18   27  xmltag2
     I                                 13  112  xmlcode
      *--------------------------------------------------------------------
     C     *entry        plist
     C                   parm                    ParseSrcMbr      10            source member
     C                   parm                    ParseSrcFile     10            source file
     C                   parm                    ParseSrcLib      10            source lib
      *  optional parameters:
     C                   parm                    i_OvrSrcFile     10            override to src
     C                   parm                    i_Conditions    128            pre-def conditions
     C                   parm                    i_TgtRls         10            target release
      *
      *  get optional parameter: Overrride to Source File
     C                   if        %parms() >= 4
     C                   eval      OvrSrcFile = i_OvrSrcFile
     C                   else
     C                   eval      OvrSrcFile = ''
     C                   endif
      *
      *  get optional parameter: Conditions
     C                   if        %parms() >= 5
     C                   if        %subst(i_Conditions:1:32) <> ''
     C                   eval      cnd_array = loadConditions(i_Conditions)
     C                   eval      isPreDefCond = *on
     C                   else
     C                   eval      isPreDefCond = *off
     C                   endif
     C                   endif
      *
      *  get optional parameter: Target Release
     C                   if        %parms() >= 6
     C                   eval      TgtRls = i_TgtRls
     C                   else
     C                   eval      TgtRls = getCurrentRelease()
     C                   endif
      *
     C                   exsr      srValidate                                   make sure exist
      *
      * Set user selected library *first for remainder of program
     C                   eval      bldexc = 'RMVLIBLE LIB('+
     C                             %trimr(ParseSrcLib) + ')'
     C                   callp(e)  qcmdexc(bldexc:%len(%trimr(bldexc)))
      *
     C                   eval      bldexc = 'ADDLIBLE LIB('+
     C                             %trimr(ParseSrcLib) + ') POSITION(*FIRST)'
     C                   callp(e)  qcmdexc(bldexc:%len(%trimr(bldexc)))
      *
      *       CPF2103 - Library &1 already exists in library list.
     C                   if        %error and sds_msgID <> 'CPF2103'
     C                   eval      qm_msgtxt = '0000 ' + sds_msgText
     C                   exsr      srKill
     C                   endif
      *
      * Set variable &TOLIB
     C                   callp     setVariable('tolib': ParseSrcLib)
      *
      * Override Input file to uploaded text file
     C                   eval      bldexc = 'OVRDBF FILE(XMLINPUT) TOFILE(' +
     C                             %trimr(ParseSrcLib)+'/'+
     C                             %trimr(ParseSrcFile) + ') MBR(' +
     C                             %trimr(ParseSrcMbr) + ')'
     C                   callp     qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   open      xmlinput
     C                   read      xmlinput
     C                   dow       not %eof
      * write records to outfile if flag is on
     C                   select
     C                   when      write_flag = *on
     C                   if        xmltag2<>'</copysrc>'
     C                   eval      srcSeqno=srcSeqno+1
     C                   except    write_one
     C                   else
     C                   eval      write_flag=*off
     C                   close     qxxxsrc
     C                   endif
      *
      * Extract values based on xml tags.
     C                   when      xmltag1 = 'mbrname ='
     C                   eval      mbrname = %subst(xmlcode:13:10)
     C                   when      xmltag1 = 'mbrtype ='
     C                   eval      mbrtype =%subst(xmlcode:13:10)
     C                   when      xmltag1 = 'mbrtext ='
     C                   eval      mbrtext =dblQuotes(%subst(xmlcode:13:50))
     C                   when      xmltag1 = 'srcfile ='
     C                   if        OvrSrcFile <> ''
     C                   eval      srcfile =OvrSrcFile
     C                   else
     C                   eval      srcfile =%subst(xmlcode:13:10)
     C                   endif
     C                   when      xmltag1 = 'srclen  ='
     C                   eval      srclen  =%subst(xmlcode:13:5)
     C                   when      xmltag1 = 'srccssid='
     C                   eval      srccssid=%subst(xmlcode:13:5)
      *--------------------------------------------------------------------
      * Start of data to copy.  Create source files/mbrs as required.
      *--------------------------------------------------------------------
     C                   when      xmltag1='<copysrc>'
     C                   move      srclen        srclenN
      * crtsrcpf
     C                   eval      bldexc = 'CRTSRCPF FILE(' +
     C                             %trimr(ParseSrcLib)+'/'+
     C                             %trimr(srcfile) + ') RCDLEN(' +
     C                             srclen + ') CCSID(' +
     C                             srccssid + ')'
     C                   callp(e)  qcmdexc(bldexc:%len(%trimr(bldexc)))
      * addpfm
     C                   eval      bldexc = 'ADDPFM   FILE(' +
     C                             %trimr(ParseSrcLib)+'/'+
     C                             %trimr(srcfile) + ') MBR(' +
     C                             %trimr(mbrname) + ') SRCTYPE(' +
     C                             %trimr(mbrtype) + ') TEXT(' +
     C                             qs+%trimr(mbrtext)+qs + ')'
     C                   callp(e)  qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   if        %error
      * chgpfm
     C                   eval      bldexc = 'CHGPFM   FILE(' +
     C                             %trimr(ParseSrcLib)+'/'+
     C                             %trimr(srcfile) + ') MBR(' +
     C                             %trimr(mbrname) + ') TEXT(' +
     C                             qs+%trimr(mbrtext)+qs + ')'
     C                   callp     qcmdexc(bldexc:%len(%trimr(bldexc)))
      * clr mbr
     C                   eval      bldexc = 'CLRPFM   FILE(' +
     C                             %trimr(ParseSrcLib)+'/'+
     C                             %trimr(srcfile) + ') MBR(' +
     C                             %trimr(mbrname) + ')'
     C                   callp     qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   endif
      * ovr to outfile mbr
     C                   eval      bldexc = 'OVRDBF QXXXSRC ' +
     C                             %trimr(ParseSrcLib) + '/' +
     C                             %trimr(srcfile) + ' ' +
     C                             mbrname
     C                   callp     qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   clear                   srcSeqno
     C                   open      qxxxsrc
     C                   eval      write_flag = *on
      *--------------------------------------------------------------------
      * Compile statement.  Read next record and execute it.
      * The subroutine TolibToken will replace &tolib with the
      * library the user has selected at run time.
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<compile '
     C                   eval      condList= getAttrData('condition':xmlcode:'')
     C                   read      xmlinput
     C                   eval      bldexc = readElement('compile')
     C                   if        isCondition(condList)
     C                   exsr      TolibToken
     C                   exsr      RplVars
     C                   exsr      SetTgtRls
     C                   callp     qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   endif
      *--------------------------------------------------------------------
      * qcmdexc statement. Build statement from each record between start
      * and stop tags.  When stop tag is found, execute statement.
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<qcmdexc '
     C                   eval      condList = getAttrData('condition'
     C                                                    :xmlcode:'')
     C                   eval      release  = getAttrData('release'
     C                                                    :xmlcode:'*CURRENT')
     C                   eval      dltsplf  = getAttrData('dltsplf'
     C                                                    :xmlcode:'*NONE')
     C                   read      xmlinput
     C                   eval      bldexc = readElement('qcmdexc')
     C                   if        isCondition(condList) and
     C                             isRelease(tgtRls: release)
     C                   exsr      TolibToken
     C                   exsr      RplVars
     C                   exsr      SetTgtRls
     C                   if        %subst(bldexc: 1: 3) = 'DLT'
     C                   callp (e) qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   else
     C                   callp (e) qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   if        %error()
     C                   eval      qm_msgtxt = '0000 Failed to execute: '+bldexc
     C                   exsr      srKill
     C                   endif
     C                   if        dltsplf <> '' and dltsplf <> '*NONE'
     C                   eval      bldexc = 'DLTSPLF FILE(' + dltsplf +
     C                                      ') JOB(*) SPLNBR(*LAST)'
     C                   callp (e) qcmdexc(bldexc:%len(%trimr(bldexc)))
     C                   endif
     C                   endif
     C                   endif
      *--------------------------------------------------------------------
      * SQL statement. Build statement from each record between start
      * and stop tags.  When stop tag is found, execute SQL statement.
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<execsql '
     C                   eval      condList = getAttrData('condition'
     C                                                    :xmlcode:'')
     C                   read      xmlinput
     C                   eval      bldexc = readElement('execsql')
     C                   if        isCondition(condList)
     C                   exsr      TolibToken
     C                   exsr      RplVars
     C                   exsr      srSQLExecute
     C                   endif
      *--------------------------------------------------------------------
      * Send messages to user as program executes
      * Extract message ID, Message Type, from <sendmsg>
      * read a record and get the single line of message text.
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<sendmsg '
     C                   eval      qm_msgid = %subst(xmlcode:22:7)
     C                   eval      qm_msgtyp = %subst(xmlcode:46:10)
     C                   read      xmlinput
     C                   eval      qm_msgq   = '*EXT   '
     C                   eval      qm_msgtxt = xmlcode
     C                   exsr      srSndMessage
      *--------------------------------------------------------------------
      * rtvobjd statement. retrieve object description of the specified
      * object. Store attributes in specified fields.
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<rtvobjd '
     C                   eval      condList = getAttrData('condition'
     C                                                    :xmlcode:'')
     C                   eval      bldexc = readElement('rtvobjd')
     C                   eval      objd_obj    =getAttrData('obj'    :bldexc:'')
     C                   eval      objd_lib    =getAttrData('lib'    :bldexc:'')
     C                   eval      objd_objtype=getAttrData('objtype':bldexc:'')
     C                   eval      objd_rtnlib =getAttrData('rtnlib' :bldexc:'')
     C                   if        isCondition(condList)
     C                   exsr      srRtvObjD
     C                   endif
      *--------------------------------------------------------------------
      * chgvar statement.
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<chgvar  '
     C                   eval      condList = getAttrData('condition'
     C                                                    :xmlcode:'')
     C                   eval      bldexc = readElement('chgvar')
     C                   eval      var_name  = getAttrData('var'    :bldexc:'')
     C                   eval      var_value = getAttrData('value'  :bldexc:'')
     C                   if        isCondition(condList)
     C                   exsr      srChgVar
     C                   endif
      *--------------------------------------------------------------------
      * Query condition
      *--------------------------------------------------------------------
     C                   when      xmltag1 = '<qrycond '
     C                   eval      bldexc = readElement('qrycond')
     C                   eval      cnd_msg    = getAttrData('msg'   : bldexc:'')
     C                   eval      cnd_values = getAttrData('values': bldexc:'')
     C                   exsr      srQueryCond
     C                   endsl
      *
     C                   read      xmlinput
     C                   enddo
      *
     C                   exsr      srSQLEnd
     C                   eval      *inlr=*on
     C                   return
      *--------------------------------------------------------------------
      * Replace &tolib (no matter how many times it is in the string)
      * with whatever library the user has selected at run time.
      *--------------------------------------------------------------------
     C     TolibToken    begsr
     C                   eval      aa=%scan('&tolib':bldexc)
     C                   dow       aa>0
     C                   eval      bldexc=%replace(%trimr(ParseSrcLib):bldexc:
     C                             aa:6)
     C                   eval      aa=%scan('&tolib':bldexc)
     C                   enddo
      *  user has selected to override source, reset SRCFILE parm in bldexcs.
     C                   if        OvrSrcFile <> ''                             xmlpreview override
     C                   eval      aa=%scan('SRCFILE(':bldexc)
     C                   if        aa>0
     C                   eval      aa=%scan('/':bldexc:aa)
     C                   if        aa>0
     C                   eval      ll=%scan(')':bldexc:aa)
     C                   eval      bldexc=%replace(
     C                               %trimr(OvrSrcFile):bldexc:aa+1:ll-(aa+1))
     C                   endif
     C                   endif
     C                   endif
     C                   endsr
      *--------------------------------------------------------------------
      * Replace variable names with their associated values.
      *--------------------------------------------------------------------
     C     RplVars       begsr
     C                   eval      aa=%scan('&':bldexc)
     C                   dow       aa>0
     C                   eval      var_name=getVarName(bldexc:aa)
     C                   eval      var_value=getVarValue(var_name)
     C                   eval      bldexc=%replace(var_value:bldexc:aa
     C                                             :%len(var_name))
     C                   eval      aa=%scan('&':bldexc)
     C                   enddo
     C                   endsr
      *--------------------------------------------------------------------
      * Sets the target release according to the optional parameter
      * i_TgtRls.
      *--------------------------------------------------------------------
     C     SetTgtRls     begsr
     C                   if        TgtRls = getCurrentRelease()
     C                   leavesr
     C                   endif
     C                   eval      bldexc =
     C                                setTargetRelease('TGTRLS': bldexc: TgtRls)
     C                   endsr
      *--------------------------------------------------------------------
      * Check of file, lib, member exist.
      *--------------------------------------------------------------------
     C     srValidate    begsr
     C                   callp     QUSRMBRD(
     C                             vrcvar:
     C                             145:
     C                             'MBRD0100':
     C                             ParseSrcFile + ParseSrcLib:
     C                             ParseSrcMbr:
     C                             '0':
     C                             errCode)
      *   --------------------------------------------------------------------------------
      *   If error occurred on call, send appropriate message back to user.
      *   ---------------------------------------------------------------------------------
     C                   if        errCode_bytAvl <> 0                          error occurred
     C                   select
      * lib not found
     C                   when      errCode_excID = 'CPF9810'
     C                   eval      qm_msgtxt = '0000 Library ' +
     C                             %trimr(ParseSrcLib) + ' was not found.'
      * src file not found
     C                   when      errCode_excID = 'CPF9812'
     C                   eval      qm_msgtxt = '0000 Source file ' +
     C                             %trimr(ParseSrcFile)+' was not found in ' +
     C                             %trimr(ParseSrcLib) + '.'
      * member not found
     C                   when      errCode_excID = 'CPF9815'
     C                   eval      qm_msgtxt = '0000 Member ' +
     C                             %trimr(ParseSrcMbr)+' was not found in ' +
     C                             %trimr(ParseSrcLib)+'/'+ %trimr(ParseSrcFile)
      * unexpected
     C                   other
     C                   eval      qm_msgtxt = '0000 Unexpected message ' +
     C                             errCode_excID + ' received. '
     C                   endsl
      * send message
     C                   exsr      srKill
     C                   eval      *inlr=*on
     C                   return
     C                   endif
     C                   endsr
      *--------------------------------------------------------------------
      * kill application
      *--------------------------------------------------------------------
     C     srKill        begsr
     C                   eval      qm_msgid  = 'CPD0006'
     C                   eval      qm_msgtyp = '*DIAG'
     C                   eval      qm_msgq   = '*CTLBDY'
     C                   exsr      srSndMessage
     C                   eval      qm_msgtxt = *blanks
     C                   eval      qm_msgid  = 'CPF0002'
     C                   eval      qm_msgtyp = '*ESCAPE'
     C                   exsr      srSndMessage
     C                   endsr
      *--------------------------------------------------------------------
      * call send program message api
      *--------------------------------------------------------------------
     C     srSndMessage  begsr
     C                   callp     QMHSNDPM(
     C                             qm_msgid:
     C                             'QCPFMSG   *LIBL     ':
     C                             qm_msgtxt:
     C                             %size(qm_msgtxt):
     C                             qm_msgtyp:
     C                             qm_msgq:
     C                             1:
     C                             '    ':
     C                             errCode)
     C                   endsr
      *--------------------------------------------------------------------
      * retrieve object description and store attributes
      *--------------------------------------------------------------------
     C     srRtvObjD     begsr
     C                   callp     QUSROBJD(objd0100
     C                                      : %size(objd0100)
     C                                      : 'OBJD0100'
     C                                      : objd_obj + objd_lib
     C                                      : objd_objtype
     C                                      : errCode)
     C                   if        errCode_bytAvl <> 0                          error occurred
     C                   eval      qm_msgtxt = '0000 Failed to retrieve +
     C                             object description of object ' +
     C                             %trim(objd_lib) + '/' + %trim(objd_obj) +
     C                             ' type ' + %trim(objd_objtype) + '.'
      * send message
     C                   exsr      srKill
     C                   else
     C                   callp     setVariable(objd_rtnlib: od_rtnlib)
     C                   endif
     C                   endsr
      *--------------------------------------------------------------------
      * change variable
      *--------------------------------------------------------------------
     C     srChgVar      begsr
     C                   callp     setVariable(var_name: var_value)
     C                   endsr
      *--------------------------------------------------------------------
      * execute SQL statement.
      *--------------------------------------------------------------------
     C     srSQLExecute  begsr
     C                   exsr      srSQLInit
     C                   Eval      retCode = SQLExecDirect(hstmt    :
     C                                                     bldexc   :
     C                                                     SQL_NTS  )
     C                   endsr
      *--------------------------------------------------------------------
      * query condition.
      *--------------------------------------------------------------------
     C     srQueryCond   begsr
     C                   if        isPreDefCond = *off
     C                   eval      cnd_values = uCase(cnd_values)
     C                   dou       (%scan(cnd_rtnVal: cnd_values) > 0) and
     C                             (cnd_rtnval <> ''                 )
     C                   eval      cnd_rtnval = ' '
     C     cnd_msg       dsply                   cnd_rtnval
     C                   eval      cnd_rtnVal = uCase(cnd_rtnVal)
     C                   enddo
     C                   eval      cnd_ptr = cnd_ptr + 1
     C                   eval      cnd_array(cnd_ptr) = cnd_rtnVal
     C                   endif
     C                   endsr
      *--------------------------------------------------------------------
      * initialize SQL.
      *--------------------------------------------------------------------
     C     srSQLInit     begsr
      *
     C                   if        sqlInit = *off
     C                   Eval      retCode = SQLAllocEnv(%addr(henv))
     C                   Eval      retCode = SQLAllocConnect(henv: %addr(hdbc))
     C                   Eval      retCode = SQLConnect(hdbc      :
     C                                                  '*LOCAL'  :
     C                                                  SQL_NTS   :
     C                                                  *null     :
     C                                                  SQL_NTS   :
     C                                                  *null     :
     C                                                  SQL_NTS   )
     C                   Eval      cOptVal = SQL_COMMIT_NONE
     C                   Eval      retCode = SQLSetConnectOption(hdbc          :
     C                                                          SQL_ATTR_COMMIT:
     C                                                          %addr(cOptVal) )
     C                   Eval      retCode = SQLAllocStmt(hdbc       :
     C                                                  %addr(hstmt) )
     C                   eval      sqlInit = *on
     C                   endif
     C                   endsr
      *--------------------------------------------------------------------
      * end SQL.
      *--------------------------------------------------------------------
     C     srSQLEnd      begsr
     C                   if        sqlInit = *on
     C                   Eval      retCode = SQLFreeStmt(hstmt    :
     C                                                   SQL_DROP )
     C                   Eval      retCode = SQLDisconnect(hdbc)
     C                   Eval      retCode = SQLFreeConnect(hdbc)
     C                   Eval      retCode = SQLFreeEnv(henv)
     C                   eval      sqlInit = *off
     C                   endif
     C                   endsr
      *--------------------------------------------------------------------
      * error handler
      *--------------------------------------------------------------------
     C     *pssr         begsr
     C                   if        errFLag = *off
     C                   eval      errFlag = *on
     C                   exsr      srSQLEnd
     C                   endif
     C                   endsr     '*CANCL'
     Oqxxxsrc   e            write_one
     O                       srcSeqno             6
     O                                           12 '000000'
     O                       xmlcode            112
      *--------------------------------------------------------------------
      * Read element
      *--------------------------------------------------------------------
     P readElement...
     P                 B
      *
     D readElement     PI                        like(bldexc)
     D  i_element                     9A   value varying
      *
     D i               S             10I 0 inz
     D value           S                   like(bldexc ) inz
     D endTag          S                   like(xmlTag2) inz
      *
     C                   eval      i = 1
     C                   eval      endTag = '</' + i_element + '>'
     C                   dow       xmltag2 <> endTag
     C                   eval      %subst(value: i: %len(xmlcode)) = xmlcode
     C                   eval      i = i + %len(xmlcode)
     C                   read      xmlinput
     C                   enddo
      *
     C                   Return    value
      *
     P readElement...
     P                 E
      *--------------------------------------------------------------------
      * Double quotes
      *--------------------------------------------------------------------
     P dblQuotes...
     P                 B
      *
     D dblQuotes       PI          2048A         varying
     D  i_string                   2048A   value varying
      *
     D x               S             10I 0         inz
     D string          S           2048A   varying inz
      *
     C                   For       x = 1 to %len(i_string)
     C                   Eval      string = string + %subst(i_string: x:1)
     C                   If        %subst(i_string: x : 1) = qs
     C                   Eval      string = string + qs
     C                   Endif
     C                   Endfor
      *
     C                   Return    string
      *
     P dblQuotes...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Get Attribute Data from String
      *---------------------------------------------------------------------------------------------
     P getAttrData...
     P                 B
      *
     D getAttrData...
     D                 PI          2000A          varying                       like(string_t)
     D  i_attr                       10a   value
     D  i_string                   2000A   value  varying                       like(string_t)
     D  i_default                  2000A   value  varying                       like(string_t)
      *
      *  return value
     D attrData        S           2000A   varying inz                          like(string_t)
      *
      *  local fields
     D attr            S             20a   varying inz
     D lenAttr         S             10i 0 inz
     D aa              S             10i 0 inz
     D cc              S             10i 0 inz
      *
     D Qd              C                   const('"')
      *-------------------------------------------------------------------*
      *
      *  find the keyword
     C                   eval      attr = %trim(i_attr) + '=' + Qd
      *
     C                   eval      aa   = %scan(attr: i_string)
     C                   if        aa = 0
     C                   return    i_default
     C                   endif
      *
     C                   eval      aa   = aa + %len(attr)
     C                   eval      cc   = %scan(Qd: i_string: aa+1)
      *
      *  return the data between the double-quotes
     C                   if        (cc-aa) > 0
     C                   eval      attrData = %subst(i_string: aa: cc-aa)
     C                   endif
      *
     C                   Return    attrData
      *
     P getAttrData...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Load condition array
      *---------------------------------------------------------------------------------------------
     P loadConditions...
     P                 B
      *
     D loadConditions...
     D                 PI                  dim(32) like(condition)
     D  i_conditions                128A   value
      *
      *  return value
     D cnd_array       s                   dim(32) inz like(condition)
     D pValue          s               *   inz
     D x               s             10i 0 inz
      *-------------------------------------------------------------------*
     C                   eval      i_conditions = uCase(i_conditions)
      *
     C                   eval      pValue = strtok(i_conditions: ';')
     C                   dow       pValue <> *null
     C                   eval      x = x + 1
     C                   eval      cnd_array(x) = %str(pValue)
     C                   eval      pValue = strtok(*null: ';')
     C                   enddo
      *
     C                   Return    cnd_array
     P loadConditions...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Check for a condition
      *---------------------------------------------------------------------------------------------
     P isCondition...
     P                 B
      *
     D isCondition...
     D                 PI              n
     D  i_condList                 2000A   value
      *
      *  return value
     D isCondition     S               n   inz
     D pValue          S               *   inz
     D aCondition      S             10a   inz
      *-------------------------------------------------------------------*
     C                   eval      i_condList = uCase(i_condList)
      *
     C                   if        (i_condList = '*NONE')  or
     C                             (i_condList = ''     )
     C                   eval      *in01 = *on
     C                   else
      *
     C                   eval      pValue = strtok(i_condList: ' ')
     C                   dow       pValue <> *null
     C                   eval      aCondition = %str(pValue)
     C     aCondition    lookup    cnd_array                              01
     C                   if        not *in01
     C                   leave
     C                   endif
     C                   eval      pValue = strtok(*null     : ' ')
     C                   enddo
      *
     C                   endif
      *
     C                   if        *in01
     C                   eval      isCondition = *on
     C                   else
     C                   eval      isCondition = *off
     C                   endif
      *
     C                   Return    isCondition
     P isCondition...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Get the current release level of the operation system
      *---------------------------------------------------------------------------------------------
     P getCurrentRelease...
     P                 B
      *
     D getCurrentRelease...
     D                 PI            10A
      *
      *  QSZRTVPR API
     D QSZRTVPR...
     D                 PR                  extpgm('QSZRTVPR')
     D  o_rcvVar                  65535A          options(*varsize)
     D  i_lenRcvVar                  10I 0 const
     D  i_format                      8A   const
     D  o_prodInf                 65535A   const  options(*varsize)
     D  io_errCode                65535A          options(*varsize)
      *
     D prdi0100        DS                  qualified
     D  productID              1      7A   inz('*OPSYS')
     D  releaseLvl             8     13A   inz('*CUR'  )
     D  productOpt            14     17A   inz('0000'  )
     D  loadID                18     27A   inz('*CODE' )
      *  Shortened!:
     D prdr0100        DS                  qualified
     D  bytRet                 1      4I 0
     D  bytAvl                 5      8I 0
     D  reserved_1             9     12I 0
     D  productID             13     19A
     D  releaseLvl            20     25A
      *  API error code
     D errCode         DS
     D  bytPrv                       10i 0 inz(0)
     D  bytAvl                       10i 0 inz(0)
      *-------------------------------------------------------------------*
     C                   Callp     QSZRTVPR(prdr0100: %size(prdr0100):
     C                                      'PRDR0100': prdi0100: errCode)
     C                   Return    prdr0100.releaseLvl
     P getCurrentRelease...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Check the release level
      *---------------------------------------------------------------------------------------------
     P isRelease...
     P                 B
      *
     D isRelease...
     D                 PI              n
     D  i_os_release                  6A   value
     D  i_release                    10A   value
      *
      *  return value
     D isRelease       S               n   inz(*off)
      *  Release
     D release         DS
     D  r_operator             1      3a
     D  r_space                4      4a
     D  r_level                5     10a
      *-------------------------------------------------------------------*
     C                   If        i_release = '*CURRENT'
     C                   Eval      isRelease = *on
     C                   Else
     C                   Eval      release = i_release
     C                   Select
     C                   When      r_operator = '*LT' and
     C                             i_os_release < r_level
     C                   Eval      isRelease = *on
     C                   When      r_operator = '*EQ' and
     C                             i_os_release = r_level
     C                   Eval      isRelease = *on
     C                   When      r_operator = '*GT' and
     C                             i_os_release > r_level
     C                   Eval      isRelease = *on
     C                   When      r_operator = '*LE' and
     C                             i_os_release <= r_level
     C                   Eval      isRelease = *on
     C                   When      r_operator = '*GE' and
     C                             i_os_release >= r_level
     C                   Eval      isRelease = *on
     C                   Other
     C                   Eval      isRelease = *off
     C                   Endsl
     C                   Endif
      *
     C                   Return    isRelease
     P isRelease...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Replaces the value of a given keyword.
      *---------------------------------------------------------------------------------------------
     P setTargetRelease...
     P                 B
      *
     D setTargetRelease...
     D                 PI          2000A          varying
     D  i_keyword                    10A   value  varying
     D  i_string                   2000A   value  varying
     D  i_value                      10A   value  varying
      *
      *  return value
     D string          S           2000A   varying inz
      *
      *  helper fields
     D x               S             10I 0 inz
     D l               S             10I 0 inz
     D tmpKeyword      S                   like(i_keyword) inz
     D tmpString       S                   like(i_string ) inz
     D tmpCmd          S             10A   inz
      *-------------------------------------------------------------------*
      /FREE
         tmpKeyword = uCase(%trimR(i_keyword));
         tmpString  = uCase(%trimR(i_string ));
         x = %scan(' ': tmpString);
         if x = 0;
            return i_string;
         endif;
         tmpCmd = %subst(tmpString: 1: x);
         if tmpCmd <> 'CRTRPGMOD' and
            tmpCmd <> 'CRTRPGPGM' and
            tmpCmd <> 'CRTCLMOD'  and
            tmpCmd <> 'CRTCLPGM'  and
            tmpCmd <> 'CRTCBLMOD' and
            tmpCmd <> 'CRTCBLPGM' and
            tmpCmd <> 'CRTCMOD'   and
            tmpCmd <> 'CRTCPPMOD' and
            tmpCmd <> 'CRTBNDC'   and
            tmpCmd <> 'CRTBNDCBL' and
            tmpCmd <> 'CRTBNDCL'  and
            tmpCmd <> 'CRTBNDCPP' and
            tmpCmd <> 'CRTBNDDIR' and
            tmpCmd <> 'CRTBNDRPG' and
            tmpCmd <> 'CRTPGM'    and
            tmpCmd <> 'CRTSRVPGM' ;
            return i_string;
         endif;
         x = %scan(tmpKeyword + '(': tmpString);
         if x = 0;
            return %trimR(i_string) +
                   ' ' + tmpKeyword + '(' + %trimR(i_value) + ')';
         endif;
         l = %scan(')': tmpString: x + %len(i_keyword) + 1);
         if l = 0;
            return i_string;
         endif;
         l = l - x + 1;
         string = %replace(tmpKeyword + '(' + %trimR(i_value) + ')'
                           : i_string: x: l);
         Return string;
      /END-FREE
      *
     P setTargetRelease...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  Store field value.
      *---------------------------------------------------------------------------------------------
     P setVariable...
     P                 B
      *
     D setVariable...
     D                 PI
     D  i_fldName                    10A   value  varying
     D  i_value                      64A   value  varying
     D i               s             10I 0 inz
      *-------------------------------------------------------------------*
      /FREE
         if (i_fldName = '');
            return;
         endif;
         for i = 1 to fld_x;
            if (uCase('&' + %trim(i_fldName)) = uCase(fld_name(fld_x)));
               fld_value(fld_x) = i_value;
               leave;
            endif;
         endfor;
         if (fld_x >= %elem(fld_name));
            return;
         endif;
         fld_x = fld_x + 1;
         fld_name(fld_x)  = uCase('&' + %trim(i_fldName));
         fld_value(fld_x) = i_value;
      /END-FREE
      *
     P setVariable...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  get variable name from statement.
      *---------------------------------------------------------------------------------------------
     P getVarName...
     P                 B
      *
     D getVarName...
     D                 PI            11a          varying
     D  i_bldexc                           value  like(bldexc)
     D  i_pos                        10i 0 value
     D name            s             11a   varying inz
     D CHARS           c                   '&ABCDEFGHIJKLMNOPQRSTUVWXYZ+
     D                                      1234567890_'
      *-------------------------------------------------------------------*
      /FREE
         dow (i_pos<=%len(i_bldexc) and
              %check(CHARS:%subst(i_bldexc:i_pos:1))=0);
            name = name+%subst(i_bldexc:i_pos:1);
            i_pos=i_pos+1;
         enddo;
         return name;
      /END-FREE
      *
     P getVarName...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  get variable value.
      *---------------------------------------------------------------------------------------------
     P getVarValue...
     P                 B
      *
     D getVarValue...
     D                 PI            64a          varying
     D  i_name                       11a   value  varying
     D i               s             10i 0 inz
     D value           s             64a   varying inz
      *-------------------------------------------------------------------*
      /FREE
         for i=1 to fld_x;
            if (ucase(fld_name(i))=uCase(i_name));
               value=%trimR(fld_value(i));
               leave;
            endif;
         endfor;
         return value;
      /END-FREE
      *
     P getVarValue...
     P                 E
      *---------------------------------------------------------------------------------------------
      *  convert to upper case
      *---------------------------------------------------------------------------------------------
     P uCase...
     P                 B
      *
     D uCase...
     D                 PI          2000A          varying
     D  i_string                   2000A   value  varying
     D uCase           s           2000A   inz varying
     D LC              C                   const('abcdefghijklmnopqrstuvwxyz')
     D UC              C                   CONST('ABCDEFGHIJKLMNOPQRSTUVWXYZ')
      *-------------------------------------------------------------------*
      /FREE
         uCase = %xlate(LC:UC:i_string);
         return uCase;
      /END-FREE
      *
     P uCase...
     P                 E
      * /// END   OF INSTALL PGM HERE   ****************************************** ///
      * /// do not copy past this point ///
]]>  </install_program>
<qrycond  msg="'Create sample programs? (YES, NO)'" values="YES        NO"><![CDATA[
]]>  </qrycond>
<qrycond  msg="'C-Compiler available? (C_YES, C_NO)'" values="C_YES      C_NO"><![CDATA[
]]>  </qrycond>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1C7)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RA)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RB)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RC)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RD)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RE)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RF)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RG)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RH)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R1)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R2)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R3)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R4)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R5)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R6)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R7)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R8)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R9)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RA_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RA_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RA_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RB_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RD_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RE_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RH_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R1_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R1_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R1_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R2_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_06)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_07)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_08)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_09)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_10)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_11)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_12)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_13)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_14)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R4_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R6_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R6_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_06)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_07)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_08)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_09)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R8_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R8_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTSRVPGM SRVPGM(&tolib/BASICS1)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RA_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RA_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RA_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RB_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RC_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RC_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RC_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RC_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RC_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RD_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RE_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_RH_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R1_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R1_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R1_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R2_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_06)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_07)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_08)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_09)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_10)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_11)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_12)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_13)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R3_14)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R4_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R5_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R5_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R5_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R5_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R5_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R6_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R6_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_06)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_07)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_08)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R7_09)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R8_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTPGM PGM(&tolib/TEST_R8_02)
]]>  </qcmdexc>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing A_README  type TXT - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "A_README  "
mbrtype =  "TXT       "
mbrtext =  "History BASICS1 Service Program                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
-----------------------
      History
-----------------------


Version 1.14.5
--------------

Added:   Procedures:
            f_cvtEpochTS()
            f_cvtTSEpoch()
            f_cvtMiTimeTS()
            f_cvtTSMiTime()


Version 1.14.2
--------------

Changed: Changed BasicList to store up to 1.044.473 items.
Changed: Added error message 'Failed to allocate memory' which is sent
         when BasicList could not allocate/reallocate memory.
Added:   Added BasicList_getTotalSize() to return the total size of
         memory used by a given BasicList.


Version 1.14.1
--------------

Changed: Updated member CLIB.


Version 1.14
------------

Added:   Procedures :
            BasicProperties_*
            f_setErrno()
            MemoryReader_*
            MemoryWriter_*
Changed: Renamed the BasicMap_KeySet_* procedures and type templates to:
            BasicMap_newKeySet()
            BasicKeySet_getFirst()
            BasicKeySet_getNext()
            BasicKeySet_delete()
            BasicKeySet_handle_t


Version 1.13.2
--------------

Added:   Procedure f_startsWithIgnoreCase().


Version 1.13.1
--------------

Fixed:   Now passing the right length to f_genSHA1() in order to
         generate a SHA-1 hash from a buffer. (TEST_R7_05)
Changed: Added CCSID(*CHAR: *JOBRUN) to member H_SPEC as recommended
         by Barbara Morris. (RPG Cafe: 'An H spec keyword that you
         might be missing')


Version 1.13
------------

Added:   Procedures BasicMap_getKeys() and BasicMap_getValues().
Added:   Procedure f_getSndInfOfRcvMsg().
Added:   Procedures f_rtvSysVal_char() and f_rtvSysVal_num().
Added:   Procedure f_cvtPtrToHexString().
Added:   Added parameter 'i_heapID' to BasicList_new(), BasicStack_new() and
         BasicMap_new().
Added:   MemoryManager.
Added:   Procedures BasicList_getHeapID(), BasicStack_getHeapID() and BasicMap_getHeapID().


Version 1.12.1
--------------

Fixed:   Changed passing mode of parameter i_followLnk of prototype Qp0lGetAttr
         from 'const' to 'value'.


Version 1.12
------------

Fixed:   Fixed problem in f_genStrCmp() that does not properly
         compare strings that contain multiple dots.


Version 1.11
------------

Changed: Added prompter action support to f_execute().
Changed: Moved declaration of user space APIs to member QUSRSPC.
Changed: Renamed f_getDisplayMode() to Display_getMode().
Fixed:   Fixed problem in f_wordwrap() that caused a runtime error
         in case that the last character of the input string is an
         EOP escape character.
Added:   Test program TEST_R5_04 to check user space procedures.
Added:   Test program TEST_R3_13 to check date formatter and parser.
Added:   Test program TEST_R3_14 to check f_formatMemSize().
Added:   Procedures: f_chgUsrSpcSize()
                     f_getUsrSpcSize()
                     f_chgUsrSpcAutoExt()
                     f_getUsrSpcAutoExt()
                     f_chgUsrSpcInitValue()
                     f_getUsrSpcInitValue()
                     f_rplUnPrtChars()
                     f_formatDate()
                     f_parseDate()
                     f_formatMemSize()
                     Display_supportsDS4()
                     Display_supportsGUI()
                     Display_getRows()
                     Display_getColumns()
                     p_wait()
                     f_dateSerial()

Procedures with V1.11                          Program:
----------------------------------------       ----------------------------------------
BASICS1R5_f_chgUsrSpcSize                      TEST_R5_04
BASICS1R5_f_getUsrSpcSize                      TEST_R5_04
BASICS1R5_f_chgUsrSpcAutoExt                   TEST_R5_04
BASICS1R5_f_getUsrSpcAutoExt                   TEST_R5_04
BASICS1R5_f_chgUsrSpcInitValue                 TEST_R5_04
BASICS1R5_f_getUsrSpcInitValue                 TEST_R5_04


Version 1.10
------------

Fixed:   Changed size of parameter 'i_text' or f_crtUsrSpc() from 10A to 50A.
Added:   Procedures: f_getObjLib()
                     f_objName()
                     f_rcvPgmMsgObj()


Version 1.9
-----------

Changed: Enabled BasicMap to store NULL values.
Changed: Added optional parameter 'offset' to f_caller().
         (Needed for the Log4rpg stub module.)
Added:   Procedures: BasicList_clone()
                     BasicMap_clone()


Version 1.8.1
-------------

Changed: Enabled BasicMap_KeySet_new() to be called more than once.
         Introduced a real KeySet handle.


Version 1.8
-----------

Changed: Changed internal structure of Map object. Introduced a real handle for the Map.
Changed: Changed internal structure of Stack object. Introduced a real handle for the Stack.
Changed: Enabled BasicList to store NULL values.
Added:   Procedures: BasicList_isSorted()
                     BasicList_addNull()
                     BasicList_setNull()
                     BasicList_isNullValue()
                     BasicMap_KeySet_new()
                     BasicMap_KeySet_getFirst()
                     BasicMap_KeySet_getNext()
                     BasicMap_KeySet_delete()
Added:   BasicList   Check type of handle restrictively.
         BasicStack  Check type of handle restrictively.
         BasicMap    Check type of handle restrictively.


Version 1.7.2
-------------

Fixed:   Error in FDMBRD0100. Invalid length of MBRD0100.SRCFILE. Renamed sub field
         'srcFile' to 'isSrcFile'.


Version 1.7.1
-------------

Fixed:   Memory leak in BasicMap. BasicMap_remove() did not properly
         free the memory used by the map entry data.


Version 1.7
-----------

Fixed:   Now BasicStack_pop() correctly removes the list entry
         for NULL pointer returned by BasicList_get(). That happens
         if a NULL string was pushed onto the stack.
Changed: Changed f_execute() to receive an error message directly
         rather that trying to get it from the errorCode parameter.
Changed: Added assert() to BasicMap_put() to ensure that the 'i_key'
         contains a value greater than 0.
Changed: Enhanced f_cvtApiErrCodeToMsg() to
         receive the original error message from the previous call
         stack entry, if possible.
Added:   Procedures: f_endsWith()
                     f_containsInvalidCharAt()
                     f_containsStringAt()
Added:   Procedures: BasicMap_getSizeByIndex()
                     BasicMap_putString()
                     BasicMap_getString()
                     BasicMap_putInteger()
                     BasicMap_getInteger()
Added:   Procedures: Url_new()
                     Url_getFile()
                     Url_getHost()
                     Url_getPath()
                     Url_getPort()
                     Url_getProtocol()
                     Url_getQuery()
                     Url_getMbr()
                     Url_toString()
                     Url_setFile()
                     Url_setHost()
                     Url_setPath()
                     Url_setPort()
                     Url_setProtocol()
                     Url_setQuery()


Version 1.6.3
-------------

Added:   Procedure f_cvtRcvMsgToMsg().


Version 1.6.2
-------------

Fixed:   Fixed problem in f_cvtErrnoToMsg(). Now errors without
         corresponding message description in QC2MSGF are
         returned as CPF9898 message.
Added:   Procedure BasicStack_peek().
Added:   Procedure BasicStack_clear().
Added:   Procedure BasicList_clear().
Added:   Procedure BasicMap_clear().
Changed: Removed external data structures from distribution package.


Version 1.6.1
-------------

Changed: Changed BasicList_get() to initialize only that bytes of
         the return buffer that are beyond the length of the list entry.
Fixed:   Changed f_getEnvVarByIndex to respect the length of the
         environment variable.


Version 1.6
-----------

Procedures with V1.6                           Program:
----------------------------------------       ----------------------------------------
BASICS1R8_MEMORY_allocate                      TEST_R8_02
BASICS1R8_MEMORY_freeAll                       TEST_R8_02
BASICS1R8_MEMORY_free                          TEST_R8_02
BASICS1R5_f_activateSrvPgm                     LOG4RPG
BASICS1R5_f_getProcPtrByName                   LOG4RPG
BASICS1RA_BasicList_add                        TEST_RA_01
BASICS1RA_BasicList_addPointer
BASICS1RA_BasicList_addString                  TEST_RA_01
BASICS1RA_BasicList_delete                     TEST_RA_01
BASICS1RA_BasicList_find                       TEST_RA_01
BASICS1RA_BasicList_findString                 TEST_RA_01
BASICS1RA_BasicList_get                        TEST_RA_01
BASICS1RA_BasicList_getListType                TEST_RA_01
BASICS1RA_BasicList_getNumE                    TEST_RA_01
BASICS1RA_BasicList_getPointer
BASICS1RA_BasicList_getSize                    TEST_RA_01
BASICS1RA_BasicList_getString                  TEST_RA_01
BASICS1RA_BasicList_getType                    TEST_RA_01
BASICS1RA_BasicList_isListTypeOf               TEST_RA_01
BASICS1RA_BasicList_isNull                     TEST_RA_01
BASICS1RA_BasicList_isTypeOf                   TEST_RA_01
BASICS1RA_BasicList_new                        TEST_RA_01
BASICS1RA_BasicList_null
BASICS1RA_BasicList_remove
BASICS1RA_BasicList_set
BASICS1RA_BasicList_setAutoSort
BASICS1RA_BasicList_setPointer
BASICS1RA_BasicList_setString
BASICS1RA_BasicList_sort
BASICS1RB_BasicStack_delete                    TEST_RB_01
BASICS1RB_BasicStack_getNumE                   TEST_RB_01
BASICS1RB_BasicStack_getSize                   TEST_RB_01
BASICS1RB_BasicStack_isNull                    TEST_RB_01
BASICS1RB_BasicStack_new                       TEST_RB_01
BASICS1RB_BasicStack_null                      TEST_RB_01
BASICS1RB_BasicStack_pop                       TEST_RB_01
BASICS1RB_BasicStack_push                      TEST_RB_01
BASICS1RC_BasicMap_containsKey                 TEST_RC_01
BASICS1RC_BasicMap_delete                      TEST_RC_01
BASICS1RC_BasicMap_get                         TEST_RC_01
BASICS1RC_BasicMap_getKeyByIndex
BASICS1RC_BasicMap_getValueByIndex             TEST_RC_01
BASICS1RC_BasicMap_getNumE                     TEST_RC_01
BASICS1RC_BasicMap_getSize                     TEST_RC_01
BASICS1RC_BasicMap_isNull                      TEST_RC_01
BASICS1RC_BasicMap_new                         TEST_RC_01
BASICS1RC_BasicMap_null                        TEST_RC_01
BASICS1RC_BasicMap_put                         TEST_RC_01
BASICS1RC_BasicMap_remove                      TEST_RC_01, TEST_RC_02
BASICS1R3_f_startsWith

Fixed:   Fixed problem in f_wordwrap() that EOL-character was not found
         when it was the last character in the string.
Changed: Changed p_assert(), f_this() and f_caller() to use a static
         buffer of 2048 byte to receive the test message for better
         performance.
Changed: Changed procedure f_caller() to return the statement ID
         as the next optional parameter.
Changed: Changed procedure f_this() to return the statement ID
         as the next optional parameter.
Changed: Changed procedure HANDLE_isTypeOf() to return "invalid handle"
         instead of throwing an exception when the pointer of the handle
         is *NULL.
Added:   Procedures MEMORY_allocate(), MEMORY_free() and MEMORY_freeAll()
         to ease working with dynamic memory allocation.
Added:   Procedure f_activateSrvPgm().
Added:   Procedure f_getProcPtrByName().
Added:   Procedures BasicList_* to enable dynamic lists.
Added:   Procedures BasicStack_* to enable stack support.
Added:   Procedures BasicMap_* to enable map support.
Added:   Procedure f_startsWith.


Version 1.5
-----------

Procedures with V1.5                           Program:
----------------------------------------       ----------------------------------------
BASICS1R9_f_getDisplayMode
BASICS1R6_f_getNumEnvVar                       TEST_R6_02
BASICS1R6_f_getEnvVarByIndex                   TEST_R6_02
BASICS1R7_f_genCRC32                           TEST_R7_08, TEST_R7_09

Changed: Changed BASICS1 to get a clear compile for V5R1M0.
Fixed:   Changed return value of procedure f_ebcdic() from 3I0 to 3U0 to
         avoid negative values.
Added:   Added procedure f_getDisplayMode() to the current display mode.
         This procedure uses the Retrieve Display Mode (QsnRtvMod) API.
Added:   Added procedure f_getNumEnvVar() get the number of environment
         variables.
Added:   Added procedure f_getEnvVarByIndex() get the value of an
         environment variable. The variable is addressed by its index.
Added:   Added procedure f_genCRC32() to calculate a CRC-32 check sum.
         Use the C compiler whenever it is possible because of great
         performance advantages.

Performance measurement results of f_genCRC32() with a 8.517 kByte file:

  iSeries:
  --------
  Model  . . . . :  820
  Main storage . :  System    Pool
                    Pool   Size (M)
                      1      820,60
                      2     1847,79
                      3      679,19
                      4       33,81

  w/o code optimization                   with maximum code optimization
  C_COMPILER    V5R3       V5R2           C_COMPILER    V5R3       V5R2
  ----------   ------     ------          ----------   ------     ------
     636        2970       4496             129         1225       2853
     572        3036       4140             186         1239       3627
     596        2526       4248             124         1343       3465
     714        2506       4896             204         1255       3220
     650        2540       4424             180         1708       2865
     570        2457       4363             173         1231       3017
     606        2506       5115             177         1397       2816
     592        2569       4327             142         1240       2718
     699        2880       4274             146         1231       2885
     628        2479       4308             177         1383       2860
  ----------   ------     ------          ----------   ------     ------
     626,3      2646,9     4459,1           163,8       1325,2     3032,6

  Speed factors:
  --------------
  C to V5R3:      4,2                     C to V5R3:      8,1
  C to V5R2:      7,1                     C to V5R2:     18,5
  V5R3 to V5R2:   1,7                     V5R3 to V5R2:   2,3


Version 1.4
-----------

Procedures with V1.3                           Program:
----------------------------------------       ----------------------------------------
BASICS1R3_f_cvtBufferToHexString               TEST_R3_11
BASICS1R3_f_cvtHexStringToBuffer               TEST_R3_11
BASICS1R7_f_genUUID                            TEST_R7_03
BASICS1R7_f_genMd5                             TEST_R7_04, TEST_R7_06
BASICS1R7_f_genSHA1                            TEST_R7_05, TEST_R7_07
BASICS1R2_f_cvtErrnoToMsg                      TEST_R2_01

Changed: Enhanced f_wordWrap() to support end-of-paragraph markers.
Added:   Added prototype of C-function time() to member CLIB.
Added:   Added procedure f_cvtBufferToHexString() to convert a memory
         buffer to a readable string of hex values.
Added:   Added procedure f_cvtHexStringToBuffer() to convert a
         a readable string of hex values to a buffer.
Added:   Added procedure f_genUUID() to generate a Universal Unique
         Identifier.
Added:   Added procedure f_genMD5() to generate a MD5 fingerprint.
Added:   Added procedure f_genSHA1() to generate a SHA-1 fingerprint.
Added:   Added procedure f_cvtErrnoToMsg() to convert a C error number
         to a message.


Version 1.3.1:
--------------

Changed: Added parameter TGTRLS(*CURRENT) to all creation commands.
Changed: Removed '#' from member names.


Version 1.3:
------------

Procedures with V1.3                           Program:
----------------------------------------       ----------------------------------------
BASICS1R1_f_rtvMsgTextRaw
BASICS1R1_f_rtvMsgHelpTextRaw
BASICS1R3_f_center                             TEST_R3#08
BASICS1R3_f_alignR                             TEST_R3#08
BASICS1R3_f_genStrCmp                          TEST_R3#09
BASICS1R3_f_genStrCmpIgnCase                   TEST_R3#09
BASICS1R1_f_scanR

Changed: Removed useless copy books PBASICS1R2, PBASICS1R4 and PBASICS1R6
         from copy book PBASICS1R5. Added copy book PBASICS1R1 instead.
Changed: Changed f_space() to accept a 0 length.
Changed: Changed f_addQuotes() to add quotes only in case it is not yet
         a quoted string. A quoted string is a string that starts and ends
         with a quote.
Changed: Changed f_rmvQuotes() to removes quotes only in case it is a
         a quoted string. A quoted string is a string that starts and ends
         with a quote.
Added:   Added procedure f_rtvMsgTextRaw() to retrieve the message text
         without replacing substitution variables.
Added:   Added procedure f_rtvMsgHelpTextRaw() to retrieve the message help text
         without replacing substitution variables.
Added:   Added procedure f_center() to center a given string.
Added:   Added procedure f_alignR() to right align a given string.
Added:   Added procedure f_genStrCmp() to perform string compare
         using wildcard characters.
Added:   Added procedure f_genStrCmpIgnCase() to perform string compare
         using wildcard characters. (Ignore case)
Added:   Added procedure f_scanR reverse scan a given string for
         a search argument.
Added:   Added data type definition rtvm0400_t.


Version 1.2:
------------

Procedures with V1.2                           Program:
----------------------------------------       ----------------------------------------
BASICS1R3_f_rmvKeyword                         TEST_R3#07
BASICS1R3_f_rmvQuotes
BASICS1R3_f_addQuotes
BASICS1R5_f_crtUsrSpc                          -+
BASICS1R5_f_rtvUsrSpcPtr                        ]
BASICS1R5_f_dltUsrSpc                           ]
BASICS1R8_HANDLE_new                            ]- Used by my list service programs
BASICS1R8_HANDLE_null                           ]
BASICS1R8_HANDLE_isNull                         ]
BASICS1R8_HANDLE_isTypeOf                       ]
BASICS1R8_HANDLE_getPointer                     ]
BASICS1R8_HANDLE_delete                        -+

Changed: Removed useless parameter i_rtnCtrlChr from f_rtvMsgText()
         procedure!
Changed: Replaced external data structures XD* by copy books FD*.
         External data structures are still shipped until 30.06.2005.
Changed: Changed f_val to use self-written code instead of MI function
         cvtefnd(). cvtefnd() crashes when it encounters an invalid
         digit. Usually VAL() functions just stop when they hit an
         invalid character.
Added:   Added procedure f_rmvKeyword(). The procedures removes a keyword
         from a given string. E.g.: DFT('This is a screen constant') is
         translated to 'This is a screen constant'.
Added:   Added procedure f_rmvQuotes(). The procedure removes quotes from
         a given string. E.g. the quotes string 'Programmer''s guide' is
         translated to Programmer's guide.
Added:   Added procedure f_addQuotes(). The procedure adds quotes to
         a given string. E.g. the string Programmer's guide is
         translated to 'Programmer''s guide'.
Added:   Added procedures to manage user spaces:
         f_crtUsrSpc()       - Creates a user space
         f_rtvUsrSpcPtr()    - Retrieves a pointer to the user space.
         f_dltUsrSpc()       - Deletes a user space.
Added:   Added procedures to manage user handles:
         HANDLE_new()        - Creates a new handle.
         HANDLE_null()       - Returns a NULL handle.
         HANDLE_isNull()     - Checks a handle for a NULL value.
         HANDLE_isTypeOf()   - Checks the type of a given handle.
         HANDLE_getPointer() - Retrieves a pointer to the handle data from
                               a given handle.
         HANDLE_delete()     - Deletes a given handle.


Version 1.1:
------------

Procedures with V1.1                           Program:
----------------------------------------       ----------------------------------------
BASICS1R3_f_editCode                           TEST_R3#06
BASICS1R3_f_editWord                           TEST_R3#06
BASICS1R3_f_getLengthEditCode                  TEST_R3#06
BASICS1R3_f_getLengthEditWord                  TEST_R3#06
BASICS1R7_f_log10                              TEST_R7#02 via f_clcLengthOfRPGIntFieldFromBufSize
BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize  TEST_R7#02


Version 1.0:
------------

Procedure:                                     Program:
----------------------------------------       ----------------------------------------
BASICS1R1_p_setAppMsgFile                      TEST_R1#02
BASICS1R1_f_newMsg                             TEST_R1#02
BASICS1R1_f_sndPgmMsg                          TEST_R1#01/TEST_R1#02
BASICS1R1_f_rcvPgmMsg                          TEST_R1#02
BASICS1R1_p_rmvPgmMsg                          TEST_R1#02
BASICS1R1_f_rtvMsgText                         TEST_R1#01
BASICS1R1_f_rtvMsgHelpText                     TEST_R1#01
BASICS1R2_f_newApiErrCode                      all programs using APIs
BASICS1R2_f_isApiError                         BASICS1R6.f_execute() ==> TEST_R6#01
BASICS1R2_f_cvtApiErrCodeToMsg                 BASICS1R6.f_execute() ==> TEST_R6#01
BASICS1R2_f_errno                              TEST_R2#01
BASICS1R2_f_strerror                           TEST_R2#01
BASICS1R3_f_left                               TEST_R3#03
BASICS1R3_f_right                              TEST_R3#03
BASICS1R3_f_space                              TEST_R3#03
BASICS1R3_f_replace                            TEST_R3#04
BASICS1R3_f_lcase                              TEST_R3#05
BASICS1R3_f_ebcdic                             BASICS1R3.f_space()   ==> TEST_R3#03
BASICS1R3_f_val                                TEST_R3#01
BASICS1R3_f_wordWrap                           TEST_R3#02
BASICS1R4_p_assert                             TEST_R4#01
BASICS1R4_f_this                               TEST_R4#01
BASICS1R5_f_exist                              TEST_R5#01 (object)
BASICS1R5_f_exist                              TEST_R5#02 (member)
BASICS1R5_f_getTmpName                         TEST_R5#03
BASICS1R5_f_getUniqueName                      TEST_R5#03
BASICS1R6_f_execute                            TEST_R6#01
BASICS1R7_f_isBitOn                            TEST_R7#01

]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1  type BND - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1   "
mbrtype =  "BND       "
mbrtext =  "SrvPgm: Export List                               "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
     /* ====================================================================== */
     /* >>PRE-COMPILER<<                                                       */
     /*                                                                        */
     /*   >>CRTCMD<< CRTSRVPGM    SRVPGM(&LI/&OB);                             */
     /*                                                                        */
     /*   >>COMPILE<<                                                          */
     /*     >>PARM<< MODULE(&LI/BASICS1R1 +                                    */
     /*                     &LI/BASICS1R2 +                                    */
     /*                     &LI/BASICS1R3 +                                    */
     /*                     &LI/BASICS1R4 +                                    */
     /*                     &LI/BASICS1R5 +                                    */
     /*                     &LI/BASICS1R6 +                                    */
     /*                     &LI/BASICS1R7 +                                    */
     /*                     &LI/BASICS1R8 +                                    */
     /*                     &LI/BASICS1R9 +                                    */
     /*                     &LI/BASICS1RA +                                    */
     /*                     &LI/BASICS1RB +                                    */
     /*                     &LI/BASICS1RC +                                    */
     /*                     &LI/BASICS1C7 +                                    */
     /*                     &LI/BASICS1RD +                                    */
     /*                     &LI/BASICS1RE +                                    */
     /*                     &LI/BASICS1RF +                                    */
     /*                     &LI/BASICS1RG +                                    */
     /*                     &LI/BASICS1RH +                                    */
     /*                                );                                      */
     /*     >>PARM<< EXPORT(*SRCFILE);                                         */
     /*     >>PARM<<   SRCFILE(&SL/&SF);                                       */
     /*     >>PARM<<   SRCMBR(&SM);                                            */
     /*     >>PARM<< ACTGRP(*CALLER);                                          */
     /*     >>PARM<< ALWUPD(*YES);                                             */
     /*     >>PARM<< ALWLIBUPD(*YES);                                          */
     /*     >>PARM<< BNDDIR(QC2LE);                                            */
     /*     >>PARM<< TEXT('Tools/400 - Runtime Library');                      */
     /*     >>PARM<< TGTRLS(V6R1M0);                                           */
     /*     >>PARM<< DETAIL(*BASIC);                                           */
     /*   >>END-COMPILE<<                                                      */
     /*                                                                        */
     /*   >>LINK<<                                                             */
     /*   >>END-LINK<<                                                         */
     /*                                                                        */
     /*   >>EXECUTE<<                                                          */
     /*                                                                        */
     /* >>END-PRE-COMPILER<<                                                   */
     /* ====================================================================== */

STRPGMEXP PGMLVL(*CURRENT) SIGNATURE('Version 1.14')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_Display_getMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

  /* --------------------- */
  /*   Added with V1.9     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_clone')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clone')
  EXPORT SYMBOL('BASICS1RC_BasicMap_clone')

  /* --------------------- */
  /*   Added with V1.10    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R3_f_objName')
  EXPORT SYMBOL('BASICS1R5_f_getObjLib')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsgObj')

  /* --------------------- */
  /*   Added with V1.11    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcInitValue')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcInitValue')

  EXPORT SYMBOL('BASICS1R3_f_rplUnPrtChars')
  EXPORT SYMBOL('BASICS1R3_f_formatDate')
  EXPORT SYMBOL('BASICS1R3_f_parseDate')
  EXPORT SYMBOL('BASICS1R3_f_formatMemSize')
  EXPORT SYMBOL('BASICS1R9_Display_supportsDS4')
  EXPORT SYMBOL('BASICS1R9_Display_supportsGUI')
  EXPORT SYMBOL('BASICS1R9_Display_getRows')
  EXPORT SYMBOL('BASICS1R9_Display_getColumns')
  EXPORT SYMBOL('BASICS1R6_p_wait')

  EXPORT SYMBOL('BASICS1RE_f_dateSerial')

  /* --------------------- */
  /*   Added with V1.12    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R8_MemoryManager_getDefaultManager')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_createHeap')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_deleteHeap')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_allocate')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_reallocate')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_free')

  /* --------------------- */
  /*   Added with V1.13    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeys')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValues')

  EXPORT SYMBOL('BASICS1R1_f_getSndInfOfRcvMsg')

  EXPORT SYMBOL('BASICS1RE_f_rtvSysVal_char')
  EXPORT SYMBOL('BASICS1RE_f_rtvSysVal_num')

  EXPORT SYMBOL('BASICS1R3_f_cvtPtrToHexString')

  EXPORT SYMBOL('BASICS1RA_BasicList_getHeapID')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getHeapID')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getHeapID')

  EXPORT SYMBOL('BASICS1R3_f_startsWithIgnoreCase')

  /* --------------------- */
  /*   Added with V1.14    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RG_BasicProperties_new')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_loadFromMember')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_loadFromStmf')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_clone')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_containsKey')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_putString')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_putInteger')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_putBoolean')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_putDecimal')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_getString')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_getInteger')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_getBoolean')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_getDecimal')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_remove')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_getHeapID')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_getNumE')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_clear')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_delete')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_null')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_isNull')
  EXPORT SYMBOL('BASICS1RG_BasicProperties_newKeySet')

  EXPORT SYMBOL('BASICS1R2_f_setErrno')

  EXPORT SYMBOL('BASICS1RH_MemoryWriter_new')
  EXPORT SYMBOL('BASICS1RH_MemoryWriter_write')
  EXPORT SYMBOL('BASICS1RH_MemoryWriter_delete')
  EXPORT SYMBOL('BASICS1RH_MemoryWriter_writeProc')
  EXPORT SYMBOL('BASICS1RH_MemoryReader_new')
  EXPORT SYMBOL('BASICS1RH_MemoryReader_read')
  EXPORT SYMBOL('BASICS1RH_MemoryReader_delete')
  EXPORT SYMBOL('BASICS1RH_MemoryReader_readProc')

  EXPORT SYMBOL('BASICS1RA_BasicList_getTotalSize')

  EXPORT SYMBOL('BASICS1R3_f_mid')

  EXPORT SYMBOL('BASICS1RE_f_cvtEpochTS')
  EXPORT SYMBOL('BASICS1RE_f_cvtTSEpoch')
  EXPORT SYMBOL('BASICS1RE_f_cvtMiTimeTS')
  EXPORT SYMBOL('BASICS1RE_f_cvtTSMiTime')
  EXPORT SYMBOL('BASICS1R5_f_cvtQSYSObjNameToPath')
  EXPORT SYMBOL('BASICS1R5_f_cvtPathToQSYSObjName')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.13')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_Display_getMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

  /* --------------------- */
  /*   Added with V1.9     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_clone')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clone')
  EXPORT SYMBOL('BASICS1RC_BasicMap_clone')

  /* --------------------- */
  /*   Added with V1.10    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R3_f_objName')
  EXPORT SYMBOL('BASICS1R5_f_getObjLib')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsgObj')

  /* --------------------- */
  /*   Added with V1.11    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcInitValue')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcInitValue')

  EXPORT SYMBOL('BASICS1R3_f_rplUnPrtChars')
  EXPORT SYMBOL('BASICS1R3_f_formatDate')
  EXPORT SYMBOL('BASICS1R3_f_parseDate')
  EXPORT SYMBOL('BASICS1R3_f_formatMemSize')
  EXPORT SYMBOL('BASICS1R9_Display_supportsDS4')
  EXPORT SYMBOL('BASICS1R9_Display_supportsGUI')
  EXPORT SYMBOL('BASICS1R9_Display_getRows')
  EXPORT SYMBOL('BASICS1R9_Display_getColumns')
  EXPORT SYMBOL('BASICS1R6_p_wait')

  EXPORT SYMBOL('BASICS1RE_f_dateSerial')

  /* --------------------- */
  /*   Added with V1.12    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R8_MemoryManager_getDefaultManager')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_createHeap')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_deleteHeap')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_allocate')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_reallocate')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_free')

  /* --------------------- */
  /*   Added with V1.13    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeys')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValues')

  EXPORT SYMBOL('BASICS1R1_f_getSndInfOfRcvMsg')

  EXPORT SYMBOL('BASICS1RE_f_rtvSysVal_char')
  EXPORT SYMBOL('BASICS1RE_f_rtvSysVal_num')

  EXPORT SYMBOL('BASICS1R3_f_cvtPtrToHexString')

  EXPORT SYMBOL('BASICS1RA_BasicList_getHeapID')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getHeapID')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getHeapID')

  EXPORT SYMBOL('BASICS1R3_f_startsWithIgnoreCase')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.12')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_Display_getMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

  /* --------------------- */
  /*   Added with V1.9     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_clone')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clone')
  EXPORT SYMBOL('BASICS1RC_BasicMap_clone')

  /* --------------------- */
  /*   Added with V1.10    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R3_f_objName')
  EXPORT SYMBOL('BASICS1R5_f_getObjLib')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsgObj')

  /* --------------------- */
  /*   Added with V1.11    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcInitValue')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcInitValue')

  EXPORT SYMBOL('BASICS1R3_f_rplUnPrtChars')
  EXPORT SYMBOL('BASICS1R3_f_formatDate')
  EXPORT SYMBOL('BASICS1R3_f_parseDate')
  EXPORT SYMBOL('BASICS1R3_f_formatMemSize')
  EXPORT SYMBOL('BASICS1R9_Display_supportsDS4')
  EXPORT SYMBOL('BASICS1R9_Display_supportsGUI')
  EXPORT SYMBOL('BASICS1R9_Display_getRows')
  EXPORT SYMBOL('BASICS1R9_Display_getColumns')
  EXPORT SYMBOL('BASICS1R6_p_wait')

  EXPORT SYMBOL('BASICS1RE_f_dateSerial')

  /* --------------------- */
  /*   Added with V1.12    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R8_MemoryManager_getDefaultManager')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_createHeap')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_deleteHeap')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_allocate')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_reallocate')
  EXPORT SYMBOL('BASICS1R8_MemoryManager_free')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.11')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_Display_getMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

  /* --------------------- */
  /*   Added with V1.9     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_clone')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clone')
  EXPORT SYMBOL('BASICS1RC_BasicMap_clone')

  /* --------------------- */
  /*   Added with V1.10    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R3_f_objName')
  EXPORT SYMBOL('BASICS1R5_f_getObjLib')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsgObj')

  /* --------------------- */
  /*   Added with V1.11    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcSize')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcAutoExt')
  EXPORT SYMBOL('BASICS1R5_f_chgUsrSpcInitValue')
  EXPORT SYMBOL('BASICS1R5_f_getUsrSpcInitValue')

  EXPORT SYMBOL('BASICS1R3_f_rplUnPrtChars')
  EXPORT SYMBOL('BASICS1R3_f_formatDate')
  EXPORT SYMBOL('BASICS1R3_f_parseDate')
  EXPORT SYMBOL('BASICS1R3_f_formatMemSize')
  EXPORT SYMBOL('BASICS1R9_Display_supportsDS4')
  EXPORT SYMBOL('BASICS1R9_Display_supportsGUI')
  EXPORT SYMBOL('BASICS1R9_Display_getRows')
  EXPORT SYMBOL('BASICS1R9_Display_getColumns')
  EXPORT SYMBOL('BASICS1R6_p_wait')

  EXPORT SYMBOL('BASICS1RE_f_dateSerial')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.10')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_f_getDisplayMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

  /* --------------------- */
  /*   Added with V1.9     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_clone')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clone')
  EXPORT SYMBOL('BASICS1RC_BasicMap_clone')

  /* --------------------- */
  /*   Added with V1.10    */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1R3_f_objName')
  EXPORT SYMBOL('BASICS1R5_f_getObjLib')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsgObj')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.9')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_f_getDisplayMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

  /* --------------------- */
  /*   Added with V1.9     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_clone')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clone')
  EXPORT SYMBOL('BASICS1RC_BasicMap_clone')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.8')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_f_getDisplayMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

  /* --------------------- */
  /*   Added with V1.8     */
  /* --------------------- */

  EXPORT SYMBOL('BASICS1RA_BasicList_isSorted')
  EXPORT SYMBOL('BASICS1RA_BasicList_addNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_setNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNullValue')

  EXPORT SYMBOL('BASICS1RC_BasicMap_newKeySet')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getFirst')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_getNext')
  EXPORT SYMBOL('BASICS1RC_BasicKeySet_delete')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.7')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_f_getDisplayMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

  /* --------------------- */
  /*   Added with V1.7     */
  /* --------------------- */

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSizeByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putString')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getString')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_endsWith')
  EXPORT SYMBOL('BASICS1RC_BasicMap_putInteger')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getInteger')
  EXPORT SYMBOL('BASICS1R3_f_containsInvalidCharAt')
  EXPORT SYMBOL('BASICS1R3_f_containsStringAt')

  /*   Module: BASICS1RD   */
  EXPORT SYMBOL('BASICS1RD_Url_new')
  EXPORT SYMBOL('BASICS1RD_Url_getProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_setProtocol')
  EXPORT SYMBOL('BASICS1RD_Url_getHost')
  EXPORT SYMBOL('BASICS1RD_Url_setHost')
  EXPORT SYMBOL('BASICS1RD_Url_getPort')
  EXPORT SYMBOL('BASICS1RD_Url_setPort')
  EXPORT SYMBOL('BASICS1RD_Url_getPath')
  EXPORT SYMBOL('BASICS1RD_Url_setPath')
  EXPORT SYMBOL('BASICS1RD_Url_getQuery')
  EXPORT SYMBOL('BASICS1RD_Url_setQuery')
  EXPORT SYMBOL('BASICS1RD_Url_getFile')
  EXPORT SYMBOL('BASICS1RD_Url_setFile')
  EXPORT SYMBOL('BASICS1RD_Url_toString')
  EXPORT SYMBOL('BASICS1RD_Url_getMbr')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.6')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_f_getDisplayMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

  /* --------------------- */
  /*   Added with V1.6     */
  /* --------------------- */

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_allocate')
  EXPORT SYMBOL('BASICS1R8_MEMORY_freeAll')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_activateSrvPgm')
  EXPORT SYMBOL('BASICS1R5_f_getProcPtrByName')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_MEMORY_free')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_add')
  EXPORT SYMBOL('BASICS1RA_BasicList_addPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_addString')
  EXPORT SYMBOL('BASICS1RA_BasicList_delete')
  EXPORT SYMBOL('BASICS1RA_BasicList_find')
  EXPORT SYMBOL('BASICS1RA_BasicList_findString')
  EXPORT SYMBOL('BASICS1RA_BasicList_get')
  EXPORT SYMBOL('BASICS1RA_BasicList_getListType')
  EXPORT SYMBOL('BASICS1RA_BasicList_getNumE')
  EXPORT SYMBOL('BASICS1RA_BasicList_getPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_getSize')
  EXPORT SYMBOL('BASICS1RA_BasicList_getString')
  EXPORT SYMBOL('BASICS1RA_BasicList_getType')
  EXPORT SYMBOL('BASICS1RA_BasicList_isNull')
  EXPORT SYMBOL('BASICS1RA_BasicList_isListTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_isTypeOf')
  EXPORT SYMBOL('BASICS1RA_BasicList_new')
  EXPORT SYMBOL('BASICS1RA_BasicList_null')
  EXPORT SYMBOL('BASICS1RA_BasicList_remove')
  EXPORT SYMBOL('BASICS1RA_BasicList_set')
  EXPORT SYMBOL('BASICS1RA_BasicList_setAutoSort')
  EXPORT SYMBOL('BASICS1RA_BasicList_setString')
  EXPORT SYMBOL('BASICS1RA_BasicList_setPointer')
  EXPORT SYMBOL('BASICS1RA_BasicList_sort')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_delete')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getNumE')
  EXPORT SYMBOL('BASICS1RB_BasicStack_getSize')
  EXPORT SYMBOL('BASICS1RB_BasicStack_isNull')
  EXPORT SYMBOL('BASICS1RB_BasicStack_new')
  EXPORT SYMBOL('BASICS1RB_BasicStack_null')
  EXPORT SYMBOL('BASICS1RB_BasicStack_pop')
  EXPORT SYMBOL('BASICS1RB_BasicStack_push')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_containsKey')
  EXPORT SYMBOL('BASICS1RC_BasicMap_delete')
  EXPORT SYMBOL('BASICS1RC_BasicMap_get')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getKeyByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getValueByIndex')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getNumE')
  EXPORT SYMBOL('BASICS1RC_BasicMap_getSize')
  EXPORT SYMBOL('BASICS1RC_BasicMap_isNull')
  EXPORT SYMBOL('BASICS1RC_BasicMap_new')
  EXPORT SYMBOL('BASICS1RC_BasicMap_null')
  EXPORT SYMBOL('BASICS1RC_BasicMap_put')
  EXPORT SYMBOL('BASICS1RC_BasicMap_remove')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_startsWith')

  /*   Module: BASICS1RB   */
  EXPORT SYMBOL('BASICS1RB_BasicStack_peek')
  EXPORT SYMBOL('BASICS1RB_BasicStack_clear')

  /*   Module: BASICS1RA   */
  EXPORT SYMBOL('BASICS1RA_BasicList_clear')

  /*   Module: BASICS1RC   */
  EXPORT SYMBOL('BASICS1RC_BasicMap_clear')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_cvtRcvMsgToMsg')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.5')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

  /* --------------------- */
  /*   Added with V1.5     */
  /* --------------------- */

  /*   Module: BASICS1R9   */
  EXPORT SYMBOL('BASICS1R9_f_getDisplayMode')
  EXPORT SYMBOL('BASICS1R6_f_getNumEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVarByIndex')
  EXPORT SYMBOL('BASICS1R7_f_genCRC32')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.4')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

  /* --------------------- */
  /*   Added with V1.4     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_cvtBufferToHexString')
  EXPORT SYMBOL('BASICS1R3_f_cvtHexStringToBuffer')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_genUUID')
  EXPORT SYMBOL('BASICS1R7_f_genMD5')
  EXPORT SYMBOL('BASICS1R7_f_genSHA1')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_cvtErrnoToMsg')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.3')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

  /* --------------------- */
  /*   Added with V1.3     */
  /* --------------------- */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgTextRaw')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpTextRaw')
  EXPORT SYMBOL('BASICS1R3_f_center')
  EXPORT SYMBOL('BASICS1R3_f_alignR')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmp')
  EXPORT SYMBOL('BASICS1R3_f_genStrCmpIgnCase')
  EXPORT SYMBOL('BASICS1R3_f_scanR')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV    ) SIGNATURE('Version 1.2')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

  /* --------------------- */
  /*   Added with V1.2     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_rmvKeyword')
  EXPORT SYMBOL('BASICS1R3_f_rmvQuotes')
  EXPORT SYMBOL('BASICS1R3_f_addQuotes')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_crtUsrSpc')
  EXPORT SYMBOL('BASICS1R5_f_rtvUsrSpcPtr')
  EXPORT SYMBOL('BASICS1R5_f_dltUsrSpc')

  /*   Module: BASICS1R8   */
  EXPORT SYMBOL('BASICS1R8_HANDLE_new')
  EXPORT SYMBOL('BASICS1R8_HANDLE_null')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isNull')
  EXPORT SYMBOL('BASICS1R8_HANDLE_isTypeOf')
  EXPORT SYMBOL('BASICS1R8_HANDLE_getPointer')
  EXPORT SYMBOL('BASICS1R8_HANDLE_delete')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV) SIGNATURE('Version 1.1')

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

  /* --------------------- */
  /*   Added with V1.1     */
  /* --------------------- */

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_editCode')
  EXPORT SYMBOL('BASICS1R3_f_editWord')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditCode')
  EXPORT SYMBOL('BASICS1R3_f_getLengthEditWord')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_log10')
  EXPORT SYMBOL('BASICS1R7_f_clcLengthOfRPGIntFieldFromBufSize')

ENDPGMEXP

STRPGMEXP PGMLVL(*PRV)    /* Version 1.0 Signature */

  /*   Module: BASICS1R1   */
  EXPORT SYMBOL('BASICS1R1_f_newMsg')
  EXPORT SYMBOL('BASICS1R1_f_rcvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgHelpText')
  EXPORT SYMBOL('BASICS1R1_f_rtvMsgText')
  EXPORT SYMBOL('BASICS1R1_f_sndPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_rmvPgmMsg')
  EXPORT SYMBOL('BASICS1R1_p_setAppMsgFile')

  /*   Module: BASICS1R2   */
  EXPORT SYMBOL('BASICS1R2_f_clrErrno')
  EXPORT SYMBOL('BASICS1R2_f_cvtApiErrCodeToMsg')
  EXPORT SYMBOL('BASICS1R2_f_errno')
  EXPORT SYMBOL('BASICS1R2_f_isApiError')
  EXPORT SYMBOL('BASICS1R2_f_newApiErrCode')
  EXPORT SYMBOL('BASICS1R2_f_strerror')

  /*   Module: BASICS1R3   */
  EXPORT SYMBOL('BASICS1R3_f_ebcdic')
  EXPORT SYMBOL('BASICS1R3_f_left')
  EXPORT SYMBOL('BASICS1R3_f_replace')
  EXPORT SYMBOL('BASICS1R3_f_right')
  EXPORT SYMBOL('BASICS1R3_f_space')
  EXPORT SYMBOL('BASICS1R3_f_lcase')
  EXPORT SYMBOL('BASICS1R3_f_ucase')
  EXPORT SYMBOL('BASICS1R3_f_val')
  EXPORT SYMBOL('BASICS1R3_f_wordWrap')

  /*   Module: BASICS1R4   */
  EXPORT SYMBOL('BASICS1R4_p_assert')
  EXPORT SYMBOL('BASICS1R4_f_this')
  EXPORT SYMBOL('BASICS1R4_f_caller')

  /*   Module: BASICS1R5   */
  EXPORT SYMBOL('BASICS1R5_f_exist')
  EXPORT SYMBOL('BASICS1R5_f_rtvMbrD')
  EXPORT SYMBOL('BASICS1R5_f_rtvObjD')
  EXPORT SYMBOL('BASICS1R5_f_getTmpName')
  EXPORT SYMBOL('BASICS1R5_f_getUniqueName')

  /*   Module: BASICS1R6   */
  EXPORT SYMBOL('BASICS1R6_f_execute')
  EXPORT SYMBOL('BASICS1R6_f_getEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_setEnvVar')
  EXPORT SYMBOL('BASICS1R6_f_delEnvVar')

  /*   Module: BASICS1R7   */
  EXPORT SYMBOL('BASICS1R7_f_isBitOn')

ENDPGMEXP
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1C7  type CLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1C7 "
mbrtype =  "CLE       "
mbrtext =  "SrvPgm: Basic Routines - C-Helpers                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
     /*=====================================================================*/
     /*  BASICS1C7  - SrvPgm: Basic Routines - C-Helper                     */
     /*=====================================================================*/
     /*  Author  :  Thomas Raddatz                                          */
     /*  Date    :  28.12.2005                                              */
     /*  E-mail  :  thomas.raddatz@tools400.de                              */
     /*  Homepage:  www.tools400.de                                         */
     /*=====================================================================*/
     /*                                                                     */
     /*  This software is free software, you can redistribute it and/or     */
     /*  modify it under the terms of the GNU General Public License (GPL)  */
     /*  as published by the Free Software Foundation.                      */
     /*                                                                     */
     /*  See GNU General Public License for details.                        */
     /*          http://www.opensource.org                                  */
     /*          http://www.opensource.org/licenses/gpl-license.html        */
     /*                                                                     */
     /*=====================================================================*/
     /*  This module contains code written by Mark Adler.                   */
     /*                                                                     */
     /*     http://www.stillhq.com/gpg/source-1.0.3/zlib/crc32.html         */
     /*                                                                     */
     /*  For conditions of distribution and use, see copyright              */
     /*  notice in zlib.h.                                                  */
     /*=====================================================================*/
     /*  History:                                                           */
     /*                                                                     */
     /*  Datum       Name          nderung                                 */
     /*  ----------  ------------  ---------------------------------------  */
     /*                                                                     */
     /*=====================================================================*/
     /*    >>PRE-COMPILER<<                                                 */
     /*                                                                     */
     /*      >>CRTCMD<<     CRTCMOD   MODULE(&LI/&OB) +                     */
     /*                               SRCFILE(&SL/&SF) +                    */
     /*                               SRCMBR(&SM);                          */
     /*                                                                     */
     /*      >>COMPILE<<                                                    */
     /*        >>PARM<< OUTPUT(*PRINT);                                     */
     /*        >>PARM<< DBGVIEW(*ALL );                                     */
     /*        >>PARM<< DEFINE(DYNAMIC_CRC_TABLE);                          */
     /*        >>PARM<< OPTIMIZE(40);                                       */
     /*        >>PARM<< TGTRLS(V6R1M0);                                     */
     /*      >>END-COMPILE<<                                                */
     /*                                                                     */
     /*      >>EXECUTE<<                                                    */
     /*                                                                     */
     /*    >>END-PRE-COMPILER<<                                             */
     /*=====================================================================*/
/* crc32.c -- compute the CRC-32 of a data stream
 * Copyright (C) 1995-1998 Mark Adler
 * For conditions of distribution and use, see copyright notice in zlib.h
 */

/* @(#) $Id: crc32.c,v 1.2 1999/01/13 13:12:48 koch Exp $ */

#include "zlib"

#define local static

#ifdef DYNAMIC_CRC_TABLE

local int crc_table_empty = 1;
local uLongf crc_table[256];
local void make_crc_table OF((void));

/*
  Generate a table for a byte-wise 32-bit CRC calculation on the polynomial:
  x^32+x^26+x^23+x^22+x^16+x^12+x^11+x^10+x^8+x^7+x^5+x^4+x^2+x+1.

  Polynomials over GF(2) are represented in binary, one bit per coefficient,
  with the lowest powers in the most significant bit.  Then adding polynomials
  is just exclusive-or, and multiplying a polynomial by x is a right shift by
  one.  If we call the above polynomial p, and represent a byte as the
  polynomial q, also with the lowest power in the most significant bit (so the
  byte 0xb1 is the polynomial x^7+x^3+x+1), then the CRC is (q*x^32) mod p,
  where a mod b means the remainder after dividing a by b.

  This calculation is done using the shift-register method of multiplying and
  taking the remainder.  The register is initialized to zero, and for each
  incoming bit, x^32 is added mod p to the register if the bit is a one (where
  x^32 mod p is p+x^32 = x^26+...+1), and the register is multiplied mod p by
  x (which is shifting right by one and adding x^32 mod p if the bit shifted
  out is a one).  We start with the highest power (least significant bit) of
  q and repeat for all eight bits of q.

  The table is simply the CRC of all possible eight bit values.  This is all
  the information needed to generate CRC's on data a byte at a time for all
  combinations of CRC register values and incoming bytes.
*/
local void make_crc_table()
{
  uLong c;
  int n, k;
  uLong poly;            /* polynomial exclusive-or pattern */
  /* terms of polynomial defining this crc (except x^32): */
  static const Byte p[] = {0,1,2,4,5,7,8,10,11,12,16,22,23,26};

  /* make exclusive-or pattern from polynomial (0xedb88320L) */
  poly = 0L;
  for (n = 0; n < sizeof(p)/sizeof(Byte); n++)
    poly |= 1L << (31 - p[n]);

  for (n = 0; n < 256; n++)
  {
    c = (uLong)n;
    for (k = 0; k < 8; k++)
      c = c & 1 ? poly ^ (c >> 1) : c >> 1;
    crc_table[n] = c;
  }
  crc_table_empty = 0;
}
#else
/* ========================================================================
 * Table of CRC-32's of all single-byte values (made by make_crc_table)
 */
local const uLongf crc_table[256] = {
  0x00000000L, 0x77073096L, 0xee0e612cL, 0x990951baL, 0x076dc419L,
  0x706af48fL, 0xe963a535L, 0x9e6495a3L, 0x0edb8832L, 0x79dcb8a4L,
  0xe0d5e91eL, 0x97d2d988L, 0x09b64c2bL, 0x7eb17cbdL, 0xe7b82d07L,
  0x90bf1d91L, 0x1db71064L, 0x6ab020f2L, 0xf3b97148L, 0x84be41deL,
  0x1adad47dL, 0x6ddde4ebL, 0xf4d4b551L, 0x83d385c7L, 0x136c9856L,
  0x646ba8c0L, 0xfd62f97aL, 0x8a65c9ecL, 0x14015c4fL, 0x63066cd9L,
  0xfa0f3d63L, 0x8d080df5L, 0x3b6e20c8L, 0x4c69105eL, 0xd56041e4L,
  0xa2677172L, 0x3c03e4d1L, 0x4b04d447L, 0xd20d85fdL, 0xa50ab56bL,
  0x35b5a8faL, 0x42b2986cL, 0xdbbbc9d6L, 0xacbcf940L, 0x32d86ce3L,
  0x45df5c75L, 0xdcd60dcfL, 0xabd13d59L, 0x26d930acL, 0x51de003aL,
  0xc8d75180L, 0xbfd06116L, 0x21b4f4b5L, 0x56b3c423L, 0xcfba9599L,
  0xb8bda50fL, 0x2802b89eL, 0x5f058808L, 0xc60cd9b2L, 0xb10be924L,
  0x2f6f7c87L, 0x58684c11L, 0xc1611dabL, 0xb6662d3dL, 0x76dc4190L,
  0x01db7106L, 0x98d220bcL, 0xefd5102aL, 0x71b18589L, 0x06b6b51fL,
  0x9fbfe4a5L, 0xe8b8d433L, 0x7807c9a2L, 0x0f00f934L, 0x9609a88eL,
  0xe10e9818L, 0x7f6a0dbbL, 0x086d3d2dL, 0x91646c97L, 0xe6635c01L,
  0x6b6b51f4L, 0x1c6c6162L, 0x856530d8L, 0xf262004eL, 0x6c0695edL,
  0x1b01a57bL, 0x8208f4c1L, 0xf50fc457L, 0x65b0d9c6L, 0x12b7e950L,
  0x8bbeb8eaL, 0xfcb9887cL, 0x62dd1ddfL, 0x15da2d49L, 0x8cd37cf3L,
  0xfbd44c65L, 0x4db26158L, 0x3ab551ceL, 0xa3bc0074L, 0xd4bb30e2L,
  0x4adfa541L, 0x3dd895d7L, 0xa4d1c46dL, 0xd3d6f4fbL, 0x4369e96aL,
  0x346ed9fcL, 0xad678846L, 0xda60b8d0L, 0x44042d73L, 0x33031de5L,
  0xaa0a4c5fL, 0xdd0d7cc9L, 0x5005713cL, 0x270241aaL, 0xbe0b1010L,
  0xc90c2086L, 0x5768b525L, 0x206f85b3L, 0xb966d409L, 0xce61e49fL,
  0x5edef90eL, 0x29d9c998L, 0xb0d09822L, 0xc7d7a8b4L, 0x59b33d17L,
  0x2eb40d81L, 0xb7bd5c3bL, 0xc0ba6cadL, 0xedb88320L, 0x9abfb3b6L,
  0x03b6e20cL, 0x74b1d29aL, 0xead54739L, 0x9dd277afL, 0x04db2615L,
  0x73dc1683L, 0xe3630b12L, 0x94643b84L, 0x0d6d6a3eL, 0x7a6a5aa8L,
  0xe40ecf0bL, 0x9309ff9dL, 0x0a00ae27L, 0x7d079eb1L, 0xf00f9344L,
  0x8708a3d2L, 0x1e01f268L, 0x6906c2feL, 0xf762575dL, 0x806567cbL,
  0x196c3671L, 0x6e6b06e7L, 0xfed41b76L, 0x89d32be0L, 0x10da7a5aL,
  0x67dd4accL, 0xf9b9df6fL, 0x8ebeeff9L, 0x17b7be43L, 0x60b08ed5L,
  0xd6d6a3e8L, 0xa1d1937eL, 0x38d8c2c4L, 0x4fdff252L, 0xd1bb67f1L,
  0xa6bc5767L, 0x3fb506ddL, 0x48b2364bL, 0xd80d2bdaL, 0xaf0a1b4cL,
  0x36034af6L, 0x41047a60L, 0xdf60efc3L, 0xa867df55L, 0x316e8eefL,
  0x4669be79L, 0xcb61b38cL, 0xbc66831aL, 0x256fd2a0L, 0x5268e236L,
  0xcc0c7795L, 0xbb0b4703L, 0x220216b9L, 0x5505262fL, 0xc5ba3bbeL,
  0xb2bd0b28L, 0x2bb45a92L, 0x5cb36a04L, 0xc2d7ffa7L, 0xb5d0cf31L,
  0x2cd99e8bL, 0x5bdeae1dL, 0x9b64c2b0L, 0xec63f226L, 0x756aa39cL,
  0x026d930aL, 0x9c0906a9L, 0xeb0e363fL, 0x72076785L, 0x05005713L,
  0x95bf4a82L, 0xe2b87a14L, 0x7bb12baeL, 0x0cb61b38L, 0x92d28e9bL,
  0xe5d5be0dL, 0x7cdcefb7L, 0x0bdbdf21L, 0x86d3d2d4L, 0xf1d4e242L,
  0x68ddb3f8L, 0x1fda836eL, 0x81be16cdL, 0xf6b9265bL, 0x6fb077e1L,
  0x18b74777L, 0x88085ae6L, 0xff0f6a70L, 0x66063bcaL, 0x11010b5cL,
  0x8f659effL, 0xf862ae69L, 0x616bffd3L, 0x166ccf45L, 0xa00ae278L,
  0xd70dd2eeL, 0x4e048354L, 0x3903b3c2L, 0xa7672661L, 0xd06016f7L,
  0x4969474dL, 0x3e6e77dbL, 0xaed16a4aL, 0xd9d65adcL, 0x40df0b66L,
  0x37d83bf0L, 0xa9bcae53L, 0xdebb9ec5L, 0x47b2cf7fL, 0x30b5ffe9L,
  0xbdbdf21cL, 0xcabac28aL, 0x53b39330L, 0x24b4a3a6L, 0xbad03605L,
  0xcdd70693L, 0x54de5729L, 0x23d967bfL, 0xb3667a2eL, 0xc4614ab8L,
  0x5d681b02L, 0x2a6f2b94L, 0xb40bbe37L, 0xc30c8ea1L, 0x5a05df1bL,
  0x2d02ef8dL
};
#endif

/* =========================================================================
 * This function can be used by asm versions of crc32()
 */
const uLongf * ZEXPORT get_crc_table()
{
#ifdef DYNAMIC_CRC_TABLE
  if (crc_table_empty) make_crc_table();
#endif
  return (const uLongf *)crc_table;
}

/* ========================================================================= */
#define DO1(buf) crc = crc_table[((int)crc ^ (*buf++)) & 0xff] ^ (crc >> 8);
#define DO2(buf)  DO1(buf); DO1(buf);
#define DO4(buf)  DO2(buf); DO2(buf);
#define DO8(buf)  DO4(buf); DO4(buf);

/* ========================================================================= */
uLong ZEXPORT crc32(crc, buf, len)
    uLong crc;
    const Bytef *buf;
    uInt len;
{
    if (buf == Z_NULL) return 0L;
#ifdef DYNAMIC_CRC_TABLE
    if (crc_table_empty)
      make_crc_table();
#endif
    // crc = crc ^ 0xffffffffL;
    while (len >= 8)
    {
      DO8(buf);
      len -= 8;
    }
    if (len) do {
      DO1(buf);
    } while (--len);
    return crc; // ^ 0xffffffffL;
}
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RA  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RA "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicList                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RA  - SrvPgm: Basic Routines - BasicList                    *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  18.05.2004                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  24.08.2006  Th.Raddatz    Changed BasicList_get() to initialize    *                 RADDAT
      *                            only that bytes of the return buffer     *                 RADDAT
      *                            that are beyond the length of the list   *                 RADDAT
      *                            entry.                                   *                 RADDAT
      *                                                                     *                 RADDAT
      *  24.04.2008  Th.Raddatz    Enabled BasicList to store NULL data.    *                 RADDAT
      *                            Fixed problem that sortList() did not    *                 RADDAT
      *                            return cTrue after having sorted the     *                 RADDAT
      *                            list.                                    *                 RADDAT
      *                            Renamed findEntryByDataPointer() to      *                 RADDAT
      *                            findEntryBySignature() in order to       *
      *                            support NULL list entries.               *                 RADDAT
      *                            Added procedures:                        *                 RADDAT
      *                               BasicList_isSorted()                  *                 RADDAT
      *                               BasicList_isNullValue()               *                 RADDAT
      *                                                                     *                 RADDAT
      *  28.04.2008  Th.Raddatz    Check type of list handle and send an    *                 RADDAT
      *                            ESCAPE message for invalid handles.      *                 RADDAT
      *                                                                     *                 RADDAT
      *  27.05.2008  Th.Raddatz    Added procedure:                         *                 RADDAT
      *                               BasicList_clone()                     *                 RADDAT
      *                                                                     *                 RADDAT
      *  23.03.2012  Th.Raddatz    Added error message 'Failed to allocate  *                 RADDAT
      *                            memory' which is sent when the program   *                 RADDAT
      *                            could not allocate/reallocate memory.    *                 RADDAT
      *                                                                     *                 RADDAT
      *  23.03.2012  Th.Raddatz    Changed 'signature_t' to use an epoch    *                 RADDAT
      *                            time instead of a RPG timestamp value.   *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RA                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
     D hList_t         DS                  qualified   based(pDummy)   align                  RADDAT
     D  intType                      20U 0
     D  intSize                      10U 0
     D  extType                            like(BasicList_type_t  )
     D  memSize                      10U 0                                                    RADDAT
     D  numE                         10U 0                                                    RADDAT
     D  maxNumE                      10U 0                                                    RADDAT
     D  totalMemSize                 10U 0                                                    RADDAT
     D  increment                    10U 0                                                    RADDAT
      /IF NOT DEFINED(*V5R2M0)                                                                RADDAT
     D  signature                          like(signature_t)                                  RADDAT
     D  sortSignature                      like(signature_t)                                  RADDAT
      /ELSE                                                                                   RADDAT
     D  signature                          likeds(signature_t)                                RADDAT
     D  sortSignature                      likeds(signature_t)                                RADDAT
      /ENDIF                                                                                  RADDAT
     D  heapID                       10I 0                                                    RADDAT
     D  pBase                          *                                                      RADDAT
     D  pAutoSortFnc                   *   procptr                                            RADDAT
     D  memMgr                             likeds(MemoryManager_manager_t)                    RADDAT
      *                                                                                       RADDAT
     D listE_t         DS                  qualified   based(pDummy)   align                  RADDAT
     D  type                               like(BasicList_type_t  )
     D  size                         10U 0                                                    RADDAT
     D  maxSize                      10U 0                                                    RADDAT
      /IF NOT DEFINED(*V5R2M0)                                                                RADDAT
     D  signature                          like(signature_t)                                  RADDAT
      /ELSE                                                                                   RADDAT
     D  signature                          likeds(signature_t)                                RADDAT
      /ENDIF                                                                                  RADDAT
     D  pData                          *                                                      RADDAT
      *                                                                                       RADDAT
    * *signature_t     DS                  qualified   based(pDummy)   align                  RADDAT
    * * tmStmp                         Z                                                      RADDAT
    * * counter                      10U 0                                                    RADDAT
      *                                                                                       RADDAT
     D signature_t     DS                  qualified   based(pDummy)   align                  RADDAT
     D  time                         10U 0                                                    RADDAT
     D  millitm                      10U 0                                                    RADDAT
     D  counter                      10U 0                                                    RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Produces a new list entry.                                                           RADDAT
     D newEntry...                                                                            RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('newEntry')
     D  io_hList                                  likeds(hList_t   )                          RADDAT
     D  i_type                             const  like(BasicList_type_t  )
      *                                                                                       RADDAT
      *  Returns a pointer to the basing pointer of the                                       RADDAT
      *  liste entry.                                                                         RADDAT
     D getPointerArrayE...                                                                    RADDAT
     D                 PR              *                                                      RADDAT
     D                                            extproc('getPointerArrayE')                 RADDAT
     D  i_hList                            const  likeds(hList_t   )                          RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns a pointer to the element at the specified                                    RADDAT
      *  position in this list.                                                               RADDAT
     D getPointerListE...                                                                     RADDAT
     D                 PR              *                                                      RADDAT
     D                                            extproc('getPointerListE')
     D  i_hList                            const  likeds(hList_t   )                          RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Frees the memory of a given element in this list.                                    RADDAT
     D freeEntryData...
     D                 PR                                                                     RADDAT
     D                                            extproc('freeEntryData')
     D  io_hList                                  likeds(hList_t   )                          RADDAT
     D  io_listE                                  likeds(listE_t   )                          RADDAT
      *                                                                                       RADDAT
      *  Returns TRUE if a given list contains no data.                                       RADDAT
     D entryData_isNULL...                                                                    RADDAT
     D                 PR              N                                                      RADDAT
     D                                            extproc('entryData_isNULL')
     D  i_listE                            const  likeds(listE_t   )                          RADDAT
      *                                                                                       RADDAT
      *  Create a very basic list handle.
     D newListInternal...
     D                 PR              *                                                      RADDAT
     D                                            extproc('newListInternal')
     D  i_extType                          const  like(BasicList_type_t  )
     D  i_increment                  10I 0 const
     D  i_heapID                     10I 0 const                                              RADDAT
     D  i_memMgr                           const  likeds(MemoryManager...                     RADDAT
     D                                                   _manager_t)                          RADDAT
      *                                                                                       RADDAT
      *  Set the entry data.                                                                  RADDAT
     D setEntryData...                                                                        RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('setEntryData')
     D  io_hList                                  likeds(hList_t  )                           RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const                                              RADDAT
     D  i_length                     10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Checks the range of the list index.
     D isIndexOutOfRange...
     D                 PR              N
     D                                            extproc('isIndexOutOfRange')
     D  i_hList                            const  likeds(hList_t  )
     D  i_index                      10I 0 const
      *                                                                                       RADDAT
      *  Sorts a given list.                                                                  RADDAT
     D qsortCallback...                                                                       RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('qsortCallback')
     D  i_pKey                         *   value                                              RADDAT
     D  i_pElement                     *   value                                              RADDAT
      *                                                                                       RADDAT
      *  Sorts the list if it is required and if an auto-sort procedure                       RADDAT
      *  has been specified.                                                                  RADDAT
     D performAutoSort...                                                                     RADDAT
     D                 PR              N                                                      RADDAT
     D                                            extproc('performAutoSort')
     D  io_hList                                  likeds(hList_t  )                           RADDAT
      *                                                                                       RADDAT
      *  Sorts the list.                                                                      RADDAT
     D sortList...                                                                            RADDAT
     D                 PR              N                                                      RADDAT
     D                                            extproc('sortList')
     D  io_hList                                  likeds(hList_t  )                           RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Returns cTrue for a sorted list, else cFalse.                                       RADDAT
     D isSortedInternally...                                                                  RADDAT
     D                 PR              N                                                      RADDAT
     D                                            extproc('isSortedInternally')
     D  i_hList                            const  likeds(hList_t  )
      *                                                                                       RADDAT
      *  Searches the list for an entry that matches the specified data pointer               RADDAT
     D findEntryBySignature...
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('+
     D                                            findEntryBySignature')
     D  i_hList                            const  likeds(hList_t    )                         RADDAT
     D  i_signature                        const  likeds(signature_t)
      *                                                                                       RADDAT
      *  Returns a new list signature.
     D Signature_new...
     D                 PR                         likeds(signature_t )                        RADDAT
     D                                            extproc('Signature_new')
      *                                                                                       RADDAT
      *  Checks, whether a given handle is a valid list handle, or not.
     D checkListHandle...
     D                 PR
     D                                            extproc('checkListHandle')
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Sends a DIAG message to signal a problem.                                            RADDAT
     D signalProblem...                                                                       RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('signalProblem')                    RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Sends an ESCAPE message to signal an error condition.
     D signalError...
     D                 PR
     D                                            extproc('signalError')
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
     D cHANDLE_TYPE_LIST...
     D                 C                   const(6688841203191988545)           =  *List
     D cHANDLE_SIZE...
     D                 C                   const(%size(hList_t))
      *                                                                                       RADDAT
     D cERROR_LIST_HANDLE_NULL...
     D                 C                   const('List handle is NULL')
     D cERROR_LIST_HANDLE_INVALID...
     D                 C                   const('List handle is invalid')
     D cERROR_NO_MEMORY...                                                                    RADDAT
     D                 C                   const('Failed to allocate/+                        RADDAT
     D                                            reallocate memory')                         RADDAT
     D cPROBLEM_LIST_FULL...                                                                  RADDAT
     D                 C                   const('Maximum number of +                         RADDAT
     D                                            list items reached')                        RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
     D g_pSortFnc      S               *   inz procptr                                        RADDAT
      *                                                                                       RADDAT
      *  Prototype of the external sort function. A procedure pointer                         RADDAT
      *  of a function that matches this prototype must be passed to                          RADDAT
      *  BasicList_sort().                                                                    RADDAT
      *                                                                                       RADDAT
      *     Return Value          Meaning                                                     RADDAT
      *     ---------------       -------------------------                                   RADDAT
      *     Less than 0           key less than element                                       RADDAT
      *     0                     key equal to element                                        RADDAT
      *     Greater than 0        key greater than element                                    RADDAT
      *                                                                                       RADDAT
     D sortFnc...                                                                             RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc(g_pSortFnc)                                RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new BasicList.                                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_extType     - The type of the list.
      *   i_increment   - The number of empty elements that are added to the                  RADDAT
      *                   list when the list needs to be resized.                             RADDAT
      *   i_memMgr      - The memory manager to use.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pList         - Returns the basing pointer of the list on                           RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicList_new...                                                                       RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_new...                                                                       RADDAT
     D                 PI                         like(BasicList_handle_t)                    RADDAT
     D  i_extType                          const  like(BasicList_type_t  )                    RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pList           S                   like(BasicList_handle_t) inz                       RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_extType       C                   const(1)                                           RADDAT
     D p_increment     C                   const(2)                                           RADDAT
     D p_heapID        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D extType         S                   like(i_extType   ) inz                             RADDAT
     D increment       S                   like(i_increment ) inz                             RADDAT
     D heapID          S                   like(i_heapID    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  House keeping:                                                                       RADDAT
      *     List handle                                                                       RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... i_extType                                                                   //RADDAT
 B01     if %parms() >= p_extType;
            CEETSTA(isPresent: p_extType: *omit);
 X01     else;                                                                              //RADDAT
            isPresent = 0;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if isPresent = 1;                                                                  //RADDAT
            extType = i_extType;
 X01     else;                                                                              //RADDAT
            extType = '';                                                                   //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_increment                                                                 //RADDAT
 B01     if %parms() >= p_increment;                                                        //RADDAT
            CEETSTA(isPresent: p_increment: *omit);
 X01     else;                                                                              //RADDAT
            isPresent = 0;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if isPresent = 1;                                                                  //RADDAT
            increment = i_increment;                                                        //RADDAT
 X01     else;                                                                              //RADDAT
            increment = 256;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_heapID                                                                    //RADDAT
 B01     if %parms() >= p_heapID;                                                           //RADDAT
            CEETSTA(isPresent: p_heapID: *omit);
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if isPresent = 1;                                                                  //RADDAT
            heapID = i_heapID;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            heapID = 0;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = MemoryManager_getDefaultManager();                                     //RADDAT
                                                                                            //RADDAT
         // Initialize house keeping fields                                                 //RADDAT
         pHList = *NULL;                                                                    //RADDAT
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Create a very basic list                                                     //RADDAT
            pHList = newListInternal(extType: increment: heapID: mm_memMgr);                //RADDAT
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Error!                                                                          //RADDAT
 B01     if isError;                                                                        //RADDAT
            // Free memory of list handle                                                   //RADDAT
 B02        if pHList <> *NULL;                                                             //RADDAT
               mm_free(pHList);                                                             //RADDAT
               pHList = *NULL;                                                              //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            pList = pHList;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            pList = BasicList_null();                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pList;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_new...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Clones a given BasicList.                                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pList         - Returns the basing pointer of the cloned list on                    RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicList_clone...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_clone...                                                                     RADDAT
     D                 PI                         like(BasicList_handle_t)                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pListRtn        S                   like(BasicList_handle_t) inz                       RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D numE            S             10I 0 inz                                                RADDAT
     D size            S             10I 0 inz                                                RADDAT
     D pData           S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      *                                                                                       RADDAT
      *  House keeping:                                                                       RADDAT
      *     List handle                                                                       RADDAT
     D pTmpList        S                   like(BasicList_handle_t) inz                       RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkListHandle(i_pList);                                                          //RADDAT
                                                                                            //RADDAT
         pListRtn = BasicList_null();                                                       //RADDAT
                                                                                            //RADDAT
         // Initialize house keeping fields                                                 //RADDAT
         pTmpList = BasicList_null();                                                       //RADDAT
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Create a new and empty list                                                  //RADDAT
            pTmpList = BasicList_new(hList.extType: hList.increment);                       //RADDAT
 B02        if (BasicList_isNull(pTmpList));                                                //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Copy list entries                                                            //RADDAT
            numE = BasicList_getNumE(i_pList);                                              //RADDAT
 B02        for x = 1 to numE;                                                              //RADDAT
 B03           if (BasicList_isNullValue(i_pList: x));                                      //RADDAT
                  BasicList_addNull(pTmpList);                                              //RADDAT
 X03           else;                                                                        //RADDAT
                  size  = BasicList_getSize(i_pList: x);                                    //RADDAT
                  pData = BasicList_get(i_pList: x);                                        //RADDAT
                  BasicList_add(pTmpList: pData: size);                                     //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endfor;                                                                         //RADDAT
                                                                                            //RADDAT
            // Set return value                                                             //RADDAT
            pListRtn = pTmpList;                                                            //RADDAT
            pTmpList = BasicList_null();                                                    //RADDAT
                                                                                            //RADDAT
            // Done.                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // House keeping ...                                                               //RADDAT
         // ... pTmpList                                                                    //RADDAT
 B01     if (not BasicList_isNull(pTmpList));                                               //RADDAT
            BasicList_delete(pTmpList);                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pListRtn;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_clone...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a given element.                                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *   i_pEntry      - Address where to copy the entry data to.
      *                   If this parameter is not passed, the address                        RADDAT
      *                   of the list entry data is returned. Hence
      *                   you gain direct access to the list entry data!
      *   i_length      - The maximum size of the entry data.                                 RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pEntry        - Returns a pointer to the entry data on                              RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicList_get...                                                                       RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_get...                                                                       RADDAT
     D                 PI              *                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const  options(*nopass)
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pElemData       S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_pEntry        C                   const(3)                                           RADDAT
     D p_length        C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D pEntry          S                   like(i_pEntry     ) inz                            RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D maxSize         S             10I 0 inz                                                RADDAT
     D numRemBytes     S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      *                                                                                       RADDAT
      *  List entry                                                                           RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... pEntry
         p_assert(%parms() <> p_pEntry
                  : 'length must be specified if pEntry is passed');

         // ... length
 B01     if %parms() >= p_length;                                                           //RADDAT
            pEntry = i_pEntry;
            length = i_length;
 X01     else;                                                                              //RADDAT
            pEntry = *NULL;
            length = 0;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Verify range of i_index                                                      //RADDAT
 B02        if isIndexOutOfRange(hList: i_index);
               isError = cTrue;
               leave;
 E02        endif;
                                                                                            //RADDAT
            // Get access to entry data                                                     //RADDAT
            pListE = getPointerListE(hList: i_index);                                       //RADDAT
                                                                                            //RADDAT
            // Determine number of bytes to copy                                            //RADDAT
 B02        if length < listE.size;                                                         //RADDAT
               maxSize = length;                                                            //RADDAT
 X02        else;                                                                           //RADDAT
               maxSize = listE.size;                                                        //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Initialize return buffer (remaining bytes only)                              //RADDAT
            numRemBytes = length - listE.size;                                              //RADDAT
 B02        if numRemBytes > 0;                                                             //RADDAT
               memset((pEntry + listE.size): x'00': numRemBytes);                           //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Copy entry data                                                              //RADDAT
 B02        if maxSize > 0;
               memcpy(pEntry: listE.pData: maxSize);
               pElemData = pEntry;
 X02        else;
               pElemData = listE.pData;
 E02        endif;
                                                                                            //RADDAT
            // Done.                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return pElemData;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_get...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a given string.                                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - Returns a string on success, else ''.                               RADDAT
      *=========================================================================              RADDAT
     P BasicList_getString...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getString...                                                                 RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying inz                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         BasicList_get(i_pList: i_index: %addr(string): %size(string));                     //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getString...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a the pointer element from the specified position.                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pointer       - Returns a pointer on success, else *NULL.                           RADDAT
      *=========================================================================              RADDAT
     P BasicList_getPointer...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getPointer...                                                                RADDAT
     D                 PI              *                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pointer         S               *   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         BasicList_get(i_pList: i_index: %addr(pointer): %size(pointer));                   //RADDAT
                                                                                            //RADDAT
         return pointer;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getPointer...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the external type of the list.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   type          - Returns the list type on success, else '';                          RADDAT
      *=========================================================================              RADDAT
     P BasicList_getListType...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getListType...
     D                 PI                         like(BasicList_type_t  )                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D type            S                   like(BasicList_type_t  ) inz                       RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle
         pHList = i_pList;
                                                                                            //RADDAT
         type = hList.extType;
                                                                                            //RADDAT
         return type;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getListType...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks the list for a given external type.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_type        - The type of the list.                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isOfType      - Returns TRUE if the list matches the specified type,                RADDAT
      *                   else, FALSE.                                                        RADDAT
      *=========================================================================              RADDAT
     P BasicList_isListTypeOf...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_isListTypeOf...
     D                 PI              N
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_type                             const  like(BasicList_type_t  )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isValid         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle
         pHList = i_pList;
                                                                                            //RADDAT
 B01     if i_type = hList.extType;
            isValid  = cTrue;
 X01     else;
            isValid  = cFalse;
 E01     endif;
                                                                                            //RADDAT
         return isValid;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_isListTypeOf...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks an list entry for a given type.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *   i_type        - The type of the list.                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isOfType      - Returns TRUE if the list matches the specified type,                RADDAT
      *                   else, FALSE.                                                        RADDAT
      *=========================================================================              RADDAT
     P BasicList_isTypeOf...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_isTypeOf...
     D                 PI              N
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const
     D  i_type                             const  like(BasicList_type_t  )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isValid         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle
         pHList = i_pList;
                                                                                            //RADDAT
         // Verify range of i_index
 B01     if isIndexOutOfRange(hList: i_index);
            isValid = cFalse;
            return isValid;
 E01     endif;

         // Get access to entry data
         pListE = getPointerListE(hList: i_index);

         // Verify entry type
 B01     if listE.type = i_type;
            isvalid = cTrue;
 X01     else;
            isvalid = cFalse;
 E01     endif;
                                                                                            //RADDAT
         return isValid;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_isTypeOf...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the type of the specified list entry.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   type          - Returns the type on success, else ''.
      *=========================================================================              RADDAT
     P BasicList_getType...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getType...
     D                 PI                         like(BasicList_type_t  )
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D type            S                   like(BasicList_type_t  ) inz
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle
         pHList = i_pList;
                                                                                            //RADDAT
         // Verify range of i_index
 B01     if isIndexOutOfRange(hList: i_index);
            type = '';
            return type;
 E01     endif;

         // Get access to entry data
         pListE = getPointerListE(hList: i_index);

         // Return entry type
         type = listE.type;
                                                                                            //RADDAT
         return type;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getType...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the size of of an element.                                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the size of the element on success, else -1.                RADDAT
      *=========================================================================              RADDAT
     P BasicList_getSize...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getSize...                                                                   RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      *                                                                                       RADDAT
      *  List entry                                                                           RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Verify range of i_index                                                      //RADDAT
 B02        if isIndexOutOfRange(hList: i_index);
               isError = cTrue;
               leave;
 E02        endif;
                                                                                            //RADDAT
            // Get access to entry data                                                     //RADDAT
            pListE = getPointerListE(hList: i_index);                                       //RADDAT
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            size = listE.size;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            size = -1;                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return size;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getSize...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Adds a element to a given BasicList.                                                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_pEntry      - The entry to be added to this list.                                 RADDAT
      *   i_length      - Optional. The size of the entry data.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_add...                                                                       RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_add...                                                                       RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_type                             const  like(BasicList_type_t  )
     D                                            options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(3)                                           RADDAT
     D p_type          C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
     D type            S                   like(i_type       ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D x               S             10U 0 inz                                                RADDAT
     D pEntryData      S               *   inz                                                RADDAT
     D prvListSortSignature...
     D                 DS                  likeds(signature_t) inz
     D entrySignature  DS                  likeds(signature_t) inz
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get length of entry data                                                     //RADDAT
 B02        if %parms() >= p_length;                                                        //RADDAT
               CEETSTA(isPresent: p_length: *omit);
 X02        else;                                                                           //RADDAT
               isPresent = 0;
 E02        endif;                                                                          //RADDAT

 B02        if isPresent = 1;
               length = i_length;                                                           //RADDAT
 X02        else;
 B03           if i_pEntry = *NULL;
                  length = 0;
 X03           else;
                  length = strlen(i_pEntry);
 E03           endif;
 E02        endif;
                                                                                            //RADDAT
            // Get type of entry data
 B02        if %parms() >= p_type;
               CEETSTA(isPresent: p_type: *omit);
 X02        else;                                                                           //RADDAT
               isPresent = 0;
 E02        endif;                                                                          //RADDAT

 B02        if isPresent = 1;
               type = i_type;
 X02        else;
               type = cBASICLIST_TYPE_UNKNOWN;
 E02        endif;
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Produce new entry                                                            //RADDAT
            x = newEntry(hList: type);
 B02        if x = 0;                                                                       //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get access to entry data                                                     //RADDAT
            pListE = getPointerListE(hList: x);                                             //RADDAT
                                                                                            //RADDAT
            // Set entry data                                                               //RADDAT
            setEntryData(hList: x: i_pEntry: length);                                       //RADDAT
                                                                                            //RADDAT
            // Save pointer to entry signature                                              //RADDAT
            entrySignature = listE.signature;
                                                                                            //RADDAT
            // Sort list, if required                                                       //RADDAT
            prvListSortSignature = hList.sortSignature;
            performAutoSort(hList);                                                         //RADDAT
                                                                                            //RADDAT
            // Find entry using its signature if the list
            // had been sorted.
 B02        if (prvListSortSignature <> hList.sortSignature);
               x = findEntryBySignature(hList: entrySignature);
 E02        endif;
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            index = x;                                                                      //RADDAT
 X01     else;                                                                              //RADDAT
            index = -1;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_add...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Adds a string to a given BasicList.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_string      - The string to be added to this list.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_addString...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_addString...                                                                 RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D string          S                   like(i_string) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         string = i_string;                                                                 //RADDAT
                                                                                            //RADDAT
         index = BasicList_add(i_pList: %addr(string)
                                      : %len(i_string) + 2
                                      : cBASICLIST_TYPE_VSTRING);                           //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_addString...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Adds a pointer to a given BasicList.                                                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_pointer     - The pointer to be added to this list.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_addPointer...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_addPointer...                                                                RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pointer                      *   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D pointer         S                   like(i_pointer) inz                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pointer = i_pointer;                                                               //RADDAT
                                                                                            //RADDAT
         index = BasicList_add(i_pList: %addr(pointer)
                                      : %size(pointer)
                                      : cBASICLIST_TYPE_POINTER);                           //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_addPointer...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Adds a NULL value to a given BasicList.                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_addNull...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_addNull...                                                                   RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         index = BasicList_add(i_pList: *NULL);                                             //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_addNull...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Searches the list for a given element.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_pEntry      - The entry to be added to this list.                                 RADDAT
      *   i_length      - Optional. The size of the entry data.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_find...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_find...                                                                      RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D ignoreCase      S               N   inz(cFalse)                                        RADDAT
     D x               S             10U 0 inz                                                RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get length of entry data                                                     //RADDAT
 B02        if %parms() >= p_length;                                                        //RADDAT
               length = i_length;                                                           //RADDAT
 X02        else;                                                                           //RADDAT
               length = strlen(i_pEntry);                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Spin through entries in list searching for the request element               //RADDAT
 B02        for x = 1 to hList.numE;                                                        //RADDAT
                                                                                            //RADDAT
               // Get access to entry data                                                  //RADDAT
               pListE = getPointerListE(hList: x);                                          //RADDAT
                                                                                            //RADDAT
               // Compare entry attributes                                                  //RADDAT
 B03           if (length = listE.size);                                                    //RADDAT
 B04              if ignoreCase;                                                            //RADDAT
                     rc = memicmp(i_pEntry: listE.pData: length);                           //RADDAT
 X04              else;                                                                     //RADDAT
                     rc = memcmp(i_pEntry: listE.pData: length);                            //RADDAT
 E04              endif;                                                                    //RADDAT
 X03           else;                                                                        //RADDAT
                  rc = -1;                                                                  //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
 B03           if rc = 0;                                                                   //RADDAT
                  index = x;                                                                //RADDAT
                  leave;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
 E02        endfor;                                                                         //RADDAT
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_find...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Searches the list for a given string.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_string      - The string to be added to this list.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_findString...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_findString...
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10U 0                inz
     D string          S                   like(i_string) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         string = i_string;
                                                                                            //RADDAT
         index = BasicList_find(i_pList: %addr(string): %len(i_string) + 2);
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_findString...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the element at the specified position in this list.                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *   i_pEntry      - The entry to be added to this list.                                 RADDAT
      *   i_length      - Optional. The size of the entry data.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   length        - Returns the length of the element on                                RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_set...                                                                       RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_set...                                                                       RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_type                             const  like(BasicList_type_t  )                    RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D newLength       S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(4)                                           RADDAT
     D p_type          C                   const(5)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
     D type            S                   like(i_type       ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Handle Data                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get length of entry data                                                     //RADDAT
 B02        if %parms() >= p_length;                                                        //RADDAT
               CEETSTA(isPresent: p_length: *omit);
 X02        else;                                                                           //RADDAT
               isPresent = 0;                                                               //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if isPresent = 1;                                                               //RADDAT
               length = i_length;                                                           //RADDAT
 X02        else;                                                                           //RADDAT
 B03           if i_pEntry = *NULL;
                  length = 0;
 X03           else;
                  length = strlen(i_pEntry);
 E03           endif;
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get type of entry data                                                       //RADDAT
 B02        if %parms() >= p_type;                                                          //RADDAT
               CEETSTA(isPresent: p_type: *omit);
 X02        else;                                                                           //RADDAT
               isPresent = 0;                                                               //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if isPresent = 1;                                                               //RADDAT
               type = i_type;                                                               //RADDAT
 X02        else;                                                                           //RADDAT
               type = cBASICLIST_TYPE_UNKNOWN;                                              //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Set entry data                                                               //RADDAT
            newLength = setEntryData(hList: i_index: i_pEntry: length);                     //RADDAT
                                                                                            //RADDAT
            // Sort list, if required                                                       //RADDAT
            performAutoSort(hList);                                                         //RADDAT
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return newLength;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_set...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the element at the specified position to NULL.                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   length        - Returns the length (always 0) of the element on                     RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_setNull...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_setNull...                                                                   RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D newLength       S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         newLength = BasicList_set(i_pList: i_index: *NULL);                                //RADDAT
                                                                                            //RADDAT
         return newLength;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_setNull...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the string at the specified position in this list.                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *   i_string      - The string that is changed.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   length        - Returns the length of the element on                                RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_setString...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_setString...                                                                 RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D newLength       S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D string          S                   like(i_string) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         string = i_string;                                                                 //RADDAT
                                                                                            //RADDAT
         newLength = BasicList_set(i_pList: i_index
                                          : %addr(string)
                                          : %len(i_string) + 2
                                          : cBASICLIST_TYPE_VSTRING);                       //RADDAT
                                                                                            //RADDAT
         return newLength;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_setString...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the pointer at the specified position in this list.                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *   i_pointer     - The pointer that is changed.                                        RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   length        - Returns the length of the element on                                RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_setPointer...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_setPointer...                                                                RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pointer                      *   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D newLength       S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D pointer         S                   like(i_pointer) inz                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pointer = i_pointer;                                                               //RADDAT
                                                                                            //RADDAT
         newLength = BasicList_set(i_pList: i_index
                                          : %addr(pointer)
                                          : %size(pointer)
                                          : cBASICLIST_TYPE_POINTER);                       //RADDAT
                                                                                            //RADDAT
         return newLength;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_setPointer...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes the element at the specified position in this list.                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Index of a given list element.                                      RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicList_remove...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_remove...                                                                    RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D pTarget         S               *   inz                                                RADDAT
     D pSource         S               *   inz                                                RADDAT
     D size            S             10U 0 inz                                                RADDAT
     D curIndex        S             10U 0 inz                                                RADDAT
     D numDeletedE     S             10U 0 inz                                                RADDAT
      *                                                                                       RADDAT
     D range           DS                  qualified                                          RADDAT
     D  from                         10U 0 inz                                                RADDAT
     D  to                           10U 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      *                                                                                       RADDAT
      *  List entry                                                                           RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
     D pListE          S               *   based(ppListE)                                     RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = MemoryManager_getDefaultManager();                                     //RADDAT
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Return to caller if there are no entries in this list                        //RADDAT
 B02        if hList.numE = 0;                                                              //RADDAT
               isDone = cTrue;                                                              //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Determine the range of elements to remove                                    //RADDAT
 B02        if i_index = cBASICLIST_REMOVE_ALL;
               range.from = 1;                                                              //RADDAT
               range.to   = hList.numE;                                                     //RADDAT
 X02        else;                                                                           //RADDAT
               range.from = i_index;                                                        //RADDAT
               range.to   = i_index;                                                        //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Remove all entries within the specified range:                               //RADDAT
            numDeletedE = 0;                                                                //RADDAT
                                                                                            //RADDAT
 B02        for curIndex = range.from to range.to;                                          //RADDAT
                                                                                            //RADDAT
               // Increment number of removed entries                                       //RADDAT
               numDeletedE = numDeletedE + 1;                                               //RADDAT
                                                                                            //RADDAT
               // Get access to entry data                                                  //RADDAT
               ppListE = getPointerArrayE(hList: curIndex);                                 //RADDAT
                                                                                            //RADDAT
               // Free entry data:                                                          //RADDAT
 B03           if (pListE <> *NULL);                                                        //RADDAT
 B04              if not entryData_isNULL(listE);                                           //RADDAT
                     clear listE.signature;                                                 //RADDAT
                     freeEntryData(hList: listE);                                           //RADDAT
 E04              endif;                                                                    //RADDAT
                                                                                            //RADDAT
                  mm_free(pListE);                                                          //RADDAT
                  ppListE = *NULL;                                                          //RADDAT
                                                                                            //RADDAT
                  hList.totalMemSize = hList.totalMemSize + %size(listE_t);                 //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
 E02        endfor;                                                                         //RADDAT
                                                                                            //RADDAT
            // If it was not the last entry that was removed                                //RADDAT
            // from the list, ...                                                           //RADDAT
 B02        if range.to < hList.numE;                                                       //RADDAT
                                                                                            //RADDAT
               // ... then shifts any subsequent elements to the left                       //RADDAT
               pTarget = getPointerArrayE(hList: range.from);                               //RADDAT
               pSource = getPointerArrayE(hList: range.to + 1);                             //RADDAT
               size    = (hList.numE - range.from) * %size(pDummy);                         //RADDAT
               memmove(pTarget: pSource: size);                                             //RADDAT
                                                                                            //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Compute number of elements remaining in this list                            //RADDAT
            hList.numE = hList.numE - numDeletedE;                                          //RADDAT
                                                                                            //RADDAT
            // Set new signature
            hList.signature = Signature_new();
                                                                                            //RADDAT
            // Initialize freed memory                                                      //RADDAT
            pSource = getPointerArrayE(hList: hList.numE + 1);                              //RADDAT
            size    = numDeletedE * %size(pDummy);                                          //RADDAT
            memset(pSource: x'00': size);                                                   //RADDAT
                                                                                            //RADDAT
            // We just removed an element from the list.                                    //RADDAT
            // Hence we do not need to sort the list again.                                 //RADDAT
            hList.sortSignature = hList.signature;                                          //RADDAT
                                                                                            //RADDAT
            // Done.                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            rc = 0;                                                                         //RADDAT
 X01     else;                                                                              //RADDAT
            rc = -1;                                                                        //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_remove...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the number of elements in this list.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the number of elements in this list on                      RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicList_getNumE...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getNumE...                                                                   RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D numE            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = i_pList;                                                               //RADDAT
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            numE = hList.numE;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            numE = -1;                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return numE;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getNumE...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the heap ID of a given BasicList.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   heapID        - ID of the heap this BasicList belongs to.                           RADDAT
      *=========================================================================              RADDAT
     P BasicList_getHeapID...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getHeapID...                                                                 RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D heapID          S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkListHandle(i_pList);                                                          //RADDAT
                                                                                            //RADDAT
         // Get access to list handle                                                       //RADDAT
         pHList = i_pList;                                                                  //RADDAT
                                                                                            //RADDAT
         heapID = hList.heapID;                                                             //RADDAT
                                                                                            //RADDAT
         return heapID;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getHeapID...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sorts a list using the specified sort function.                                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_pSortFnc    - Procedure pointer of sort procedure.                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSorted      - Returns TRUE on success, else FALSE.                                RADDAT
      *=========================================================================              RADDAT
     P BasicList_sort...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_sort...                                                                      RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSorted        S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle                                                       //RADDAT
         pHList = i_pList;                                                                  //RADDAT
                                                                                            //RADDAT
         // Sort the list.                                                                  //RADDAT
         isSorted = sortList(hList: i_pSortFnc);                                            //RADDAT
                                                                                            //RADDAT
         return isSorted;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_sort...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns cTrue if a given list is sorted.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSorted      - Returns TRUE if the list is sorted, else cFalse.                    RADDAT
      *=========================================================================              RADDAT
     P BasicList_isSorted...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_isSorted...                                                                  RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSorted        S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle                                                       //RADDAT
         pHList = i_pList;                                                                  //RADDAT
                                                                                            //RADDAT
         return isSortedInternally(hList);
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_isSorted...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Specifies an auto-sort function for this list.                                       RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_pSortFnc    - Procedure pointer of sort procedure.                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns TRUE on success, else FALSE.                                RADDAT
      *=========================================================================              RADDAT
     P BasicList_setAutoSort...                                                               RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_setAutoSort...                                                               RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Get access to list handle                                                       //RADDAT
         pHList = i_pList;                                                                  //RADDAT
                                                                                            //RADDAT
         // Set auto-sort procedure address                                                 //RADDAT
         hList.pAutoSortFnc = i_pSortFnc;                                                   //RADDAT
                                                                                            //RADDAT
         // Sort list                                                                       //RADDAT
 B01     if performAutoSort(hList);                                                         //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 X01     else;                                                                              //RADDAT
            isSet = cFalse;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_setAutoSort...                                                               RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes all entries from a given list.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicList_clear...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_clear...                                                                     RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(i_pList);
                                                                                            //RADDAT
         // Return to caller if there are no entries in this list
 B01     if BasicList_getNumE(i_pList) = 0;
            rc = 0;
 X01     else;
            // Remove all entries from the list
            rc = BasicList_remove(i_pList: cBASICLIST_REMOVE_ALL);
 E01     endif;
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_clear...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the total size of memory used by this list.                                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   totalSize     - Returns the total size of memory used by the list.                  RADDAT
      *=========================================================================              RADDAT
     P BasicList_getTotalSize...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_getTotalSize...                                                              RADDAT
     D                 PI            20I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D totalSize       S             20I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkListHandle(i_pList);                                                          //RADDAT
                                                                                            //RADDAT
         // Get access to list handle                                                       //RADDAT
         pHList = i_pList;                                                                  //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         totalSize = hList.totalMemSize;                                                    //RADDAT
                                                                                            //RADDAT
         return totalSize;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_getTotalSize...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given BasicList.                                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pList      - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicList_delete...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_delete...                                                                    RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  io_pList                                  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         checkListHandle(io_pList);
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Get access to list handle                                                    //RADDAT
            pHList = io_pList;                                                              //RADDAT
                                                                                            //RADDAT
            // Set memory manager                                                           //RADDAT
            mm_memMgr = hList.memMgr;                                                       //RADDAT
                                                                                            //RADDAT
            // Free all list entries                                                        //RADDAT
 B02        dow hList.numE > 0;                                                             //RADDAT
               BasicList_remove(io_pList: hList.numE);                                      //RADDAT
 E02        enddo;                                                                          //RADDAT

            p_assert(hList.numE = 0);
                                                                                            //RADDAT
            // Free memory of list handle                                                   //RADDAT
 B02        if hList.pBase <> *NULL;                                                        //RADDAT
               hList.totalMemSize = hList.totalMemSize - hList.memSize;                     //RADDAT
               mm_free(hList.pBase);                                                        //RADDAT
               hList.memSize = 0;                                                           //RADDAT
 E02        endif;                                                                          //RADDAT

            p_assert(hList.pBase = *NULL);
                                                                                            //RADDAT
            // Clear handle data                                                            //RADDAT
            clear hList;                                                                    //RADDAT
            hList.intType       = 0;
            hList.intSize       = 0;
            hList.extType       = *ALLx'00';                                                //RADDAT
            hList.memSize       = 0;                                                        //RADDAT
            hList.numE          = 0;                                                        //RADDAT
            hList.maxNumE       = 0;                                                        //RADDAT
            hList.totalMemSize  = 0;                                                        //RADDAT
            hList.increment     = 0;                                                        //RADDAT
            hList.signature     = Signature_new();
            hList.sortSignature = hList.signature;                                          //RADDAT
            hList.pBase         = *NULL;                                                    //RADDAT
            hList.pAutoSortFnc  = *NULL;                                                    //RADDAT
                                                                                            //RADDAT
            // Free memory of list handle                                                   //RADDAT
            mm_free(pHList);                                                                //RADDAT
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return parameter value                                                      //RADDAT
 B01     if isDone;                                                                         //RADDAT
            io_pList = BasicList_null();
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            rc = 0;                                                                         //RADDAT
 X01     else;                                                                              //RADDAT
            rc = -1;                                                                        //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_delete...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a BasicList NULL handle.                                                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pList         - NULL handle of a BasicList.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicList_null...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_null...                                                                      RADDAT
     D                 PI                         like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pList           S                   like(BasicList_handle_t) inz                       RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pList = *NULL;                                                                     //RADDAT
                                                                                            //RADDAT
         return pList;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_null...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks a given BasicList handle for a NULL value.                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull        - Returns TRUE if the handle is null, else FALSE.                     RADDAT
      *=========================================================================              RADDAT
     P BasicList_isNull...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_isNull...                                                                    RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNull          S               N   inz(cTrue)                                         RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if i_pList = BasicList_null();                                                     //RADDAT
            isNull = cTrue;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            isNull = cFalse;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isNull;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_isNull...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks a given BasicList entry for a NULL value.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the list returned by BasicList_new().             RADDAT
      *   i_index       - Position of the element.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull        - Returns TRUE if the liste entry is null, else FALSE.
      *=========================================================================              RADDAT
     P BasicList_isNullValue...                                                               RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicList_isNullValue...                                                               RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNull          S               N   inz(cTrue)                                         RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      *                                                                                       RADDAT
      *  List entry                                                                           RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         // Get access to list handle
         pHList = i_pList;

         // Verify range of i_index
 B01     if isIndexOutOfRange(hList: i_index);
            p_assert(cFalse:
                     'Index value (' + %char(i_index) + ') is out of range');
 E01     endif;

         // Get access to entry data
         pListE = getPointerListE(hList: i_index);

 B01     if (listE.pData = *NULL);
            isNull = cTrue;
 X01     else;
            isNull = cFalse;
 E01     endif;
                                                                                            //RADDAT
         return isNull;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicList_isNullValue...                                                               RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Produces a new list entry.                                                           RADDAT
      *=========================================================================              RADDAT
     P newEntry...                                                                            RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D newEntry...                                                                            RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_hList                                   likeds(hList_t   )                          RADDAT
     D  i_type                             const  like(BasicList_type_t  )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Loop control                                                                         RADDAT
     D isDone          S               N   inz(cFalse)                                        RADDAT
     D isError         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D newMemSize      S                   like(hList_t.memSize) inz                          RADDAT
     D listE           DS                  likeds(listE_t      ) based(pListE)                RADDAT
     D pListE          S               *   based(ppListE)                                     RADDAT
      *                                                                                       RADDAT
      *  Maximum size for a non-Teraspace malloc()                                            RADDAT
     D MAX_MEM_SIZE    C                   16711568                                           RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou isDone or isError;                                                             //RADDAT
                                                                                            //RADDAT
            // Set memory manager                                                           //RADDAT
            mm_memMgr = i_hList.memMgr;                                                     //RADDAT
                                                                                            //RADDAT
            // If the there are no more free entries in this list, ...                      //RADDAT
 B02        if i_hList.maxNumE = i_hList.numE;                                              //RADDAT
                                                                                            //RADDAT
               // ... then check amout of used memory and                                   //RADDAT
 B03           if i_hList.memSize >= MAX_MEM_SIZE;                                          //RADDAT
                  signalError(cPROBLEM_LIST_FULL: f_caller());                              //RADDAT
                  // signalProblem(cPROBLEM_LIST_FULL: f_caller());                         //RADDAT
                  // signalProblem(                                                         //RADDAT
                  //       '#list items: ' +                                                //RADDAT
                  //        %char(i_hList.maxNumE): f_caller());                            //RADDAT
                  // signalProblem(                                                         //RADDAT
                  //       '#total size of memory: ' +                                      //RADDAT
                  //        %char(i_hList.totalMemSize): f_caller());                       //RADDAT
                  // return 0;                                                              //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
               // ... (re)allocate additional memory                                        //RADDAT
               newMemSize = i_hList.memSize +
                            (%size(pDummy) * i_hList.increment);                            //RADDAT
                                                                                            //RADDAT
 B03           if (newMemSize > MAX_MEM_SIZE);                                              //RADDAT
                  newMemSize =
                        %div(MAX_MEM_SIZE: %size(pDummy)) * %size(pDummy);                  //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
 B03           if i_hList.pBase = *NULL;                                                    //RADDAT
                  i_hList.pBase = mm_allocate(newMemSize: i_hList.heapID);                  //RADDAT
 X03           else;                                                                        //RADDAT
                  i_hList.pBase = mm_reallocate(i_hList.pBase: newMemSize);                 //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
 B03           if i_hList.pBase = *NULL;                                                    //RADDAT
                  signalError(cERROR_NO_MEMORY: f_caller());                                //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
               i_hList.totalMemSize = i_hList.totalMemSize - i_hList.memSize;               //RADDAT
                                                                                            //RADDAT
               i_hList.memSize      = newMemSize;                                           //RADDAT
               i_hList.maxNumE      = i_hList.memSize / %size(pDummy);                      //RADDAT
                                                                                            //RADDAT
               i_hList.totalMemSize = i_hList.totalMemSize + i_hList.memSize;               //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Increment number of entries in this list
            i_hList.numE = i_hList.numE + 1;                                                //RADDAT
                                                                                            //RADDAT
            // Set new signature
            i_hList.signature = Signature_new();
                                                                                            //RADDAT
            // Create liste entry                                                           //RADDAT
            ppListE = getPointerArrayE(i_hList: i_hList.numE);                              //RADDAT
            pListE = mm_allocate(%size(listE_t): i_hList.heapID);                           //RADDAT
                                                                                            //RADDAT
            i_hList.totalMemSize = i_hList.totalMemSize + %size(listE_t);                   //RADDAT
                                                                                            //RADDAT
            // Initialize entry data                                                        //RADDAT
            clear listE;                                                                    //RADDAT
            listE.type      = i_type;
            listE.pData     = *NULL;                                                        //RADDAT
            listE.size      = 0;                                                            //RADDAT
            listE.maxSize   = 0;                                                            //RADDAT
            listE.signature = Signature_new();
                                                                                            //RADDAT
            // Ready                                                                        //RADDAT
            isDone = cTrue;                                                                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
 B01     if isDone;                                                                         //RADDAT
            index = i_hList.numE;                                                           //RADDAT
 X01     else;                                                                              //RADDAT
            index = 0;                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P newEntry...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns a pointer to the basing pointer of the                                       RADDAT
      *  liste entry.                                                                         RADDAT
      *=========================================================================              RADDAT
     P getPointerArrayE...                                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D getPointerArrayE...                                                                    RADDAT
     D                 PI              *                                                      RADDAT
     D  i_hList                            const  likeds(hList_t   )                          RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D ppListE         S               *   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Compute memory address of list entry                                            //RADDAT
         ppListE = i_hList.pBase + ((i_index-1) * %size(pDummy));                           //RADDAT
                                                                                            //RADDAT
         return ppListE;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P getPointerArrayE...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns a pointer to the element at the specified                                    RADDAT
      *  position in this list.                                                               RADDAT
      *=========================================================================              RADDAT
     P getPointerListE...                                                                     RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D getPointerListE...                                                                     RADDAT
     D                 PI              *                                                      RADDAT
     D  i_hList                            const  likeds(hList_t   )                          RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pListE          S               *   based(ppListE)                                     RADDAT
     D ppListE         S               *   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Compute memory address of list entry                                            //RADDAT
         ppListE = getPointerArrayE(i_hList: i_index);                                      //RADDAT
                                                                                            //RADDAT
         return pListE;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P getPointerListE...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Frees the memory of a given element in this list.                                    RADDAT
      *=========================================================================              RADDAT
     P freeEntryData...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D freeEntryData...
     D                 PI                                                                     RADDAT
     D  i_hList                                   likeds(hList_t   )                          RADDAT
     D  io_listE                                  likeds(listE_t   )                          RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Do until everything is done or an error occured                                 //RADDAT
 B01     dou '1';                                                                           //RADDAT
                                                                                            //RADDAT
            // Set memory manager                                                           //RADDAT
            mm_memMgr = i_hList.memMgr;                                                     //RADDAT
                                                                                            //RADDAT
            // Keep track of the sized of memory used by the list                           //RADDAT
            i_hList.totalMemSize = i_hList.totalMemSize - io_listE.maxSize;                 //RADDAT
                                                                                            //RADDAT
            // Initialize entry data                                                        //RADDAT
 B02        if io_listE.size > 0;                                                           //RADDAT
               memset(io_listE.pData: x'00': io_listE.maxSize);                             //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Free memory of entry entry                                                   //RADDAT
            mm_free(io_listE.pData);                                                        //RADDAT
            io_listE.type    = '';
            io_listE.size    = 0;                                                           //RADDAT
            io_listE.maxSize = 0;                                                           //RADDAT
                                                                                            //RADDAT
            i_hList.totalMemSize = i_hList.totalMemSize + io_listE.maxSize;                 //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P freeEntryData...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns TRUE if a given list contains no data.                                       RADDAT
      *=========================================================================              RADDAT
     P entryData_isNULL...                                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D entryData_isNULL...                                                                    RADDAT
     D                 PI              N                                                      RADDAT
     D  i_listE                            const  likeds(listE_t   )                          RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNULL          S               N   inz(cFalse)                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_listE.size = 0) and (i_listE.pData = *NULL);                                 //RADDAT
            isNULL = cTrue;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            isNULL = cFalse;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isNULL;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P entryData_isNULL...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Create a very basic list handle.
      *=========================================================================              RADDAT
     P newListInternal...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D newListInternal...
     D                 PI              *                                                      RADDAT
     D  i_extType                          const  like(BasicList_type_t  )
     D  i_increment                  10I 0 const
     D  i_heapID                     10I 0 const                                              RADDAT
     D  i_memMgr                           const  likeds(MemoryManager...                     RADDAT
     D                                                   _manager_t)                          RADDAT
      *
      *  Return value
     D hList           DS                  likeds(hList_t    ) based(pHList)                  RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = i_memMgr;                                                              //RADDAT
                                                                                            //RADDAT
         // Allocate memory for list handle
         pHList = mm_allocate(%size(hList_t): i_heapID);                                    //RADDAT
                                                                                            //RADDAT
 B01     if pHList = *NULL;                                                                 //RADDAT
            signalError(cERROR_NO_MEMORY: f_caller());                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Initialize list handle
         clear hList;
         hList.intType       = cHANDLE_TYPE_LIST;
         hList.intSize       = %size(hList);
         hList.extType       = i_extType;
         hList.memSize       = 0;
         hList.numE          = 0;
         hList.maxNumE       = 0;
         hList.totalMemSize  = 0;
         hList.increment     = i_increment;
         hList.signature     = Signature_new();
         hList.sortSignature = hList.signature;                                             //RADDAT
         hList.pBase         = *NULL;
         hList.pAutoSortFnc  = *NULL;                                                       //RADDAT
         hList.memMgr        = i_memMgr;                                                    //RADDAT
         hList.heapID        = i_heapID;                                                    //RADDAT
                                                                                            //RADDAT
         return pHList;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P newListInternal...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Set the entry data.                                                                  RADDAT
      *=========================================================================              RADDAT
     P setEntryData...                                                                        RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D setEntryData...                                                                        RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  io_hList                                  likeds(hList_t  )                           RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const                                              RADDAT
     D  i_length                     10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return Value                                                                         RADDAT
     D newLength       S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Entry Data                                                                           RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = io_hList.memMgr;                                                       //RADDAT
                                                                                            //RADDAT
         // Get access to entry data                                                        //RADDAT
         pListE = getPointerListE(io_hList: i_index);                                       //RADDAT
                                                                                            //RADDAT
         // If the lenth of the entry data exceeds the                                      //RADDAT
         // size of the allocated memory ...                                                //RADDAT
 B01     if i_length > listE.maxSize;                                                       //RADDAT
            // ... (re)allocate memory buffer                                               //RADDAT
 B02        if listE.pData = *NULL;                                                         //RADDAT
               listE.pData = mm_allocate(i_length: io_hList.heapID);                        //RADDAT
 X02        else;                                                                           //RADDAT
               listE.pData = mm_reallocate(listE.pData: i_length);                          //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if listE.pData = *NULL;                                                         //RADDAT
               signalError(cERROR_NO_MEMORY: f_caller());                                   //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_hList.totalMemSize = io_hList.totalMemSize - listE.maxSize;                  //RADDAT
                                                                                            //RADDAT
            listE.maxSize = i_length;                                                       //RADDAT
                                                                                            //RADDAT
            io_hList.totalMemSize = io_hList.totalMemSize + listE.maxSize;                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // If entry data is available ...                                                  //RADDAT
 B01     if i_length > 0;                                                                   //RADDAT
            // ... then copy entry data to buffer                                           //RADDAT
            memcpy(listE.pData: i_pEntry: i_length);                                        //RADDAT
            // ... clear remaining data                                                     //RADDAT
 B02        if i_length < listE.maxSize;                                                    //RADDAT
               memset(listE.pData + i_length: x'00': listE.maxSize - i_length);             //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            // ... else clear entry data                                                    //RADDAT
            memset(listE.pData: x'00': listE.maxSize);                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set new signature                                                               //RADDAT
         io_hList.signature = Signature_new();                                              //RADDAT
                                                                                            //RADDAT
         // Save current length of entry data                                               //RADDAT
         listE.size = i_length;                                                             //RADDAT
                                                                                            //RADDAT
         // Free entry data if applicable:                                                  //RADDAT
 B01     if not entryData_isNULL(listE) and (listE.size = 0);                               //RADDAT
            freeEntryData(io_hList: listE);                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         newLength = listE.size;                                                            //RADDAT
                                                                                            //RADDAT
         return newLength;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P setEntryData...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Checks the range of the list index.
      *=========================================================================              RADDAT
     P isIndexOutOfRange...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D isIndexOutOfRange...
     D                 PI              N                                                      RADDAT
     D  i_hList                            const  likeds(hList_t  )
     D  i_index                      10I 0 const
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_index < 1) or (i_index > i_hList.numE);
            return cTrue;
 X01     else;
            return cFalse;
 E01     endif;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P isIndexOutOfRange...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sorts a given list.                                                                  RADDAT
      *=========================================================================              RADDAT
     P qsortCallback...                                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D qsortCallback...                                                                       RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pKey                         *   value                                              RADDAT
     D  i_pElement                     *   value                                              RADDAT
      *                                                                                       RADDAT
     D pKey            S               *   based(i_pKey)                                      RADDAT
     D pElement        S               *   based(i_pElement)                                  RADDAT
      *                                                                                       RADDAT
     D key             DS                  likeds(listE_t) based(pKey    )                    RADDAT
     D element         DS                  likeds(listE_t) based(pElement)                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         return sortFnc(key.pData: key.size: element.pData: element.size);                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P qsortCallback...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sorts the list if it is required and if an auto-sort procedure                       RADDAT
      *  has been specified.                                                                  RADDAT
      *=========================================================================              RADDAT
     P performAutoSort...                                                                     RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D performAutoSort...                                                                     RADDAT
     D                 PI              N                                                      RADDAT
     D  io_hList                                  likeds(hList_t  )                           RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_currentE      C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSorted        S               N   inz(cFalse)                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if io_hList.pAutoSortFnc <> *NULL;                                                 //RADDAT
            isSorted = sortList(io_hList: io_hList.pAutoSortFnc);                           //RADDAT
 X01     else;                                                                              //RADDAT
            isSorted = cTrue;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSorted;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P performAutoSort...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sorts the list.                                                                      RADDAT
      *=========================================================================              RADDAT
     P sortList...                                                                            RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D sortList...                                                                            RADDAT
     D                 PI              N                                                      RADDAT
     D  io_hList                                  likeds(hList_t  )                           RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSorted        S               N   inz(cFalse)                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (isSortedInternally(io_hList));
            isSorted = cTrue;                                                               //RADDAT
 X01     else;                                                                              //RADDAT
                                                                                            //RADDAT
            p_assert(g_pSortFnc = *NULL
                     : 'g_pSortFnc should be NULL');                                        //RADDAT
                                                                                            //RADDAT
            // Set global variable to hold address of sort procedure                        //RADDAT
            g_pSortFnc = i_pSortFnc;                                                        //RADDAT
                                                                                            //RADDAT
            // Sort list                                                                    //RADDAT
            qsort(io_hList.pBase: io_hList.numE
                                : %size(pDummy)
                                : %paddr('qsortCallback'));                                 //RADDAT
                                                                                            //RADDAT
            // Set sort signature                                                           //RADDAT
            io_hList.sortSignature = io_hList.signature;                                    //RADDAT
                                                                                            //RADDAT
            // Clear global sort function pointer                                           //RADDAT
            g_pSortFnc = *NULL;                                                             //RADDAT
                                                                                            //RADDAT
            isSorted = cTrue;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSorted;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sortList...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns cTrue for a sorted list, else cFalse.                                       RADDAT
      *=========================================================================              RADDAT
     P isSortedInternally...                                                                  RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D isSortedInternally...                                                                  RADDAT
     D                 PI              N                                                      RADDAT
     D  i_hList                            const  likeds(hList_t  )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSorted        S               N   inz(cFalse)                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if i_hList.signature = i_hList.sortSignature;
            isSorted = cTrue;                                                               //RADDAT
 X01     else;                                                                              //RADDAT
            isSorted = cFalse;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSorted;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P isSortedInternally...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Searches the list for an entry using the data pointer of the entry                   RADDAT
      *=========================================================================              RADDAT
     P findEntryBySignature...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D findEntryBySignature...
     D                 PI            10I 0                                                    RADDAT
     D  i_hList                            const  likeds(hList_t    )                         RADDAT
     D  i_signature                        const  likeds(signature_t)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  List entry                                                                           RADDAT
     D listE           DS                  likeds(listE_t    ) based(pListE)                  RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     for x = 1 to i_hList.numE;                                                         //RADDAT
            pListE = getPointerListE(i_hList: x);                                           //RADDAT
 B02        if listE.signature = i_signature;
               index = x;                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P findEntryBySignature...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns a new list signature.
      *=========================================================================              RADDAT
     P Signature_new...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D Signature_new...
     D                 PI                         likeds(signature_t )                        RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D signature       DS                  likeds(signature_t ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Endless counter                                                                      RADDAT
     D lastCounter     S             10U 0 inz           static
     D maxCounter      S             10U 0 inz(*HIVAL)   static
     D now             DS                  likeds(timeb_t ) inz                               RADDAT
      *                                                                                       RADDAT
     D ftime           PR            10I 0 extproc('ftime')                                   RADDAT
     D  tp                                 const  likeds(timeb_t)                             RADDAT
      *                                                                                       RADDAT
     D timeb_t         DS                  qualified               based(pDummy)              RADDAT
     D  time                         10I 0                                                    RADDAT
     D  millitm                      10I 0                                                    RADDAT
     D  timezone                     10I 0                                                    RADDAT
     D  dstflag                      10I 0                                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // signature.tmStmp  = %timestamp();                                               //RADDAT
      /IF NOT DEFINED(*V5R3M0)                                                              //RADDAT
         signature.time = time(*NULL);
         signature.millitm = 0;                                                             //RADDAT
      /ELSE                                                                                 //RADDAT
         ftime(now);   // API introduced: V5R3                                              //RADDAT
         signature.time = now.time;                                                         //RADDAT
         signature.millitm = now.millitm;                                                   //RADDAT
      /ENDIF                                                                                //RADDAT

 B01     if lastCounter < maxCounter;
            signature.counter = lastCounter + 1;
 X01     else;
            signature.counter = 1;
 E01     endif;

         lastCounter = signature.counter;
                                                                                            //RADDAT
         return signature;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *
     P Signature_new...
     P                 E
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Checks, whether a given handle is a valid list handle, or not.
      *  Returns TRUE for a valid list handle, else FALSE.
      *=========================================================================              RADDAT
     P checkListHandle...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D checkListHandle...
     D                 PI
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  List handle                                                                          RADDAT
     D hList           DS                  likeds(hList_t    ) based(i_pList)                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

 B01     if (BasicList_isNull(i_pList));
            signalError(cERROR_LIST_HANDLE_NULL: f_caller());
 E01     endif;
                                                                                            //RADDAT
 B01     if (hList.intType <> cHANDLE_TYPE_LIST);
            signalError(cERROR_LIST_HANDLE_INVALID: f_caller());
 E01     endif;
                                                                                            //RADDAT
 B01     if (hList.intSize <> cHANDLE_SIZE);
            signalError(cERROR_LIST_HANDLE_INVALID: f_caller());
 E01     endif;

         return;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P checkListHandle...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sends a DIAG message to signal a problem.                                            RADDAT
      *=========================================================================              RADDAT
     P signalProblem...                                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D signalProblem...                                                                       RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t ) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg('CPF9897'
                        : 'BasicList: ERROR - ' + i_text
                        : cMsg_Diag: 'QCPFMSG': '*LIBL');                                   //RADDAT
         f_sndPgmMsg(msg: cMsg_Same: i_proc);                                               //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P signalProblem...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sends an ESCAPE message to signal an error condition.
      *=========================================================================              RADDAT
     P signalError...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D signalError...
     D                 PI
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *
      *  Helper fields
     D msg             DS                  likeds(msg_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         msg = f_newMsg('CPF9898'
                        : 'BasicList: ERROR - ' + i_text
                        : cMsg_Escape: 'QCPFMSG': '*LIBL');
         f_sndPgmMsg(msg: cMsg_Same: i_proc);

         return;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P signalError...
     P                 E                                                                      RADDAT
      *
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RB  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RB "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicStack               "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RB  - SrvPgm: Basic Routines - BasicStack                   *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  09.06.2004                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  28.04.2008  Th.Raddatz    Introduced a real stack handle (hStack_t)*
      *                                                                     *                 RADDAT
      *  28.04.2008  Th.Raddatz    Check type of stack handle and send an   *
      *                            ESCAPE message for invalid handles.      *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RB                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
     D hStack_t        DS                  qualified   based(pDummy)   align
     D  intType                      20U 0
     D  intSize                      10U 0
     D  heapID                       10I 0                                                    RADDAT
     D  pList                              like(BasicList_handle_t)
     D  memMgr                             likeds(MemoryManager_manager_t)                    RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Checks, whether a given handle is a valid stack handle, or not.
     D checkStackHandle...
     D                 PR                                                                     RADDAT
     D                                            extproc('checkStackHandle')
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      *  Sends an ESCAPE message to signal an error condition.                                RADDAT
     D signalError...                                                                         RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('signalError')
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
     D cHANDLE_TYPE_STACK...
     D                 C                   const(6693091772879487297)           =  *Stack
     D cHANDLE_SIZE...
     D                 C                   const(%size(hStack_t))
      *                                                                                       RADDAT
     D cERROR_STACK_HANDLE_NULL...
     D                 C                   const('Stack handle is NULL')
     D cERROR_STACK_HANDLE_INVALID...
     D                 C                   const('Stack handle is invalid')
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new BasicStack.                                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_increment   - The number of empty elements that are added to the                  RADDAT
      *                   stack when the stack needs to be resized.                           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pStack        - Returns the basing pointer of the stack on                          RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicStack_new...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_new...                                                                      RADDAT
     D                 PI                         like(BasicStack_handle_t  )                 RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10U 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pStack          S                   like(BasicStack_handle_t  ) inz                    RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_increment     C                   const(1)                                           RADDAT
     D p_heapID        C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D increment       S                   like(i_increment ) inz                             RADDAT
     D heapID          S                   like(i_heapID    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // i_increment                                                                     //RADDAT
 B01     if (%parms() >= p_increment and %addr(i_increment) <> *NULL);                      //RADDAT
            increment = i_increment;                                                        //RADDAT
 X01     else;                                                                              //RADDAT
            increment = 256;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_heapID                                                                    //RADDAT
 B01     if (%parms() >= p_heapID and %addr(i_heapID) <> *NULL);                            //RADDAT
            heapID = i_heapID;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            heapID = 0;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = MemoryManager_getDefaultManager();                                     //RADDAT

         // Allocate memory for stack handle
         pStack = mm_allocate(%size(hStack_t): heapID);                                     //RADDAT

         // Initialize stack handle
         clear hStack;
         hStack.intType = cHANDLE_TYPE_STACK;
         hStack.intSize = %size(hStack);
         hStack.pList   = BasicList_new('*BASICSTACK': increment);
         hStack.heapID  = heapID;                                                           //RADDAT
         hStack.memMgr  = mm_memMgr;                                                        //RADDAT
                                                                                            //RADDAT
         return pStack;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_new...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Clones a given BasicStack.                                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pStack        - Returns the basing pointer of the cloned stack on
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicStack_clone...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_clone...                                                                    RADDAT
     D                 PI                         like(BasicStack_handle_t  )                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pStackRtn       S                   like(BasicStack_handle_t  ) inz                    RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(cFalse
                  : 'Procedure not yet implemented');
                                                                                            //RADDAT
         return pStackRtn;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_clone...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets the last entry from top of the stack without removing it from stack.            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *   i_pEntry      - Optional. Address where to copy the entry data to.                  RADDAT
      *   i_length      - Optional. The maximum size of the entry data.                       RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pEntry        - Returns a pointer to the entry data on                              RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicStack_peek...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_peek...                                                                     RADDAT
     D                 PI              *                                                      RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pElemData       S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_pEntry        C                   const(2)                                           RADDAT
     D p_length        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D pEntry          S                   like(i_pEntry    ) inz                             RADDAT
     D length          S                   like(i_length    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D numElements     S             10I 0 inz                                                RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);
                                                                                            //RADDAT
         p_assert(%parms() <> p_pEntry
                  : 'Invalid number of arguments: i_length is missing');                    //RADDAT
                                                                                            //RADDAT
         // Get element from underlaying BasicList                                          //RADDAT
         numElements = BasicList_getNumE(hStack.pList);
 B01     if numElements <> -1;                                                              //RADDAT
 B02        if %parms() >= p_length;                                                        //RADDAT
               pElemData = BasicList_get(hStack.pList: numElements
                                         : i_pEntry: i_length);                             //RADDAT
 X02        else;                                                                           //RADDAT
               pElemData = BasicList_get(hStack.pList: numElements);
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            pElemData = *NULL;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pElemData;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_peek...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes the lement at the top of the stack and returnns that element.                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *   i_pEntry      - Address where to copy the entry data to.
      *   i_length      - The maximum size of the entry data.                                 RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pEntry        - Returns a pointer to the entry data on                              RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicStack_pop...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_pop...                                                                      RADDAT
     D                 PI              *                                                      RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
     D  i_pEntry                       *   const
     D  i_length                     10I 0 const
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pElemData       S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D numElements     S             10I 0 inz
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);
                                                                                            //RADDAT
         // Get element from underlaying BasicList                                          //RADDAT
         numElements = BasicList_getNumE(hStack.pList);
 B01     if numElements <> -1;                                                              //RADDAT
            pElemData = BasicList_get(
                             hStack.pList: numElements: i_pEntry: i_length);
            BasicList_remove(hStack.pList: numElements);
 X01     else;                                                                              //RADDAT
            pElemData = *NULL;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pElemData;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_pop...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Pushes an item onto the top of the stack.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *   i_pEntry      - The entry to be added to this stack.                                RADDAT
      *   i_length      - Optional. The size of the entry data.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   index         - Returns the index of the element on                                 RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicStack_push...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_push...                                                                     RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);
                                                                                            //RADDAT
         // Get length of entry data                                                        //RADDAT
 B01     if %parms() >= p_length;                                                           //RADDAT
            length = i_length;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            length = strlen(i_pEntry);                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Add entry to underlaying BasicList                                              //RADDAT
         index = BasicList_add(hStack.pList: i_pEntry: length);
                                                                                            //RADDAT
         return index;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_push...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the size of of the element that is on top of this stack.                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the size of the element on success, else -1.                RADDAT
      *=========================================================================              RADDAT
     P BasicStack_getSize...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_getSize...
     D                 PI            10I 0                                                    RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D numElements     S             10I 0 inz
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);
                                                                                            //RADDAT
         // Get index of last element of this stack
         numElements = BasicList_getNumE(hStack.pList);
                                                                                            //RADDAT
         // Get size of that element
 B01     if numElements <> -1;
            size = BasicList_getSize(hStack.pList: numElements);
 E01     endif;
                                                                                            //RADDAT
         return size;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_getSize...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the number of elements in this stack.                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the number of elements in this list on                      RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicStack_getNumE...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_getNumE...
     D                 PI            10I 0                                                    RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D numE            S             10I 0 inz(-1)                                            RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);
                                                                                            //RADDAT
         // Return number of elements of underlaying list
         numE = BasicList_getNumE(hStack.pList);
                                                                                            //RADDAT
         return numE;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_getNumE...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the heap ID of a given BasicStack.                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   heapID        - ID of the heap this BasicStack belongs to.                          RADDAT
      *=========================================================================              RADDAT
     P BasicStack_getHeapID...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_getHeapID...                                                                RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D heapID          S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Stack handle                                                                         RADDAT
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);                                                        //RADDAT
                                                                                            //RADDAT
         // Return the heap ID of underlaying list                                          //RADDAT
         heapID = BasicList_getHeapID(hStack.pList);                                        //RADDAT
                                                                                            //RADDAT
         return heapID;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_getHeapID...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes all entries from a given stack.                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicStack_clear...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_clear...                                                                    RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(i_pStack);
                                                                                            //RADDAT
         // Clear underlaying BasicList                                                     //RADDAT
         rc = BasicList_clear(hStack.pList);
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_clear...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given BasicStack.                                                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pStack     - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicStack_delete...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_delete...                                                                   RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  io_pStack                                 like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(io_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkStackHandle(io_pStack);
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = hStack.memMgr;                                                         //RADDAT
                                                                                            //RADDAT
         // Delete underlaying BasicList.                                                   //RADDAT
         rc = BasicList_delete(hStack.pList);
                                                                                            //RADDAT
         // Clear stack handle
         clear hStack;
         hStack.intType = 0;
         hStack.intSize = 0;
         hStack.pList   = BasicList_null();
         hStack.heapID  = 0;                                                                //RADDAT
         clear hStack.memMgr;                                                               //RADDAT
                                                                                            //RADDAT
         // Free memory of map handle
         mm_free(io_pStack);                                                                //RADDAT

         io_pStack = BasicStack_null();
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_delete...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a BasicStack NULL handle.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pStack        - NULL handle of a BasicStack.                                        RADDAT
      *=========================================================================              RADDAT
     P BasicStack_null...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_null...                                                                     RADDAT
     D                 PI                         like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pStack          S                   like(BasicStack_handle_t  ) inz                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pStack = *NULL;
                                                                                            //RADDAT
         return pStack;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_null...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks a given BasicStack handle for a NULL value.                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pStack      - Basing pointer of the stack returned by BasicStack_new().           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull        - Returns TRUE if the handle is null, else FALSE.                     RADDAT
      *=========================================================================              RADDAT
     P BasicStack_isNull...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicStack_isNull...                                                                   RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNull          S               N   inz(cTrue)                                         RADDAT
      *
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_pStack = BasicStack_null());
            isNull = cTrue;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            isNull = cFalse;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isNull;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicStack_isNull...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Checks, whether a given handle is a valid stack handle, or not.
      *  Returns TRUE for a valid stack handle, else FALSE.
      *=========================================================================              RADDAT
     P checkStackHandle...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D checkStackHandle...
     D                 PI                                                                     RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      *  Stack handle
     D hStack          DS                  likeds(hStack_t   ) based(i_pStack)                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (BasicStack_isNull(i_pStack));
            signalError(cERROR_STACK_HANDLE_NULL: f_caller());
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hStack.intType <> cHANDLE_TYPE_STACK);
            signalError(cERROR_STACK_HANDLE_INVALID: f_caller());
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hStack.intSize <> cHANDLE_SIZE);
            signalError(cERROR_STACK_HANDLE_INVALID: f_caller());
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P checkStackHandle...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sends an ESCAPE message to signal an error condition.                                RADDAT
      *=========================================================================              RADDAT
     P signalError...                                                                         RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D signalError...                                                                         RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t ) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg('CPF9898'
                        : 'BasicStack: ERROR - ' + i_text
                        : cMsg_Escape: 'QCPFMSG': '*LIBL');                                 //RADDAT
         f_sndPgmMsg(msg: cMsg_Same: i_proc);                                               //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P signalError...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RC  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RC "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicMap                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RC  - SrvPgm: Basic Routines - BasicMap                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  09.06.2004                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  08.11.2007  Th.Raddatz    Added procedures:                        *                 RADDAT
      *                            BasicMap_getSizeByIndex()                *                 RADDAT
      *                            BasicMap_putString()                     *                 RADDAT
      *                            BasicMap_getString()                     *                 RADDAT
      *                                                                     *                 RADDAT
      *  05.12.2007  Th.Raddatz    Added procedures:                        *                 RADDAT
      *                            BasicMap_putInteger()                    *                 RADDAT
      *                            BasicMap_getInteger()                    *                 RADDAT
      *                                                                     *                 RADDAT
      *  14.12.2007  Th.Raddatz    Added assert() to BasicMap_put() to      *                 RADDAT
      *                            ensure that key length is greater 0.     *                 RADDAT
      *                                                                     *                 RADDAT
      *  25.02.2008  Th.Raddatz    Fixed memory leak. BasicMap_remove()     *                 RADDAT
      *                            did remove the map entry from the        *                 RADDAT
      *                            underlaying list but did not free the    *                 RADDAT
      *                            memory allocted for that map entry.      *                 RADDAT
      *                                                                     *                 RADDAT
      *  24.04.2008  Th.Raddatz    Introduced a real map handle (hMap_t).   *                 RADDAT
      *                                                                     *                 RADDAT
      *  28.04.2008  Th.Raddatz    Check type of map handle and send an     *                 RADDAT
      *                            ESCAPE message for invalid handles.      *                 RADDAT
      *                            Added procedures:                        *                 RADDAT
      *                               BasicMap_KeySet_new()                 *                 RADDAT
      *                               BasicMap_KeySet_getFirst()            *                 RADDAT
      *                               BasicMap_KeySet_getNext()             *                 RADDAT
      *                               BasicMap_KeySet_delete()              *                 RADDAT
      *                                                                     *                 RADDAT
      *  14.05.2008  Th.Raddatz    Enabled BasicMap_KeySet_new() to be      *                 RADDAT
      *                            called more than once. Introduced        *                 RADDAT
      *                            counter to keep track of the number of   *
      *                            references. (hMap.keySetNumRef)          *                 RADDAT
      *                                                                     *                 RADDAT
      *  27.05.2008  Th.Raddatz    Added procedures:                        *                 RADDAT
      *                               BasicMap_clone()                      *                 RADDAT
      *                            Enabled BasicMap to store NULL data.     *
      *                                                                     *                 RADDAT
      *  09.05.2011  Th.Raddatz    Renamed the KeySet procedures and        *                 RADDAT
      *                            type templates to:                       *                 RADDAT
      *                               BasicMap_newKeySet()                  *                 RADDAT
      *                               BasicKeySet_getFirst()                *                 RADDAT
      *                               BasicKeySet_getNext()                 *                 RADDAT
      *                               BasicKeySet_delete()                  *                 RADDAT
      *                               BasicKeySet_handle_t                  *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RC                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
     D hMap_t          DS                  qualified   based(pDummy)   align                  RADDAT
     D  intType                      20U 0                                                    RADDAT
     D  intSize                      10U 0                                                    RADDAT
     D  pList                              like(BasicList_handle_t)                           RADDAT
     D  pKeySet                            like(BasicList_handle_t)                           RADDAT
     D  keySetRefList                  *   dim(64)                                            RADDAT
     D  keySetNumRef                 10I 0                                                    RADDAT
     D  increment                    10I 0                                                    RADDAT
     D  heapID                       10I 0                                                    RADDAT
     D  memMgr                             likeds(MemoryManager_manager_t)                    RADDAT
      *                                                                                       RADDAT
     D hKeySet_t       DS                  qualified   based(pDummy)   align                  RADDAT
     D  intType                      20U 0                                                    RADDAT
     D  intSize                      10U 0                                                    RADDAT
     D  x                            10I 0                                                    RADDAT
     D  pMap                               like(BasicMap_handle_t )                           RADDAT
      *                                                                                       RADDAT
     D mapE_t          DS                  qualified
     D  pKey                           *
     D  pData                          *
     D  size                         10I 0
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Produces a new KeySet handle.                                                        RADDAT
     D produceKeySetHandle...                                                                 RADDAT
     D                 PR                         like(BasicKeySet_handle_t)                  RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Frees a given KeySet handle.                                                         RADDAT
     D freeKeySetHandle...
     D                 PR                                                                     RADDAT
     D  io_pKeySet                                like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  Adds a key to the associated key set of a given map.                                 RADDAT
     D addKeySetEntry...                                                                      RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('addKeySetEntry')                   RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
      *                                                                                       RADDAT
      *  Removes a key from the associated key set of a given map.                            RADDAT
     D removeKeySetEntry...                                                                   RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('removeKeySetEntry')                RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
      *                                                                                       RADDAT
      *  Frees the memory of a given map entry.
     D freeMapE...
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('freeMapE')                         RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_index                      10I 0 const
      *                                                                                       RADDAT
      *  Searches the underlaying list for a given key.
     D findMapE...                                                                            RADDAT
     D                 PR            10I 0
     D                                            extproc('findMapE')                         RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Sorts the map.                                                                       RADDAT
     D sortMap...                                                                             RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('sortMap')                          RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
     D sortCallback...                                                                        RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('sortCallback')                            RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Checks, whether a given handle is a valid map handle, or not.                        RADDAT
     D checkMapHandle...                                                                      RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('checkMapHandle')                   RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Checks, whether a given handle is a valid KeySet handle, or not.
     D checkKeySetHandle...
     D                 PR                                                                     RADDAT
     D                                            extproc('checkKeySetHandle')
     D  i_pKeySet                          const  like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  Sends an ESCAPE message to signal an error condition.                                RADDAT
     D signalError...                                                                         RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('signalError')                      RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
     D cHANDLE_TYPE_MAP...                                                                    RADDAT
     D                 C                   const(6689113833186869569)           =  *Map       RADDAT
     D cHANDLE_MAP_SIZE...
     D                 C                   const(%size(hMap_t))                               RADDAT
      *                                                                                       RADDAT
     D cERROR_MAP_HANDLE_NULL...                                                              RADDAT
     D                 C                   const('Map handle is NULL')                        RADDAT
     D cERROR_MAP_HANDLE_INVALID...                                                           RADDAT
     D                 C                   const('Map handle is invalid')                     RADDAT
      *                                                                                       RADDAT
     D cHANDLE_TYPE_KEYSET...                                                                 RADDAT
     D                 C                   const(6688555357000016705)           =  *KeySet    RADDAT
     D cHANDLE_KEYSET_SIZE...
     D                 C                   const(%size(hKeySet_t))
      *                                                                                       RADDAT
     D cERROR_KEYSET_HANDLE_NULL...
     D                 C                   const('KeySet handle is NULL')
     D cERROR_KEYSET_HANDLE_INVALID...
     D                 C                   const('KeySet handle is invalid')
      *                                                                                       RADDAT
     D cTYPE_KEYSET...                                                                        RADDAT
     D                 C                   const('*BASIC_KEYSET')                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new BasicMap.                                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_increment   - The number of empty elements that are added to the                  RADDAT
      *                   map when the map needs to be resized.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pMap          - Returns the basing pointer of the map on
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicMap_new...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_new...
     D                 PI                         like(BasicMap_handle_t )
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMap            S                   like(BasicMap_handle_t ) inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_increment     C                   const(1)                                           RADDAT
     D p_heapID        C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D increment       S                   like(i_increment ) inz                             RADDAT
     D heapID          S                   like(i_heapID    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(pMap )                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... i_increment                                                                 //RADDAT
 B01     if (%parms() >= p_increment and %addr(i_increment) <> *NULL);                      //RADDAT
            increment = i_increment;                                                        //RADDAT
 X01     else;                                                                              //RADDAT
            increment = 256;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_heapID                                                                    //RADDAT
 B01     if (%parms() >= p_heapID and %addr(i_heapID) <> *NULL);                            //RADDAT
            heapID = i_heapID;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            heapID = 0;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = MemoryManager_getDefaultManager();                                     //RADDAT
                                                                                            //RADDAT
         // Allocate memory for map handle                                                  //RADDAT
         pMap = mm_allocate(%size(hMap_t): heapID);                                         //RADDAT
                                                                                            //RADDAT
         // Initialize map handle                                                           //RADDAT
         clear hMap;                                                                        //RADDAT
         hMap.intType   = cHANDLE_TYPE_MAP;                                                 //RADDAT
         hMap.intSize   = %size(hMap);                                                      //RADDAT
         hMap.pList     = BasicList_new('*BASICMAP': increment: heapID);                    //RADDAT
         hMap.pKeySet   = BasicList_null();                                                 //RADDAT
         clear hMap.keySetRefList;
         hMap.keySetNumRef = 0;
         hMap.increment = increment;                                                        //RADDAT
         hMap.heapID    = heapID;                                                           //RADDAT
         hMap.memMgr    = mm_memMgr;                                                        //RADDAT
                                                                                            //RADDAT
         return pMap;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_new...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Clones a given BasicMap.                                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_increment   - The number of empty elements that are added to the                  RADDAT
      *                   map when the map needs to be resized.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pMap          - Returns the basing pointer of the map on
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicMap_clone...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_clone...
     D                 PI                         like(BasicMap_handle_t )
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMapRtn         S                   like(BasicMap_handle_t ) inz
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz
     D numE            S             10I 0 inz
     D key             S                   like(BasicMap_key_t ) inz
     D size            S             10I 0 inz
     D pData           S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create a new and empty map
         pMapRtn = BasicMap_new(hMap.increment);
                                                                                            //RADDAT
         // Copy map entries
         numE = BasicMap_getNumE(i_pMap);
 B01     for x = 1 to numE;
            key   = BasicMap_getKeyByIndex(i_pMap: x);
            pData = BasicMap_getValueByIndex(i_pMap: x);
            size  = BasicMap_getSizeByIndex(i_pMap: x);
            BasicMap_put(pMapRtn: key: pData: size);
 E01     endfor;
                                                                                            //RADDAT
         // Create a key set if the base map has a key set
 B01     if (not BasicList_isNull(hMap.pKeySet));
            BasicMap_newKeySet(i_pMap);                                                     //RADDAT
 E01     endif;
                                                                                            //RADDAT
         return pMapRtn;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_clone...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes the entry to which this map maps the specified key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *   i_key         - Key whose associated value is to be removed.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P BasicMap_remove...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_remove...
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Locate element by key in list
         x = findMapE(i_pMap: i_key);                                                       //RADDAT
 B01     if x = -1;
            return rc;
 E01     endif;
                                                                                            //RADDAT
         // Free memory of map entry
         rc = freeMapE(i_pMap: x);                                                          //RADDAT
                                                                                            //RADDAT
         return rc;

      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_remove...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns true if this map contains a mapping for the specified key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *   i_key         - Key whose associated value is to be returned.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isFound       - Returns TRUE is this map contains a mapping for the
      *                   specified key, else FALSE.                                          RADDAT
      *=========================================================================              RADDAT
     P BasicMap_containsKey...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_containsKey...
     D                 PI              N
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isFound         S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0                       inz
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Locate element by key in list
 B01     if findMapE(i_pMap: i_key) = -1;                                                   //RADDAT
            isFound = cFalse;
 X01     else;
            isFound = cTrue;
 E01     endif;
                                                                                            //RADDAT
         return isFound;

      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_containsKey...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the value to which this map maps the specified key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *   i_key         - Key whose associated value is to be returned.
      *   i_pEntry      - Value to be associated with the specified key.
      *   i_length      - Optional. The size of the value.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pElemData     - Pointer to the value addressed by 'i_key'.                          RADDAT
      *=========================================================================              RADDAT
     P BasicMap_get...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_get...
     D                 PI              *
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pElemData       S               *   inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_pEntry        C                   const(3)                                           RADDAT
     D p_length        C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D pEntry          S                   like(i_pEntry     ) inz                            RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0                       inz
     D maxSize         S             10I 0                       inz
     D mapE            DS                  likeds(mapE_t       )
     D                                     based(pMapE         )
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT

         // Get values of optional parameters
         // ... pEntry
         p_assert(%parms() <> p_pEntry
                  : 'length must be specified if pEntry is passed');

         // ... length
 B01     if %parms() >= p_length;
            pEntry = i_pEntry;
            length = i_length;
 X01     else;
            pEntry = *NULL;
            length = 0;
 E01     endif;
                                                                                            //RADDAT
         // Locate element by key in list
         x = findMapE(i_pMap: i_key);                                                       //RADDAT
 B01     if x = -1;
            return pElemData;
 E01     endif;
                                                                                            //RADDAT
         // Get element from underlaying list
         pMapE = BasicList_get(hMap.pList: x);                                              //RADDAT
 B01     if pMapE = *NULL;
            return pElemData;
 E01     endif;

         // Determine number of bytes to copy
 B01     if length < mapE.size;
            maxSize = length;
 X01     else;
            maxSize = mapE.size;
 E01     endif;

         // Initialize return buffer
 B01     if length > 0;
            memset(pEntry: x'00': length);
 E01     endif;

         // Copy entry data
 B01     if maxSize > 0;
            memcpy(pEntry: mapE.pData: maxSize);
            pElemData = pEntry;
 X01     else;
            pElemData = mapE.pData;
 E01     endif;
                                                                                            //RADDAT
         return pElemData;

      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_get...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the string value to which this map maps the specified key.                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_key         - Key whose associated value is to be returned.                       RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - String value addressed by 'i_key'.                                  RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getString...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getString...                                                                  RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz
     D length          S             10I 0 inz
     D maxSize         S             10I 0 inz
     D mapE            DS                  likeds(mapE_t       )                              RADDAT
     D                                     based(pMapE         )                              RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Locate element by key in list                                                   //RADDAT
         x = findMapE(i_pMap: i_key);                                                       //RADDAT
 B01     if x = -1;                                                                         //RADDAT
            return string;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get element from underlaying list                                               //RADDAT
         pMapE = BasicList_get(hMap.pList: x);                                              //RADDAT
 B01     if pMapE = *NULL;                                                                  //RADDAT
            return string;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Determine size of return value                                                  //RADDAT
         length = %size(string);                                                            //RADDAT
                                                                                            //RADDAT
         // Determine number of bytes to copy                                               //RADDAT
 B01     if length < mapE.size;                                                             //RADDAT
            maxSize = length;                                                               //RADDAT
 X01     else;                                                                              //RADDAT
            maxSize = mapE.size;                                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Initialize return buffer                                                        //RADDAT
 B01     if length > 0;                                                                     //RADDAT
            memset(%addr(string): x'00': length);                                           //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Copy entry data                                                                 //RADDAT
 B01     if maxSize > 0;                                                                    //RADDAT
            memcpy(%addr(string): mapE.pData: maxSize);                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getString...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the integer value to which this map maps the specified key.                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_key         - Key whose associated value is to be returned.                       RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   integer       - Integer value addressed by 'i_key'.                                 RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getInteger...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getInteger...                                                                 RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D integer         S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (BasicMap_get(i_pMap:i_key:%addr(integer):%size(integer)) = *NULL);             //RADDAT
            integer = 0;                                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return integer;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getInteger...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the key addressed by a given index.                                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_index       - Index whose associated value is to be returned.                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   key           - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getKeyByIndex...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getKeyByIndex...                                                              RADDAT
     D                 PI                         like(BasicMap_key_t    )                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D key             S                   like(BasicMap_key_t    ) inz                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0                       inz                          RADDAT
     D mapE_key        S                   like(BasicMap_key_t )
     D                                     based(mapE.pKey)
     D mapE            DS                  likeds(mapE_t       )                              RADDAT
     D                                     based(pMapE         )                              RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Locate element by index                                                         //RADDAT
         x = i_index;                                                                       //RADDAT
 B01     if (x < 1) and (x > BasicList_getNumE(hMap.pList));                                //RADDAT
            return key;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Sort list, to keep order stable in case the user performs                       //RADDAT
         // a BasicMap_get() once that he got the key.                                      //RADDAT
         sortMap(i_pMap);                                                                   //RADDAT
                                                                                            //RADDAT
         // Get element from underlaying list                                               //RADDAT
         pMapE = BasicList_get(hMap.pList: x);                                              //RADDAT
 B01     if pMapE = *NULL;                                                                  //RADDAT
            return key;
 E01     endif;                                                                             //RADDAT

         key = %subst(mapE_key: 1: %len(mapE_key));
                                                                                            //RADDAT
         return key;                                                                        //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getKeyByIndex...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the value addressed by a given index.                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_index       - Index whose associated value is to be returned.                     RADDAT
      *   i_pEntry      - Value to be associated with the specified key.                      RADDAT
      *   i_length      - Optional. The size of the value.                                    RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getValueByIndex...                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getValueByIndex...                                                            RADDAT
     D                 PI              *                                                      RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pElemData       S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_pEntry        C                   const(3)                                           RADDAT
     D p_length        C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D pEntry          S                   like(i_pEntry     ) inz                            RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0                       inz                          RADDAT
     D maxSize         S             10I 0                       inz                          RADDAT
     D mapE            DS                  likeds(mapE_t       )                              RADDAT
     D                                     based(pMapE         )                              RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... pEntry                                                                      //RADDAT
         p_assert(%parms() <> p_pEntry
                  : 'length must be specified if pEntry is passed');                        //RADDAT
                                                                                            //RADDAT
         // ... length                                                                      //RADDAT
 B01     if %parms() >= p_length;                                                           //RADDAT
            pEntry = i_pEntry;                                                              //RADDAT
            length = i_length;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            pEntry = *NULL;                                                                 //RADDAT
            length = 0;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Locate element by index                                                         //RADDAT
         x = i_index;                                                                       //RADDAT
 B01     if (x < 1) and (x > BasicList_getNumE(hMap.pList));                                //RADDAT
            return pElemData;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Sort list, to keep order stable in case the user performs                       //RADDAT
         // a BasicMap_get() once that he got the key.                                      //RADDAT
         sortMap(i_pMap);                                                                   //RADDAT
                                                                                            //RADDAT
         // Get element from underlaying list                                               //RADDAT
         pMapE = BasicList_get(hMap.pList: x);                                              //RADDAT
 B01     if pMapE = *NULL;                                                                  //RADDAT
            return pElemData;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Determine number of bytes to copy                                               //RADDAT
 B01     if length < mapE.size;                                                             //RADDAT
            maxSize = length;                                                               //RADDAT
 X01     else;                                                                              //RADDAT
            maxSize = mapE.size;                                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Initialize return buffer                                                        //RADDAT
 B01     if length > 0;                                                                     //RADDAT
            memset(pEntry: x'00': length);                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Copy entry data                                                                 //RADDAT
 B01     if maxSize > 0;                                                                    //RADDAT
            memcpy(pEntry: mapE.pData: maxSize);                                            //RADDAT
            pElemData = pEntry;                                                             //RADDAT
 X01     else;                                                                              //RADDAT
            pElemData = mapE.pData;                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pElemData;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getValueByIndex...                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified value with the specified key in this map.
      *  If the map previously contained a mapping for this key, the old
      *  value is replaced by the specified value.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *   i_key         - Key with which the specified value is to be associated.
      *   i_pEntry      - Value to be associated with the specified key.
      *   i_length      - Optional. The size of the value.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P BasicMap_put...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_put...
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D length          S                   like(i_length     ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz
     D key             S                   like(BasicMap_key_t ) inz
     D mapE            DS                  likeds(mapE_t       ) inz
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         p_assert(%len(i_key) > 0:
                  'Key length must be greater 0');                                          //RADDAT
                                                                                            //RADDAT
         // Get length of entry data                                                        //RADDAT
 B01     if %parms() >= p_length;                                                           //RADDAT
            length = i_length;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if i_pEntry = *NULL;
               length = 0;
 X02        else;
               length = strlen(i_pEntry);
 E02        endif;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = hMap.memMgr;                                                           //RADDAT
                                                                                            //RADDAT
         // Locate element by key in list
         x = findMapE(i_pMap: i_key);                                                       //RADDAT
 B01     if x = -1;
            // Add new entry to map
            key = i_key;

            clear mapE;
            mapE.pKey  = mm_allocate(%len(key) + 2: hMap.heapID);                           //RADDAT
 B02        if (length = 0);
               mapE.pData = *NULL;
 X02        else;
               mapE.pData = mm_allocate(length: hMap.heapID);                               //RADDAT
 E02        endif;
            mapE.size  = length;
            memcpy(mapE.pKey : %addr(key): %len(key) + 2);
            memcpy(mapE.pData: i_pEntry  : length       );
 B02        if BasicList_add(hMap.pList: %addr(mapE): %size(MapE)) <> -1;                   //RADDAT
               addKeySetEntry(hMap.pKeySet: key);                                           //RADDAT
               rc = 0;                                                                      //RADDAT
 E02        endif;                                                                          //RADDAT
            return rc;
 E01     endif;
                                                                                            //RADDAT
         // Get existing map entry from underlaying list
 B01     if BasicList_get(hMap.pList: x: %addr(mapE): %size(mapE)) = *NULL;                 //RADDAT
            return rc;
 E01     endif;
                                                                                            //RADDAT
         // Associate new value to key
         mapE.pData = mm_reallocate(mapE.pData: length);                                    //RADDAT
         mapE.size  = length;
         memcpy(mapE.pData: i_pEntry: length);
                                                                                            //RADDAT
         // Write back map entry to list
 B01     if BasicList_set(hMap.pList: x: %addr(mapE): %size(MapE)) <> -1;                   //RADDAT
            rc = 0;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_put...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified value with the specified key in this map.                   RADDAT
      *  If the map previously contained a mapping for this key, the old                      RADDAT
      *  value is replaced by the specified value.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_key         - Key with which the specified value is to be associated.             RADDAT
      *   i_string      - String value to be associated with the specified key.               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicMap_putString...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_putString...                                                                  RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D string          S                   like(i_string       ) inz                          RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         string = i_string;                                                                 //RADDAT
         rc = BasicMap_put(i_pMap: i_key: %addr(string): %len(string) + 2);                 //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_putString...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified value with the specified key in this map.                   RADDAT
      *  If the map previously contained a mapping for this key, the old                      RADDAT
      *  value is replaced by the specified value.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_key         - Key with which the specified value is to be associated.             RADDAT
      *   i_integer     - Integer value to be associated with the specified key.              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicMap_putInteger...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_putInteger...                                                                 RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_integer                    10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D integer         S                   like(i_integer      ) inz                          RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         integer = i_integer;                                                               //RADDAT
         rc = BasicMap_put(i_pMap: i_key: %addr(integer): %size(integer));                  //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_putInteger...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the size of of the element that is associated with this key.                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *   i_key         - Key of the value.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the size of the element on success, else -1.                RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getSize...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getSize...
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz
     D mapE            DS                  likeds(mapE_t       ) inz
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Locate element by key in list
         x = findMapE(i_pMap: i_key);                                                       //RADDAT
 B01     if x = -1;
            return size;
 E01     endif;
                                                                                            //RADDAT
         // Get map entry from underlaying list
 B01     if BasicList_get(hMap.pList: x: %addr(mapE): %size(mapE)) = *NULL;                 //RADDAT
            return size;
 E01     endif;

         size = mapE.size;
                                                                                            //RADDAT
         return size;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getSize...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the size of of the element that is addressed by a given index.               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_index       - Index whose associated value is to be returned.                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the size of the element on success, else -1.                RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getSizeByIndex...                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getSizeByIndex...                                                             RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D mapE            DS                  likeds(mapE_t       ) inz                          RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Locate element by index                                                         //RADDAT
         x = i_index;                                                                       //RADDAT
 B01     if (x < 1) and (x > BasicList_getNumE(hMap.pList));                                //RADDAT
            return size;                                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get element from underlaying list                                               //RADDAT
 B01     if BasicList_get(hMap.pList: x: %addr(mapE): %size(mapE)) = *NULL;                 //RADDAT
            return size;
 E01     endif;
                                                                                            //RADDAT
         size = mapE.size;                                                                  //RADDAT
                                                                                            //RADDAT
         return size;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getSizeByIndex...                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the number of key-value mappings in this map.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the number of elements in this list on                      RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getNumE...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getNumE...
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D numE            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Return number of elements of underlaying list
         numE = BasicList_getNumE(hMap.pList);                                              //RADDAT
                                                                                            //RADDAT
         return numE;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getNumE...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the heap ID of a given BasicMap.                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   heapID        - ID of the heap this BasicMap belongs to.                            RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getHeapID...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getHeapID...                                                                  RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D heapID          S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Return the heap ID of underlaying list                                          //RADDAT
         heapID = BasicList_getHeapID(hMap.pList);                                          //RADDAT
                                                                                            //RADDAT
         return heapID;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getHeapID...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a list of all keys that are in a given map.                                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_pSortFnc    - Optional: Procedure pointer of sort procedure.                      RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   hList         - List, containing all keys of the map.                               RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getKeys...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getKeys...                                                                    RADDAT
     D                 PI                         like(BasicList_handle_t)                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D hList           S                   like(BasicList_handle_t ) inz                      RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_pSortFnc      C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D pSortFnc        S                   like(i_pSortFnc  ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D key             S                   like(BasicMap_key_t ) inz                          RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Get optional parameter values:                                                  //RADDAT
         // ... pSortFnc                                                                    //RADDAT
 B01     if (%parms() >= p_pSortFnc and %addr(i_pSortFnc) <> *NULL);                        //RADDAT
            pSortFnc = i_pSortFnc;                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            pSortFnc = *NULL;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Create a new BasicList                                                          //RADDAT
         hList = BasicList_new('*BASICMAP_KEYS'
                               : hMap.increment
                               : hMap.heapID);                                              //RADDAT
                                                                                            //RADDAT
         // Add map values to list                                                          //RADDAT
 B01     for x = 1 to BasicMap_getNumE(i_pMap);                                             //RADDAT
            key = BasicMap_getKeyByIndex(i_pMap: x);                                        //RADDAT
            BasicList_addString(hList: key);                                                //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Sort list if the user passed a comparator                                       //RADDAT
 B01     if (pSortFnc <> *NULL);                                                            //RADDAT
            BasicList_sort(hList: pSortFnc);                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return hList;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getKeys...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a list of all values that are in a given map.                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *   i_pSortFnc    - Optional: Procedure pointer of sort procedure.                      RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   hList         - List, containing all values of the map.                             RADDAT
      *=========================================================================              RADDAT
     P BasicMap_getValues...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_getValues...                                                                  RADDAT
     D                 PI                         like(BasicList_handle_t)                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D hList           S                   like(BasicList_handle_t ) inz                      RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_pSortFnc      C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D pSortFnc        S                   like(i_pSortFnc  ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D size            S             10I 0 inz                                                RADDAT
     D pData           S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Get optional parameter values:                                                  //RADDAT
         // ... pSortFnc                                                                    //RADDAT
 B01     if (%parms() >= p_pSortFnc and %addr(i_pSortFnc) <> *NULL);                        //RADDAT
            pSortFnc = i_pSortFnc;                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            pSortFnc = *NULL;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Create a new BasicList                                                          //RADDAT
         hList = BasicList_new('*BASICMAP_VALUES'
                               : hMap.increment
                               : hMap.heapID);                                              //RADDAT
                                                                                            //RADDAT
         // Add map values to list                                                          //RADDAT
 B01     for x = 1 to BasicMap_getNumE(i_pMap);                                             //RADDAT
            pData = BasicMap_getValueByIndex(i_pMap: x);                                    //RADDAT
            size  = BasicMap_getSizeByIndex(i_pMap: x);                                     //RADDAT
            BasicList_add(hList: pData: size);                                              //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Sort list if the user passed a comparator                                       //RADDAT
 B01     if (pSortFnc <> *NULL);                                                            //RADDAT
            BasicList_sort(hList: pSortFnc);                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return hList;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_getValues...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes all entries from a given map.                                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicMap_clear...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_clear...                                                                      RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D numE            S             10I 0 inz                                                RADDAT
     D aPointer        S               *   inz                                                RADDAT
     D mapE            DS                  likeds(mapE_t       ) inz                          RADDAT
      *                                                                                       RADDAT
      *  Debug:                                                                               RADDAT
     D key             S                   like(BasicMap_key_t )                              RADDAT
     D                                     based(mapE.pKey)                                   RADDAT
     D data            S          65535A   based(mapE.pData)                                  RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
         // Remove elements from map.                                                       //RADDAT
         numE = BasicList_getNumE(hMap.pList);                                              //RADDAT
                                                                                            //RADDAT
 B01     dow numE > 0;                                                                      //RADDAT
                                                                                            //RADDAT
            // Free memory of map entry                                                     //RADDAT
            freeMapE(i_pMap: numE);                                                         //RADDAT
                                                                                            //RADDAT
            numE = BasicList_getNumE(hMap.pList);                                           //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         rc = 0;                                                                            //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_clear...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given BasicMap.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pMap       - Basing pointer of the map returned by BasicMap_new().
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicMap_delete...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_delete...
     D                 PI            10I 0                                                    RADDAT
     D  io_pMap                                   like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(io_pMap )                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(io_pMap);                                                           //RADDAT
                                                                                            //RADDAT
 B01     dou 1=1;                                                                           //RADDAT
                                                                                            //RADDAT
            // Set memory manager                                                           //RADDAT
            mm_memMgr = hMap.memMgr;                                                        //RADDAT
                                                                                            //RADDAT
            // Free KeySet handles.
 B02        for x = 1 to %elem(hMap.keySetRefList);
 B03           if (hMap.keySetRefList(x) <> *NULL);
                  freeKeySetHandle(hMap.keySetRefList(x));
 E03           endif;
 E02        endfor;
                                                                                            //RADDAT
            // Remove elements from map.                                                    //RADDAT
            rc = BasicMap_clear(io_pMap);
 B02        if rc <> 0;                                                                     //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Delete underlaying BasicList.                                                //RADDAT
            BasicList_delete(hMap.pList);                                                   //RADDAT
                                                                                            //RADDAT
            // Delete key set if present.                                                   //RADDAT
 B02        if (not BasicList_isNull(hMap.pKeySet));                                        //RADDAT
               BasicList_delete(hMap.pKeySet);                                              //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Clear map handle                                                             //RADDAT
            clear hMap;                                                                     //RADDAT
            hMap.intType       = 0;                                                         //RADDAT
            hMap.intSize       = 0;                                                         //RADDAT
            hMap.pList         = BasicList_null();                                          //RADDAT
            hMap.pKeySet       = BasicList_null();                                          //RADDAT
 B02        for x = 1 to %elem(hMap.keySetRefList);
               p_assert(hMap.keySetRefList(x) = *NULL:
                        'hMap.keySetRefList does not match +
                         expected value *NULL');
 E02        endfor;
            p_assert(hMap.keySetNumRef = 0:
                     'hMap.keySetNumRef does not match expected value 0');
            hMap.increment     = 0;                                                         //RADDAT
            hMap.heapID        = 0;                                                         //RADDAT
            clear hMap.memMgr;                                                              //RADDAT
                                                                                            //RADDAT
            // Free memory of map handle                                                    //RADDAT
            mm_free(io_pMap);                                                               //RADDAT

            io_pMap = BasicMap_null();
                                                                                            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_delete...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a BasicMap NULL handle.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pMap          - NULL handle of a BasicMap.
      *=========================================================================              RADDAT
     P BasicMap_null...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_null...
     D                 PI                         like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMap            S                   like(BasicMap_handle_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pMap = *NULL;
                                                                                            //RADDAT
         return pMap;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_null...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks a given BasicMap handle for a NULL value.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull        - Returns TRUE if the handle is null, else FALSE.                     RADDAT
      *=========================================================================              RADDAT
     P BasicMap_isNull...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_isNull...
     D                 PI              N                                                      RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNull          S               N   inz(cTrue)                                         RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_pMap = BasicMap_null());                                                     //RADDAT
            isNull = cTrue;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            isNull = cFalse;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isNull;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_isNull...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Produces a list of keys from a given map.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pList         - Handle of the list which contains all keys of                       RADDAT
      *                   the map.                                                            RADDAT
      *=========================================================================              RADDAT
      *  Note:            Do not delete the list with BasicList_delete()!                     RADDAT
      *                   Use BasicKeySet_delete() to delete the list.                        RADDAT
      *=========================================================================              RADDAT
     P BasicMap_newKeySet...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicMap_newKeySet...                                                                  RADDAT
     D                 PI                         like(BasicKeySet_handle_t)                  RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkMapHandle(i_pMap);                                                            //RADDAT
                                                                                            //RADDAT
 B01     if (not BasicList_isNull(hMap.pKeySet));                                           //RADDAT
            return produceKeySetHandle(i_pMap);                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         p_assert(hMap.keySetNumRef = 0
                  : 'Expected 0 in hMap.keySetNumRef');                                     //RADDAT
                                                                                            //RADDAT
         hMap.pKeySet = BasicList_new(cTYPE_KEYSET: hMap.increment);                        //RADDAT
                                                                                            //RADDAT
 B01     for x = 1 to BasicMap_getNumE(i_pMap);                                             //RADDAT
            BasicList_addString(hMap.pKeySet
                                : BasicMap_getKeyByIndex(i_pMap: x));                       //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         return produceKeySetHandle(i_pMap);                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicMap_newKeySet...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the first entry of a given key set.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pKeySet     - Handle of a given KeySet, returned by                               RADDAT
      *                   BasicMap_newKeySet().                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   key           - Returns the key of a map entry on success, else ''.
      *=========================================================================              RADDAT
     P BasicKeySet_getFirst...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicKeySet_getFirst...                                                                RADDAT
     D                 PI                         like(BasicMap_key_t    )
     D  i_pKeySet                          const  like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  KeySet handle                                                                        RADDAT
     D hKeySet         DS                  likeds(hKeySet_t  )                                RADDAT
     D                                     based(i_pKeySet)                                   RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     )                                RADDAT
     D                                     based(hKeySet.pMap)                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkKeySetHandle(i_pKeySet);
                                                                                            //RADDAT
         checkMapHandle(hKeySet.pMap);                                                      //RADDAT
                                                                                            //RADDAT
 B01     if (BasicList_isNull(hMap.pKeySet));
            return '';
 E01     endif;
                                                                                            //RADDAT
         hKeySet.x = 0;                                                                     //RADDAT
                                                                                            //RADDAT
         return BasicKeySet_getNext(i_pKeySet);                                             //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicKeySet_getFirst...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the next entry of a given key set.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pKeySet     - Handle of a given KeySet, returned by                               RADDAT
      *                   BasicMap_newKeySet().                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   key           - Returns the key of a map entry on success, else ''.
      *=========================================================================              RADDAT
     P BasicKeySet_getNext...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicKeySet_getNext...                                                                 RADDAT
     D                 PI                         like(BasicMap_key_t    )
     D  i_pKeySet                          const  like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  KeySet handle                                                                        RADDAT
     D hKeySet         DS                  likeds(hKeySet_t  )                                RADDAT
     D                                     based(i_pKeySet)                                   RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     )                                RADDAT
     D                                     based(hKeySet.pMap)                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D numE            S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkKeySetHandle(i_pKeySet);
                                                                                            //RADDAT
         checkMapHandle(hKeySet.pMap);                                                      //RADDAT
                                                                                            //RADDAT
 B01     if (BasicList_isNull(hMap.pKeySet));
            return '';
 E01     endif;

         numE = BasicList_getNumE(hMap.pKeySet);
 B01     if (hKeySet.x >= numE);                                                            //RADDAT
            return '';
 E01     endif;
                                                                                            //RADDAT
 B01     dow (hKeySet.x < numE);                                                            //RADDAT
            hKeySet.x = hKeySet.x + 1;                                                      //RADDAT
 B02        if (not BasicList_isNullValue(hMap.pKeySet: hKeySet.x));                        //RADDAT
               return BasicList_getString(hMap.pKeySet: hKeySet.x);                         //RADDAT
 E02        endif;
 E01     enddo;
                                                                                            //RADDAT
         return '';
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicKeySet_getNext...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes the key list associated to a given map.                                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pKeySet    - Handle of a given KeySet, returned by                               RADDAT
      *                   BasicMap_newKeySet().                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicKeySet_delete...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicKeySet_delete...                                                                  RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  io_pKeySet                                like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  KeySet handle                                                                        RADDAT
     D hKeySet         DS                  likeds(hKeySet_t  )                                RADDAT
     D                                     based(io_pKeySet  )                                RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     )                                RADDAT
     D                                     based(pMap        )                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkKeySetHandle(io_pKeySet);
                                                                                            //RADDAT
         checkMapHandle(hKeySet.pMap);                                                      //RADDAT

         pMap = hKeySet.pMap;
                                                                                            //RADDAT
 B01     if (not BasicList_isNull(hMap.pKeySet));                                           //RADDAT
            freeKeySetHandle(io_pKeySet);                                                   //RADDAT
 B02        if (hMap.keySetNumRef = 0);                                                     //RADDAT
               BasicList_delete(hMap.pKeySet);                                              //RADDAT
               hMap.pKeySet = BasicList_null();                                             //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         rc = 0;                                                                            //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicKeySet_delete...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Produces a new KeySet handle.                                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Handle of a given map.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pKeySet       - Returns a handle for the KeySet on success, else                    RADDAT
      *                   *NULL.                                                              RADDAT
      *=========================================================================              RADDAT
     P produceKeySetHandle...                                                                 RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D produceKeySetHandle...                                                                 RADDAT
     D                 PI                         like(BasicKeySet_handle_t)                  RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pKeySet         S                   like(BasicKeySet_handle_t)                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      *                                                                                       RADDAT
      *  KeySet handle                                                                        RADDAT
     D hKeySet         DS                  likeds(hKeySet_t  ) based(pKeySet)                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(hMap.keySetNumRef < %elem(hMap.keySetRefList):
                  'No more space for another KeySet');                                      //RADDAT
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = hMap.memMgr;                                                           //RADDAT
                                                                                            //RADDAT
         pKeySet = mm_allocate(%size(hKeySet): hMap.heapID);                                //RADDAT
                                                                                            //RADDAT
         clear hKeySet;                                                                     //RADDAT
         hKeySet.intType = cHANDLE_TYPE_KEYSET;                                             //RADDAT
         hKeySet.intSize = %size(hKeySet);
         hKeySet.x       = 0;                                                               //RADDAT
         hKeySet.pMap    = i_pMap;                                                          //RADDAT
                                                                                            //RADDAT
         x = %lookup(*NULL: hMap.keySetRefList);                                            //RADDAT
         hMap.keySetRefList(x) = pKeySet;                                                   //RADDAT
                                                                                            //RADDAT
         hMap.keySetNumRef = hMap.keySetNumRef + 1;                                         //RADDAT
                                                                                            //RADDAT
         return pKeySet;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P produceKeySetHandle...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Frees a given KeySet handle.                                                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pKeySet    - Handle of a given KeySet.                                           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P freeKeySetHandle...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D freeKeySetHandle...
     D                 PI                                                                     RADDAT
     D  io_pKeySet                     *                                                      RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  KeySet handle                                                                        RADDAT
     D hKeySet         DS                  likeds(hKeySet_t  )                                RADDAT
     D                                     based(io_pKeySet  )                                RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     )                                RADDAT
     D                                     based(pMap        )                                RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         pMap = hKeyset.pMap;
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = hMap.memMgr;                                                           //RADDAT
                                                                                            //RADDAT
         x = %lookup(io_pKeySet: hMap.keySetRefList);                                       //RADDAT
         p_assert(x > 0:
                  'KeySet handle not found in list');                                       //RADDAT

         mm_free(io_pKeySet);                                                               //RADDAT
                                                                                            //RADDAT
         hMap.keySetRefList(x) = *NULL;                                                     //RADDAT
         hMap.keySetNumRef     = hMap.keySetNumRef - 1;
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P freeKeySetHandle...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Adds a key to the associated key set of a given map.                                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the key set (list).                               RADDAT
      *   i_key         - Key to add.                                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P addKeySetEntry...                                                                      RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D addKeySetEntry...                                                                      RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (BasicList_isNull(i_pList));                                                    //RADDAT
            rc = 0;                                                                         //RADDAT
            return rc;                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         x = BasicList_findString(i_pList: i_key);                                          //RADDAT
                                                                                            //RADDAT
         p_assert(x = -1
                  : 'Key already in key set');                                              //RADDAT
                                                                                            //RADDAT
         BasicList_addString(i_pList: i_key);                                               //RADDAT
                                                                                            //RADDAT
         rc = 0;                                                                            //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P addKeySetEntry...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Removes a key from the associated key set of a given map.                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pList       - Basing pointer of the key set (list).                               RADDAT
      *   i_key         - Key to remove.                                                      RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P removeKeySetEntry...                                                                   RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D removeKeySetEntry...                                                                   RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (BasicList_isNull(i_pList));                                                    //RADDAT
            rc = 0;                                                                         //RADDAT
            return rc;                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         x = BasicList_findString(i_pList: i_key);                                          //RADDAT
                                                                                            //RADDAT
         p_assert(x > 0
                  : 'Key in key set not found');                                            //RADDAT
                                                                                            //RADDAT
         // Actually the entry is not removed but set to NULL in order
         // to keep the positions of the list entries stable.
         BasicList_set(i_pList: x: *NULL);
                                                                                            //RADDAT
         rc = 0;                                                                            //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P removeKeySetEntry...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Frees the memory of a given map entry.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *   i_index       - Index of the map entry.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P freeMapE...
     P                 B
      *                                                                                       RADDAT
     D freeMapE...
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_index                      10I 0 const
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D aPointer        S               *   inz                                                RADDAT
     D key             S                   like(BasicMap_key_t )                              RADDAT
     D                                     based(mapE.pKey)                                   RADDAT
     D mapE            DS                  likeds(mapE_t       ) inz                          RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = hMap.memMgr;                                                           //RADDAT

         // Get map entry from underlaying list
         aPointer = BasicList_get(hMap.pList: i_index
                                            : %addr(mapE)
                                            : %size(mapE) );                                //RADDAT

         p_assert(aPointer <> *NULL
                  : 'BasicList_get() failed');
                                                                                            //RADDAT
         // Remove entry from an associated key set                                         //RADDAT
         removeKeySetEntry(hMap.pKeySet: key);                                              //RADDAT
                                                                                            //RADDAT
         // Free memory of map entry
         mm_free(mapE.pKey);           // key                                               //RADDAT
                                                                                            //RADDAT
 B01     if (mapE.pData <> *NULL);                                                          //RADDAT
            mm_free(mapE.pData);       // data                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         clear mapE;
                                                                                            //RADDAT
         // Remove that map entry from the underlaying list
         rc = BasicList_remove(hMap.pList: i_index);                                        //RADDAT
                                                                                            //RADDAT
         p_assert(rc <> -1
                  : 'BasicList_remove() failed');
                                                                                            //RADDAT
         return rc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P freeMapE...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Searches the underlaying list for a given key.
      *  (Binary search algorithm)
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMap        - Basing pointer of the map returned by BasicMap_new().
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull        - Returns TRUE if the handle is null, else FALSE.                     RADDAT
      *=========================================================================              RADDAT
     P findMapE...                                                                            RADDAT
     P                 B
      *                                                                                       RADDAT
     D findMapE...                                                                            RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D index           S             10I 0 inz(-1)
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D currentE        S             10I 0                       inz
     D lowerE          S             10I 0                       inz
     D upperE          S             10I 0                       inz
     D mapE_key        S                   like(BasicMap_key_t )
     D                                     based(mapE.pKey)
     D mapE            DS                  likeds(mapE_t )
     D                                     based(pMapE   )
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         sortMap(i_pMap);                                                                   //RADDAT

         lowerE   = 1;
         upperE   = BasicList_getNumE(hMap.pList);                                          //RADDAT

 B01     dow (index = -1) and (lowerE <= upperE);

            currentE = %int((lowerE + upperE) / 2);

            pMapE = BasicList_get(hMap.pList: currentE);                                    //RADDAT
 B02        select;
               when i_key < mapE_key;
                  upperE = currentE - 1;
               when i_key > mapE_key;
                  lowerE = currentE + 1;
 X02        other;
               index = currentE;
 E02        endsl;

 E01     enddo;
                                                                                            //RADDAT
         return index;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P findMapE...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sorts the map.                                                                       RADDAT
      *=========================================================================              RADDAT
     P sortMap...                                                                             RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D sortMap...                                                                             RADDAT
     D                 PI                                                                     RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSorted        S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         BasicList_sort(hMap.pList: %paddr('sortCallback'));                                //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sortMap...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Procedure used by BasicList to sort this map.
      *=========================================================================              RADDAT
     P sortCallback...                                                                        RADDAT
     P                 B
      *                                                                                       RADDAT
     D sortCallback...                                                                        RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D keyMapE         DS                  likeds(mapE_t )
     D                                     based(i_pKeyData )
     D elemMapE        DS                  likeds(mapE_t )
     D                                     based(i_pElemData)
     D keyMapE_key     S                   like(BasicMap_key_t )
     D                                     based(keyMapE.pKey)
     D elemMapE_key    S                   like(BasicMap_key_t )
     D                                     based(elemMapE.pKey)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

 B01     select;
         when %subst(keyMapE_key : 1: %len(keyMapE_key )) >
              %subst(elemMapE_key: 1: %len(elemMapE_key));
            rc = 1;
         when %subst(keyMapE_key : 1: %len(keyMapE_key )) <
              %subst(elemMapE_key: 1: %len(elemMapE_key));
            rc = -1;
 X01     other;
            rc = 0;
 E01     endsl;
                                                                                            //RADDAT
         return rc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sortCallback...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Checks, whether a given handle is a valid map handle, or not.                        RADDAT
      *  Returns TRUE for a valid map handle, else FALSE.                                     RADDAT
      *=========================================================================              RADDAT
     P checkMapHandle...                                                                      RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D checkMapHandle...                                                                      RADDAT
     D                 PI                                                                     RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hMap            DS                  likeds(hMap_t     ) based(i_pMap )                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (BasicMap_isNull(i_pMap));                                                      //RADDAT
            signalError(cERROR_MAP_HANDLE_NULL: f_caller());                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hMap.intType <> cHANDLE_TYPE_MAP);                                             //RADDAT
            signalError(cERROR_MAP_HANDLE_INVALID: f_caller());                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hMap.intSize <> cHANDLE_MAP_SIZE);
            signalError(cERROR_MAP_HANDLE_INVALID: f_caller());                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P checkMapHandle...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Checks, whether a given handle is a valid KeySet handle, or not.
      *  Returns TRUE for a valid map handle, else FALSE.                                     RADDAT
      *=========================================================================              RADDAT
     P checkKeySetHandle...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D checkKeySetHandle...
     D                 PI                                                                     RADDAT
     D  i_pKeySet                          const  like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  Map handle                                                                           RADDAT
     D hKeySet         DS                  likeds(hKeySet_t  ) based(i_pKeySet)               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_pKeySet = *NULL);
            signalError(cERROR_KEYSET_HANDLE_NULL: f_caller());
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hKeySet.intType <> cHANDLE_TYPE_KEYSET);
            signalError(cERROR_KEYSET_HANDLE_INVALID: f_caller());
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hKeySet.intSize <> cHANDLE_KEYSET_SIZE);
            signalError(cERROR_KEYSET_HANDLE_INVALID: f_caller());
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P checkKeySetHandle...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sends an ESCAPE message to signal an error condition.                                RADDAT
      *=========================================================================              RADDAT
     P signalError...                                                                         RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D signalError...                                                                         RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t ) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg('CPF9898'
                        : 'BasicMap: ERROR - ' + i_text
                        : cMsg_Escape: 'QCPFMSG': '*LIBL');                                 //RADDAT
         f_sndPgmMsg(msg: cMsg_Same: i_proc);                                               //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P signalError...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RD  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RD "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - URL                      "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RC  - SrvPgm: Basic Routines - URL                          *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  20.12.2007                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RD                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
 CPY  /COPY QBASICS1,FDURL                                                                    RADDAT
      *                                                                                       RADDAT
      *  Parsed URL                                                                           RADDAT
     D parsedUrl_t...                                                                         RADDAT
     D                 DS           512    qualified               based(pDummy)              RADDAT
     D  type                         10A                                                      RADDAT
     D  pos                           5U 0                                                    RADDAT
     D  protocol                           likeds(substr_t)                                   RADDAT
     D  host                               likeds(substr_t)                                   RADDAT
     D  port                               likeds(substr_t)                                   RADDAT
     D  file                               likeds(substr_t)                                   RADDAT
     D  path                               likeds(substr_t)                                   RADDAT
     D  query                              likeds(substr_t)                                   RADDAT
     D  data                               like(url_t     )                                   RADDAT
      *                                                                                       RADDAT
      *  For internal use only                                                                RADDAT
     D substr_t...                                                                            RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  start                         5U 0                                                    RADDAT
     D  length                        5U 0                                                    RADDAT
     D  baseStart                     5U 0                                                    RADDAT
     D  totalLength                   5U 0                                                    RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported Prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,CEELIB                                                                   RADDAT
      *                                                                                       RADDAT
 CPY  /COPY QBASICS1,PBASICS1R3                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Parses a given URL.                                                                  RADDAT
     D parseUrl...                                                                            RADDAT
     D                 PR                         likeds(parsedUrl_t )                        RADDAT
     D  i_url                              const  like(url_t         )                        RADDAT
     D  o_rc                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Parsen Standard-URL                                                                  RADDAT
     D parseStandardUrl...                                                                    RADDAT
     D                 PR                         likeds(parsedUrl_t )                        RADDAT
     D  i_parsedUrl                        const  likeds(parsedUrl_t )                        RADDAT
     D  o_rc                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Returns the sub-string defined by 'i_subString'.                                     RADDAT
     D getSubstring...                                                                        RADDAT
     D                 PR           512A          varying                                     RADDAT
     D  i_string                    512A   const  varying                                     RADDAT
     D  i_subString                        const  likeds(substr_t )                           RADDAT
      *                                                                                       RADDAT
      *  Breaks the path of a given URL into the pieces: library, file and member
     D splittPath...
     D                 PR              N   opdesc
     D  i_url                              const  likeds(parsedUrl_t )                        RADDAT
     D  i_dftObj                    256A   const  options(*varsize)                           RADDAT
     D  o_file                       10A
     D  o_lib                        10A
     D  o_obj                       256A          options(*varsize)                           RADDAT
     D  o_rc                         10I 0
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
     D cEND_OF_PROTOCOL...                                                                    RADDAT
     D                 C                   const(':')                                         RADDAT
     D cSTART_OF_HOST...                                                                      RADDAT
     D                 C                   const('//')                                        RADDAT
     D cSTART_OF_FILE...                                                                      RADDAT
     D                 C                   const('/')                                         RADDAT
     D cSTART_OF_PORT...                                                                      RADDAT
     D                 C                   const(':')                                         RADDAT
     D cSTART_OF_QUERY...                                                                     RADDAT
     D                 C                   const('?')                                         RADDAT
     D cHANDLE_TYPE...                                                                        RADDAT
     D                 C                   const('*URL')                                      RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new Url.                                                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The string representation of a Url.                                 RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   parsedUrl     - A parsed Url.                                                       RADDAT
      *=========================================================================              RADDAT
     P Url_new...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_new...                                                                             RADDAT
     D                 PI                         like(url_t )
     D  i_url                              const  like(url_t )
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);                                                   //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to create URL. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return parsedUrl;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_new...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the protocol of a given URL.                                                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.                                                            RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   protocol      - The protocol of the URL.                                            RADDAT
      *=========================================================================              RADDAT
     P Url_getProtocol...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getProtocol...                                                                     RADDAT
     D                 PI                         like(url_t )                                RADDAT
     D  i_url                              const  like(url_t )                                RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D protocol        S                   like(url_t ) inz                                   RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);                                                   //RADDAT
                                                                                            //RADDAT
 B01     if (rc = 0);                                                                       //RADDAT
            protocol = f_lcase(getSubstring(parsedUrl.data
                                            : parsedUrl.protocol));                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to retrieve protocol. Error code: ' +
                         %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return protocol;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getProtocol...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the protocol of a given URL.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_url        - The URL.
      *   i_protocol    - The protocol of the URL.
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue if the protocol could be set,
      *                   else cFalse.                                                        RADDAT
      *=========================================================================              RADDAT
     P Url_setProtocol...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_setProtocol...                                                                     RADDAT
     D                 PI              N
     D  io_url                                    like(url_t )                                RADDAT
     D  i_protocol                         const  like(url_t ) options(*varsize)              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D tmpProtocol     S                   like(i_protocol    ) inz                           RADDAT
     D tmpUrl          S                   like(io_URL        ) inz                           RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(%trim(io_url): rc);                                        //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            tmpProtocol = %trimR(%subst(i_protocol: 1: %len(i_protocol)));
                                                                                            //RADDAT
            // replace protocol of URL                                                      //RADDAT
 B02        if (tmpProtocol = '');                                                          //RADDAT
               parsedUrl.data = %replace(''
                                         : parsedUrl.data
                                         : parsedUrl.protocol.baseStart
                                         : parsedUrl.protocol.totalLength);                 //RADDAT
 X02        else;                                                                           //RADDAT
 B03           if (not f_endsWith(cEND_OF_PROTOCOL: tmpProtocol));                          //RADDAT
                  tmpProtocol = tmpProtocol + cEND_OF_PROTOCOL;                             //RADDAT
 E03           endif;                                                                       //RADDAT
               parsedUrl.data = %replace(tmpProtocol
                                         : parsedUrl.data
                                         : parsedUrl.protocol.baseStart
                                         : parsedUrl.protocol.totalLength);                 //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // parse changed URL                                                            //RADDAT
            tmpUrl = parseUrl(parsedUrl.data: rc);                                          //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_URL = tmpUrl;                                                                //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to set protocol. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_setProtocol...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the host name of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.                                                            RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   host          - The host name of the URL.
      *=========================================================================              RADDAT
     P Url_getHost...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getHost...
     D                 PI                         like(url_t    )                             RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D host            S                   like(url_t ) inz                                   RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);
 B01     if (rc = 0);                                                                       //RADDAT
            host = getSubstring(parsedUrl.data: parsedUrl.host);
 E01     endif;
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to retrieve host name. Error code: ' +
                         %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return host;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getHost...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the host name of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_url        - The URL.
      *   i_host        - The name of the host.
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue if the host name could be set,
      *                   else cFalse.                                                        RADDAT
      *=========================================================================              RADDAT
     P Url_setHost...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_setHost...
     D                 PI              N
     D  io_url                                    like(url_t )
     D  i_host                             const  like(url_t ) options(*varsize)
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D tmpHost         S                   like(i_host        ) inz                           RADDAT
     D tmpUrl          S                   like(io_URL        ) inz                           RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(%trim(io_url): rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            tmpHost = %trimR(%subst(i_host: 1: %len(i_host)));
                                                                                            //RADDAT
            // replace host name of URL
 B02        if (tmpHost = '');
               parsedUrl.data = %replace(''
                                         : parsedUrl.data
                                         : parsedUrl.host.baseStart
                                         : parsedUrl.host.totalLength);
 X02        else;                                                                           //RADDAT
 B03           if not f_startsWith(cSTART_OF_HOST: tmpHost);
                  tmpHost = cSTART_OF_HOST + tmpHost;
 E03           endif;                                                                       //RADDAT
               parsedUrl.data = %replace(tmpHost
                                         : parsedUrl.data
                                         : parsedUrl.host.baseStart
                                         : parsedUrl.host.totalLength);
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // parse changed URL                                                            //RADDAT
            tmpUrl = parseUrl(parsedUrl.data: rc);                                          //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_url = tmpUrl;                                                                //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to set host name. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_setHost...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the port of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.                                                            RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   port          - The port of the URL.
      *=========================================================================              RADDAT
     P Url_getPort...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getPort...
     D                 PI            10I 0
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D port            S             10I 0 inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);
 B01     if (rc = 0);                                                                       //RADDAT
            port = atoi(getSubstring(parsedUrl.data: parsedUrl.port));
 E01     endif;
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to retrieve port. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return port;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getPort...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the port number of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_url        - The URL.
      *   i_port        - The port number.
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue if the port number could be set,
      *                   else cFalse.                                                        RADDAT
      *=========================================================================              RADDAT
     P Url_setPort...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_setPort...
     D                 PI              N
     D  io_url                                    like(url_t )
     D  i_port                       10I 0 const
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D tmpPort         S             30A   varying              inz
     D tmpUrl          S                   like(io_URL        ) inz                           RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(%trim(io_url): rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // replace port of URL
 B02        if (i_port = 0);
               parsedUrl.data = %replace(''
                                         : parsedUrl.data
                                         : parsedUrl.port.baseStart
                                         : parsedUrl.port.totalLength);
 X02        else;                                                                           //RADDAT
               tmpPort = cSTART_OF_PORT + %char(i_port);                                    //RADDAT
               parsedUrl.data = %replace(tmpPort
                                         : parsedUrl.data
                                         : parsedUrl.port.baseStart
                                         : parsedUrl.port.totalLength);
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // parse changed URL                                                            //RADDAT
            tmpUrl = parseUrl(parsedUrl.data: rc);                                          //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_url = tmpUrl;                                                                //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to set port number. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_setPort...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the path of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.                                                            RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   path          - The path of the URL. The path of a URL is the
      *                   file name without the query parameters.                             RADDAT
      *=========================================================================              RADDAT
     P Url_getPath...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getPath...
     D                 PI                         like(url_t    )                             RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D path            S                   like(url_t ) inz                                   RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);
 B01     if (rc = 0);                                                                       //RADDAT
            path = getSubstring(parsedUrl.data: parsedUrl.path);
 E01     endif;
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to retrieve path. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return path;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getPath...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the path of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_url        - The URL.
      *   i_path        - The path. The path of a URL is the file name
      *                   without the query parameters.                                       RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue if the path could be set, else cFalse.
      *=========================================================================              RADDAT
     P Url_setPath...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_setPath...
     D                 PI              N
     D  io_url                                    like(url_t )
     D  i_path                             const  like(url_t ) options(*varsize)
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D tmpUrl          S                   like(io_URL        ) inz                           RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(%trim(io_url): rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // replace path of URL
            parsedUrl.data = %replace(%trimR(%subst(i_path: 1: %len(i_path)))
                                      : parsedUrl.data
                                      : parsedUrl.path.baseStart
                                      : parsedUrl.path.totalLength);
                                                                                            //RADDAT
            // parse changed URL                                                            //RADDAT
            tmpUrl = parseUrl(parsedUrl.data: rc);                                          //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_url = tmpUrl;                                                                //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to set path. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_setPath...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the file of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.                                                            RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   file          - The file of the URL. The file of a URL is everything
      *                   behind the host name (and port number).
      *=========================================================================              RADDAT
     P Url_getFile...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getFile...
     D                 PI                         like(url_t    )                             RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D file            S                   like(url_t ) inz                                   RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);
 B01     if (rc = 0);                                                                       //RADDAT
            file = getSubstring(parsedUrl.data: parsedUrl.file);
 E01     endif;
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to retrieve file. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return file;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getFile...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the file of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_url        - The URL.
      *   i_file        - The file. The file of a URL is everything behind the
      *                   hostname (and port number).
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue if the file could be set, else cFalse.
      *=========================================================================              RADDAT
     P Url_setFile...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_setFile...
     D                 PI              N
     D  io_url                                    like(url_t )
     D  i_file                             const  like(url_t ) options(*varsize)
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D tmpUrl          S                   like(io_URL        ) inz                           RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(%trim(io_url): rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // replace file of URL
            parsedUrl.data = %replace(%trimR(%subst(i_file: 1: %len(i_file)))
                                      : parsedUrl.data
                                      : parsedUrl.file.baseStart
                                      : parsedUrl.file.totalLength);
                                                                                            //RADDAT
            // parse changed URL                                                            //RADDAT
            tmpUrl = parseUrl(parsedUrl.data: rc);                                          //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_url = tmpUrl;                                                                //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to set file. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_setFile...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the query part of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.                                                            RADDAT
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   query         - The query part of the URL.
      *=========================================================================              RADDAT
     P Url_getQuery...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getQuery...
     D                 PI                         like(url_t    )                             RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D query           S                   like(url_t ) inz                                   RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(i_url: rc);
 B01     if (rc = 0);                                                                       //RADDAT
            query = getSubstring(parsedUrl.data: parsedUrl.query);
 E01     endif;
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to retrieve query. Error code: ' + %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return query;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getQuery...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the query part of a given URL.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_url        - The URL.
      *   i_query       - The query part of the URL.
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue if the query part could be set,
      *                   else cFalse.                                                        RADDAT
      *=========================================================================              RADDAT
     P Url_setQuery...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_setQuery...
     D                 PI              N
     D  io_url                                    like(url_t )
     D  i_query                            const  like(url_t ) options(*varsize)
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D tmpQuery        S                   like(i_query       ) inz                           RADDAT
     D tmpUrl          S                   like(io_URL        ) inz                           RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(%trim(io_url): rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            tmpQuery = %trimR(%subst(i_query: 1: %len(i_query)));
                                                                                            //RADDAT
            // replace query part of the URL
 B02        if (tmpQuery = '');
               parsedUrl.data = %replace(''
                                         : parsedUrl.data
                                         : parsedUrl.query.baseStart
                                         : parsedUrl.query.totalLength);
 X02        else;                                                                           //RADDAT
 B03           if not f_startsWith(cSTART_OF_QUERY: tmpQuery);
                  tmpQuery = cSTART_OF_QUERY + tmpQuery;
 E03           endif;                                                                       //RADDAT
               parsedUrl.data = %replace(tmpQuery
                                         : parsedUrl.data
                                         : parsedUrl.query.baseStart
                                         : parsedUrl.query.totalLength);
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // parse changed URL                                                            //RADDAT
            tmpUrl = parseUrl(parsedUrl.data: rc);                                          //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            io_url = tmpUrl;                                                                //RADDAT
            isSet = cTrue;                                                                  //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to set query parameters. Error code: ' +
                         %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isSet;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_setQuery...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the string representation of a given URL.                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string representation of the URL.
      *=========================================================================              RADDAT
     P Url_toString...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_toString...
     D                 PI           512A          varying                                     RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S                   like(url_t ) inz                                   RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rc            C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = parseUrl(%trim(i_URL): rc);
 B01     if (rc = 0);
            string = %trimR(parsedUrl.data);
 E01     endif;

 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to get string representation. Error code: ' +
                         %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_toString...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the library, file and member of a URL of type 'mbr'.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_url         - The URL.
      *   o_file        - The file name of a URL of type 'mbr'.
      *   o_lib         - The library name of a URL of type 'mbr'.
      *   o_mbr         - The member name of a URL of type 'mbr'.
      *   o_rc          - Return code. 0 = no errror.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isOK          - Returns cTrue on success, else cFalse.
      *=========================================================================              RADDAT
     P Url_getMbr...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Url_getMbr...
     D                 PI              N                                                      RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_file                       10A          options(*nopass: *omit)
     D  o_lib                        10A          options(*nopass: *omit)
     D  o_mbr                        10A          options(*nopass: *omit)
     D  o_rc                         10I 0        options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Funktionswert                                                                        RADDAT
     D isDone          S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Parameterpositionen                                                                  RADDAT
     D p_file          C                   const(2)                                           RADDAT
     D p_lib           C                   const(3)                                           RADDAT
     D p_mbr           C                   const(4)                                           RADDAT
     D p_rc            C                   const(5)                                           RADDAT
      *                                                                                       RADDAT
      *  Felder fr optionale Parameter                                                       RADDAT
     D file            S                   like(o_file   ) inz                                RADDAT
     D lib             S                   like(o_lib    ) inz                                RADDAT
     D mbr             S                   like(o_mbr    ) inz                                RADDAT
     D rc              S                   like(o_rc     ) inz                                RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D protocol        S                   like(url_t         ) inz
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
            parsedUrl = parseUrl(i_URL: rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            protocol = Url_getProtocol(parsedUrl: rc);
 B02        if (rc <> 0);
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if (protocol <> 'mbr');
               o_rc = cURL_ERROR_UNSUPPORTED_OPERATION;
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if (not splittPath(parsedUrl: '*FIRST': file: lib: mbr: rc));
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set values of optional parameters ...
         // ... file                                                                        //RADDAT
 B01     if (%parms() >= p_file);
            CEETSTA(isPresent: p_file: *omit);
 B02        if (isPresent = 1);
               o_file = file;                                                               //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... lib                                                                         //RADDAT
 B01     if %parms() >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);
 B02        if (isPresent = 1);
               o_lib = lib;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... mbr                                                                         //RADDAT
 B01     if %parms() >= p_mbr;                                                              //RADDAT
            CEETSTA(isPresent: p_mbr: *omit);
 B02        if (isPresent = 1);
               o_mbr = mbr;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT

 B01     if (%parms() >= p_rc);                                                             //RADDAT
            CEETSTA(isPresent: p_rc: *omit);                                                //RADDAT
 B02        if (isPresent = 1);                                                             //RADDAT
               o_rc = rc;                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (rc <> 0);                                                                   //RADDAT
               p_assert(cFalse:
                        'Failed to get file, library, member. Error code: ' +
                         %char(rc));
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return cTrue;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Url_getMbr...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Parses a given URL.                                                                  RADDAT
      *=========================================================================              RADDAT
     P parseUrl...                                                                            RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D parseUrl...                                                                            RADDAT
     D                 PI                         likeds(parsedUrl_t )                        RADDAT
     D  i_url                              const  like(url_t         )                        RADDAT
     D  o_rc                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D itemStart       S             10I 0 inz                                                RADDAT
     D protocol        S             20A   varying inz                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_url = '');                                                                   //RADDAT
            o_rc = cURL_ERROR_EMPTY_URL;
            return parsedUrl;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if f_left(i_url: %len(parsedUrl_t.type)) = cHANDLE_TYPE;                           //RADDAT
            o_rc = 0;                                                                       //RADDAT
            return i_url;                                                                   //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         clear parsedUrl;                                                                   //RADDAT
         parsedUrl.data = %trimR(i_url);                                                    //RADDAT
                                                                                            //RADDAT
         // Get protocol from URL                                                           //RADDAT
         parsedUrl.pos = 1;                                                                 //RADDAT
         itemStart = parsedUrl.pos;                                                         //RADDAT
 B01     dow (parsedUrl.pos <= %len(parsedUrl.data)) and
             (parsedUrl.protocol.start = 0);                                                //RADDAT
 B02        select;                                                                         //RADDAT
            when f_containsStringAt(parsedUrl.data: parsedUrl.pos
                                                  : cEND_OF_PROTOCOL);                      //RADDAT
                                                                                            //RADDAT
               parsedUrl.protocol.start  = itemStart;                                       //RADDAT
               parsedUrl.protocol.length = parsedUrl.pos - itemStart;                       //RADDAT
                                                                                            //RADDAT
               parsedUrl.protocol.baseStart   = itemStart;                                  //RADDAT
               parsedUrl.protocol.totalLength = parsedUrl.pos - itemStart + 1;              //RADDAT
                                                                                            //RADDAT
               parsedUrl.pos = parsedUrl.pos + %len(cEND_OF_PROTOCOL);                      //RADDAT
 X02        other;                                                                          //RADDAT
               parsedUrl.pos = parsedUrl.pos + 1;                                           //RADDAT
 E02        endsl;                                                                          //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Failed to retrieve protocol ==> error                                           //RADDAT
 B01     if parsedUrl.protocol.length = 0;                                                  //RADDAT
            o_rc = cURL_ERROR_NO_PROTOCOL;
            return parsedUrl;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         protocol = f_lcase(getSubstring(parsedUrl.data: parsedUrl.protocol));              //RADDAT
                                                                                            //RADDAT
         // Unknown protocol ==> error                                                      //RADDAT
 B01     if (protocol <> 'http' ) and (protocol <> 'https' ) and
            (protocol <> 'ftp'  ) and (protocol <> 'ftps'  ) and
            (protocol <> 'file' ) and (protocol <> 'mbr'   );
            o_rc = cURL_ERROR_UNSUPPORTED_PROTOCOL;
            return parsedUrl;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Parse URL for protocol ...                                                      //RADDAT
 B01     select;                                                                            //RADDAT
 X01     other;                                                                             //RADDAT
            parsedUrl = parseStandardUrl(parsedUrl: o_rc);                                  //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set missing start position and length information ...                           //RADDAT
         // ... protocol (should not happen)                                                //RADDAT
 B01     if (parsedUrl.protocol.length = 0);                                                //RADDAT
            parsedUrl.protocol.start     = 1;                                               //RADDAT
            parsedUrl.protocol.baseStart = parsedUrl.protocol.start;                        //RADDAT
 E01     endif;                                                                             //RADDAT
         // ... host                                                                        //RADDAT
 B01     if (parsedUrl.host.length = 0);                                                    //RADDAT
            parsedUrl.host.start     = parsedUrl.protocol.baseStart +
                                       parsedUrl.protocol.totalLength;                      //RADDAT
            parsedUrl.host.baseStart = parsedUrl.host.start;                                //RADDAT
 E01     endif;                                                                             //RADDAT
         // ... port                                                                        //RADDAT
 B01     if (parsedUrl.port.length = 0);                                                    //RADDAT
            parsedUrl.port.start     = parsedUrl.host.baseStart +
                                       parsedUrl.host.totalLength;                          //RADDAT
            parsedUrl.port.baseStart = parsedUrl.port.start;                                //RADDAT
 E01     endif;                                                                             //RADDAT
         // ... path                                                                        //RADDAT
 B01     if (parsedUrl.path.length) = 0;                                                    //RADDAT
            parsedUrl.path.start     = parsedUrl.port.baseStart +
                                       parsedUrl.port.totalLength;                          //RADDAT
            parsedUrl.path.baseStart = parsedUrl.path.start;                                //RADDAT
 E01     endif;                                                                             //RADDAT
         // ... file                                                                        //RADDAT
 B01     if (parsedUrl.file.length) = 0;                                                    //RADDAT
            parsedUrl.file.start     = parsedUrl.port.baseStart +
                                       parsedUrl.port.totalLength;                          //RADDAT
            parsedUrl.file.baseStart = parsedUrl.file.start;                                //RADDAT
 E01     endif;                                                                             //RADDAT
         // ... query                                                                       //RADDAT
 B01     if (parsedUrl.query.length) = 0;                                                   //RADDAT
            parsedUrl.query.start     = parsedUrl.path.baseStart +
                                        parsedUrl.path.totalLength;                         //RADDAT
            parsedUrl.query.baseStart = parsedUrl.query.start;                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         o_rc = 0;                                                                          //RADDAT
                                                                                            //RADDAT
         return parsedUrl;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P parseUrl...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Parsen Standard-URL                                                                  RADDAT
      *=========================================================================              RADDAT
     P parseStandardUrl...                                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D parseStandardUrl...                                                                    RADDAT
     D                 PI                         likeds(parsedUrl_t )                        RADDAT
     D  i_parsedUrl                        const  likeds(parsedUrl_t )                        RADDAT
     D  o_rc                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Funktionswert                                                                        RADDAT
     D parsedUrl       DS                  likeds(parsedUrl_t ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Lokale Arbeitsfelder                                                                 RADDAT
     D baseStart       S             10I 0 inz                                                RADDAT
     D itemStart       S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         parsedUrl = i_parsedUrl;                                                           //RADDAT
                                                                                            //RADDAT
         // Get host name from URL                                                          //RADDAT
 B01     if (f_containsStringAt(parsedUrl.data
                                : parsedUrl.pos
                                : cSTART_OF_HOST));                                         //RADDAT
            baseStart = parsedUrl.pos;                                                      //RADDAT
            parsedUrl.pos = parsedUrl.pos + %len(cSTART_OF_HOST);                           //RADDAT
            itemStart = parsedUrl.pos;                                                      //RADDAT
 B02        dow (parsedUrl.pos <= %len(parsedUrl.data)) and
                (parsedUrl.host.start = 0);                                                 //RADDAT
 B03           select;                                                                      //RADDAT
               when f_containsStringAt(parsedUrl.data: parsedUrl.pos
                                                     : cSTART_OF_FILE);                     //RADDAT
                  parsedUrl.host.start  = itemStart;                                        //RADDAT
                  parsedUrl.host.length = parsedUrl.pos - itemStart;                        //RADDAT
                                                                                            //RADDAT
                  parsedUrl.host.baseStart   = baseStart;                                   //RADDAT
                  parsedUrl.host.totalLength = parsedUrl.pos - baseStart;                   //RADDAT
                                                                                            //RADDAT
               when f_containsStringAt(parsedUrl.data: parsedUrl.pos
                                                     : cSTART_OF_PORT);                     //RADDAT
                  parsedUrl.host.start  = itemStart;                                        //RADDAT
                  parsedUrl.host.length = parsedUrl.pos - itemStart;                        //RADDAT
                                                                                            //RADDAT
                  parsedUrl.host.baseStart   = baseStart;                                   //RADDAT
                  parsedUrl.host.totalLength = parsedUrl.pos - baseStart;                   //RADDAT
                                                                                            //RADDAT
 X03           other;                                                                       //RADDAT
                  parsedUrl.pos = parsedUrl.pos + 1;                                        //RADDAT
 E03           endsl;                                                                       //RADDAT
 E02        enddo;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get port number from URL                                                        //RADDAT
 B01     if (f_containsStringAt(parsedUrl.data: parsedUrl.pos: cSTART_OF_PORT));            //RADDAT
            baseStart = parsedUrl.pos;                                                      //RADDAT
            parsedUrl.pos = parsedUrl.pos + %len(cSTART_OF_PORT);                           //RADDAT
            itemStart = parsedUrl.pos;                                                      //RADDAT
 B02        dow (parsedUrl.pos <= %len(parsedUrl.data)) and
                (parsedUrl.port.start = 0);                                                 //RADDAT
 B03           select;                                                                      //RADDAT
               when parsedUrl.pos = %len(parsedUrl.data) or
                    f_containsStringAt(parsedUrl.data: parsedUrl.pos
                                                     : cSTART_OF_FILE);                     //RADDAT
 B04              if (parsedUrl.pos = %len(parsedUrl.data));                                //RADDAT
                     parsedUrl.pos = parsedUrl.pos + 1;                                     //RADDAT
 E04              endif;                                                                    //RADDAT
                                                                                            //RADDAT
                  parsedUrl.port.start  = itemStart;                                        //RADDAT
                  parsedUrl.port.length = parsedUrl.pos - itemStart;                        //RADDAT
                                                                                            //RADDAT
                  parsedUrl.port.baseStart   = baseStart;                                   //RADDAT
                  parsedUrl.port.totalLength = parsedUrl.pos - baseStart;                   //RADDAT
                                                                                            //RADDAT
               when f_containsInvalidCharAt(parsedUrl.data: parsedUrl.pos
                                                          : '0123456789');                  //RADDAT
                  // Stop parsing on invalid character                                      //RADDAT
                  o_rc = cURL_ERROR_INVALID_PORT_NUMBER;
                  return parsedUrl;                                                         //RADDAT
 X03           other;                                                                       //RADDAT
                  parsedUrl.pos = parsedUrl.pos + 1;                                        //RADDAT
 E03           endsl;                                                                       //RADDAT
 E02        enddo;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get file / path / query from URL                                                //RADDAT
         //    File  :  path + query                                                        //RADDAT
         //    Path  :  path of the file without trailing parameters (query)                //RADDAT
         //    Query :  parameters (query)                                                  //RADDAT
 B01     if (parsedUrl.pos <= %len(parsedUrl.data));                                        //RADDAT
                                                                                            //RADDAT
            // Info: File = Path + Query                                                    //RADDAT
            parsedUrl.file.start  = parsedUrl.pos;                                          //RADDAT
            parsedUrl.file.length = %len(parsedUrl.data) - parsedUrl.pos + 1;               //RADDAT
            parsedUrl.file.baseStart   = parsedUrl.file.start;                              //RADDAT
            parsedUrl.file.totalLength = parsedUrl.file.length;                             //RADDAT
                                                                                            //RADDAT
            parsedUrl.path = parsedUrl.file;                                                //RADDAT
                                                                                            //RADDAT
 B02        dow (parsedUrl.pos <= %len(parsedUrl.data));                                    //RADDAT
 B03           if (f_containsStringAt(parsedUrl.data: parsedUrl.pos
                                                    : cSTART_OF_QUERY));                    //RADDAT
                                                                                            //RADDAT
                  parsedUrl.path.length = parsedUrl.pos -
                                          parsedUrl.path.start;                             //RADDAT
                  parsedUrl.path.totalLength = parsedUrl.path.length;                       //RADDAT
                                                                                            //RADDAT
 B04              if (parsedUrl.pos < %len(parsedUrl.data));                                //RADDAT
                     parsedUrl.query.start  = parsedUrl.pos + 1;                            //RADDAT
                     parsedUrl.query.length = %len(parsedUrl.data) -
                                              parsedUrl.pos;                                //RADDAT
                     parsedUrl.query.baseStart   = parsedUrl.query.start - 1;               //RADDAT
                     parsedUrl.query.totalLength = parsedUrl.query.length + 1;              //RADDAT
 X04              else;                                                                     //RADDAT
                     parsedUrl.query.start  = 0;                                            //RADDAT
                     parsedUrl.query.length = 0;                                            //RADDAT
                     parsedUrl.query.baseStart   = 0;                                       //RADDAT
                     parsedUrl.query.totalLength = 0;                                       //RADDAT
 E04              endif;                                                                    //RADDAT
                                                                                            //RADDAT
                  leave;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
               parsedUrl.pos = parsedUrl.pos + 1;                                           //RADDAT
 E02        enddo;                                                                          //RADDAT
                                                                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         parsedUrl.type = cHANDLE_TYPE;                                                     //RADDAT
                                                                                            //RADDAT
         o_rc = 0;                                                                          //RADDAT
                                                                                            //RADDAT
         return parsedUrl;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P parseStandardUrl...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the sub-string defined by 'i_subString'.                                     RADDAT
      *=========================================================================              RADDAT
     P getSubstring...                                                                        RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D getSubstring...                                                                        RADDAT
     D                 PI           512A          varying                                     RADDAT
     D  i_string                    512A   const  varying                                     RADDAT
     D  i_subString                        const  likeds(substr_t )                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S            512A   varying inz                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_subString.start  > 0) and
            (i_subString.length > 0) and
            (%len(i_string) >= i_subString.start + i_subString.length - 1);                 //RADDAT
            string = %subst(i_string: i_subString.start: i_subString.length);               //RADDAT
 X01     else;                                                                              //RADDAT
            string = '';                                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P getSubstring...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Breaks a given URL into the pieces: library, file and member
      *=========================================================================              RADDAT
     P splittPath...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D splittPath...
     D                 PI              N   opdesc
     D  i_url                              const  likeds(parsedUrl_t )                        RADDAT
     D  i_dftObj                    256A   const  options(*varsize)                           RADDAT
     D  o_file                       10A
     D  o_lib                        10A
     D  o_obj                       256A          options(*varsize)                           RADDAT
     D  o_rc                         10I 0
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_dftObj        C                   const(2)                                           RADDAT
     D p_obj           C                   const(5)                                           RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D x               S             10I 0 inz                                                RADDAT
     D path            S                   like(url_t    ) inz                                RADDAT
     D closingChar     S              1A   inz                                                RADDAT
      *                                                                                       RADDAT
     D isError         S               N   inz(cFalse)
      *                                                                                       RADDAT
     D dftObj          S                   like(i_dftObj ) inz                                RADDAT
     D file            S                   like(o_file   ) inz                                RADDAT
     D lib             S                   like(o_lib    ) inz                                RADDAT
     D obj             S                   like(o_obj    ) inz                                RADDAT
      *                                                                                       RADDAT
     D dftObjInf       DS                  likeds(strInf_t) inz
     D objInf          DS                  likeds(strInf_t) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         CEEGSI(p_dftObj: dftObjInf.dataType
                        : dftObjInf.curlen
                        : dftObjInf.maxlen  : *omit);
                                                                                            //RADDAT
         CEEGSI(p_obj: objInf.dataType
                     : objInf.curlen
                     : objInf.maxlen  : *omit);
                                                                                            //RADDAT
 B01     if (dftObjInf.curlen > 0);
            dftObj = %subst(i_dftObj: 1: dftObjInf.curlen);
 X01     else;                                                                              //RADDAT
            dftObj = '';                                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         o_file = '';                                                                       //RADDAT
         o_lib  = '';                                                                       //RADDAT
         %subst(o_obj: 1 : objInf.curlen ) = '';
         o_rc   = 0;
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
                                                                                            //RADDAT
            path = f_ucase(%trim(Url_getPath(i_url: o_rc)));
 B02        if (o_rc <> 0);
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get library name from path                                                   //RADDAT
            x = %scan('/': path);                                                           //RADDAT
                                                                                            //RADDAT
 B02        select;                                                                         //RADDAT
            when x > 11;                                                                    //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
            when x > 1;                                                                     //RADDAT
               lib = %subst(path: 1: x-1);                                                  //RADDAT
 B03           if (x < %len(path));
                  path = %subst(path: x+1);                                                 //RADDAT
 X03           else;                                                                        //RADDAT
                  isError = cTrue;                                                          //RADDAT
                  leave;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
            when x = 1;                                                                     //RADDAT
               lib = '*LIBL';                                                               //RADDAT
               path = %subst(path: x+1);                                                    //RADDAT
 X02        other;                                                                          //RADDAT
               lib = '*LIBL';                                                               //RADDAT
 E02        endsl;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get file name from path                                                      //RADDAT
            x = %scan('(': path);                                                           //RADDAT
 B02        if (x > 0);
               closingChar = ')';                                                           //RADDAT
 X02        else;                                                                           //RADDAT
               x = %scan('.': path);                                                        //RADDAT
 B03           if (x > 0);
                  closingChar = '';                                                         //RADDAT
 X03           else;                                                                        //RADDAT
                  x = %len(path) + 1;                                                       //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        select;                                                                         //RADDAT
            when x > 11;                                                                    //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
            when x > 1;                                                                     //RADDAT
               file = %subst(path: 1: x-1);                                                 //RADDAT
 B03           if (x < %len(path));
                  path = %subst(path: x+1);                                                 //RADDAT
 X03           else;                                                                        //RADDAT
 B04              if (dftObj <> '');
                     obj = dftObj;                                                          //RADDAT
 X04              else;                                                                     //RADDAT
                     isError = cTrue;                                                       //RADDAT
 E04              endif;                                                                    //RADDAT
                  leave;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
            when x = 1;                                                                     //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
 E02        endsl;                                                                          //RADDAT
                                                                                            //RADDAT
            // Get member name from path                                                    //RADDAT
 B02        if (closingChar = '');
               x = %len(path) + 1;                                                          //RADDAT
 X02        else;                                                                           //RADDAT
               x = %scan(closingChar: path);                                                //RADDAT
 B03           if (x = 0);
                  isError = cTrue;                                                          //RADDAT
                  leave;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        select;                                                                         //RADDAT
            when x > 11;                                                                    //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
            when x > 1;                                                                     //RADDAT
               obj = %subst(path: 1: x-1);                                                  //RADDAT
 X02        other;                                                                          //RADDAT
               isError = cTrue;                                                             //RADDAT
               leave;                                                                       //RADDAT
 E02        endsl;                                                                          //RADDAT
                                                                                            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (isError);
            o_rc = cURL_ERROR_INVALID_OBJECT_DATA;
            return cFalse;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         o_file = file;                                                                     //RADDAT
         o_lib  = lib;                                                                      //RADDAT
         %subst(o_obj: 1 : objInf.curlen ) = obj;
                                                                                            //RADDAT
         return cTrue;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P splittPath...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RE  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RE "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Date and Time            "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      // -------------------------------------------------------------------
      //  BASICS1RC  - SrvPgm: Basic Routines - Date and Time
      // -------------------------------------------------------------------
      //  Author  :  Thomas Raddatz
      //  Date    :  19.02.2009
      //  E-mail  :  thomas.raddatz@Tools400.de
      //  Homepage:  www.tools400.de
      // -------------------------------------------------------------------
      //
      //  This software is free software, you can redistribute it and/or
      //  modify it under the terms of the GNU General Public License (GPL)
      //  as published by the Free Software Foundation.
      //
      //  See GNU General Public License for details.
      //          http://www.opensource.org
      //          http://www.opensource.org/licenses/gpl-license.html
      //
      // -------------------------------------------------------------------
      //  History:
      //
      //  Datum       Name          nderung
      //  ----------  ------------  ---------------------------------------
      //
      // -------------------------------------------------------------------
      //   >>PRE-COMPILER<<
      //
      //     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +
      //                              SRCFILE(&SL/&SF) +
      //                              SRCMBR(&SM);
      //
      //     >>COMPILE<<
      //       >>PARM<< TRUNCNBR(*NO);
      //       >>PARM<< DBGVIEW(*LIST);
      //       >>PARM<< TGTRLS(V6R1M0);
      //     >>END-COMPILE<<
      //
      //     >>EXECUTE<<
      //
      //   >>END-PRE-COMPILER<<
      // -------------------------------------------------------------------
     H NOMAIN
      *  Standard H-Specs
      /COPY QBASICS1,H_SPEC
      /COPY QBASICS1,COPYRIGHT
      *=====================================================================*

      // -----------------------------------------
      //  Exported functions
      // -----------------------------------------
      /COPY QBASICS1,PBASICS1RE

      // -----------------------------------------
      //  Reference fields
      // -----------------------------------------
      /COPY QBASICS1,BASICS1R0

      // -----------------------------------------
      //  Imported Prototypes
      // -----------------------------------------
      /COPY QBASICS1,QWCCVTDT                      Convert Date and Time Format (QWCCVTDT) API
      /COPY QBASICS1,PBASICS1R2                    API Error Handling

      // -----------------------------------------
      //  Private prototypes
      // -----------------------------------------

      // -----------------------------------------
      //  Global constants
      // -----------------------------------------

     D EPOCHSTART      s               z   inz(z'1970-01-01-00.00.00.000000')

      // -----------------------------------------
      //  Global fields
      // -----------------------------------------

      // -----------------------------------------------------------------------
      //  Produces a date from a given year, month and day.
      // -----------------------------------------------------------------------
      //  Parameters:
      //   i_year        - Year of the date. Range: 1-9999
      //   i_month       - Day of the date. Any numeric value.
      //   i_day         - Day of the date. Any numeric value.
      //
      //  Returns:
      //   date          - Date.
      // -----------------------------------------------------------------------
     P f_dateSerial...
     P                 b                   export
     D                 pi              D
     D  i_year                       10I 0 const
     D  i_month                      10I 0 const
     D  i_day                        10I 0 const

      //  Return value
     D date            s               D   inz

      //  Helper fields
     D tmpDate         s             10A   inz
      /free

         tmpDate = %editc(%dec(i_year: 4: 0): 'X') + '-' + '01' + '-' + '01';
         date = %date(tmpDate: *ISO);
         date = date + %months(i_month-1);
         date = date + %days(i_day-1);

         return date;

      /end-free
     P                 e

      // -----------------------------------------------------------------------
      //  Converts an epoch date to a RPG timestamp.
      // -----------------------------------------------------------------------
      //  Parameters:
      //
      //   i_epochSecs   - The UNIX timestamp, in UNIX epoch format (number of
      //                   seconds since midnight, Jan 1, 1970).
      //   i_adjustUTC   - Determine whether the time should be adjusted by the
      //                   UTC offset.
      //                   true  - adjust for UTC offset
      //                   false - do not adjust for UTC offset
      //
      //  Returns:
      //   timestamp     - RPG timestamp value
      // -----------------------------------------------------------------------
     P f_cvtEpochTS...
     P                 b                   export
     D                 pi              z
     D  i_epochSecs                  10i 0 const
     D  i_adjustUTC                    n   const options(*nopass: *omit)

      // Return value
     D timestamp       s               z   inz

      // Parameter position
     D p_adjustUTC     c                   2

      // Optional parameters
     D adjustUTC       s                   like(i_adjustUTC)

      // Variables.
     D utc             ds                  likeds(cee_utco_t) inz
      /free

         if (%parms() >= p_adjustUTC and %addr(i_adjustUTC) <> *null);
            adjustUTC = i_adjustUTC;
         else;
            adjustUTC = cTrue;
         endif;

         timestamp = EPOCHSTART + %seconds(i_epochSecs);
         if (adjustUTC);
              CEEUTCO(utc.offHours: utc.offMins: utc.offSecs);
              timestamp = timestamp + %seconds(%int(utc.offSecs));
         endif;

         return timestamp;

      /end-free
     p                 e

      // -----------------------------------------------------------------------
      //  Converts a RPG timestamp to an epoch value.
      // -----------------------------------------------------------------------
      //  Parameters:
      //
      //   i_timestamp   - The OS/400 timestamp value.
      //   i_adjustUTC   - Determine whether the time should be adjusted by the
      //                   UTC offset.
      //                   true  - adjust for UTC offset
      //                   false - do not adjust for UTC offset
      //
      //  Returns:
      //   epoch         - Epoch value
      // -----------------------------------------------------------------------
     P f_cvtTSEpoch...
     P                 b                   export
     D                 pi            10i 0
     D  i_timestamp                    z   const
     D  i_adjustUTC                    n   const options(*nopass: *omit)

      // Return value
     D epochSecs       s             10i 0 inz

      // Parameter position
     D p_adjustUTC     c                   2

      // Optional parameters
     D adjustUTC       s                   like(i_adjustUTC)

      // Constants.
     D PIC_TIMESTAMP   c                   'YYYY-MM-DD-HH.MI.SS.999999'

      // Variables.
     D utc             ds                  likeds(cee_utco_t) inz
     D tsSecs          s              8f   inz
     D epochStartSecs  s              8f   inz
      /free

         if (%parms() >= p_adjustUTC and %addr(i_adjustUTC) <> *null);
            adjustUTC = i_adjustUTC;
         else;
            adjustUTC = cTrue;
         endif;

         CEESECS(%char(i_timestamp): PIC_TIMESTAMP: tsSecs: *omit);
         CEESECS(%char(EPOCHSTART): PIC_TIMESTAMP: epochStartSecs: *omit);

         epochSecs = tsSecs - epochStartSecs;
         if (adjustUTC);
              CEEUTCO(utc.offHours: utc.offMins: utc.offSecs);
              epochSecs = epochSecs - %int(utc.offSecs);
         endif;

         return epochSecs;

      /end-free
     p                 e

      // -----------------------------------------------------------------------
      //  Converts a MI time value to a RPG timestamp.
      // -----------------------------------------------------------------------
      //  Parameters:
      //
      //   i_miTime      - MI time value.
      //   i_adjustUTC   - Determine whether the time should be adjusted by the
      //                   UTC offset.
      //                   true  - adjust for UTC offset
      //                   false - do not adjust for UTC offset
      //
      //  Returns:
      //   timestamp     - RPG timestamp value
      // -----------------------------------------------------------------------
     P f_cvtMiTimeTS...
     P                 b                   export
     D                 pi              z
     D  i_miTime                     20a   const
     D  i_adjustUTC                    n   const options(*nopass: *omit)

      // Return value
     D timestamp       s               z   inz

      // Parameter position
     D p_adjustUTC     c                   2

      // Optional parameters
     D adjustUTC       s                   like(i_adjustUTC)

      // Variables
     D tmpDate         ds                  qualified
     D  date                   1      8a   inz('00010101')
     D  time                   9     14a   inz('000000')
     D  mSecs                 15     20a   inz('000000')
     D utc             ds                  likeds(cee_utco_t) inz
     D timeZone        s            116a
     D errCode         ds                  likeds(errCode_t) inz
      /free

         if (%parms() >= p_adjustUTC and %addr(i_adjustUTC) <> *null);
            adjustUTC = i_adjustUTC;
         else;
            adjustUTC = cTrue;
         endif;

         errCode = f_newApiErrCode(cFalse);
         QWCCVTDT('*DTS' : i_miTime : '*YYMD' : tmpDate: errCode
                  : '*JOB': '*JOB': timeZone: %len(timeZone): '1');

         timestamp = %date(tmpDate.date: *ISO0) +
                     %time(tmpDate.time: *ISO0);
         timestamp += %mseconds(%int(tmpDate.mSecs));

         if (not adjustUTC);
              CEEUTCO(utc.offHours: utc.offMins: utc.offSecs);
              timestamp = timestamp - %seconds(%int(utc.offSecs));
         endif;

         return timestamp;

      /end-free
     p                 e

      // -----------------------------------------------------------------------
      //  Converts a RPG timestamp to an epoch value.
      // -----------------------------------------------------------------------
      //  Parameters:
      //
      //   i_timestamp   - The OS/400 timestamp value.
      //   i_adjustUTC   - Determine whether the time should be adjusted by the
      //                   UTC offset.
      //                   true  - adjust for UTC offset
      //                   false - do not adjust for UTC offset
      //
      //  Returns:
      //   epoch         - Epoch value
      // -----------------------------------------------------------------------
     P f_cvtTSMiTime...
     P                 b                   export
     D                 pi            20a
     D  i_timestamp                    z   const
     D  i_adjustUTC                    n   const options(*nopass: *omit)

      // Return value
     D miTime          s             20a   inz(*ALLx'00')

      // Parameter position
     D p_adjustUTC     c                   2

      // Optional parameters
     D adjustUTC       s                   like(i_adjustUTC)

      // Variables
     D timestamp       s                   like(i_timestamp)
     D tmpDate         ds                  qualified
     D  date                   1      8a   inz('00010101')
     D  time                   9     14a   inz('000000')
     D  mSecs                 15     20a   inz('000000')
     D utc             ds                  likeds(cee_utco_t) inz
     D timeZone        s            116a
     D errCode         ds                  likeds(errCode_t) inz
      /free

         if (%parms() >= p_adjustUTC and %addr(i_adjustUTC) <> *null);
            adjustUTC = i_adjustUTC;
         else;
            adjustUTC = cTrue;
         endif;

         timestamp = i_timestamp;

         if (not adjustUTC);
              CEEUTCO(utc.offHours: utc.offMins: utc.offSecs);
              timestamp = timestamp + %seconds(%int(utc.offSecs));
         endif;

         errCode = f_newApiErrCode(cFalse);
         QWCCVTDT('*YYMD' : %char(timestamp: *ISO0) : '*DTS' : miTime: errCode
                  : '*JOB': '*JOB': timeZone: %len(timeZone): '1');

         return miTime;

      /end-free
     p                 e
      *
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RF  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RF "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - System Values            "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RF  - SrvPgm: Basic Routines - System Values                *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  11.04.2010                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RF                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported Prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R1                                                               RADDAT
 CPY  /COPY QBASICS1,QWCRSVAL                      Retrieve System Values (QWCRSVAL) API      RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves an alpha-numeric system value.                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_name        - System value name.                                                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   value         - The value of the specified system value.                            RADDAT
      *=========================================================================              RADDAT
     P f_rtvSysVal_char...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvSysVal_char...                                                                    RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_name                       10A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t )                              RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D value           S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msg           C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
     D sysVal          DS                  likeds(QWCRSVAL_rtnValue_t    ) inz                RADDAT
     D sysValTbl       DS                  likeds(QWCRSVAL_sysValInfTbl_t)                    RADDAT
     D                                     based(pSysValTbl)                                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_OK);                                                        //RADDAT
                                                                                            //RADDAT
         // Check system value name                                                         //RADDAT
         p_assert(i_name   = 'QABNORMSW'    or   //  Character    1
                  i_name   = 'QACGLVL'      or   //  Character    80
                  i_name   = 'QALWOBJRST'   or   //  Character    150
                  i_name   = 'QALWUSRDMN'   or   //  Character    500
                  i_name   = 'QASTLVL'      or   //  Character    10
                  i_name   = 'QATNPGM'      or   //  Character    20
                  i_name   = 'QAUDCTL'      or   //  Character    50
                  i_name   = 'QAUDENDACN'   or   //  Character    10
                  i_name   = 'QAUDLVL'      or   //  Character    160
                  i_name   = 'QAUTOCFG'     or   //  Character    1
                  i_name   = 'QAUTORMT'     or   //  Character    1
                  i_name   = 'QAUTOSPRPT'   or   //  Character    1
                  i_name   = 'QCENTURY'     or   //  Character    1
                  i_name   = 'QCFGMSGQ'     or   //  Character    20
                  i_name   = 'QCHRID'       or   //  Character    20
                  i_name   = 'QCHRIDCTL'    or   //  Character    10
                  i_name   = 'QCMNARB'      or   //  Character    10
                  i_name   = 'QCMNRCYLMT'   or   //  Character    20
                  i_name   = 'QCNTRYID'     or   //  Character    2
                  i_name   = 'QCONSOLE'     or   //  Character    10
                  i_name   = 'QCRTAUT'      or   //  Character    10
                  i_name   = 'QCRTOBJAUD'   or   //  Character    10
                  i_name   = 'QCTLSBSD'     or   //  Character    20
                  i_name   = 'QCURSYM'      or   //  Character    1
                  i_name   = 'QDATE'        or   //  Character    5 (for Julian dates) or 6
                  i_name   = 'QDATFMT'      or   //  Character    3
                  i_name   = 'QDATSEP'      or   //  Character    1
                  i_name   = 'QDAY'         or   //  Character    2 or 3 (for Julian dates)
                  i_name   = 'QDAYOFWEEK'   or   //  Character    4
                  i_name   = 'QDBFSTCCOL'   or   //  Character    10
                  i_name   = 'QDBRCVYWT'    or   //  Character    1
                  i_name   = 'QDECFMT'      or   //  Character    1
                  i_name   = 'QDEVNAMING'   or   //  Character    10
                  i_name   = 'QDEVRCYACN'   or   //  Character    20
                  i_name   = 'QDSCJOBITV'   or   //  Character    10
                  i_name   = 'QDSPSGNINF'   or   //  Character    1
                  i_name   = 'QDYNPTYADJ'   or   //  Character    1
                  i_name   = 'QDYNPTYSCD'   or   //  Character    1
                  i_name   = 'QFRCCVNRST'   or   //  Character    1
                  i_name   = 'QHOUR'        or   //  Character    2
                  i_name   = 'QIGC'         or   //  Character    1
                  i_name   = 'QIGCCDEFNT'   or   //  Character    20
                  i_name   = 'QINACTITV'    or   //  Character    10
                  i_name   = 'QINACTMSGQ'   or   //  Character    20
                  i_name   = 'QIPLDATTIM'   or   //  Character    20
                  i_name   = 'QIPLSTS'      or   //  Character    1
                  i_name   = 'QIPLTYPE'     or   //  Character    1
                  i_name   = 'QJOBMSGQFL'   or   //  Character    10
                  i_name   = 'QKBDBUF'      or   //  Character    10
                  i_name   = 'QKBDTYPE'     or   //  Character    3
                  i_name   = 'QLANGID'      or   //  Character    3
                  i_name   = 'QLIBLCKLVL'   or   //  Character    1
                  i_name   = 'QLMTDEVSSN'   or   //  Character    1
                  i_name   = 'QLMTSECOFR'   or   //  Character    1
                  i_name   = 'QLOCALE'      or   //  Character    1024
                  i_name   = 'QMAXSGNACN'   or   //  Character    1
                  i_name   = 'QMAXSIGN'     or   //  Character    6
                  i_name   = 'QMINUTE'      or   //  Character    2
                  i_name   = 'QMLTTHDACN'   or   //  Character    1
                  i_name   = 'QMODEL'       or   //  Character    4
                  i_name   = 'QMONTH'       or   //  Character    2
                  i_name   = 'QPASTHRSVR'   or   //  Character    10
                  i_name   = 'QPFRADJ'      or   //  Character    1
                  i_name   = 'QPRBFTR'      or   //  Character    20
                  i_name   = 'QPRCFEAT'     or   //  Character    4
                  i_name   = 'QPRCMLTTSK'   or   //  Character    1
                  i_name   = 'QPRTDEV'      or   //  Character    10
                  i_name   = 'QPRTKEYFMT'   or   //  Character    10
                  i_name   = 'QPRTTXT'      or   //  Character    30
                  i_name   = 'QPWDEXPITV'   or   //  Character    6
                  i_name   = 'QPWDLMTAJC'   or   //  Character    1
                  i_name   = 'QPWDLMTCHR'   or   //  Character    10
                  i_name   = 'QPWDLMTREP'   or   //  Character    1
                  i_name   = 'QPWDPOSDIF'   or   //  Character    1
                  i_name   = 'QPWDRQDDGT'   or   //  Character    1
                  i_name   = 'QPWDRQDDIF'   or   //  Character    1
                  i_name   = 'QPWDVLDPGM'   or   //  Character    20
                  i_name   = 'QPWRRSTIPL'   or   //  Character    1
                  i_name   = 'QQRYDEGREE'   or   //  Character    10
                  i_name   = 'QQRYTIMLMT'   or   //  Character    10
                  i_name   = 'QRCLSPLSTG'   or   //  Character    10
                  i_name   = 'QRETSVRSEC'   or   //  Character    1
                  i_name   = 'QRMTIPL'      or   //  Character    1
                  i_name   = 'QRMTSRVATR'   or   //  Character    1
                  i_name   = 'QRMTSIGN'     or   //  Character    20
                  i_name   = 'QSCPFCONS'    or   //  Character    1
                  i_name   = 'QSECOND'      or   //  Character    2
                  i_name   = 'QSECURITY'    or   //  Character    2
                  i_name   = 'QSETJOBATR'   or   //  Character    160
                  i_name   = 'QSFWERRLOG'   or   //  Character    10
                  i_name   = 'QSHRMEMCTL'   or   //  Character    1
                  i_name   = 'QSPCENV'      or   //  Character    10
                  i_name   = 'QSPLFACN'     or   //  Character    10
                  i_name   = 'QSRLNBR'      or   //  Character    8
                  i_name   = 'QSRTSEQ'      or   //  Character    20
                  i_name   = 'QSRVDMP'      or   //  Character    10
                  i_name   = 'QSTGLOWACN'   or   //  Character    10
                  i_name   = 'QSTRPRTWTR'   or   //  Character    1
                  i_name   = 'QSTRUPPGM'    or   //  Character    20
                  i_name   = 'QSTSMSG'      or   //  Character    10
                  i_name   = 'QSYSLIBL'     or   //  Character    150
                  i_name   = 'QTIME'        or   //  Character    7, 8, or 9
                  i_name   = 'QTIMSEP'      or   //  Character    1
                  i_name   = 'QTSEPOOL'     or   //  Character    10
                  i_name   = 'QUPSDLYTIM'   or   //  Character    20
                  i_name   = 'QUPSMSGQ'     or   //  Character    20
                  i_name   = 'QUSEADPAUT'   or   //  Character    10
                  i_name   = 'QUSRLIBL'     or   //  Character    2750
                  i_name   = 'QUTCOFFSET'   or   //  Character    5
                  i_name   = 'QVFYOBJRST'   or   //  Character    1
                  i_name   = 'QYEAR'        :    //  Character    2                         //RADDAT
                  'Invalid system value name specified: ' + i_name);                        //RADDAT
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
                                                                                            //RADDAT
            errCode = f_newApiErrCode(cTrue);                                               //RADDAT
            QWCRSVAL(sysVal: %size(sysVal): 1: i_name: errCode);                            //RADDAT
                                                                                            //RADDAT
 B02        if (f_isApiError(errCode));                                                     //RADDAT
               msg = f_cvtApiErrCodeToMsg(errCode);                                         //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            pSysValTbl = %addr(sysVal) + sysVal.ofsSysValTbl(1);                            //RADDAT
                                                                                            //RADDAT
            p_assert(sysValTbl.length <= %len(sysValTbl.data):
                     'Value ' + %char(sysValTbl.length) +
                     ' exceeds maximum length of ' + %char(%size(value)-2));                //RADDAT
                                                                                            //RADDAT
            value = %subst(sysValTbl.data: 1: sysValTbl.length);                            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set optional/omissible message parameter                                        //RADDAT
 B01     if (%parms() >= p_msg);                                                            //RADDAT
 B02        if (%addr(o_msg) <> *NULL);                                                     //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return value;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvSysVal_char...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves a numeric system value.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_name        - System value name.                                                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   value         - The value of the specified system value.                            RADDAT
      *=========================================================================              RADDAT
     P f_rtvSysVal_num...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvSysVal_num...                                                                     RADDAT
     D                 PI            15P 5                                                    RADDAT
     D  i_name                       10A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t )                              RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D value           S             15P 5 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msg           C                   2                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
     D sysVal          DS                  likeds(QWCRSVAL_rtnValue_t    ) inz                RADDAT
     D sysValTbl       DS                  likeds(QWCRSVAL_sysValInfTbl_t)                    RADDAT
     D                                     based(pSysValTbl)                                  RADDAT
     D fraction        S             10I 0 inz                                                RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D binary4         S             10I 0 based(pBinary4)                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_OK);                                                        //RADDAT
                                                                                            //RADDAT
         // Check system value name                                                         //RADDAT
         p_assert(i_name   = 'QACTJOB'      or   //  Decimal      (5 0)
                  i_name   = 'QADLACTJ'     or   //  Decimal      (5 0)
                  i_name   = 'QADLSPLA'     or   //  Decimal      (5 0)
                  i_name   = 'QADLTOTJ'     or   //  Decimal      (5 0)
                  i_name   = 'QAUDFRCLVL'   or   //  Decimal      (5 0)
                  i_name   = 'QAUTOVRT'     or   //  Decimal      (5 0)
                  i_name   = 'QBASACTLVL'   or   //  Zoned        (5 0)
                  i_name   = 'QBASPOOL'     or   //  Zoned        (10 0)
                  i_name   = 'QCCSID'       or   //  Decimal      (5 0)
                  i_name   = 'QHSTLOGSIZ'   or   //  Decimal      (5 0)
                  i_name   = 'QIGCFNTSIZ'   or   //  Decimal      (4 1)
                  i_name   = 'QJOBMSGQMX'   or   //  Decimal      (5 0)
                  i_name   = 'QJOBMSGQSZ'   or   //  Decimal      (5 0)
                  i_name   = 'QJOBMSGQTL'   or   //  Decimal      (5 0)
                  i_name   = 'QJOBSPLA'     or   //  Decimal      (5 0)
                  i_name   = 'QLEAPADJ'     or   //  Decimal      (5 0)
                  i_name   = 'QMAXACTLVL'   or   //  Decimal      (5 0)
                  i_name   = 'QMAXJOB'      or   //  Zoned        (10 0)
                  i_name   = 'QMAXSPLF'     or   //  Zoned        (10 0)
                  i_name   = 'QMCHPOOL'     or   //  Zoned        (10 0)
                  i_name   = 'QPRBHLDITV'   or   //  Decimal      (5 0)
                  i_name   = 'QPWDLVL'      or   //  Decimal      (5 0)
                  i_name   = 'QPWDMAXLEN'   or   //  Decimal      (5 0)
                  i_name   = 'QPWDMINLEN'   or   //  Decimal      (5 0)
                  i_name   = 'QPWRDWNLMT'   or   //  Decimal      (5 0)
                  i_name   = 'QSTGLOWLMT'   or   //  Decimal      (7 4)
                  i_name   = 'QSVRAUTITV'   or   //  Decimal      (6 0)
                  i_name   = 'QTOTJOB'      :    //  Decimal      (5 0)
                  'Invalid system value name specified: ' + i_name);                        //RADDAT
                                                                                            //RADDAT
 B01     dou '1';                                                                           //RADDAT
                                                                                            //RADDAT
            errCode = f_newApiErrCode(cTrue);                                               //RADDAT
            QWCRSVAL(sysVal: %size(sysVal): 1: i_name: errCode);                            //RADDAT
                                                                                            //RADDAT
 B02        if (f_isApiError(errCode));                                                     //RADDAT
               msg = f_cvtApiErrCodeToMsg(errCode);                                         //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            pSysValTbl = %addr(sysVal) + sysVal.ofsSysValTbl(1);                            //RADDAT
                                                                                            //RADDAT
            p_assert(sysValTbl.length = 4
                     : 'Size of system value ' + i_name +
                       ' does not match expected integer size of 4');                       //RADDAT
                                                                                            //RADDAT
 B02        select;                                                                         //RADDAT
            when (sysValTbl.sysVal = 'QIGCFNTSIZ');   //  Decimal      (4 1)                //RADDAT
               fraction = 1;                                                                //RADDAT
            when (sysValTbl.sysVal = 'QSTGLOWLMT');   //  Decimal      (7 4)                //RADDAT
               fraction = 4;                                                                //RADDAT
 X02        other;                                                                          //RADDAT
               fraction = 0;                                                                //RADDAT
 E02        endsl;                                                                          //RADDAT
                                                                                            //RADDAT
            pBinary4 = %addr(sysValTbl.data);                                               //RADDAT
            value = binary4;                                                                //RADDAT
 B02        for x = 1 to fraction;                                                          //RADDAT
               value = value / 10;                                                          //RADDAT
 E02        endfor;                                                                         //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set optional/omissible message parameter                                        //RADDAT
 B01     if (%parms() >= p_msg);                                                            //RADDAT
 B02        if (%addr(o_msg) <> *NULL);                                                     //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return value;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvSysVal_num...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RG  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RG "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicProperties          "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RG  - SrvPgm: Basic Routines - BasicProperties              *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  06.05.2011                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs w/o DECEDIT(...)                                                    RADDAT
      /DEFINE NO_DECEDIT                                                                      RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
     H DECEDIT('0.')                                                                          RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
     FPROPERTIESIF   F  512        DISK    usropn
     F                                     extfile(g_properties.file)
     F                                     extmbr(g_properties.name)
     F                                     infds(g_propsOpnInf)
      *
     D g_properties    DS                  qualified
     D  file                         21A   inz
     D  name                         10A   inz
      *
     D g_propsOpnInf   DS                  qualified
     D  rcdLength            125    126I 0
     D  sourceFile           163    163A
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RG                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
     D hProperties_t   DS                  qualified   based(pDummy)   align                  RADDAT
     D  intType                      20U 0                                                    RADDAT
     D  intSize                      10U 0                                                    RADDAT
     D  pMap                               like(BasicMap_handle_t)                            RADDAT
     D  increment                    10I 0                                                    RADDAT
     D  heapID                       10I 0                                                    RADDAT
     D  memMgr                             likeds(MemoryManager_manager_t)                    RADDAT
      *                                                                                       RADDAT
     D readLine_line_t...
     D                 S           1024A   varying     based(pDummy)
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported Prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,CLIB                          C-Prototypes                               RADDAT
 CPY  /COPY QBASICS1,PBASICS1RC                    BasicMap                                   RADDAT
      *                                                                                       RADDAT
     D property_t      DS                  qualified               based(pDummy)              RADDAT
     D  key                         512A   varying                                            RADDAT
     D  value                       512A   varying                                            RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *
      *  Reads a line from a given file descriptor.
     D readLine...
     D                 PR            10I 0        extproc('readLine')
     D  i_fd                         10I 0 const
     D  io_line                                   like(readLine_line_t)
     D  i_isFirstLine                  N   const
      *
      *  Test the specified buffer, splitts the buffer and adds the property
      *  to the property list.
     D retrieveAndAddPropertyToMap...                                                         RADDAT
     D                 PR
     D                                            extproc('+                                  RADDAT
     D                                            retrieveAndAddPropertyToMap')               RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t    )
     D  i_buffer                   4096A   const  varying  options(*varsize)                  RADDAT
      *                                                                                       RADDAT
      *  Adds the specified key and value to the map.                                         RADDAT
     D addPropertyToMap...                                                                    RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('+                                  RADDAT
     D                                            addPropertyToMap')                          RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_property                         const  likeds(property_t      )                    RADDAT
      *                                                                                       RADDAT
      *  Returns the value that is associated to a given key                                  RADDAT
      *  from the specified map.                                                              RADDAT
     D getStringFromMap...                                                                    RADDAT
     D                 PR              N                                                      RADDAT
     D                                            extproc('+                                  RADDAT
     D                                            getStringFromMap')                          RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D  o_string                                  like(property_t.value  )
      *                                                                                       RADDAT
      *  Checks, whether a given handle is a valid properties handle, or not.                 RADDAT
     D checkPropertiesHandle...                                                               RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('+                                  RADDAT
     D                                            checkPropertiesHandle')                     RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Sends an ESCAPE message to signal an error condition.                                RADDAT
     D signalError...                                                                         RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('signalError')                      RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Send message to the job log.
     D sendToJobLog...                                                                        RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('sendToJobLog')                     RADDAT
     D  i_text                      512A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
     D cHANDLE_TYPE_PROPERTIES...                                                             RADDAT
     D                 C                   const(6689984643550298433)           =  *Props     RADDAT
     D cHANDLE_PROPERTIES_SIZE...                                                             RADDAT
     D                 C                   const(%size(hProperties_t))                        RADDAT
      *                                                                                       RADDAT
     D cERROR_PROPERTIES_HANDLE_NULL...                                                       RADDAT
     D                 C                   const('Properties handle is NULL')                 RADDAT
     D cERROR_PROPERTIES_HANDLE_INVALID...                                                    RADDAT
     D                 C                   const('Properties handle is invalid')              RADDAT
      *                                                                                       RADDAT
     D BOOLEAN_FALSE...                                                                       RADDAT
     D                 C                   'false'                                            RADDAT
     D BOOLEAN_TRUE...                                                                        RADDAT
     D                 C                   'true'                                             RADDAT
     D BOOLEAN_0...                                                                           RADDAT
     D                 C                   '0'                                                RADDAT
     D BOOLEAN_1...                                                                           RADDAT
     D                 C                   '1'                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new BasicProperties.                                                       RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_heapID       - ID of the heap that is used to allocate memory.                    RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pProperties    - Returns the basing pointer of the properties on                    RADDAT
      *                    success, else NULL.                                                RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_new...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_new...                                                                 RADDAT
     D                 PI                         like(BasicProperties_handle_t)              RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pProperties     S                   like(BasicProperties_handle_t) inz                 RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_increment     C                   const(1)                                           RADDAT
     D p_heapID        C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D increment       S                   like(i_increment ) inz                             RADDAT
     D heapID          S                   like(i_heapID    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(pProperties )                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... i_increment                                                                 //RADDAT
 B01     if (%parms() >= p_increment and %addr(i_increment) <> *NULL);                      //RADDAT
            increment = i_increment;                                                        //RADDAT
 X01     else;                                                                              //RADDAT
            increment = 512;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_heapID                                                                    //RADDAT
 B01     if (%parms() >= p_heapID and %addr(i_heapID) <> *NULL);                            //RADDAT
            heapID = i_heapID;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            heapID = 0;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set memory manager                                                              //RADDAT
         mm_memMgr = MemoryManager_getDefaultManager();                                     //RADDAT
                                                                                            //RADDAT
         // Allocate memory for properties handle                                           //RADDAT
         pProperties = mm_allocate(%size(hProperties_t): heapID);                           //RADDAT
                                                                                            //RADDAT
         // Initialize properties handle                                                    //RADDAT
         clear hProperties;                                                                 //RADDAT
         hProperties.intType   = cHANDLE_TYPE_PROPERTIES;                                   //RADDAT
         hProperties.intSize   = %size(hProperties);                                        //RADDAT
         hProperties.pMap      = BasicMap_new(increment: heapID);                           //RADDAT
         hProperties.increment = increment;                                                 //RADDAT
         hProperties.heapID    = heapID;                                                    //RADDAT
         hProperties.memMgr    = mm_memMgr;                                                 //RADDAT
                                                                                            //RADDAT
         return pProperties;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_new...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Clones a given BasicProperties.                                                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned by                    RADDAT
      *                    BasicProperties_new().                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pProperties   - Returns the basing pointer of the properies on                      RADDAT
      *                   success, else NULL.                                                 RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_clone...                                                               RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_clone...                                                               RADDAT
     D                 PI                         like(BasicProperties_handle_t)              RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pPropertiesRtn  S                   like(BasicProperties_handle_t) inz                 RADDAT
     D hPropertiesRtn  DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(pPropertiesRtn)                              RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D numE            S             10I 0 inz                                                RADDAT
     D key             S                   like(BasicMap_key_t ) inz                          RADDAT
     D size            S             10I 0 inz                                                RADDAT
     D pData           S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         // Create a new and empty properties                                               //RADDAT
         pPropertiesRtn = BasicProperties_new(hProperties.increment);                       //RADDAT
                                                                                            //RADDAT
         // Copy properties entries of embedded map                                         //RADDAT
         numE = BasicMap_getNumE(hProperties.pMap);                                         //RADDAT
 B01     for x = 1 to numE;                                                                 //RADDAT
            key   = BasicMap_getKeyByIndex(hProperties.pMap: x);                            //RADDAT
            pData = BasicMap_getValueByIndex(hProperties.pMap: x);                          //RADDAT
            size  = BasicMap_getSizeByIndex(hProperties.pMap: x);                           //RADDAT
            BasicMap_put(hPropertiesRtn.pMap: key: pData: size);                            //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         return pPropertiesRtn;                                                             //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_clone...                                                               RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Load properties from a given physical file member.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned                       RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_file         - File that contains the member that contains the                    RADDAT
      *                    properties.                                                        RADDAT
      *   i_lib          - (optional) Library that contains the file.                         RADDAT
      *   i_mbr          - (optional) Member that contains the properties.                    RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P BasicProperties_loadFromMember...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_loadFromMember...                                                      RADDAT
     D                 PI            10I 0
     D  i_pProperties                      const  like(BasicProperties_handle_t)
     D  i_file                       10A   const  varying
     D  i_lib                        10A   const  varying
     D                                            options(*nopass: *omit)
     D  i_mbr                        10A   const  varying
     D                                            options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(3)                                           RADDAT
     D p_mbr           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D lib             S                   like(i_lib ) inz
     D mbr             S                   like(i_mbr ) inz
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D length          S             10I 0 inz
     D warnLength      S               N   inz(cTrue)
      *                                                                                       RADDAT
     D inBufMbr        DS                  qualified
     D  data                        512A
      *
     D inBufSrcMbr     DS                  qualified
     D  srcSeq                        6S 2
     D  srcDat                        6S 0
     D  srcDta                      500A
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... i_lib                                                                       //RADDAT
 B01     if (%parms() >= p_lib and %addr(i_lib) <> *NULL);
            lib = i_lib;
 X01     else;                                                                              //RADDAT
            lib = '*LIBL';
 E01     endif;                                                                             //RADDAT

         // ... i_mbr                                                                       //RADDAT
 B01     if (%parms() >= p_mbr and %addr(i_mbr) <> *NULL);
            mbr = i_mbr;
 X01     else;                                                                              //RADDAT
            mbr = '*FIRST';
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check library
 B01     if (not f_startsWith('*': lib));
 B02        if not f_exist(lib: *omit: '*LIB');
               sendToJobLog('Library ' + %trim(lib) + ' not found');
               return rc;
 E02        endif;
 E01     endif;
                                                                                            //RADDAT
         // Check file
 B01     if (not f_exist(i_file: lib: '*FILE'));
               sendToJobLog('File ' + %trim(i_file) +
                            ' in library ' + %trim(lib) + ' not found');
            return rc;
 E01     endif;
                                                                                            //RADDAT
         // Check member
 B01     if not f_exist(i_file: lib: '*FILE': mbr);
               sendToJobLog('Member ' + %trim(mbr) +
                            ' of file ' + %trim(i_file) +
                            ' in library ' + %trim(lib) + ' not found');
            return rc;
 E01     endif;
                                                                                            //RADDAT
         // Open member
         g_properties.file = %trim(lib) + '/' + %trim(i_file);
         g_properties.name = mbr;

         open(E) PROPERTIES;
 B01     if (%error());
            sendToJobLog('Could not open member ' + %trim(mbr) +
                         ' of file ' + %trim(i_file) +
                         ' in library ' + %trim(lib));
            return rc;
 E01     endif;

         p_rmvPgmMsg(cMsg_Rmv_All: *omit: cMsg_Same: cMsg_ToMyself);
                                                                                            //RADDAT
         // Load properties from member
         setll 1 PROPERTIES;
 B01     dow %found(PROPERTIES);
 B02        if (g_propsOpnInf.sourceFile = 'Y');
               read PROPERTIES inBufSrcMbr;
 X02        else;
               read PROPERTIES inBufMbr;
 E02        endif;

 B02        if %eof(PROPERTIES);
               leave;
 E02        endif;

 B02        if (g_propsOpnInf.sourceFile = 'Y');
               length = g_propsOpnInf.rcdLength - (%size(inBufSrcMbr.SrcSeq) +
                                                   %size(inBufSrcMbr.SrcDat));
               retrieveAndAddPropertyToMap(
                     hProperties.pMap: %subst(inBufSrcMbr.srcDta: 1: length));
 X02        else;
 B03           if (g_propsOpnInf.rcdLength > %len(inBufMbr.data));
                  length = %len(inBufMbr.data);
 B04              if (not warnLength);
                     sendToJobLog('Record length of properties file +
                                   exceeded maximum of ' +
                                   %char(%len(inBufMbr.data)) + ' byte.');
                     warnLength = cTrue;
 E04              endif;
 X03           else;
                  length = g_propsOpnInf.rcdLength;
 E03           endif;
               retrieveAndAddPropertyToMap(
                     hProperties.pMap: %subst(inBufMbr.data: 1: length));
 E02        endif;
 E01     enddo;
                                                                                            //RADDAT
         // Close member
         close PROPERTIES;

         rc = 0;
                                                                                            //RADDAT
         return rc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_loadFromMember...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Load properties from a given stream file.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned                       RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_stmf         - Stream file that contains the properties.                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_loadFromStmf...                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_loadFromStmf...                                                        RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_stmf                     5000A   const  varying options(*varsize)                   RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D fd              S             10I 0 inz                                                RADDAT
     D st_stat         DS                  likeds(st_stat_t      ) inz
     D line            S                   like(readLine_line_t  ) inz
     D isFirstLine     S               N   inz(cTrue)
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         // Check stream file                                                               //RADDAT
 B01     if (stat(%trim(i_stmf): %addr(st_stat)) = -1);                                     //RADDAT
            sendToJobLog(
                  'File or directory ' + %trim(i_stmf) + ' does not exist');
            return rc;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Open stream file                                                                //RADDAT
         monitor;                                                                           //RADDAT
            fd = open(%trim(i_stmf): O_RDONLY + O_SHARE_RDONLY + O_TEXTDATA);               //RADDAT
         on-error;                                                                          //RADDAT
            sendToJobLog('Could not open stream file: ' + %trim(i_stmf));                   //RADDAT
            return rc;                                                                      //RADDAT
         endmon;                                                                            //RADDAT
                                                                                            //RADDAT
         // Load properties from steam file                                                 //RADDAT
         isFirstLine = cTrue;
 B01     dow (readLine(fd: line: isFirstLine) <> -1);
            retrieveAndAddPropertyToMap(hProperties.pMap: line);                            //RADDAT
            isFirstLine = cFalse;
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Close member                                                                    //RADDAT
         close PROPERTIES;                                                                  //RADDAT
                                                                                            //RADDAT
         rc = 0;                                                                            //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_loadFromStmf...                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes the entry that is associated to the specified key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned
      *                    by BasicProperties_new().
      *   i_key          - Key of the entry that is removed from the list
      *                    of properties.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P BasicProperties_remove...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_remove...
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz
      *                                                                                       RADDAT
      *  Properties handle
     D hProperties     DS                  likeds(hProperties_t)
     D                                     based(i_pProperties )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         rc = BasicMap_remove(hProperties.pMap: i_key);
                                                                                            //RADDAT
         return rc;

      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_remove...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns true if the list of properties contains a entry matching
      *  the specified key value.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned
      *                    by BasicProperties_new().
      *   i_key          - Key the list of properties is searched for.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isFound       - Returns TRUE is the list of properties contains an
      *                   entry matching the specified key, else FALSE.
      *=========================================================================              RADDAT
     P BasicProperties_containsKey...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_containsKey...
     D                 PI              N
     D  i_pProperties                      const  like(BasicProperties_handle_t)
     D  i_key                              const  like(BasicMap_key_t          )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isFound         S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Properties handle
     D hProperties     DS                  likeds(hProperties_t)
     D                                     based(i_pProperties )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         isFound = BasicMap_containsKey(hProperties.pMap: i_key);
                                                                                            //RADDAT
         return isFound;

      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_containsKey...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the string that is associated to the specified key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key the list of properties is searched for.                        RADDAT
      *
      *  Returns:                                                                             RADDAT
      *   string        - String value addressed by 'i_key'.                                  RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_getString...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_getString...
     D                 PI          4096A          varying                                     RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)
     D  i_key                              const  like(BasicMap_key_t          )
     D                                            options(*varsize)                           RADDAT
     D  i_default                  4096A   const  varying
     D                                            options(*nopass: *varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S                   like(property_t.value ) inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_default       C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Local fields
     D isFound         S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Properties handle
     D hProperties     DS                  likeds(hProperties_t)
     D                                     based(i_pProperties )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         isFound = getStringFromMap(hProperties.pMap: i_key: string);
 B01     if (not isFound and %parms() >= p_default);
            return i_default;
 E01     endif;
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_getString...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the integer value that is associated to the specified key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key the list of properties is searched for.                        RADDAT
      *
      *  Returns:                                                                             RADDAT
      *   integer       - Integer value addressed by 'i_key'.
      *=========================================================================              RADDAT
     P BasicProperties_getInteger...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_getInteger...
     D                 PI            10I 0
     D  i_pProperties                      const  like(BasicProperties_handle_t)
     D  i_key                              const  like(BasicMap_key_t          )
     D                                            options(*varsize)                           RADDAT
     D  i_default                    10I 0 const  options(*nopass)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D integer         S             10I 0 inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_default       C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Local fields
     D string          S                   like(property_t.value ) inz
     D isFound         S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Local constants
     D INT_LEN         C                   %len(integer)
     D INT_DECPOS      C                   %decpos(integer)
      *                                                                                       RADDAT
      *  Properties handle
     D hProperties     DS                  likeds(hProperties_t)
     D                                     based(i_pProperties )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         isFound = getStringFromMap(hProperties.pMap: i_key: string);
 B01     if (not isFound and %parms() >= p_default);
            return i_default;
 E01     endif;

 B01     if (string = '');   // Existing key but no value assigned to it.
            return 0;
 E01     endif;

         integer = %dec(string: INT_LEN: INT_DECPOS);
                                                                                            //RADDAT
         return integer;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_getInteger...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the boolean value that is associated to the specified key.                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key the list of properties is searched for.                        RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   integer       - Boolean value addressed by 'i_key'.                                 RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_getBoolean...                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_getBoolean...                                                          RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_default                      N   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D boolean         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_default       C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D string          S                   like(property_t.value ) inz
     D isFound         S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         isFound = getStringFromMap(hProperties.pMap: i_key: string);
 B01     if (not isFound and %parms() >= p_default);
            return i_default;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (string = '');   // Existing key but no value assigned to it.                   //RADDAT
            return cFalse;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         string = f_lcase(string);                                                          //RADDAT
                                                                                            //RADDAT
 B01     select;                                                                            //RADDAT
         when (string = BOOLEAN_FALSE or string = BOOLEAN_0);                               //RADDAT
            boolean = cFalse;                                                               //RADDAT
         when (string = BOOLEAN_TRUE or string = BOOLEAN_1);                                //RADDAT
            boolean = cTrue;                                                                //RADDAT
 X01     other;                                                                             //RADDAT
            sendToJobLog('Invalid boolean value <' + string + '> +
                          associated to key <' + i_key + '>');                              //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         return boolean;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_getBoolean...                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the decimal value that is associated to the specified key.                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key the list of properties is searched for.                        RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   decimal       - Decimal value addressed by 'i_key'.                                 RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_getDecimal...                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_getDecimal...                                                          RADDAT
     D                 PI                         like(BasicProperties_decVal_t)              RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_default                          const  like(BasicProperties_decVal_t)              RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D decimal         S                   like(BasicProperties_decVal_t) inz                 RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_default       C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D string          S                   like(property_t.value ) inz
     D isFound         S               N   inz(cFalse)
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D DEC_LEN         C                   %len(BasicProperties_decVal_t)                     RADDAT
     D DEC_DECPOS      C                   %decpos(BasicProperties_decVal_t)                  RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         isFound = getStringFromMap(hProperties.pMap: i_key: string);
 B01     if (not isFound and %parms() >= p_default);
            return i_default;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (string = '');   // Existing key but no value assigned to it.                   //RADDAT
            return 0;                                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         decimal = %dec(string: DEC_LEN: DEC_DECPOS);                                       //RADDAT
                                                                                            //RADDAT
         return decimal;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_getDecimal...                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified string value to a given key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key that is associated to the specified string value.              RADDAT
      *   i_string       - The string value that is associated to a given key.                RADDAT
      *
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P BasicProperties_putString...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_putString...
     D                 PI            10I 0
     D  i_pProperties                      const  like(BasicProperties_handle_t)
     D  i_key                              const  like(BasicMap_key_t          )
     D                                            options(*varsize)                           RADDAT
     D  i_string                   4096A   const  varying
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D property        DS                  likeds(property_t) inz                             RADDAT
      *                                                                                       RADDAT
      *  Properties handle
     D hProperties     DS                  likeds(hProperties_t)
     D                                     based(i_pProperties )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         property.key   = i_key;                                                            //RADDAT
         property.value = i_string;                                                         //RADDAT
         rc = addPropertyToMap(hProperties.pMap: property);                                 //RADDAT
                                                                                            //RADDAT
         return rc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_putString...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified integer value to a given key.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key that is associated to the specified integer value.
      *   i_integer      - The integer value that is associated to a given key.
      *
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.
      *=========================================================================              RADDAT
     P BasicProperties_putInteger...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_putInteger...
     D                 PI            10I 0
     D  i_pProperties                      const  like(BasicProperties_handle_t)
     D  i_key                              const  like(BasicMap_key_t          )
     D                                            options(*varsize)                           RADDAT
     D  i_integer                    10I 0 const
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D property        DS                  likeds(property_t) inz                             RADDAT
      *                                                                                       RADDAT
      *  Properties handle
     D hProperties     DS                  likeds(hProperties_t)
     D                                     based(i_pProperties )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         property.key   = i_key;                                                            //RADDAT
         property.value = %char(i_integer);                                                 //RADDAT
         rc = addPropertyToMap(hProperties.pMap: property);                                 //RADDAT
                                                                                            //RADDAT
         return rc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_putInteger...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified boolean value to a given key.                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key that is associated to the specified integer value.             RADDAT
      *   i_boolean      - The boolean value that is associated to a given key.               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_putBoolean...                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_putBoolean...                                                          RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_boolean                      N   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D property        DS                  likeds(property_t) inz                             RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         property.key   = i_key;                                                            //RADDAT
                                                                                            //RADDAT
 B01     if (i_boolean);                                                                    //RADDAT
            property.value = BOOLEAN_TRUE;                                                  //RADDAT
 X01     else;                                                                              //RADDAT
            property.value = BOOLEAN_FALSE;                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         rc = addPropertyToMap(hProperties.pMap: property);                                 //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_putBoolean...                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Associates the specified decimal value to a given key.                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *   i_key          - Key that is associated to the specified decimal value.             RADDAT
      *   i_decimal      - The decimal value that is associated to a given key.               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_putDecimal...                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_putDecimal...                                                          RADDAT
     D                 PI                         like(BasicProperties_decVal_t)              RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_decimal                          const  like(BasicProperties_decVal_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D property        DS                  likeds(property_t) inz                             RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         property.key   = i_key;                                                            //RADDAT
                                                                                            //RADDAT
         property.value = %editc(i_decimal: 'P');                                           //RADDAT
         x = %checkr('0': property.value);   // trim trailing '0'                           //RADDAT
 B01     if (x < %len(property.value));                                                     //RADDAT
            %subst(property.value: x+1) = '';                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         property.value = %trim(property.value);                                            //RADDAT
         rc = addPropertyToMap(hProperties.pMap: property);                                 //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_putDecimal...                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the number of key-value mappings in this properties list.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   numE          - NUmber of entries on success, else -1;                              RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_getNumE...                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_getNumE...                                                             RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D numE            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         numE = BasicMap_getNumE(hProperties.pMap);
                                                                                            //RADDAT
         return numE;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_getNumE...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the heap ID of a given BasicProperties.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   numE          - NUmber of entries on success, else -1;                              RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_getHeapID...                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_getHeapID...                                                           RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D heapID          S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         heapID = BasicMap_getHeapID(hProperties.pMap);
                                                                                            //RADDAT
         return heapID;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_getHeapID...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes all entries from a given properties list.                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned   ew().               RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc            - Returns 0 on success, else -1.                                      RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_clear...                                                               RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_clear...                                                               RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);                                              //RADDAT
                                                                                            //RADDAT
         rc = BasicMap_clear(hProperties.pMap);                                             //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_clear...                                                               RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given BasicProperties.                                                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pProperties - Basing pointer of the properties as returned by                    RADDAT
      *                    BasicProperties_new().                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rc              Returns 0 success, else -1.                                         RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_delete...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_delete...                                                              RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  io_pProperties...                                                                     RADDAT
     D                                            like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Memory Manager                                                                       RADDAT
 CPY  /COPY QBASICS1,MEMMGR                                                                   RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(io_pProperties)                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(io_pProperties);                                             //RADDAT
                                                                                            //RADDAT
 B01     dou 1=1;                                                                           //RADDAT
                                                                                            //RADDAT
            // Set memory manager                                                           //RADDAT
            mm_memMgr = hProperties.memMgr;                                                 //RADDAT
                                                                                            //RADDAT
            // Delete underlaying BasicMap.                                                 //RADDAT
            BasicMap_delete(hProperties.pMap);                                              //RADDAT
                                                                                            //RADDAT
            // Clear properties handle                                                      //RADDAT
            clear hProperties;                                                              //RADDAT
            hProperties.intType       = 0;                                                  //RADDAT
            hProperties.intSize       = 0;                                                  //RADDAT
            hProperties.pMap          = BasicMap_null();                                    //RADDAT
            hProperties.increment     = 0;                                                  //RADDAT
            hProperties.heapID        = 0;                                                  //RADDAT
            clear hProperties.memMgr;                                                       //RADDAT
                                                                                            //RADDAT
            // Free memory of properties handle                                             //RADDAT
            mm_free(io_pProperties);                                                        //RADDAT
                                                                                            //RADDAT
            io_pProperties = BasicProperties_null();                                        //RADDAT
                                                                                            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_delete...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a BasicProperties NULL handle.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pProperties    - NULL handle of a BasicProperties.                                  RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_null...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_null...                                                                RADDAT
     D                 PI                         like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pProperties     S                   like(BasicProperties_handle_t) inz                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pProperties = *NULL;                                                               //RADDAT
                                                                                            //RADDAT
         return pProperties;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_null...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks a given BasicProperties handle for a NULL value.                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned                       RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull         - Returns TRUE if the handle is null, else FALSE.                    RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_isNull...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_isNull...                                                              RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNull          S               N   inz(cTrue)                                         RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_pProperties = BasicProperties_null());                                       //RADDAT
            isNull = cTrue;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            isNull = cFalse;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isNull;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_isNull...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the list of key values from a given properties list.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pProperties  - Basing pointer of the properties as returned                       RADDAT
      *                    by BasicProperties_new().                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pKeySet       - Handle of the key set.
      *=========================================================================              RADDAT
      *  Note:            Use BasicKeySet_delete() to delete the key set.                     RADDAT
      *=========================================================================              RADDAT
     P BasicProperties_newKeySet...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D BasicProperties_newKeySet...
     D                 PI                         like(BasicKeySet_handle_t)                  RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pKeySet         S                   like(BasicKeySet_handle_t) inz                     RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         checkPropertiesHandle(i_pProperties);
                                                                                            //RADDAT
         pKeySet = BasicMap_newKeySet(hProperties.pMap);
                                                                                            //RADDAT
         return pKeySet;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P BasicProperties_newKeySet...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Checks, whether a given handle is a valid properties handle, or not.                 RADDAT
      *  Returns TRUE for a valid properties handle, else FALSE.                              RADDAT
      *=========================================================================              RADDAT
     P checkPropertiesHandle...                                                               RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D checkPropertiesHandle...                                                               RADDAT
     D                 PI                                                                     RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Properties handle                                                                    RADDAT
     D hProperties     DS                  likeds(hProperties_t)                              RADDAT
     D                                     based(i_pProperties )                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (BasicProperties_isNull(i_pProperties));                                        //RADDAT
            signalError(cERROR_PROPERTIES_HANDLE_NULL: f_caller());                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hProperties.intType <> cHANDLE_TYPE_PROPERTIES);                               //RADDAT
            signalError(cERROR_PROPERTIES_HANDLE_INVALID: f_caller());                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (hProperties.intSize <> cHANDLE_PROPERTIES_SIZE);                               //RADDAT
            signalError(cERROR_PROPERTIES_HANDLE_INVALID: f_caller());                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P checkPropertiesHandle...                                                               RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================
      *  *** Private ***
      *  Reads a line from a given file descriptor.
      *=========================================================================
     P readLine...
     P                 B
      *
     D readLine...
     D                 PI            10I 0
     D  i_fd                         10I 0 const
     D  io_line                                   like(readLine_line_t)
     D  i_isFirstLine                  N   const
      *
      *  Helper fields
     D rd              DS                  qualified static
     D  buffer                     4096A   inz
     D  pos                          10I 0 inz
     D  len                          10I 0 inz
     D  pChar                          *   inz
     D  lineFeed                      1A   inz(x'00')
      *
     D char            S              1A   based(rd.pChar)
     D isEndOfLine     S               N   inz(cFalse)
      *
     D line            DS                  qualified based(pLine)
     D  len                           5I 0
     D  data                       1024A
      *
     D MAX_LENGTH      C                   1024
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      /FREE

 B01     if (i_isFirstLine);
            reset rd;
 E01     endif;

         pLine = %addr(io_line);
         line.len = 0;

 B01     dou (isEndOfLine);

 B02        if (rd.pos >= rd.len);
               rd.pos = 0;
               rd.len = read(i_fd: %addr(rd.buffer): %size(rd.buffer));
 B03           if (rd.len < 1);
                  return -1;
 E03           endif;
               rd.pChar = %addr(rd.buffer);
 E02        endif;

 B02        if (rd.lineFeed = x'00' and (char = x'25' or char = x'0D'));
               rd.lineFeed = char;
 E02        endif;

 B02        if (char <> x'25' and char <> x'0D' and line.len < MAX_LENGTH);
               line.len = line.len + 1;
               %subst(line.data: line.len: 1) = char;
 E02        endif;

 B02        if (char = rd.lineFeed);
               isEndOfLine = cTrue;
 E02        endif;

            rd.pChar = rd.pChar + 1;
            rd.pos   = rd.pos + 1;
 E01     enddo;

         return line.len;

      /END-FREE
      *                                                                                       RADDAT
     P readLine...
     P                 E
      *                                                                                       RADDAT
      *=========================================================================
      *  *** Private ***
      *  Test the specified buffer, splitts the buffer and adds the property
      *  to the property list.
      *=========================================================================
     P retrieveAndAddPropertyToMap...                                                         RADDAT
     P                 B
      *
     D retrieveAndAddPropertyToMap...                                                         RADDAT
     D                 PI
     D  i_pMap                             const  like(BasicMap_handle_t    )
     D  i_buffer                   4096A   const  varying  options(*varsize)                  RADDAT
      *
      *  Helper fields
     D x               S             10I 0                    inz
     D char            S              1A                      inz
     D buffer          S                   like(i_buffer    ) inz
     D property        DS                  likeds(property_t) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      /FREE

         buffer = %trim(i_buffer);

 B01     if buffer = '';
            return;
 E01     endif;

         char   = %subst(buffer: 1: 1);

 B01     if (char <> '#') and (char <> ';') and (char <> '!');
            x = %scan('=': buffer);
 B02        if (x > 1) and (x < %len(buffer));
               property.key   = %trim(%subst(buffer: 1: x-1));                              //RADDAT
               property.value = %trim(%subst(buffer: x+1));
               addPropertyToMap(i_pMap: property);                                          //RADDAT
 E02        endif;
 E01     endif;

         return;

      /END-FREE
      *                                                                                       RADDAT
     P retrieveAndAddPropertyToMap...                                                         RADDAT
     P                 E
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  *** Private ***                                                                      RADDAT
      *  Adds the specified key and value to the map.                                         RADDAT
      *=========================================================================              RADDAT
     P addPropertyToMap...                                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D addPropertyToMap...                                                                    RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_property                         const  likeds(property_t      )                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D  key            S                   like(i_property.key ) inz                          RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         key = f_lcase(i_property.key);                                                     //RADDAT
         rc = BasicMap_putString(i_pMap: key: i_property.value);                            //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P addPropertyToMap...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  *** Private ***                                                                      RADDAT
      *  Returns the value that is associated to a given key                                  RADDAT
      *  from the specified map.                                                              RADDAT
      *=========================================================================              RADDAT
     P getStringFromMap...                                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D getStringFromMap...                                                                    RADDAT
     D                 PI              N                                                      RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D  o_string                                  like(property_t.value  )
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D  key            S                   like(property_t.key ) inz                          RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         key = f_lcase(i_key);                                                              //RADDAT
 B01     if (not BasicMap_containsKey(i_pMap: key));
            return cFalse;
 E01     endif;

         o_string = BasicMap_getString(i_pMap: key);
                                                                                            //RADDAT
         return cTrue;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P getStringFromMap...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sends an ESCAPE message to signal an error condition.                                RADDAT
      *=========================================================================              RADDAT
     P signalError...                                                                         RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D signalError...                                                                         RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      128A   const  varying                                     RADDAT
     D  i_proc                      256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t ) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg('CPF9898'
                        : 'BasicProperties: ERROR - ' + i_text
                        : cMsg_Escape: 'QCPFMSG': '*LIBL');                                 //RADDAT
         f_sndPgmMsg(msg: cMsg_Same: i_proc);                                               //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P signalError...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Sends a DIAGNOSTIC message to the job log.
      *=========================================================================              RADDAT
     P sendToJobLog...
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D sendToJobLog...                                                                        RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      512A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D proc            S            256A   varying inz
     D msg             DS                  likeds(msg_t ) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         proc = f_caller();
                                                                                            //RADDAT
         msg = f_newMsg('CPF9897'
                        : 'BasicProperties: WARNING - ' + i_text + '.'
                        : cMsg_Diag: 'QCPFMSG': '*LIBL');
         f_sndPgmMsg(msg: cMsg_Same: proc);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sendToJobLog...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1RH  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1RH "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - MemoryBufferRdrWtr       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1RH  - SrvPgm: Basic Routines - MemoryBufferRdrWtr           *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  16.07.2011                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN BNDDIR('QSNAPI')                                                                RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RH                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
     D reader_t        DS                  qualified               based(pDummy)              RADDAT
     D  fd                           10I 0                                                    RADDAT
     D  offset                       10I 0                                                    RADDAT
     D  size                         10I 0                                                    RADDAT
     D  pData                          *                                                      RADDAT
      *                                                                                       RADDAT
     D writer_t        DS                  qualified               based(pDummy)              RADDAT
     D  fd                           10I 0                                                    RADDAT
     D  offset                       10I 0                                                    RADDAT
     D  size                         10I 0                                                    RADDAT
     D  pData                          *                                                      RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,CLIB                          C Runtime Library                          RADDAT
      *                                                                                       RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2                    API Error Handling                         RADDAT
 CPY  /COPY QBASICS1,PBASICS1R8                    Handle/Memory                              RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
     D HANDLE_TYPE_WRITER...                                                                  RADDAT
     D                 C                   '*MEMORY_WRITER'                                   RADDAT
     D HANDLE_TYPE_READER...                                                                  RADDAT
     D                 C                   '*MEMORY_READER'                                   RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a memory buffer writer.                                                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pBuffer     - Buffer data is written to.                                          RADDAT
      *   i_maxSize     - Maximum size of the buffer.                                         RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   fd            - Buffer descriptor on success, else -1.                              RADDAT
      *=========================================================================              RADDAT
     P MemoryWriter_new...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryWriter_new...                                                                    RADDAT
     D                 PI                         like(memWtr_handle_t)                       RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_maxSize                          value  like(size_t         )                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D fd              S             10I 0 inz(RC_ERROR)                                      RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *                                                                                       RADDAT
      *  Handle                                                                               RADDAT
     D hWriter         DS                  likeds(writer_t ) based(pHWriter)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         fd = HANDLE_new(HANDLE_TYPE_WRITER: %size(hWriter));                               //RADDAT
                                                                                            //RADDAT
         pHWriter = HANDLE_getPointer(fd);                                                  //RADDAT
                                                                                            //RADDAT
         clear hWriter;                                                                     //RADDAT
         hWriter.fd     = fd;                                                               //RADDAT
         hWriter.offset = 0;                                                                //RADDAT
         hWriter.size   = i_maxSize;                                                        //RADDAT
         hWriter.pData  = i_pBuffer;                                                        //RADDAT
                                                                                            //RADDAT
         return fd;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryWriter_new...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Write to a given memory buffer descriptor.                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_fd          - Descriptor as created by MemoryWriter_new().                        RADDAT
      *   i_pBuffer     - Buffer that is written to the descriptor.                           RADDAT
      *   i_buflen      - Length of the buffer.                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   fd            - Number of bytes written to the descriptor on                        RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P MemoryWriter_write...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryWriter_write...                                                                  RADDAT
     D                 PI                         like(ssize_t        )                       RADDAT
     D  i_fd                               value  like(memWtr_handle_t)                       RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_buflen                           value  like(size_t         )                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S                   like(ssize_t ) inz(RC_ERROR)                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D size            S                   like(rc      ) inz                                 RADDAT
     D pDest           S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Handle                                                                               RADDAT
     D hWriter         DS                  likeds(writer_t ) based(pHWriter)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (not HANDLE_isTypeOf(i_fd: HANDLE_TYPE_WRITER));                                //RADDAT
            f_setErrno(EBADF_C);                                                            //RADDAT
            return RC_ERROR;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         pHWriter = HANDLE_getPointer(i_fd);                                                //RADDAT
                                                                                            //RADDAT
 B01     if (hWriter.offset + i_buflen > hWriter.size);                                     //RADDAT
            f_setErrno(ENOBUFS_C);                                                          //RADDAT
            return RC_ERROR;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         size = i_buflen;                                                                   //RADDAT
         pDest = memcpy(hWriter.pData + hWriter.offset: i_pBuffer: size);                   //RADDAT
 B01     if (pDest <> hWriter.pData + hWriter.offset);                                      //RADDAT
            f_setErrno(ENOBUFS_C);                                                          //RADDAT
            return RC_ERROR;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         hWriter.offset = hWriter.offset + size;                                            //RADDAT
                                                                                            //RADDAT
         rc = size;                                                                         //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryWriter_write...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given memory buffer writer.                                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_fd         - Descriptor as created by MemoryWriter_new().                        RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P MemoryWriter_delete...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryWriter_delete...                                                                 RADDAT
     D                 PI                                                                     RADDAT
     D  io_fd                                     like(memWtr_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *                                                                                       RADDAT
      *  Handle                                                                               RADDAT
     D hWriter         DS                  likeds(writer_t ) based(pHWriter)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (not HANDLE_isTypeOf(io_fd: HANDLE_TYPE_WRITER));                               //RADDAT
            f_setErrno(EBADF_C);                                                            //RADDAT
            return;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         pHWriter = HANDLE_getPointer(io_fd);                                               //RADDAT
                                                                                            //RADDAT
         clear hWriter;                                                                     //RADDAT
                                                                                            //RADDAT
         HANDLE_delete(io_fd);                                                              //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryWriter_delete...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the 'write' procedure of a MemoryWriter.                                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pWriteProc    - Procedure pointer of the 'write' procedure                          RADDAT
      *                   of a MemoryWriter.                                                  RADDAT
      *=========================================================================              RADDAT
     P MemoryWriter_writeProc...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryWriter_writeProc...                                                              RADDAT
     D                 PI              *          procptr                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         return %paddr('BASICS1RH_MemoryWriter_write');                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryWriter_writeProc...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a memory buffer reader.                                                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pBuffer     - Buffer data is read from.                                           RADDAT
      *   i_size        - Size of the buffer.                                                 RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   fd            - Buffer descriptor on success, else -1.                              RADDAT
      *=========================================================================              RADDAT
     P MemoryReader_new...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryReader_new...                                                                    RADDAT
     D                 PI                         like(memRdr_handle_t)                       RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_size                             value  like(size_t         )                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D fd              S             10I 0 inz(RC_ERROR)                                      RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *                                                                                       RADDAT
      *  Handle                                                                               RADDAT
     D hReader         DS                  likeds(reader_t ) based(pHReader)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         fd = HANDLE_new(HANDLE_TYPE_READER: %size(hReader));                               //RADDAT
                                                                                            //RADDAT
         pHReader = HANDLE_getPointer(fd);                                                  //RADDAT
                                                                                            //RADDAT
         clear hReader;                                                                     //RADDAT
         hReader.fd     = fd;                                                               //RADDAT
         hReader.offset = 0;                                                                //RADDAT
         hReader.size   = i_size;                                                           //RADDAT
         hReader.pData  = i_pBuffer;                                                        //RADDAT
                                                                                            //RADDAT
         return fd;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryReader_new...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Reads from a given memory buffer descriptor.                                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_fd          - Descriptor as created by MemoryReader_new().                        RADDAT
      *   i_pBuffer     - Buffer used to store the data taht was read                         RADDAT
      *                   from the descriptor.                                                RADDAT
      *   i_nByte       - Length of the buffer.                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   fd            - Number of bytes read from the descriptor on                         RADDAT
      *                   success, else -1.                                                   RADDAT
      *=========================================================================              RADDAT
     P MemoryReader_read...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryReader_read...                                                                   RADDAT
     D                 PI                         like(ssize_t        )                       RADDAT
     D  i_fd                               value  like(memRdr_handle_t)                       RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_nByte                            value  like(size_t         )                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S                   like(ssize_t ) inz(RC_ERROR)                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D size            S                   like(rc      ) inz                                 RADDAT
     D pDest           S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Handle                                                                               RADDAT
     D hReader         DS                  likeds(reader_t ) based(pHReader)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (not HANDLE_isTypeOf(i_fd: HANDLE_TYPE_READER));                                //RADDAT
            f_setErrno(EBADF_C);                                                            //RADDAT
            return RC_ERROR;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         pHReader = HANDLE_getPointer(i_fd);                                                //RADDAT
                                                                                            //RADDAT
 B01     if (hReader.offset + i_nByte > hReader.size);                                      //RADDAT
            size = hReader.size - hReader.offset;                                           //RADDAT
 X01     else;                                                                              //RADDAT
            size = i_nByte;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         pDest = memcpy(i_pBuffer: hReader.pData + hReader.offset: size);                   //RADDAT
 B01     if (pDest <> i_pBuffer);                                                           //RADDAT
            return RC_ERROR;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         hReader.offset = hReader.offset + size;                                            //RADDAT
                                                                                            //RADDAT
         rc = size;                                                                         //RADDAT
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryReader_read...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given memory buffer reader.                                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_fd         - Descriptor as created by MemoryReader_new().                        RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P MemoryReader_delete...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryReader_delete...                                                                 RADDAT
     D                 PI                                                                     RADDAT
     D  io_fd                                     like(memRdr_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *                                                                                       RADDAT
      *  Handle                                                                               RADDAT
     D hReader         DS                  likeds(reader_t ) based(pHReader)                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (not HANDLE_isTypeOf(io_fd: HANDLE_TYPE_READER));                               //RADDAT
            f_setErrno(EBADF_C);                                                            //RADDAT
            return;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         pHReader = HANDLE_getPointer(io_fd);                                               //RADDAT
                                                                                            //RADDAT
         clear hReader;                                                                     //RADDAT
                                                                                            //RADDAT
         HANDLE_delete(io_fd);                                                              //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryReader_delete...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the 'read' procedure of a MemoryReader.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pWriteProc    - Procedure pointer of the 'read' procedure
      *                   of a MemoryReader.                                                  RADDAT
      *=========================================================================              RADDAT
     P MemoryReader_readProc...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryReader_readProc...
     D                 PI              *          procptr                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         return %paddr('BASICS1RH_MemoryReader_read');
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryReader_readProc...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R0  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R0 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Declarations        cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICR0)                                                                RADDAT
      /DEFINE BASICR0                                                                         RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Constants                                                                            RADDAT
      * -----------------------------------------                                             RADDAT
      /IF NOT DEFINED(cTrue)                                                                  RADDAT
      /DEFINE cTrue                                                                           RADDAT
     D cTrue           C                   const(*on )                                        RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      /IF NOT DEFINED(cFalse)                                                                 RADDAT
      /DEFINE cFalse                                                                          RADDAT
     D cFalse          C                   const(*off)                                        RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Prototypes                                                                           RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,CLIB                                                                     RADDAT
 CPY  /COPY QBASICS1,CEELIB                                                                   RADDAT
      *                                                                                       RADDAT
      *  Retrieve Message (QMHRTVM) API                                                       RADDAT
     D QMHRTVM         PR                         extpgm('QMHRTVM')                           RADDAT
     D  o_msgInf                  32767A          options(*varsize )                          RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_msgID                       7A   const                                              RADDAT
     D  i_qMsgF                      20A   const                                              RADDAT
     D  i_rplData                 32767A   const  options(*varsize )                          RADDAT
     D  i_rpldataLen                 10I 0 const                                              RADDAT
     D  i_rplVars                    10A   const                                              RADDAT
     D  i_rtnCtrlChrs                10A   const                                              RADDAT
     D  io_ErrCode                32767A          options(*varsize )                          RADDAT
      *                                                                                       RADDAT
      *  Send Program Message (QMHSNDPM) API                                                  RADDAT
     D QMHSNDPM        PR                         extpgm('QMHSNDPM')                          RADDAT
     D  i_msgID                       7A   const                                              RADDAT
     D  i_qMsgF                      20A   const                                              RADDAT
     D  i_msgData                 32767A   const  options(*varsize )                          RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_msgType                    10A   const                                              RADDAT
     D  i_callStkE                32767A   const  options(*varsize )                          RADDAT
     D  i_callStkC                   10I 0 const                                              RADDAT
     D  o_msgKey                      4A                                                      RADDAT
     D  io_ErrCode                32767A          options(*varsize )                          RADDAT
     D  i_lenStkE                    10I 0 const  options(*nopass  )            | optGrp 1    RADDAT
     D  i_callStkEQ                  20A   const  options(*nopass  )            |             RADDAT
     D  i_wait                       10I 0 const  options(*nopass  )            |             RADDAT
     D  i_callStkEDT                 10A   const  options(*nopass  )            | optGrp 2    RADDAT
     D  i_ccsid                      10I 0 const  options(*nopass  )            |             RADDAT
      *                                                                                       RADDAT
      *  Receive Program Message (QMHRCVPM) API                                               RADDAT
     D QMHRCVPM        PR                         extpgm('QMHRCVPM')                          RADDAT
     D  o_rcvVar                  32767A          options(*varsize )                          RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_callStkE                   10A   const                                              RADDAT
     D  i_callStkC                   10I 0 const                                              RADDAT
     D  i_msgType                    10A   const                                              RADDAT
     D  i_msgKey                      4A   const                                              RADDAT
     D  i_wait                       10I 0 const                                              RADDAT
     D  i_action                     10A   const                                              RADDAT
     D  io_ErrCode                32767A          options(*varsize )                          RADDAT
     D  i_lenStkE                    10I 0 const  options(*nopass  )            | optGrp 1    RADDAT
     D  i_callStkEQ                  20A   const  options(*nopass  )            |             RADDAT
     D  i_callStkEDT                 10A   const  options(*nopass  )            | optGrp 2    RADDAT
     D  i_ccsid                      10I 0 const  options(*nopass  )            |             RADDAT
      *                                                                                       RADDAT
      *  Remove Program Messages (QMHRMVPM) API                                               RADDAT
     D QMHRMVPM        PR                         extpgm('QMHRMVPM')                          RADDAT
     D  i_callStkE                   10A   const                                              RADDAT
     D  i_callStkC                   10I 0 const                                              RADDAT
     D  i_msgKey                      4A   const                                              RADDAT
     D  i_msgToRemove                10A   const                                              RADDAT
     D  io_ErrCode                32767A          options(*varsize )                          RADDAT
     D  i_lenStkE                    10I 0 const  options(*nopass  )            | optGrp 1    RADDAT
     D  i_callStkEQ                  20A   const  options(*nopass  )            |             RADDAT
     D  i_rmvUnhExcp                 10A   const  options(*nopass  )            |
      *                                                                                       RADDAT
      *  Process Commands (QCAPCMD) API                                                       RADDAT
     D QCAPCMD...                                                                             RADDAT
     D                 PR                         extpgm('QCAPCMD')                           RADDAT
     D  i_cmd...                                                                              RADDAT
     D                            32702A   const  options(*varsize)                           RADDAT
     D  i_cmdLength...                                                                        RADDAT
     D                               10I 0 const                                              RADDAT
     D  i_optCtrlBlk...                                                                       RADDAT
     D                            32767A   const  options(*varsize)                           RADDAT
     D  i_optCtrlBlkLength...                                                                 RADDAT
     D                               10I 0 const                                              RADDAT
     D  i_optCtrlBlkFormat...                                                                 RADDAT
     D                                8A   const                                              RADDAT
     D  o_chgCmd...                                                                           RADDAT
     D                            32702A          options(*varsize)                           RADDAT
     D  i_chgCmdLength...                                                                     RADDAT
     D                               10I 0 const                                              RADDAT
     D  o_chgCmdLengthAvl...                                                                  RADDAT
     D                               10I 0                                                    RADDAT
     D  io_errorCode...                                                                       RADDAT
     D                            32767A          options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Retrieve Object Description (QUSROBJD) API                                           RADDAT
     D QUSROBJD        PR                         extpgm('QUSROBJD')                          RADDAT
     D  i_rcvVar                  32767A          options(*varsize)                           RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_qObj                       20A   const                                              RADDAT
     D  i_objType                    10A   const                                              RADDAT
     D  io_ErrCode                32767A          options(*nopass: *varsize)    | optGrp      RADDAT
      *                                                                                       RADDAT
      *  Retrieve Member Description (QUSRMBRD) API                                           RADDAT
     D QUSRMBRD        PR                         extpgm('QUSRMBRD')                          RADDAT
     D  i_rcvVar                  32767A          options(*varsize)                           RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_qFile                      20A   const                                              RADDAT
     D  i_mbr                        10A   const                                              RADDAT
     D  i_prcOverride                 1A   const                                              RADDAT
     D  io_ErrCode                32767A          options(*nopass: *varsize)    | optGrp 1    RADDAT
      *                                                                                       RADDAT
      *  Convert Case (QLGCNVCS, QlgConvertCase) API                                          RADDAT
     D QlgConvertCase  PR                         extproc('QlgConvertCase')                   RADDAT
     D  i_reqCtrlBlk              32767A   const  options(*varsize)                           RADDAT
     D  i_inData                  32767A   const  options(*varsize)                           RADDAT
     D  o_outData                 32767A          options(*varsize)                           RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  io_ErrCode                32767A          options(*nopass: *varsize)                  RADDAT
      *                                                                                       RADDAT
     D cCVTCASE_TYPE_ccsid...                                                                 RADDAT
     D                 C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
     D cCVTCASE_TYPE_table...                                                                 RADDAT
     D                 C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
     D cCVTCASE_TYPE_userDef...                                                               RADDAT
     D                 C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
     D cCVTCASE_toUpper...                                                                    RADDAT
     D                 C                   const(0)                                           RADDAT
      *                                                                                       RADDAT
     D cCVTCASE_toLower...                                                                    RADDAT
     D                 C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
     D cCVTCASE_CCSID_Job...                                                                  RADDAT
     D                 C                   const(0)                                           RADDAT
      *                                                                                       RADDAT
     D reqCtrlBlk_t    DS                  qualified           based(pDummy)                  RADDAT
     D  type                         10I 0                                                    RADDAT
     D  CCSID                        10I 0                                                    RADDAT
     D  case                         10I 0                                                    RADDAT
     D  reserved                     10A                                                      RADDAT
      *                                                                                       RADDAT
      *  Convert Edit Code (QECCVTEC) API                                                     RADDAT
     D QECCVTEC...                                                                            RADDAT
     D                 PR                  extpgm('QECCVTEC')                                 RADDAT
     D  o_editMask                  256A                                                      RADDAT
     D  o_editMaskLen                10I 0                                                    RADDAT
     D  o_rcvVarLen                  10I 0                                                    RADDAT
     D  o_zeroFilChar                 1A                                                      RADDAT
     D  i_editCode                    2A   const                                              RADDAT
     D  i_floatInd                    1A   const                                              RADDAT
     D  i_precision                  10I 0 const                                              RADDAT
     D  i_decPos                     10I 0 const                                              RADDAT
     D  io_ErrCode                32767A          options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Convert Edit Word (QECCVTEW) API                                                     RADDAT
     D QECCVTEW...                                                                            RADDAT
     D                 PR                  extpgm('QECCVTEW')                                 RADDAT
     D  o_editMask                  256A                                                      RADDAT
     D  o_editMaskLen                10I 0                                                    RADDAT
     D  o_rcvVarLen                  10I 0                                                    RADDAT
     D  i_editWord                32767A   const options(*varsize)                            RADDAT
     D  i_editWordLen                10I 0 const                                              RADDAT
     D  io_ErrCode                32767A         options(*varsize)                            RADDAT
      *                                                                                       RADDAT
      *  Edit (QECEDT) API                                                                    RADDAT
     D QECEDT...                                                                              RADDAT
     D                 PR                  extpgm('QECEDT')                                   RADDAT
     D  o_rcvVar                  32767A         options(*varsize)                            RADDAT
     D  i_rcvVarLen                  10I 0 const                                              RADDAT
     D  i_srcVar                  32767A   const options(*varsize)                            RADDAT
     D  i_srcVarClass                10A   const                                              RADDAT
     D  i_srcVarPrec                 10I 0 const                                              RADDAT
     D  i_editMask                32767A   const options(*varsize)                            RADDAT
     D  i_editMaskLen                10I 0 const                                              RADDAT
     D  i_zeroFilChar                 1A   const                                              RADDAT
     D  io_ErrCode                32767A         options(*varsize)                            RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R1  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R1 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Messages                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R1  - SrvPgm: Basic Routines - Messages                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  26.01.2005  Th.Raddatz    Removed Parameter i_rtnCtrlChr from      *                 RADDAT
      *                            f_rtvMsgText().                          *                 RADDAT
      *                                                                     *                 RADDAT
      *  09.02.2005  Th.Raddatz    Added f_rtvMsgTextRaw() and              *                 RADDAT
      *                            f_rtvMsgHelpTextRaw().                   *
      *                                                                     *                 RADDAT
      *  22.03.2007  Th.Raddatz    Added f_cvtRcvMsgToMsg().                *                 RADDAT
      *                                                                     *                 RADDAT
      *  12.12.2007  Th.Raddatz    Fixed problem f_cvtRcvMsgToMsg().        *                 RADDAT
      *                            returned msg ID was blanks when          *                 RADDAT
      *                            i_rcvm0200 was empty. Now msg ID is      *                 RADDAT
      *                            set to cMSG_ID_NONE.                     *                 RADDAT
      *                                                                     *                 RADDAT
      *  17.12.2008  Th.Raddatz    Added f_rcvPgmMsgObj().                  *                 RADDAT
      *                                                                     *                 RADDAT
      *  17.12.2008  Th.Raddatz    Changed f_cvtRcvMsgToMsg() to get the    *                 RADDAT
      *                            message type from the rcvm0200 format    *                 RADDAT
      *                            if the message type has not been passed. *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R1
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Get application message file name                                                    RADDAT
     D lf_getAppMsgFileName...                                                                RADDAT
     D                 PR            10A                                                      RADDAT
      *                                                                                       RADDAT
      *  Get application message file library name                                            RADDAT
     D lf_getAppMsgFileLibrary...                                                             RADDAT
     D                 PR            10A                                                      RADDAT
      *                                                                                       RADDAT
      *  Set application message file name                                                    RADDAT
     D lp_setAppMsgFileName...                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_file                       10A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Set application message file library name                                            RADDAT
     D lp_setAppMsgFileLibrary...                                                             RADDAT
     D                 PR                                                                     RADDAT
     D  i_lib                        10A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Retrieve message description                                                         RADDAT
     D lf_rtvMsgD...                                                                          RADDAT
     D                 PR              *                                                      RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_msgID                       7A   const                                              RADDAT
     D  i_rplData                  4096A   const  varying                                     RADDAT
     D  i_qMsgF                            const  likeds(qObj_t    )                          RADDAT
     D  o_msg                                     likeds(msg_t     )                          RADDAT
     D  i_rplVars                    10A   const  options(*nopass)                            RADDAT
     D  i_rtnCtrlChr                 10A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
     D g_qAppMsgFile   DS                  likeds(qObj_t    ) inz                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the application message file.                                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_file        - The name of the message file.                                       RADDAT
      *                   Default:        QCPFMSG                                             RADDAT
      *   i_lib         - The name of the message file library.                               RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P p_setAppMsgFile...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D p_setAppMsgFile...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  i_file                       10A   const  options(*nopass)                            RADDAT
     D  i_lib                        10A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_file          C                   const(1)                                           RADDAT
     D p_lib           C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D file            S                   like(i_file    ) inz                               RADDAT
     D lib             S                   like(i_lib     ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... file                                                                        //RADDAT
 B01     if   %parms >= p_file;                                                             //RADDAT
            CEETSTA(isPresent: p_file: *omit);                                              //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            file = i_file;                                                                  //RADDAT
 X01     else;                                                                              //RADDAT
            file = 'QCPFMSG';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... library                                                                     //RADDAT
 B01     if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
 X01     else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set the message file ...                                                        //RADDAT
         lp_setAppMsgFileName(file);                                                        //RADDAT
         lp_setAppMsgFileLibrary(lib);                                                      //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P p_setAppMsgFile...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new message.                                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_ID          - The message ID.                                                     RADDAT
      *                   Default:        cMSG_ID_NONE (if omitted)                           RADDAT
      *                                   cMSG_ID_NULL (if not passed)                        RADDAT
      *                   cMsg_ID_OK    - An OK message which actually is                     RADDAT
      *                                   a blank message structure.                          RADDAT
      *                   cMsg_ID_NONE  - A message with no message ID,                       RADDAT
      *                                   just message text.                                  RADDAT
      *                   cMsg_ID_NULL  - A NULL message.                                     RADDAT
      *   i_data        - The message data of the replacement variables.                      RADDAT
      *                   Default:        *BLANKS                                             RADDAT
      *   i_type        - The message type.                                                   RADDAT
      *                   Default:        cMsg_Info                                           RADDAT
      *                   Please refer to PBASICS1R1 for a list of valid                      RADDAT
      *                   message types.                                                      RADDAT
      *   i_file        - The message file that contains the message ID.                      RADDAT
      *                   Default:        The application message file.                       RADDAT
      *   i_lib         - The message file library.                                           RADDAT
      *                   Default:        The application message file                        RADDAT
      *                                   library.                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P f_newMsg...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_newMsg...                                                                            RADDAT
     D                 PI                         likeds(msg_t     )                          RADDAT
     D  i_ID                               const  like(msg_t.id    )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_data                      512A   const  varying                                     RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_type                             const  like(msg_t.type  )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_file                             const  like(msg_t.file  )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_lib                              const  like(msg_t.lib   )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_ID            C                   const(1)                                           RADDAT
     D p_data          C                   const(2)                                           RADDAT
     D p_type          C                   const(3)                                           RADDAT
     D p_file          C                   const(4)                                           RADDAT
     D p_lib           C                   const(5)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D ID              S                   like(i_ID      ) inz                               RADDAT
     D data            S                   like(i_data    ) inz                               RADDAT
     D type            S                   like(i_type    ) inz                               RADDAT
     D file            S                   like(i_file    ) inz                               RADDAT
     D lib             S                   like(i_lib     ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * ---------------------------------------------------------                             RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... ID                                                                          //RADDAT
 B01     if  %parms >= p_ID;                                                                //RADDAT
            CEETSTA(isPresent: p_ID: *omit);                                                //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            ID = i_ID;                                                                      //RADDAT
 X01     else;
 B02        if  %parms >= p_ID;                                                             //RADDAT
               ID = cMSG_ID_NONE;                                                           //RADDAT
 X02        else;                                                                           //RADDAT
               ID = cMSG_ID_NULL;                                                           //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... Data                                                                        //RADDAT
 B01     if  %parms >= p_data;                                                              //RADDAT
            CEETSTA(isPresent: p_data: *omit);                                              //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            data = i_data;                                                                  //RADDAT
 X01     else;
            data = '';                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... Type                                                                        //RADDAT
 B01     if  %parms >= p_type;                                                              //RADDAT
            CEETSTA(isPresent: p_type: *omit);                                              //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            type = i_type;                                                                  //RADDAT
 X01     else;
 B02        if   (ID <> cMsg_ID_OK  ) and
                 (ID <> cMsg_ID_NULL);                                                      //RADDAT
               type = cMsg_Info;                                                            //RADDAT
 X02        else;                                                                           //RADDAT
               type = '';                                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... File                                                                        //RADDAT
 B01     if  %parms >= p_file;                                                              //RADDAT
            CEETSTA(isPresent: p_file: *omit);                                              //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            file = i_file;                                                                  //RADDAT
 X01     else;
            file = lf_getAppMsgFileName();                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... Library                                                                     //RADDAT
 B01     if  %parms >= p_lib;                                                               //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            lib = i_lib;                                                                    //RADDAT
 X01     else;
            lib = lf_getAppMsgFileLibrary();                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check dependencies ...                                                          //RADDAT
 B01     if   (ID = cMSG_ID_NONE) and (data = '');                                          //RADDAT
            p_assert(cFalse:
                     'Message data must not be *BLANKS in case that -
                      message ID is specified as cMsg_ID_NONE.'           );                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Produce message ...                                                             //RADDAT
         clear   msg;                                                                       //RADDAT
                                                                                            //RADDAT
         msg.ID   = ID;                                                                     //RADDAT
 B01     if   msg.ID <> cMSG_ID_NULL;                                                       //RADDAT
            msg.data = data;                                                                //RADDAT
            msg.type = type;                                                                //RADDAT
            msg.file = file;                                                                //RADDAT
            msg.lib  = lib;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msg;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_newMsg...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sends a program message.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msg         - The message to send.
      *   i_toStkC      - The stack entry to send the message to.
      *                   Default:        cMsg_Same                                           RADDAT
      *                   cMsg_Ext      - The external message queue.                         RADDAT
      *                   cMsg_Prv      - The procedure that is before
      *                                   the procdure that is specified
      *                                   at i_toProc.
      *                   cMsg_Same     - The procedure that is specified                     RADDAT
      *                                   at i_toProc.                                        RADDAT
      *   i_toProc      - The procedure to send the message to.
      *                   Default:        cMsg_ToMyself                                       RADDAT
      *                   cMsg_ToMyself - The procedure that calls
      *                                   f_sndPgmMsg().
      *                   cMsg_ToPgmBdy - The program boundary.
      *                   cMsg_ToCtlBdy - The control boundary.
      *                   cMsg_ToPgm    - The program specified
      *                                   at i_toPgm.
      *   i_toMod       - The module that contains the procedure.
      *                   Default:        *NONE                                               RADDAT
      *   i_toPgm       - The program that contains the module.
      *                   Default:        *NONE                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *
      *  Returns:
      *   msgKey        - The message key of the message sent.                                RADDAT
      *=========================================================================              RADDAT
     P f_sndPgmMsg...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_sndPgmMsg...                                                                         RADDAT
     D                 PI             4A                                                      RADDAT
     D  i_msg                              const  likeds(msg_t   )                            RADDAT
     D  i_toStkC                     10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_toProc                    256A   const  options(*nopass: *omit)                     RADDAT
     D  i_toMod                      10A   const  options(*nopass: *omit)                     RADDAT
     D  i_toPgm                      10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msgKey          S              4A   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_toStkC        C                   const(2)                                           RADDAT
     D p_toProc        C                   const(3)                                           RADDAT
     D p_toMod         C                   const(4)                                           RADDAT
     D p_toPgm         C                   const(5)                                           RADDAT
     D p_msg           C                   const(6)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D toStkC          S                   like(i_toStkC  ) inz                               RADDAT
     D toProc          S                   like(i_toProc  ) inz                               RADDAT
     D toMod           S                   like(i_toMod   ) inz                               RADDAT
     D toPgm           S                   like(i_toPgm   ) inz                               RADDAT
     D msg             DS                  likeds(o_msg   ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHSNDPM                                                               RADDAT
     D qMsgF           DS                  likeds(qObj_t    ) inz                             RADDAT
     D callStkE        S                   like(i_toProc)     inz                             RADDAT
     D callStkCtr      S             10I 0                    inz                             RADDAT
     D callStkEQ       DS                  qualified                                          RADDAT
     D  module                 1     10A                      inz                             RADDAT
     D  program               11     20A                      inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... stack counter                                                               //RADDAT
 B01     if  %parms >= p_toStkC;                                                            //RADDAT
            CEETSTA(isPresent: p_toStkC: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            toStkC = i_toStkC;                                                              //RADDAT
 X01     else;
            toStkC = cMsg_Same;                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... to procedure                                                                //RADDAT
 B01     if  %parms >= p_toProc;                                                            //RADDAT
            CEETSTA(isPresent: p_toProc: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            toProc = i_toProc;                                                              //RADDAT
 X01     else;
            toProc = cMsg_toMySelf;                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... to module                                                                   //RADDAT
 B01     if  %parms >= p_toMod;                                                             //RADDAT
            CEETSTA(isPresent: p_toMod: *omit);                                             //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            toMod  = i_toMod;                                                               //RADDAT
 X01     else;
            toMod  = '*NONE';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... to program                                                                  //RADDAT
 B01     if  %parms >= p_toPgm;                                                             //RADDAT
            CEETSTA(isPresent: p_toPgm: *omit);                                             //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            toPgm  = i_toPgm;                                                               //RADDAT
 X01     else;
            toPgm  = '*NONE';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check dependencies ...                                                          //RADDAT
         p_assert(i_msg.ID <> cMSG_ID_OK     and
                  i_msg.ID <> cMSG_ID_NULL         :
                  'Message ID must not be ''' + i_msg.ID + '''.'   );                       //RADDAT
                                                                                            //RADDAT
         // Set values to call QMHSNDPM API:                                                //RADDAT
         // Call stack counter ...                                                          //RADDAT
 B01     select;                                                                            //RADDAT
         // ... *EXT                                                                        //RADDAT
         when   toStkC = cMsg_Ext;                                                          //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
            toProc     = '*EXT';                                                            //RADDAT
         // ... *PERVIOUS                                                                   //RADDAT
         when   toStkC = cMsg_Prv;                                                          //RADDAT
            callStkCtr = 1;                                                                 //RADDAT
         // ... *SAME                                                                       //RADDAT
         when   toStkC = cMsg_Same;                                                         //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
         // ... others                                                                      //RADDAT
 X01     other;                                                                             //RADDAT
            callStkCtr = toStkC;                                                            //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // To procedure ...                                                                //RADDAT
 B01     select;                                                                            //RADDAT
         // ... *                                                                           //RADDAT
         when   toProc = cMsg_ToMyself;                                                     //RADDAT
            callStkE   = '*';                                                               //RADDAT
            // ... add 1 to skip f_sndPgmMsg() stack entry                                  //RADDAT
            callStkCtr = callStkCtr + 1;                                                    //RADDAT
            // ... *PGMBDY                                                                  //RADDAT
         when   toProc = cMsg_ToPgmBdy;                                                     //RADDAT
            callStkE   = '*PGMBDY';                                                         //RADDAT
            // ... *CTLBDY                                                                  //RADDAT
         when   toProc = cMsg_ToCtlBdy;                                                     //RADDAT
            callStkE   = '*CTLBDY';                                                         //RADDAT
            // ... *PGMNAME                                                                 //RADDAT
         when   toProc = cMsg_ToPgm;                                                        //RADDAT
            callStkE   = '*PGMNAME';                                                        //RADDAT
            // ... *EXT                                                                     //RADDAT
         when   toProc = '*EXT';                                                            //RADDAT
            callStkE   = '*EXT';                                                            //RADDAT
            // ... named procedure                                                          //RADDAT
 X01     other;                                                                             //RADDAT
            callStkE   = toProc;                                                            //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // To module ...                                                                   //RADDAT
         callStkEQ.module  = toMod;                                                         //RADDAT
                                                                                            //RADDAT
         // To program ...                                                                  //RADDAT
         callStkEQ.program = toPgm;                                                         //RADDAT
                                                                                            //RADDAT
         // Set message file name and library ...                                           //RADDAT
         qMsgF.name = i_msg.file;                                                           //RADDAT
         qMsgF.lib  = i_msg.lib;                                                            //RADDAT
                                                                                            //RADDAT
         // Initialize message key ...                                                      //RADDAT
         msgKey  = '';                                                                      //RADDAT
                                                                                            //RADDAT
         // Initialize error code ...                                                       //RADDAT
         errCode = f_newApiErrCode(cFalse);                                                 //RADDAT
                                                                                            //RADDAT
         // Finally send the message ...                                                    //RADDAT
         QMHSNDPM(i_msg.ID: qMsgF: i_msg.data: %len(%trimR(i_msg.data)):
                  i_msg.type: callStkE: callStkCtr: msgKey: errCode:
                  %len(%trimR(callStkE)): callStkEQ: -1);                                   //RADDAT
                                                                                            //RADDAT
         // Check API error code                                                            //RADDAT
 B01     if  f_isApiError(errCode);                                                         //RADDAT
            msgKey = '';                                                                    //RADDAT
            msg    = f_cvtApiErrCodeToMsg(errCode);                                         //RADDAT
 X01     else;                                                                              //RADDAT
            msg    = f_newMsg(cMsg_ID_OK);                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msgKey;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_sndPgmMsg...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Receives a program message.                                                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msgType     - The type of the message to receive.                                 RADDAT
      *                   Please refer to PBASICS1R1 for a list of valid                      RADDAT
      *                   message types.                                                      RADDAT
      *   i_msgKey      - The key of the message to receive.
      *                   Default:        *BLANKS                                             RADDAT
      *   i_action      - The action to take after the message
      *                   is received.
      *                   Default:        cMsg_Act_Same                                       RADDAT
      *                   cMsg_Act_Old  - Keep message, mark as old.
      *                   cMsg_Act_Rmv  - Remove message.
      *                   cMsg_Act_Same - Keep message.
      *   i_wait        - The time to wait for the message.                                   RADDAT
      *                   Default:        0                                                   RADDAT
      *                   0             - Do not wait.                                        RADDAT
      *                   -1            - Wait forever.                                       RADDAT
      *                   n             - Wait n seconds.                                     RADDAT
      *   i_fromStkC    - The stack entry to send the message to.                             RADDAT
      *                   Default:        cMsg_Same                                           RADDAT
      *                   cMsg_Ext      - The external message queue.                         RADDAT
      *                   cMsg_Prv      - The procedure that is before
      *                                   the procdure that is specified
      *                                   at i_toProc.
      *                   cMsg_Same     - The procedure that is specified                     RADDAT
      *                                   at i_toProc.                                        RADDAT
      *   i_fromProc    - The procedure to send the message to.                               RADDAT
      *                   Default:        cMsg_ToMyself                                       RADDAT
      *                   cMsg_ToMyself - The procedure that calls
      *                                   f_rcvPgmMsg().
      *   i_fromMod     - The module that contains the procedure.                             RADDAT
      *                   Default:        *NONE                                               RADDAT
      *   i_fromPgm     - The program that contains the module.                               RADDAT
      *                   Default:        *NONE                                               RADDAT
      *   o_msg         - The API error message.
      *
      *  Returns:
      *   rcvm0200_t    - Format RCVM0200 of the received message.                            RADDAT
      *=========================================================================              RADDAT
     P f_rcvPgmMsg...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rcvPgmMsg...                                                                         RADDAT
     D                 PI                         likeds(rcvm0200_t)                          RADDAT
     D  i_msgType                    10A   const                                              RADDAT
     D  i_msgKey                      4A   const  options(*nopass: *omit)                     RADDAT
     D  i_action                     10A   const  options(*nopass: *omit)                     RADDAT
     D  i_wait                       10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromStkC                   10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromProc                  256A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromMod                    10A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromPgm                    10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msgKey        C                   const(2)                                           RADDAT
     D p_action        C                   const(3)                                           RADDAT
     D p_wait          C                   const(4)                                           RADDAT
     D p_fromStkC      C                   const(5)                                           RADDAT
     D p_fromProc      C                   const(6)                                           RADDAT
     D p_fromMod       C                   const(7)                                           RADDAT
     D p_fromPgm       C                   const(8)                                           RADDAT
     D p_msg           C                   const(9)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D msgKey          S                   like(i_msgKey  ) inz                               RADDAT
     D action          S                   like(i_action  ) inz                               RADDAT
     D wait            S                   like(i_wait    ) inz                               RADDAT
     D fromStkC        S                   like(i_fromStkC) inz                               RADDAT
     D fromProc        S                   like(i_fromProc) inz                               RADDAT
     D fromMod         S                   like(i_fromMod ) inz                               RADDAT
     D fromPgm         S                   like(i_fromPgm ) inz                               RADDAT
     D msg             DS                  likeds(o_msg   ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHSNDPM                                                               RADDAT
     D rcvm0200        DS                  likeds(rcvm0200_t) inz                             RADDAT
     D callStkE        S                   like(i_fromProc  ) inz                             RADDAT
     D callStkCtr      S             10I 0                    inz                             RADDAT
     D callStkEQ       DS                  qualified                                          RADDAT
     D  module                 1     10A                      inz                             RADDAT
     D  program               11     20A                      inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... message key                                                                 //RADDAT
 B01     if  %parms >= p_msgKey;                                                            //RADDAT
            CEETSTA(isPresent: p_msgKey: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            msgKey = i_msgKey;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            msgKey = '';                                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... action                                                                      //RADDAT
 B01     if  %parms >= p_action;                                                            //RADDAT
            CEETSTA(isPresent: p_action: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            action = i_action;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            action = cMsg_Act_Same;                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... wait                                                                        //RADDAT
 B01     if  %parms >= p_wait;                                                              //RADDAT
            CEETSTA(isPresent: p_wait: *omit);                                              //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            wait = i_wait;                                                                  //RADDAT
 X01     else;                                                                              //RADDAT
            wait = 0;            //  Do not wait for the message.                           //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... stack counter                                                               //RADDAT
 B01     if  %parms >= p_fromStkC;                                                          //RADDAT
            CEETSTA(isPresent: p_fromStkC: *omit);                                          //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromStkC = i_fromStkC;                                                          //RADDAT
 X01     else;
            fromStkC = cMsg_Same;                                                           //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... from procedure                                                              //RADDAT
 B01     if  %parms >= p_fromProc;                                                          //RADDAT
            CEETSTA(isPresent: p_fromProc: *omit);                                          //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromProc = i_fromProc;                                                          //RADDAT
 X01     else;
            fromProc = cMsg_toMySelf;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... from module                                                                 //RADDAT
 B01     if  %parms >= p_fromMod;                                                           //RADDAT
            CEETSTA(isPresent: p_fromMod: *omit);                                           //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromMod  = i_fromMod;                                                           //RADDAT
 X01     else;
            fromMod  = '*NONE';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... from program                                                                //RADDAT
 B01     if  %parms >= p_fromPgm;                                                           //RADDAT
            CEETSTA(isPresent: p_fromPgm: *omit);                                           //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromPgm  = i_fromPgm;                                                           //RADDAT
 X01     else;
            fromPgm  = '*NONE';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set values to call QMHSNDPM API:                                                //RADDAT
         // Call stack counter ...                                                          //RADDAT
 B01     select;                                                                            //RADDAT
         // ... *EXT                                                                        //RADDAT
         when   fromStkC = cMsg_Ext;                                                        //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
            fromProc   = '*EXT';                                                            //RADDAT
         // ... *PERVIOUS                                                                   //RADDAT
         when   fromStkC = cMsg_Prv;                                                        //RADDAT
            callStkCtr = 1;                                                                 //RADDAT
         // ... *SAME                                                                       //RADDAT
         when   fromStkC = cMsg_Same;                                                       //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
         // ... sonst                                                                       //RADDAT
 X01     other;                                                                             //RADDAT
            callStkCtr = fromStkC;                                                          //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // From procedure ...                                                              //RADDAT
 B01     select;                                                                            //RADDAT
         // ... *                                                                           //RADDAT
         when   fromProc = cMsg_ToMyself;                                                   //RADDAT
            callStkE   = '*';                                                               //RADDAT
            // ... add 1 to skip f_rcvPgmMsg() stack entry                                  //RADDAT
            callStkCtr = callStkCtr + 1;                                                    //RADDAT
         // ... *EXT                                                                        //RADDAT
         when   fromProc = '*EXT';                                                          //RADDAT
            callStkE   = '*EXT';                                                            //RADDAT
         // ... named procedure                                                             //RADDAT
 X01     other;                                                                             //RADDAT
            callStkE   = fromProc;                                                          //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // From module ...                                                                 //RADDAT
         callStkEQ.module  = fromMod;                                                       //RADDAT
                                                                                            //RADDAT
         // From program ...                                                                //RADDAT
         callStkEQ.program = fromPgm;                                                       //RADDAT
                                                                                            //RADDAT
         // Initialize error code ...                                                       //RADDAT
         errCode = f_newApiErrCode(cFalse);                                                 //RADDAT
                                                                                            //RADDAT
         // Finally receive the message ...                                                 //RADDAT
         QMHRCVPM(rcvm0200: %size(rcvm0200): 'RCVM0200': callStkE: callStkCtr:
                  i_msgType: msgKey: wait: action: errCode:
                  %len(%trimR(callStkE)): callStkEQ);                                       //RADDAT
                                                                                            //RADDAT
         // Check API error code                                                            //RADDAT
 B01     if  f_isApiError(errCode);                                                         //RADDAT
            clear   rcvm0200;                                                               //RADDAT
            msg = f_cvtApiErrCodeToMsg(errCode);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            p_assert(%size(rcvm0200) >= rcvm0200.bytAvl :                                   //RADDAT
                     'RCVM0200 too small to hold result');                                  //RADDAT
            msg = f_newMsg(cMsg_ID_OK);                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   rcvm0200;                                                                 //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rcvPgmMsg...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Receives a program message and returns a message structure.                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msgType     - The type of the message to receive.                                 RADDAT
      *                   Please refer to PBASICS1R1 for a list of valid                      RADDAT
      *                   message types.                                                      RADDAT
      *   i_msgKey      - The key of the message to receive.                                  RADDAT
      *                   Default:        *BLANKS                                             RADDAT
      *   i_action      - The action to take after the message                                RADDAT
      *                   is received.                                                        RADDAT
      *                   Default:        cMsg_Act_Same                                       RADDAT
      *                   cMsg_Act_Old  - Keep message, mark as old.                          RADDAT
      *                   cMsg_Act_Rmv  - Remove message.                                     RADDAT
      *                   cMsg_Act_Same - Keep message.                                       RADDAT
      *   i_wait        - The time to wait for the message.                                   RADDAT
      *                   Default:        0                                                   RADDAT
      *                   0             - Do not wait.                                        RADDAT
      *                   -1            - Wait forever.                                       RADDAT
      *                   n             - Wait n seconds.                                     RADDAT
      *   i_fromStkC    - The stack entry to send the message to.                             RADDAT
      *                   Default:        cMsg_Same                                           RADDAT
      *                   cMsg_Ext      - The external message queue.                         RADDAT
      *                   cMsg_Prv      - The procedure that is before                        RADDAT
      *                                   the procdure that is specified                      RADDAT
      *                                   at i_toProc.                                        RADDAT
      *                   cMsg_Same     - The procedure that is specified                     RADDAT
      *                                   at i_toProc.                                        RADDAT
      *   i_fromProc    - The procedure to send the message to.                               RADDAT
      *                   Default:        cMsg_ToMyself                                       RADDAT
      *                   cMsg_ToMyself - The procedure that calls                            RADDAT
      *                                   f_rcvPgmMsg().                                      RADDAT
      *   i_fromMod     - The module that contains the procedure.                             RADDAT
      *                   Default:        *NONE                                               RADDAT
      *   i_fromPgm     - The program that contains the module.                               RADDAT
      *                   Default:        *NONE                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msg           - Received message.                                                   RADDAT
      *=========================================================================              RADDAT
     P f_rcvPgmMsgObj...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rcvPgmMsgObj...                                                                      RADDAT
     D                 PI                         likeds(msg_t )                              RADDAT
     D  i_msgType                    10A   const                                              RADDAT
     D  i_msgKey                      4A   const  options(*nopass: *omit)                     RADDAT
     D  i_action                     10A   const  options(*nopass: *omit)                     RADDAT
     D  i_wait                       10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromStkC                   10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromProc                  256A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromMod                    10A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromPgm                    10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rtnMsg          DS                  likeds(msg_t ) inz                                 RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msgKey        C                   const(2)                                           RADDAT
     D p_action        C                   const(3)                                           RADDAT
     D p_wait          C                   const(4)                                           RADDAT
     D p_fromStkC      C                   const(5)                                           RADDAT
     D p_fromProc      C                   const(6)                                           RADDAT
     D p_fromMod       C                   const(7)                                           RADDAT
     D p_fromPgm       C                   const(8)                                           RADDAT
     D p_msg           C                   const(9)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D fromStkC        S                   like(i_fromStkC) inz                               RADDAT
     D msg             DS                  likeds(o_msg   ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D callStkCtr      S             10I 0 inz                                                RADDAT
     D rcvm0200        DS                  likeds(rcvm0200_t ) inz                            RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... stack counter                                                               //RADDAT
 B01     if (%parms() >= p_fromStkC);                                                       //RADDAT
            CEETSTA(isPresent: p_fromStkC: *omit);                                          //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (isPresent = 1);                                                                //RADDAT
            fromStkC = i_fromStkC;                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            fromStkC = cMsg_Same;                                                           //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Adjust stack counter                                                            //RADDAT
 B01     select;                                                                            //RADDAT
         when (fromStkC = cMsg_Ext);                                                        //RADDAT
            callStkCtr = fromStkC;
         // ... *PERVIOUS                                                                   //RADDAT
         when (fromStkC = cMsg_Prv);                                                        //RADDAT
            callStkCtr = 1 + 1;  // let f_rcvPgmMsg() skip f_rcvPgmMsgObj()                 //RADDAT
         // ... *SAME                                                                       //RADDAT
         when (fromStkC = cMsg_Same);                                                       //RADDAT
            callStkCtr = 0 + 1;  // let f_rcvPgmMsg() skip f_rcvPgmMsgObj()                 //RADDAT
         // ... everything else                                                             //RADDAT
 X01     other;                                                                             //RADDAT
            callStkCtr = fromStkC + 1;  // let f_rcvPgmMsg() skip f_rcvPgmMsgObj()          //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // Receive the message                                                             //RADDAT
 B01     select;                                                                            //RADDAT
         when (%parms() < p_msgKey);    //   1 parameter passed                             //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType: *omit: *omit: *omit: callStkCtr
                                   : *omit: *omit: *omit: msg);
                                                                                            //RADDAT
         when (%parms() = p_msgKey);    //   2 parameters passed                            //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey: *omit: *omit: callStkCtr
                                   : *omit: *omit: *omit: msg);
                                                                                            //RADDAT
         when (%parms() = p_action);    //   3 parameters passed                            //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey
                                   : i_action: *omit: callStkCtr
                                   : *omit: *omit: *omit: msg);
                                                                                            //RADDAT
         when (%parms() = p_wait);      //   4 parameters passed                            //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey
                                   : i_action
                                   : i_wait: callStkCtr
                                   : *omit: *omit: *omit: msg);
                                                                                            //RADDAT
         when (%parms() = p_fromStkC);  //   5 parameters passed                            //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey
                                   : i_action
                                   : i_wait
                                   : callStkCtr
                                   : *omit: *omit: *omit: msg);
                                                                                            //RADDAT
         when (%parms() = p_fromProc);  //   6 parameters passed                            //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey
                                   : i_action
                                   : i_wait
                                   : callStkCtr
                                   : i_fromProc
                                   : *omit: *omit: msg);
                                                                                            //RADDAT
         when (%parms() = p_fromMod);   //   7 parameters passed                            //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey
                                   : i_action
                                   : i_wait
                                   : callStkCtr
                                   : i_fromProc
                                   : i_fromMod
                                   : *omit: msg);
                                                                                            //RADDAT
 X01     other;                         //   8 or more parameters passed                    //RADDAT
            rcvm0200 = f_rcvPgmMsg(i_msgType
                                   : i_msgKey
                                   : i_action
                                   : i_wait
                                   : callStkCtr
                                   : i_fromProc
                                   : i_fromMod
                                   : i_fromPgm
                                   : msg);
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (msg.ID = cMSG_ID_OK);                                                          //RADDAT
            rtnMsg = f_cvtRcvMsgToMsg(rcvm0200);                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return rtnMsg;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rcvPgmMsgObj...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes a program message.                                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msgToRemove - The type of the message to receive.                                 RADDAT
      *                   cMsg_Rmv_All  - Remove all messages.
      *                   cMsg_Rmv_ByKey- Remove message that is specified
      *                                   by i_msgKey.
      *                   cMsg_Rmv_New  - Remove new messages.
      *                   cMsg_Rmv_Old  - Remove old messages.
      *                   cMsg_Rmv_Scope- Remove the scope message in the
      *                                   message key parameter.
      *   i_msgKey      - The key of the message to remove.
      *                   Default:        *BLANKS                                             RADDAT
      *   i_toStkC      - The stack entry to send the message to.
      *                   Default:        cMsg_Same                                           RADDAT
      *                   cMsg_AllInact - All inactive call stack entries.                    RADDAT
      *                                   i_msgToRemove must be cMsg_Rmv_All.                 RADDAT
      *                   cMsg_Ext      - The external message queue.                         RADDAT
      *                   cMsg_Prv      - The procedure that is before
      *                                   the procdure that is specified
      *                                   at i_toProc.
      *                   cMsg_Same     - The procedure that is specified                     RADDAT
      *                                   at i_toProc.                                        RADDAT
      *   i_toProc      - The procedure to send the message to.
      *                   Default:        cMsg_toMySelf                                       RADDAT
      *                   cMsg_ToMyself - The procedure that calls
      *                                   f_rcvPgmMsg().
      *   i_toMod       - The module that contains the procedure.
      *                   Default:        *NONE                                               RADDAT
      *   i_toPgm       - The program that contains the module.
      *                   Default:        *NONE                                               RADDAT
      *   o_msg         - The API error message.
      *
      *  Returns:
      *   void
      *=========================================================================              RADDAT
     P p_rmvPgmMsg...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D p_rmvPgmMsg...                                                                         RADDAT
     D                 PI
     D  i_msgToRemove                10A   const                                              RADDAT
     D  i_msgKey                      4A   const  options(*nopass: *omit)
     D  i_fromStkC                   10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromProc                  256A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromMod                    10A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromPgm                    10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msgKey        C                   const(2)                                           RADDAT
     D p_fromStkC      C                   const(3)                                           RADDAT
     D p_fromProc      C                   const(4)                                           RADDAT
     D p_fromMod       C                   const(5)                                           RADDAT
     D p_fromPgm       C                   const(6)                                           RADDAT
     D p_msg           C                   const(7)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D msgKey          S                   like(i_msgKey  ) inz                               RADDAT
     D fromStkC        S                   like(i_fromStkC) inz                               RADDAT
     D fromProc        S                   like(i_fromProc) inz                               RADDAT
     D fromMod         S                   like(i_fromMod ) inz                               RADDAT
     D fromPgm         S                   like(i_fromPgm ) inz                               RADDAT
     D msg             DS                  likeds(o_msg   ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHSNDPM                                                               RADDAT
     D callStkE        S                   like(i_fromProc  ) inz                             RADDAT
     D callStkCtr      S             10I 0                    inz                             RADDAT
     D callStkEQ       DS                  qualified                                          RADDAT
     D  module                 1     10A                      inz                             RADDAT
     D  program               11     20A                      inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... message key
 B01     if  %parms >= p_msgKey;
            CEETSTA(isPresent: p_msgKey: *omit);
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            msgKey = i_msgKey;
 X01     else;
            msgKey = '';
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... stack counter                                                               //RADDAT
 B01     if  %parms >= p_fromStkC;                                                          //RADDAT
            CEETSTA(isPresent: p_fromStkC: *omit);                                          //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromStkC = i_fromStkC;                                                          //RADDAT
 X01     else;
            fromStkC = cMsg_Same;                                                           //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... from procedure
 B01     if  %parms >= p_fromProc;                                                          //RADDAT
            CEETSTA(isPresent: p_fromProc: *omit);                                          //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromProc = i_fromProc;                                                          //RADDAT
 X01     else;
            fromProc = cMsg_toMySelf;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... from module
 B01     if  %parms >= p_fromMod;                                                           //RADDAT
            CEETSTA(isPresent: p_fromMod: *omit);                                           //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromMod  = i_fromMod;                                                           //RADDAT
 X01     else;
            fromMod  = '*NONE';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... from program                                                                //RADDAT
 B01     if  %parms >= p_fromPgm;                                                           //RADDAT
            CEETSTA(isPresent: p_fromPgm: *omit);                                           //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            fromPgm  = i_fromPgm;                                                           //RADDAT
 X01     else;
            fromPgm  = '*NONE';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set values to call QMHRMVPM API:                                                //RADDAT
         // Call stack counter ...                                                          //RADDAT
 B01     select;                                                                            //RADDAT
         // ... *ALLINACT                                                                   //RADDAT
         when   fromStkC = cMsg_AllInact;                                                   //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
            fromProc   = '*ALLINACT';                                                       //RADDAT
         // ... *EXT                                                                        //RADDAT
         when   fromStkC = cMsg_Ext;                                                        //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
            fromProc   = '*EXT';                                                            //RADDAT
         // ... *PERVIOUS                                                                   //RADDAT
         when   fromStkC = cMsg_Prv;                                                        //RADDAT
            callStkCtr = 1;                                                                 //RADDAT
         // ... *SAME                                                                       //RADDAT
         when   fromStkC = cMsg_Same;                                                       //RADDAT
            callStkCtr = 0;                                                                 //RADDAT
         // ... sonst                                                                       //RADDAT
 X01     other;                                                                             //RADDAT
            callStkCtr = fromStkC;                                                          //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // From procedure ...                                                              //RADDAT
 B01     select;                                                                            //RADDAT
         // ... *                                                                           //RADDAT
         when   fromProc = cMsg_ToMyself;                                                   //RADDAT
            callStkE   = '*';                                                               //RADDAT
            // ... add 1 to skip f_rcvPgmMsg() stack entry                                  //RADDAT
            callStkCtr = callStkCtr + 1;                                                    //RADDAT
         // ... *EXT                                                                        //RADDAT
         when   fromProc = '*EXT';                                                          //RADDAT
            callStkE   = '*EXT';                                                            //RADDAT
         // ... *ALLINACT                                                                   //RADDAT
         when   fromProc = '*ALLINACT';                                                     //RADDAT
            callStkE   = '*ALLINACT';                                                       //RADDAT
         // ... named procedure                                                             //RADDAT
 X01     other;                                                                             //RADDAT
            callStkE   = fromProc;                                                          //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // From module ...                                                                 //RADDAT
         callStkEQ.module  = fromMod;                                                       //RADDAT
                                                                                            //RADDAT
         // From program ...                                                                //RADDAT
         callStkEQ.program = fromPgm;                                                       //RADDAT
                                                                                            //RADDAT
         // Initialize error code ...                                                       //RADDAT
         errCode = f_newApiErrCode(cFalse);                                                 //RADDAT
                                                                                            //RADDAT
         // Finally remove the message ...
         QMHRMVPM(callStkE: callStkCtr: msgKey: i_msgToRemove: errCode:
                  %len(%trimR(callStkE)): callStkEQ: '*NO');                                //RADDAT
                                                                                            //RADDAT
         // Check API error code                                                            //RADDAT
 B01     if  f_isApiError(errCode);                                                         //RADDAT
            msg = f_cvtApiErrCodeToMsg(errCode);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            msg = f_newMsg(cMsg_ID_OK);                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P p_rmvPgmMsg...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves the message text of a given message.                                       RADDAT
      *  Replaces substitution variables with message data.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msg         - The message to retrieve the text from.                              RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msgText       - The message text that was retrieved from                            RADDAT
      *                   the given message.                                                  RADDAT
      *=========================================================================              RADDAT
     P f_rtvMsgText...                                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvMsgText...                                                                        RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msgText         S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msg           C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D msg             DS                  likeds(o_msg       ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D rtvm0100        DS                  likeds(rtvm0100_t  ) based(pRtvm0100)              RADDAT
     D qMsgF           DS                  likeds(qObj_t      ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         // Retrieve message information                                                    //RADDAT
         qMsgF.name = i_msg.file;                                                           //RADDAT
         qMsgF.lib  = i_msg.lib;                                                            //RADDAT
         pRtvm0100  = lf_rtvMsgD('RTVM0100':
                                 i_msg.ID: %trimR(i_msg.data): qMsgF: msg:
                                 '*YES': '*NO');                                            //RADDAT
                                                                                            //RADDAT
         // Retrieve message text from message information                                  //RADDAT
 B01     if   pRtvm0100 <> *NULL;                                                           //RADDAT
 B02        if   rtvm0100.lenMsgRet > 0;                                                    //RADDAT
               msgText = %subst(rtvm0100: 25: rtvm0100.lenMsgRet);                          //RADDAT
               dealloc(N) pRtvm0100;                                                        //RADDAT
 X02        else;                                                                           //RADDAT
               msgText = '';                                                                //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            msgText = '';                                                                   //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msgText;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvMsgText...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves the message help text of a given message.                                  RADDAT
      *  Replaces substitution variables with message data.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msg         - The message to retrieve the help text from.                         RADDAT
      *   i_rtnCtrlChr  - Specifies whether the control characters are                        RADDAT
      *                   returned or not.                                                    RADDAT
      *                   cMsg_RtnCtrlChar_Yes - Return control characters                    RADDAT
      *                   cMsg_RtnCtrlChar_No  - Do not return control characters             RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msgText       - The message help text that was retrieved from                       RADDAT
      *                   the given message.                                                  RADDAT
      *=========================================================================              RADDAT
     P f_rtvMsgHelpText...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvMsgHelpText...                                                                    RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  i_rtnCtrlChr                 10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msgHelpText     S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rtnCtrlChr    C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D rtnCtrlChr      S                   like(i_rtnCtrlChr  ) inz                           RADDAT
     D msg             DS                  likeds(o_msg       ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qMsgF           DS                  likeds(qObj_t      ) inz                           RADDAT
     D rtvm0100        DS                  likeds(rtvm0100_t  ) based(pRtvm0100)              RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... rtnCtrlChr                                                                  //RADDAT
 B01     if   %parms >= p_rtnCtrlChr;                                                       //RADDAT
            CEETSTA(isPresent: p_rtnCtrlChr: *omit);                                        //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            rtnCtrlChr = i_rtnCtrlChr;                                                      //RADDAT
 X01     else;                                                                              //RADDAT
            rtnCtrlChr = '*NO';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve message information                                                    //RADDAT
         qMsgF.name = i_msg.file;                                                           //RADDAT
         qMsgF.lib  = i_msg.lib;                                                            //RADDAT
         pRtvm0100  = lf_rtvMsgD('RTVM0100':
                                 i_msg.ID: %trimR(i_msg.data): qMsgF: msg:
                                 '*YES': rtnCtrlChr);                                       //RADDAT
                                                                                            //RADDAT
         // Retrieve message help text from message information                             //RADDAT
 B01     if   pRtvm0100 <> *NULL;                                                           //RADDAT
 B02        if   rtvm0100.lenHlpRet > 0;                                                    //RADDAT
               msgHelpText = %subst(rtvm0100: 25 + rtvm0100.lenMsgRet:
                                    rtvm0100.lenHlpRet);                                    //RADDAT
               dealloc(N) pRtvm0100;                                                        //RADDAT
 X02        else;                                                                           //RADDAT
               msgHelpText = '';                                                            //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            msgHelpText = '';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msgHelpText;                                                              //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvMsgHelpText...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves the message text of a given message.                                       RADDAT
      *  Does not replaces substitution variables with message data.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msg         - The message to retrieve the text from.                              RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msgText       - The message text that was retrieved from                            RADDAT
      *                   the given message.                                                  RADDAT
      *=========================================================================              RADDAT
     P f_rtvMsgTextRaw...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvMsgTextRaw...
     D                 PI          4096A          varying                                     RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msgText         S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msg           C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D msg             DS                  likeds(o_msg       ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D rtvm0100        DS                  likeds(rtvm0100_t  ) based(pRtvm0100)              RADDAT
     D qMsgF           DS                  likeds(qObj_t      ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         // Retrieve message information                                                    //RADDAT
         qMsgF.name = i_msg.file;                                                           //RADDAT
         qMsgF.lib  = i_msg.lib;                                                            //RADDAT
         pRtvm0100  = lf_rtvMsgD('RTVM0100':
                                 i_msg.ID: %trimR(i_msg.data): qMsgF: msg:
                                 '*NO': '*NO');
                                                                                            //RADDAT
         // Retrieve message text from message information                                  //RADDAT
 B01     if   pRtvm0100 <> *NULL;                                                           //RADDAT
 B02        if   rtvm0100.lenMsgRet > 0;                                                    //RADDAT
               msgText = %subst(rtvm0100: 25: rtvm0100.lenMsgRet);                          //RADDAT
               dealloc(N) pRtvm0100;                                                        //RADDAT
 X02        else;                                                                           //RADDAT
               msgText = '';                                                                //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            msgText = '';                                                                   //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msgText;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvMsgTextRaw...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves the message help text of a given message.                                  RADDAT
      *  Does not replaces substitution variables with message data.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_msg         - The message to retrieve the help text from.                         RADDAT
      *   i_rtnCtrlChr  - Specifies whether the control characters are                        RADDAT
      *                   returned or not.                                                    RADDAT
      *                   cMsg_RtnCtrlChar_Yes - Return control characters                    RADDAT
      *                   cMsg_RtnCtrlChar_No  - Do not return control characters             RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msgText       - The message help text that was retrieved from                       RADDAT
      *                   the given message.                                                  RADDAT
      *=========================================================================              RADDAT
     P f_rtvMsgHelpTextRaw...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvMsgHelpTextRaw...                                                                 RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  i_rtnCtrlChr                 10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msgHelpText     S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rtnCtrlChr    C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D rtnCtrlChr      S                   like(i_rtnCtrlChr  ) inz                           RADDAT
     D msg             DS                  likeds(o_msg       ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qMsgF           DS                  likeds(qObj_t      ) inz                           RADDAT
     D rtvm0100        DS                  likeds(rtvm0100_t  ) based(pRtvm0100)              RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... rtnCtrlChr                                                                  //RADDAT
 B01     if   %parms >= p_rtnCtrlChr;                                                       //RADDAT
            CEETSTA(isPresent: p_rtnCtrlChr: *omit);                                        //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            rtnCtrlChr = i_rtnCtrlChr;                                                      //RADDAT
 X01     else;                                                                              //RADDAT
            rtnCtrlChr = '*NO';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve message information                                                    //RADDAT
         qMsgF.name = i_msg.file;                                                           //RADDAT
         qMsgF.lib  = i_msg.lib;                                                            //RADDAT
         pRtvm0100  = lf_rtvMsgD('RTVM0100':
                                 i_msg.ID: %trimR(i_msg.data): qMsgF: msg:
                                 '*NO': rtnCtrlChr);
                                                                                            //RADDAT
         // Retrieve message help text from message information                             //RADDAT
 B01     if   pRtvm0100 <> *NULL;                                                           //RADDAT
 B02        if   rtvm0100.lenHlpRet > 0;                                                    //RADDAT
               msgHelpText = %subst(rtvm0100: 25 + rtvm0100.lenMsgRet:
                                    rtvm0100.lenHlpRet);                                    //RADDAT
               dealloc(N) pRtvm0100;                                                        //RADDAT
 X02        else;                                                                           //RADDAT
               msgHelpText = '';                                                            //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            msgHelpText = '';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msgHelpText;                                                              //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvMsgHelpTextRaw...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a received message of format RCVM0200 to a message.                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_rcvm0200    - Format RCVM0200 of the received message.
      *   i_type        - The message type.                                                   RADDAT
      *                   Default:        cMsg_Info                                           RADDAT
      *
      *  Returns:
      *   msg           - Message as message structure
      *=========================================================================              RADDAT
     P f_cvtRcvMsgToMsg...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_cvtRcvMsgToMsg...                                                                    RADDAT
     D                 PI                         likeds(msg_t     )                          RADDAT
     D  i_rcvm0200                         const  likeds(rcvm0200_t)
     D  i_type                             const  like(msg_t.type  )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_type          C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D type            S                   like(i_type      ) inz
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz
      *                                                                                       RADDAT
      *  Helper fields
     D msgID           S                   like(msg_t.ID    ) inz                             RADDAT
     D msgData         S                   like(msg_t.data  ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... Type                                                                        //RADDAT
 B01     if  %parms >= p_type;                                                              //RADDAT
            CEETSTA(isPresent: p_type: *omit);                                              //RADDAT
 X01     else;
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  isPresent = 1;                                                                 //RADDAT
            type = i_type;                                                                  //RADDAT
 X01     else;
 B02        select;                                                                         //RADDAT
            when (i_rcvm0200.msgType = '01');   // Completion                               //RADDAT
               type = cMsg_Comp;                                                            //RADDAT
            when (i_rcvm0200.msgType = '02');   // Diagnostic                               //RADDAT
               type = cMsg_Diag;                                                            //RADDAT
            when (i_rcvm0200.msgType = '04');   // Informational                            //RADDAT
               type = cMsg_Info;                                                            //RADDAT
            when (i_rcvm0200.msgType = '05');   // Inquery                                  //RADDAT
               type = cMsg_Inq;                                                             //RADDAT
            when (i_rcvm0200.msgType = '06');   // Sender's copy                            //RADDAT
               type = cMsg_Copy;                                                            //RADDAT
            when (i_rcvm0200.msgType = '08');   // Request                                  //RADDAT
               type = cMsg_Rqs;                                                             //RADDAT
            when (i_rcvm0200.msgType = '10');   // Request with prompting                   //RADDAT
               type = cMsg_Rqs;                                                             //RADDAT
            when (i_rcvm0200.msgType = '14');   // Notify                                   //RADDAT
               type = cMsg_Notify;                                                          //RADDAT
            when (i_rcvm0200.msgType = '15');   // Escape                                   //RADDAT
               type = cMsg_Escape;                                                          //RADDAT
            when (i_rcvm0200.msgType = '16');   // Notify, exception not handled when API is c//RADD
               type = cMsg_Notify;                                                          //RADDAT
            when (i_rcvm0200.msgType = '17');   // Escape, exception not handled when API is c//RADD
               type = cMsg_Escape;                                                          //RADDAT
            when (i_rcvm0200.msgType = '21');   // Reply, not validity checked              //RADDAT
               type = cMsg_Rpy;                                                             //RADDAT
            when (i_rcvm0200.msgType = '22');   // Reply, validity checked                  //RADDAT
               type = cMsg_Rpy;                                                             //RADDAT
            when (i_rcvm0200.msgType = '23');   // Reply, message default used              //RADDAT
               type = cMsg_Rpy;                                                             //RADDAT
            when (i_rcvm0200.msgType = '24');   // Reply, system default used               //RADDAT
               type = cMsg_Rpy;                                                             //RADDAT
            when (i_rcvm0200.msgType = '25');   // Reply, from system reply list            //RADDAT
               type = cMsg_Rpy;                                                             //RADDAT
            when (i_rcvm0200.msgType = '26');   // Reply, from exit program                 //RADDAT
               type = cMsg_Rpy;                                                             //RADDAT
 X02        other;                                                                          //RADDAT
               type = cMsg_Info;                                                            //RADDAT
 E02        endsl;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if i_rcvm0200.lnRplDtR = 0;
            msgData = '';                                                                   //RADDAT
 X01     else;
            msgData = %subst(i_rcvm0200.value: 1: i_rcvm0200.lnRplDtR);                     //RADDAT
 E01     endif;

 B01     if i_rcvm0200.msgID = '';                                                          //RADDAT
            msgID = cMSG_ID_NULL;                                                           //RADDAT
 X01     else;                                                                              //RADDAT
            msgID = i_rcvm0200.msgID;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(msgID: msgData: type
                        : i_rcvm0200.msgF: i_rcvm0200.msgLU);
                                                                                            //RADDAT
         return   msg;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_cvtRcvMsgToMsg...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the sender information of a receives program message.                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_rcvm0200    - Format RCVM0200 of the received message.                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   sndInf        - Sender information of the received message.                         RADDAT
      *=========================================================================              RADDAT
     P f_getSndInfOfRcvMsg...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getSndInfOfRcvMsg...                                                                 RADDAT
     D                 PI                         likeds(sndInf_t  )                          RADDAT
     D  i_rcvm0200                         const  likeds(rcvm0200_t)                          RADDAT
     D  o_longSndPgm                256A          options(*nopass: *omit)                     RADDAT
     D  o_longSndPrc                256A          options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D sndInf          DS                  likeds(sndInf_t  ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_longSndPgm    C                   const(2)                                           RADDAT
     D p_longSndPrc    C                   const(3)                                           RADDAT
     D p_msg           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D longSndPgm      S                   like(o_longSndPgm) inz                             RADDAT
     D longSndPrc      S                   like(o_longSndPrc) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D memSize         S             10I 0 inz                                                RADDAT
     D rcvm0300        DS                  likeds(rcvm0300_t) based(pRcvm0300 )               RADDAT
     D tmpSndInf       DS                  likeds(sndInf_t  )                                 RADDAT
     D                                     based(pTmpSndInf)                                  RADDAT
     D tmpLongSndPgm   S                   like(o_longSndPgm)                                 RADDAT
     D                                     based(pTmpLongSndPgm)                              RADDAT
     D tmpLongSndPrc   S                   like(o_longSndPrc)                                 RADDAT
     D                                     based(pTmpLongSndPrc)                              RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         memSize   = %size(rcvm0300) + 1024;                                                //RADDAT
         pRcvm0300 = %alloc(memSize);                                                       //RADDAT
         errCode   = f_newApiErrCode(cFalse);                                               //RADDAT
                                                                                            //RADDAT
 B01     dou (rcvm0300.bytRet >= rcvm0300.bytAvl or f_isApiError(errCode));                 //RADDAT
            QMHRCVPM(rcvm0300: memSize: 'RCVM0300': '*': 0:
                     cMsg_Any: i_rcvm0200.msgKey: 0: cMsg_Act_Same: errCode);               //RADDAT
 B02        if (rcvm0300.bytRet < rcvm0300.bytAvl);                                         //RADDAT
               memSize   = rcvm0300.bytAvl;                                                 //RADDAT
               pRcvm0300 = %realloc(pRcvm0300: memSize);                                    //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check API error code                                                            //RADDAT
 B01     if  f_isApiError(errCode);                                                         //RADDAT
            msg = f_cvtApiErrCodeToMsg(errCode);                                            //RADDAT
            clear sndInf;                                                                   //RADDAT
            clear longSndPgm;                                                               //RADDAT
            clear longSndPrc;                                                               //RADDAT
 X01     else;                                                                              //RADDAT
            msg = f_newMsg(cMsg_ID_OK);                                                     //RADDAT
            pTmpSndInf = %addr(rcvm0300) +
                         %size(rcvm0300) +
                         rcvm0300.lenRplDataR +
                         rcvm0300.lenMsgR +
                         rcvm0300.lenMsgHlpR;                                               //RADDAT
            pTmpLongSndPgm = pTmpSndInf + tmpSndInf.ofsSndPgmLName;                         //RADDAT
            pTmpLongSndPrc = pTmpSndInf + tmpSndInf.ofsSndPrcLName;                         //RADDAT
            sndInf     = tmpSndInf;                                                         //RADDAT
            longSndPgm = %subst(tmpLongSndPgm: 1: tmpSndInf.lenSndPgmLName);                //RADDAT
            longSndPrc = %subst(tmpLongSndPrc: 1: tmpSndInf.lenSndPrcLName);                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         dealloc(N) pRcvm0300;                                                              //RADDAT
                                                                                            //RADDAT
         // Set optional output parameters                                                  //RADDAT
 B01     if (%parms() >= p_longSndPgm and %addr(o_longSndPgm) <> *NULL);                    //RADDAT
            o_longSndPgm = longSndPgm;                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (%parms() >= p_longSndPrc and %addr(o_longSndPrc) <> *NULL);                    //RADDAT
            o_longSndPrc = longSndPrc;                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if (%parms() >= p_msg);                                                            //RADDAT
 B02        if (%addr(o_msg) <> *NULL);                                                     //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return sndInf;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getSndInfOfRcvMsg...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** Private ***                                                                      RADDAT
      *  Get application message file name                                                    RADDAT
      *=========================================================================              RADDAT
     P lf_getAppMsgFileName...                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_getAppMsgFileName...                                                                RADDAT
     D                 PI            10A                                                      RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D appMsgFileName  S             10A   inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if  g_qAppMsgFile.name = '';                                                       //RADDAT
            appMsgFileName = 'QCPFMSG';                                                     //RADDAT
 X01        else;                                                                           //RADDAT
            appMsgFileName = g_qAppMsgFile.name;                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   appMsgFileName;                                                           //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_getAppMsgFileName...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** Private ***                                                                      RADDAT
      *  Get application message file library name                                            RADDAT
      *=========================================================================              RADDAT
     P lf_getAppMsgFileLibrary...                                                             RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_getAppMsgFileLibrary...                                                             RADDAT
     D                 PI            10A                                                      RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D appMsgFileLib   S             10A   inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if  g_qAppMsgFile.name = '';                                                       //RADDAT
            appMsgFileLib = '*LIBL';                                                        //RADDAT
 X01        else;                                                                           //RADDAT
            appMsgFileLib = g_qAppMsgFile.lib;                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   appMsgFileLib;                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_getAppMsgFileLibrary...                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** Private ***                                                                      RADDAT
      *  Set application message file name                                                    RADDAT
      *=========================================================================              RADDAT
     P lp_setAppMsgFileName...                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lp_setAppMsgFileName...                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_file                       10A   const                                              RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         g_qAppMsgFile.name = i_file;                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lp_setAppMsgFileName...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** Private ***                                                                      RADDAT
      *  Set application message file library name                                            RADDAT
      *=========================================================================              RADDAT
     P lp_setAppMsgFileLibrary...                                                             RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lp_setAppMsgFileLibrary...                                                             RADDAT
     D                 PI                                                                     RADDAT
     D  i_lib                        10A   const                                              RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         g_qAppMsgFile.lib = i_lib;                                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lp_setAppMsgFileLibrary...                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** Private ***                                                                      RADDAT
      *  Retrieve message description                                                         RADDAT
      *=========================================================================              RADDAT
     P lf_rtvMsgD...                                                                          RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_rtvMsgD...                                                                          RADDAT
     D                 PI              *                                                      RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_msgID                       7A   const                                              RADDAT
     D  i_rplData                  4096A   const  varying                                     RADDAT
     D  i_qMsgF                            const  likeds(qObj_t    )                          RADDAT
     D  o_msg                                     likeds(msg_t     )                          RADDAT
     D  i_rplVars                    10A   const  options(*nopass)                            RADDAT
     D  i_rtnCtrlChr                 10A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMsgInf         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rplVars       C                   const(6)                                           RADDAT
     D p_rtnCtrlChr    C                   const(7)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D rplVars         S                   like(i_rplVars   ) inz                             RADDAT
     D rtnCtrlChr      S                   like(i_rtnCtrlChr) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D msgInf          DS                  based(pMsgInf) qualified                           RADDAT
     D  bytRet                       10I 0                                                    RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
     D memSize         S             10I 0 inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... rplvars                                                                     //RADDAT
 B01     if   %parms >= p_rplvars;                                                          //RADDAT
            rplvars = i_rplvars;                                                            //RADDAT
 X01     else;                                                                              //RADDAT
            rplvars = '*YES';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... rtnCtrlChr                                                                  //RADDAT
 B01     if   %parms >= p_rtnCtrlChr;                                                       //RADDAT
            rtnCtrlChr = i_rtnCtrlChr;                                                      //RADDAT
 X01     else;                                                                              //RADDAT
            rtnCtrlChr = '*NO';                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Allocate memory and set initial parameter values                                //RADDAT
         memSize = 8;                                                                       //RADDAT
         pMsgInf = %alloc(memSize);                                                         //RADDAT
         errCode = f_newApiErrCode(cTrue);                                                  //RADDAT
                                                                                            //RADDAT
         // Loop until complete message information is received ...                         //RADDAT
 B01     dou   msgInf.bytRet >= msgInf.bytAvl;                                              //RADDAT
            // ... call the API                                                             //RADDAT
            QMHRTVM(msgInf: memSize: i_format: i_msgID: i_qMsgF:
                    i_rplData: %len(i_rplData): rplVars: rtnCtrlChr: errCode);              //RADDAT
                                                                                            //RADDAT
            // ... check for errors                                                         //RADDAT
 B02        if  f_isApiError(errCode);                                                      //RADDAT
               dealloc(N) pMsgInf;                                                          //RADDAT
               o_msg = f_cvtApiErrCodeToMsg(errCode);                                       //RADDAT
               leave;                                                                       //RADDAT
 X02        else;                                                                           //RADDAT
               // ... get more memory                                                       //RADDAT
 B03           if   memSize < msgInf.bytAvl;                                                //RADDAT
                  memSize = msgInf.bytAvl;                                                  //RADDAT
                  pMsgInf = %realloc(pMsgInf: memSize);                                     //RADDAT
 X03           else;                                                                        //RADDAT
                  o_msg = f_newMsg(cMsg_ID_OK);                                             //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return   pMsgInf;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_rtvMsgD...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R2  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R2 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - API Error Handling       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R2  - SrvPgm: Basic Routines - API Error Handling           *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  08.02.2006  Th.Raddatz    Changed BASICS1R2 to be compatible to    *                 RADDAT
      *                            V5R1M0.                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *  08.01.2007  Th.Raddatz    Fixed problem in f_cvtErrnoToMsg().      *                 RADDAT
      *                            Now errors without corresponding         *                 RADDAT
      *                            message description in QC2MSGF are       *                 RADDAT
      *                            returned as CPF9898 message.             *                 RADDAT
      *                                                                     *                 RADDAT
      *  12.12.2007  Th.Raddatz    Enhanced f_cvtApiErrCodeToMsg() to       *                 RADDAT
      *                            receive the original error message from  *                 RADDAT
      *                            the previous call stack entry, if        *                 RADDAT
      *                            possible.                                *                 RADDAT
      *                                                                     *                 RADDAT
      *  16.07.2011  Th.Raddatz    Added procedure f_setErrno().            *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new API error code.                                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_monMsg      - Specifies whether API error conditions
      *                   are monitored or not.                                               RADDAT
      *                   Default:        cFalse                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   errCode       - The new API error code.                                             RADDAT
      *=========================================================================              RADDAT
     P f_newApiErrCode...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_newApiErrCode...                                                                     RADDAT
     D                 PI                         likeds(errCode_t )                          RADDAT
     D  i_monMsg                       N   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_monMsg        C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D monMsg          S                   like(i_monMsg    ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... monitor messages                                                            //RADDAT
 B01      if   %parms >= p_monMsg;                                                          //RADDAT
             monMsg = i_monMsg;                                                             //RADDAT
 X01      else;                                                                             //RADDAT
             monMsg = cFalse;                                                               //RADDAT
 E01      endif;                                                                            //RADDAT
                                                                                            //RADDAT
         // Produce API error code ...                                                      //RADDAT
         clear   errCode;                                                                   //RADDAT
 B01     if   monMsg = cTrue;                                                               //RADDAT
            errCode.bytPrv = %size(errCode);                                                //RADDAT
 X01     else;                                                                              //RADDAT
            errCode.bytPrv = 0;                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   errCode;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_newApiErrCode...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Is API error?                                                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_errCode     - The error code returned from the API call.                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isError       - Returns cTrue in case of an API error.                              RADDAT
      *=========================================================================              RADDAT
     P f_isApiError...                                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_isApiError...                                                                        RADDAT
     D                 PI              N                                                      RADDAT
     D  i_errCode                      N   const  likeds(errCode_t )                          RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isError         S               N   inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if   i_errCode.bytAvl > 0;                                                         //RADDAT
            isError = cTrue;                                                                //RADDAT
 X01     else;                                                                              //RADDAT
            isError = cFalse;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   isError;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_isApiError...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts an API error code to a messsage.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_errCode     - The error code returned from the API call.                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msg           - The error message.                                                  RADDAT
      *=========================================================================              RADDAT
     P f_cvtApiErrCodeToMsg...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_cvtApiErrCodeToMsg...                                                                RADDAT
     D                 PI                         like(msg_t     )                            RADDAT
     D  i_errCode                      N   const  likeds(errCode_t )                          RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D tmpMsg          DS                  likeds(msg_t     ) inz                             RADDAT
     D rcvm0200        DS                  likeds(rcvm0200_t) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if   i_errCode.bytAvl = 0;                                                         //RADDAT
            msg = f_newMsg(cMSG_ID_OK);                                                     //RADDAT
 X01     else;                                                                              //RADDAT
            msg = f_newMsg(i_errCode.excID: i_errCode.excDta: cMsg_Escape:
                           'QCPFMSG' : '*LIBL');                                            //RADDAT
            // Try to get the user error message from the previous                          //RADDAT
            // call stack entry                                                             //RADDAT
            rcvm0200 = f_rcvPgmMsg(cMsg_Any: *omit: cMsg_Act_Same: 0: cMsg_Prv);
            tmpMsg = f_cvtRcvMsgToMsg(rcvm0200: cMsg_Escape);                               //RADDAT
 B02        if (i_errCode.excID = tmpMsg.ID);                                               //RADDAT
               msg = tmpMsg;                                                                //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msg;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_cvtApiErrCodeToMsg...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the C runtime error number.                                                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   errno         - The C runtime error number.                                         RADDAT
      *=========================================================================              RADDAT
     P f_errno...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_errno...                                                                             RADDAT
     D                 PI            10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D errorNo         S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D runTimeError    S             10I 0 based(pRunTimeError)                               RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         pRunTimeError = errno();                                                           //RADDAT
                                                                                            //RADDAT
         errorNo = runTimeError;                                                            //RADDAT
                                                                                            //RADDAT
         return   errorNo;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_errno...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the C runtime error number to ZERO (no error).                                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P f_clrErrno...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_clrErrno...                                                                          RADDAT
     D                 PI                                                                     RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         f_setErrno(0);                                                                     //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_clrErrno...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets the C runtime error number to a given error code.                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_errno       - A C runtime error number.                                           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P f_setErrno...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_setErrno...                                                                          RADDAT
     D                 PI                                                                     RADDAT
     D  i_errno                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D runTimeError    S             10I 0 based(pRunTimeError)                               RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         pRunTimeError = errno();                                                           //RADDAT
         runTimeError = i_errno;                                                            //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_setErrno...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the message text of a C runtime error number.                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_errno       - The C runtime error number returned by                              RADDAT
      *                   the f_errno()-function.                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   errText       - The message text of the error number.                               RADDAT
      *=========================================================================              RADDAT
     P f_strerror...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_strerror...                                                                          RADDAT
     D                 PI           128A          varying                                     RADDAT
     D  i_errno                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D errText         S            128A   inz  varying                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D pErrText        S               *   inz                                                RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
         pErrText = strerror(i_errno);                                                      //RADDAT
 B01     if   pErrText = *NULL;                                                             //RADDAT
            errText = '';                                                                   //RADDAT
 X01     else;                                                                              //RADDAT
            errText = %str(pErrText);                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   errText;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_strerror...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a C runtime error number to a message.                                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_errno       - The C runtime error number returned by                              RADDAT
      *                   the f_errno()-function.                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   msg           - The error message.                                                  RADDAT
      *=========================================================================              RADDAT
     P f_cvtErrnoToMsg...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_cvtErrnoToMsg...                                                                     RADDAT
     D                 PI                         like(msg_t     )                            RADDAT
     D  i_errno                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      /if not defined(*V5R3M0)                                                                RADDAT
     D msgID           DS                  qualified                                          RADDAT
     D  prefix                        3A                                                      RADDAT
     D  nbr                           4S 0                                                    RADDAT
      /endif                                                                                  RADDAT
      *                                                                                       RADDAT
     D qMsgF           DS                  likeds(qObj_t    ) inz                             RADDAT
     D msgInf          DS                  qualified                                          RADDAT
     D  bytRet                       10I 0 inz                                                RADDAT
     D  bytAvl                       10I 0 inz                                                RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------*                   RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if   i_errno = 0;                                                                  //RADDAT
            msg = f_newMsg(cMSG_ID_OK);                                                     //RADDAT
 X01     else;                                                                              //RADDAT
      /if not defined(*V5R3M0)                                                              //RADDAT
            msgID.prefix = 'C2M';                                                           //RADDAT
            msgID.nbr    = i_errno;                                                         //RADDAT
            msg.ID = msgID;                                                                 //RADDAT
      /else                                                                                 //RADDAT
            msg.ID.prefix = 'C2M';                                                          //RADDAT
            msg.ID.nbr    = i_errno;                                                        //RADDAT
      /endif                                                                                //RADDAT
            qMsgF.name = 'QC2MSGF';                                                         //RADDAT
            qMsgF.lib  = '*LIBL';                                                           //RADDAT
            errCode = f_newApiErrCode(cTrue);                                               //RADDAT
            QMHRTVM(msgInf: %size(msgInf): 'RTVM0100': msg.ID: qMsgF:
                    '': 0: '*NO': '*NO': errCode);                                          //RADDAT
 B02        if not f_isApiError(errCode);                                                   //RADDAT
               msg   = f_newMsg(msg.ID
                                : ''
                                : cMsg_Escape: 'QC2MSGF': '*LIBL');                         //RADDAT
 X02        else;                                                                           //RADDAT
               msg   = f_newMsg('CPF9898'
                                : %char(i_errno) + ': ' + f_strerror(i_errno)
                                : cMsg_Escape: 'QCPFMSG': '*LIBL');                         //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   msg;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_cvtErrnoToMsg...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R3  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R3 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Strings                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R3  - SrvPgm: Basic Routines - Strings                      *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  26.01.2005  Th.Raddatz    Changed f_val to use self-written code   *
      *                            instead of MI function cvtefnd().        *
      *                            cvtefnd() crashes when it encounters an  *
      *                            invalid character.                       *
      *                                                                     *                 RADDAT
      *  10.02.2005  Th.Raddatz    Added f_center() to center a string.     *                 RADDAT
      *                                                                     *                 RADDAT
      *  10.02.2005  Th.Raddatz    Added f_alignR() to right align a        *                 RADDAT
      *                            given string.                            *                 RADDAT
      *                                                                     *                 RADDAT
      *  10.02.2005  Th.Raddatz    Changed f_space() to accept a 0 length.  *                 RADDAT
      *                                                                     *                 RADDAT
      *  15.02.2005  Th.Raddatz    Fixed problem in f_addQuotes() that      *                 RADDAT
      *                            added to many leading and trailing       *                 RADDAT
      *                            quotes.                                  *                 RADDAT
      *                            Changed f_rmvQuotes() to removes quotes  *                 RADDAT
      *                            only in case it is a quoted string.      *                 RADDAT
      *                            String must have a leading *and* a       *                 RADDAT
      *                            trailing quote.                          *                 RADDAT
      *                                                                     *                 RADDAT
      *  15.02.2005  Th.Raddatz    Added f_genStrCmp() and                  *                 RADDAT
      *                            f_genStrCmpIgncase() to compare strings  *                 RADDAT
      *                            using wildcard characters.               *                 RADDAT
      *                                                                     *                 RADDAT
      *  17.02.2005  Th.Raddatz    Added f_scanR() to a string for the      *                 RADDAT
      *                            latest occurrence of a search argument.  *
      *                                                                     *                 RADDAT
      *  24.02.2005  Th.Raddatz    Added f_cvtBufferToHexString() to        *                 RADDAT
      *                            convert a buffer to a hex string.        *                 RADDAT
      *                                                                     *                 RADDAT
      *  25.02.2005  Th.Raddatz    Added f_cvtHexStringToBuffer() to        *                 RADDAT
      *                            convert a hex string to a buffer.        *                 RADDAT
      *                                                                     *                 RADDAT
      *  28.02.2005  Th.Raddatz    Changed parameter i_string of            *                 RADDAT
      *                            f_wordWrap() to VARYING. Enhanced        *                 RADDAT
      *                            f_wordWrap() tp support end-of-paragraph *                 RADDAT
      *                            marker.                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *  17.06.2005  Th.Raddatz    Added f_startsWith().                    *                 RADDAT
      *                                                                     *                 RADDAT
      *  28.06.2006  Th.Raddatz    Fixed problem in f_wordwrap() that       *                 RADDAT
      *                            EOL-character was not found when it was  *                 RADDAT
      *                            the last character in the string.        *                 RADDAT
      *                                                                     *                 RADDAT
      *  20.11.2007  Th.Raddatz    Added f_endsWith().                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  21.12.2007  Th.Raddatz    Added f_containsInvalidCharAt() and      *                 RADDAT
      *                            f_containsStringAt().                    *                 RADDAT
      *                                                                     *                 RADDAT
      *  17.12.2008  Th.Raddatz    Added f_objName().                       *                 RADDAT
      *                                                                     *                 RADDAT
      *  15.01.2009  Th.Raddatz    Added f_rplUnPrtChars().                 *                 RADDAT
      *                                                                     *                 RADDAT
      *  15.01.2009  Th.Raddatz    Added f_rplUnPrtChars().                 *                 RADDAT
      *                                                                     *                 RADDAT
      *  23.01.2009  Th.Raddatz    Added f_formatDate() and f_parseDate().  *                 RADDAT
      *                            Changed parameter i_quote of             *                 RADDAT
      *                            f_addQuotes() from 'required' to         *                 RADDAT
      *                            'optional'.                              *                 RADDAT
      *                            Added f_formatMemSize().                 *                 RADDAT
      *                                                                     *                 RADDAT
      *  02.02.2009  Th.Raddatz    Fixed problem in f_wordwrap() that       *                 RADDAT
      *                            caused a runtime error in case that the  *                 RADDAT
      *                            last character of the input string is an *                 RADDAT
      *                            EOP escape character.                    *                 RADDAT
      *                                                                     *                 RADDAT
      *  24.06.2009  Th.Raddatz    Fixed problem in f_genStrCmp() that      *                 RADDAT
      *                            does not properly compare strings        *                 RADDAT
      *                            that contain multiple dots.              *                 RADDAT
      *                                                                     *                 RADDAT
      *  03.04.2010  Th.Raddatz    Added f_cvtPtrToHexString().             *                 RADDAT
      *                                                                     *                 RADDAT
      *  22.01.2010  Th.Raddatz    Added f_startsWithIgnoreCase().          *                 RADDAT
      *                                                                     *                 RADDAT
      *  07.04.2015  Th.Raddatz    Replaced f_genStrCmp() with a more       *
      *                            reliable approach.                       *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
      /COPY QBASICS1,H_SPEC                                                                   RADDAT
      /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,PBASICS1R3
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,CEELIB
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Converts a RPG variable type to a variable class of the edit APIs.                   RADDAT
     D lf_cvtRpgVarTypeToEdtAPIVarClass...                                                    RADDAT
     D                 PR            10A                                                      RADDAT
     D                                     extproc(
     D                                     'lf_cvtRpgVarTypeToEdtAPIVarClass')
     D  i_varType                     1A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Performs word wrapping on a given string without respect to                          RADDAT
      *  end-of-paragraph markers.                                                            RADDAT
     D lf_wordWrap...                                                                         RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('lf_wordWrap')
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_width                      10U 0 const                                              RADDAT
     D  io_startPos                  10U 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Compare strings using wildcard characters. (Compare generic)                         RADDAT
     D lf_genStrCmpInternal...
     D                 PR              N                                                      RADDAT
     D                                     extproc('lf_genStrCmpInternal')
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_pattern                  4096A   const   varying                                    RADDAT
     D  i_wildcard                    2A   const   options(*nopass)
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
     D cOPEN_PARENTHESIS...                                                                   RADDAT
     D                 C                   const('(')                                         RADDAT
     D cCLOSE_PARENTHESIS...                                                                  RADDAT
     D                 C                   const(')')                                         RADDAT
     D cSINGLE_QUOTE...                                                                       RADDAT
     D                 C                   const('''')                                        RADDAT
      *                                                                                       LOSTAN
     D cEQUAL_TRUE     C                   const('1')                                         LOSTAN
     D cEQUAL_FALSE    C                   const('0')                                         LOSTAN
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the left portion of a string.                                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to return the left portion of.                           RADDAT
      *   i_length      - The length of the left portion to return.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The left portion if the string.                                     RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_left...                                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_left...                                                                              RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D leftString      S           4096A   varying  inz                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D length          S                   like(i_length  )  inz                              RADDAT
     D start           S                   like(i_length  )  inz                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if   i_length <= %len(i_string);                                                   //RADDAT
            length = i_length;                                                              //RADDAT
         else;                                                                              //RADDAT
            length = %len(i_string);                                                        //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         start = 1;                                                                         //RADDAT
                                                                                            //RADDAT
         leftString = %subst(i_string: start: length);                                      //RADDAT
                                                                                            //RADDAT
         return   leftString;                                                               //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_left...                                                                              RADDAT
     P                 E                                                                      RADDAT
      *
      *=========================================================================
      *  Returns the sub string that starts at a given position.                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to return the left portion of.                           RADDAT
      *   i_start       - Start position of the sub string.
      *   i_length      - The length of the sub string to return.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The sub string.
      *=========================================================================
     P f_mid...
     P                 B                   export
     D                 PI          4096A           varying
     D  i_string                   4096A   const   varying
     D                                             options(*varsize)
     D  i_start                      10I 0 const
     D  i_length                     10I 0 const   options(*nopass: *omit)
      *
      *  Definieren Funktionswert
     D rtnString       S           4096A   varying  inz
      *
      *  Parameterpositionen
     D p_length        c                   3
      *
      *  Definieren Arbeitsfelder
     D maxLength       s             10i 0 inz
     D length          s                   like(i_length) inz
     D msgText         s            256A   varying inz
     D msg             ds                  likeds(msg_t) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      /free

         if (%parms() >= p_length and %addr(i_length) <> *NULL);
            length = i_length;
         else;
            length = *HIVAL;
         endif;

         if (i_start > %len(i_string) + 1 or i_start < 1);
            msgText = 'Start position is out of range: ' + %char(i_start);
            f_sndPgmMsg(f_newMsg(
                  'CPF9898': msgText: cMsg_Escape: 'QCPFMSG'): cMsg_Prv);
         endif;

         if (i_start + length - 1 > %len(i_string));
            length = %len(i_string) - i_start + 1;
         endif;

         if (length < 0);
            msgText = 'Length is out of range: ' + %char(i_length);
            f_sndPgmMsg(f_newMsg(
                  'CPF9898': msgText: cMsg_Escape: 'QCPFMSG'): cMsg_Prv);
         endif;

         if (length = 0);
            return '';
         endif;

         rtnString = %subst(i_string: i_start: length);

         return rtnString;

      /end-free
     P                 E
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Tests if the specified string starts with the specified prefix.                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_prefix      - The prefix.                                                         RADDAT
      *   i_string      - The string that is tested.                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   startsWith    - Returns TRUE if the string starts with the prefix,                  RADDAT
      *                   else FALSE.                                                         RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_startsWith...                                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_startsWith...                                                                        RADDAT
     D                 PI              N                                                      RADDAT
     D  i_prefix                   4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D startsWith      S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if (%len(i_string) = 0  or
             %len(i_prefix) = 0  or
             %len(i_string) < %len(i_prefix));                                              //RADDAT
            return cFalse;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (%subst(i_string: 1: %len(i_prefix)) <> i_prefix);                              //RADDAT
            return cFalse;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return cTrue;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_startsWith...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Tests if the specified string starts with the specified prefix,                      RADDAT
      *  ignoring case considerations.                                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_prefix      - The prefix.                                                         RADDAT
      *   i_string      - The string that is tested.                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   startsWith    - Returns TRUE if the string starts with the prefix,                  RADDAT
      *                   else FALSE.                                                         RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_startsWithIgnoreCase...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_startsWithIgnoreCase...                                                              RADDAT
     D                 PI              N                                                      RADDAT
     D  i_prefix                   4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D startsWith      S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if (%len(i_string) = 0  or
             %len(i_prefix) = 0  or
             %len(i_string) < %len(i_prefix));                                              //RADDAT
            return cFalse;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (f_lcase(%subst(i_string: 1: %len(i_prefix))) <> f_lcase(i_prefix));            //RADDAT
            return cFalse;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return cTrue;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_startsWithIgnoreCase...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the right portion of a string.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to return the right portion of.
      *   i_length      - The length of the right portion to return.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The right portion if the string.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_right...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_right...                                                                             RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rightString     S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D length          S                   like(i_length  )  inz                              RADDAT
     D start           S                   like(i_length  )  inz                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if   i_length <= %len(i_string);                                                   //RADDAT
            length = i_length;                                                              //RADDAT
         else;                                                                              //RADDAT
            length = %len(i_string);                                                        //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         start = %len(i_string) - length + 1;                                               //RADDAT
                                                                                            //RADDAT
         rightString = %subst(i_string: start: length);                                     //RADDAT
                                                                                            //RADDAT
         return   rightString;                                                              //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_right...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Tests if the specified string ends with the specified suffix.                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_suffix      - The suffix.                                                         RADDAT
      *   i_string      - The string that is tested.                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   endsWith      - Returns TRUE if the string ends with the suffix,                    RADDAT
      *                   else FALSE.                                                         RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_endsWith...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_endsWith...                                                                          RADDAT
     D                 PI              N                                                      RADDAT
     D  i_suffix                   4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D endsWith        S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if %len(i_string) = 0  or
            %len(i_suffix) = 0  or
            %len(i_string) < %len(i_suffix);                                                //RADDAT
            return endsWith;                                                                //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if %subst(i_string
                   : %len(i_string) - %len(i_suffix) + 1) = i_suffix;                       //RADDAT
            endsWith = cTrue;                                                               //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   endsWith;                                                                 //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_endsWith...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Produces an empty string.                                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_length      - The length of the string to produce.
      *   i_char        - The fill char of the string.
      *                   Default:        *BLANKS                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The new string initialized with i_char.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_space...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_space...                                                                             RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_char                        1A   const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D spaceString     S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_char          C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D tmpStr          S           4096A                     inz                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(i_length >= 0:
                  'i_length is out of range. It must be less than ' +
                  %editc(%size(tmpStr): 'N'));                                              //RADDAT
                                                                                            //RADDAT
         if i_length = 0;
            spaceString = '';
         else;
            if   %parms >= p_char;
               memset(%addr(tmpStr): f_ebcdic(i_char): i_length);
            else;
               memset(%addr(tmpStr): f_ebcdic(' ')   : i_length);
            endif;

            spaceString = %subst(tmpStr: 1: i_length);
         endif;
                                                                                            //RADDAT
         return   spaceString;                                                              //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_space...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a given string to lower case.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to convert to lower case.                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string converted to lower case.                                 RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_lcase...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_lcase...                                                                             RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Fields for QlgConvertCase API                                                        RADDAT
     D stringBuf       S           4096A             inz                                      RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
     D reqCtrlBlk      DS                  qualified                                          RADDAT
     D  type                         10I 0                                                    RADDAT
     D  CCSID                        10I 0                                                    RADDAT
     D  case                         10I 0                                                    RADDAT
     D  reserved                     10A                                                      RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
                                                                                            //RADDAT
         if   i_string <> '';                                                               //RADDAT
            reqCtrlBlk.type     = cCVTCASE_TYPE_ccsid;                                      //RADDAT
            reqCtrlBlk.CCSID    = cCVTCASE_CCSID_Job;                                       //RADDAT
            reqCtrlBlk.case     = cCVTCASE_toLower;                                         //RADDAT
            reqCtrlBlk.reserved = *ALLx'00';                                                //RADDAT
            errCode = f_newApiErrCode(cFalse);                                              //RADDAT
            QlgConvertCase(reqCtrlBlk:
                           i_string: stringBuf: %len(i_string): errCode);                   //RADDAT
            string = %subst(stringBuf: 1: %len(i_string));                                  //RADDAT
         else;                                                                              //RADDAT
            string = i_string;                                                              //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   string;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_lcase...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a given string to upper case.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to convert to upper case.                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string converted to upper case.                                 RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_ucase...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_ucase...                                                                             RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Fields for QlgConvertCase API                                                        RADDAT
     D stringBuf       S           4096A             inz                                      RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
     D reqCtrlBlk      DS                  qualified                                          RADDAT
     D  type                         10I 0                                                    RADDAT
     D  CCSID                        10I 0                                                    RADDAT
     D  case                         10I 0                                                    RADDAT
     D  reserved                     10A                                                      RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
                                                                                            //RADDAT
         if   i_string <> '';                                                               //RADDAT
            reqCtrlBlk.type     = cCVTCASE_TYPE_ccsid;                                      //RADDAT
            reqCtrlBlk.CCSID    = cCVTCASE_CCSID_Job;                                       //RADDAT
            reqCtrlBlk.case     = cCVTCASE_toUpper;                                         //RADDAT
            reqCtrlBlk.reserved = *ALLx'00';                                                //RADDAT
            errCode = f_newApiErrCode(cFalse);                                              //RADDAT
            QlgConvertCase(reqCtrlBlk:
                           i_string: stringBuf: %len(i_string): errCode);                   //RADDAT
            string = %subst(stringBuf: 1: %len(i_string));                                  //RADDAT
         else;                                                                              //RADDAT
            string = i_string;                                                              //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   string;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_ucase...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Replaces all occurences of a search argument by                                      RADDAT
      *  a replacement string in a given string.                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_searchArg   - The argument that is replaced by the replacement                    RADDAT
      *                   string.                                                             RADDAT
      *   i_rplString   - The replacement string that replaces the search                     RADDAT
      *                   argument.                                                           RADDAT
      *   i_string      - The string that contains the search argument.                       RADDAT
      *   i_startPos    - The position where to start from.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string having the search argument replaced with                 RADDAT
      *                   the replacement string.                                             RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_replace...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_replace...                                                                           RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_searchArg                4096A   const  varying                                     RADDAT
     D  i_rplString                4096A   const  varying                                     RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_startPos                   10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_startPos      C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Standardwerte fr nicht bergebene Parameter                                         RADDAT
     D startPos        S                   like(i_startPos) inz                               RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D X               S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if   %parms >= p_startPos;                                                         //RADDAT
            startPos = i_startPos;                                                          //RADDAT
         else;                                                                              //RADDAT
            startPos = 1;                                                                   //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         string = i_string;                                                                 //RADDAT
                                                                                            //RADDAT
         x = %scan(i_searchArg: string: startPos);                                          //RADDAT
         dow   x > 0;                                                                       //RADDAT
            string = %replace(i_rplString: string: x: %len(i_searchArg));                   //RADDAT
            x = x + %len(i_rplString);                                                      //RADDAT
            if   x <= %len(string);                                                         //RADDAT
               x = %scan(i_searchArg: string: x);                                           //RADDAT
            else;                                                                           //RADDAT
               leave;                                                                       //RADDAT
            endif;                                                                          //RADDAT
         enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return   string;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_replace...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the EBCDIC value of a given character.                                       RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_char        - The fill char to return the EBCDIC value of.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   ebcdic        - The EBCDIC value of i_char.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_ebcdic...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_ebcdic...                                                                            RADDAT
     D                 PI             3U 0                                                    RADDAT
     D  i_char                        1A   const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D ebcdic          DS                  qualified                                          RADDAT
     D  char                   1      1A                                                      RADDAT
     D  integer                1      1U 0                                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         ebcdic.char = i_char;                                                              //RADDAT
                                                                                            //RADDAT
         return   ebcdic.integer;                                                           //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_ebcdic...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================
      *  Returns the numeric value of a string.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - A string representing a numeric value.                              RADDAT
      *   i_decPoint    - The decimal point symbol.                                           RADDAT
      *   i_comma       - The comma symbol.                                                   RADDAT
      *   i_curSym      - The currency symbol.                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   value         - The numeric value of i_string.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_val...                                                                               RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_val...                                                                               RADDAT
     D                 PI             8F                                                      RADDAT
     D  i_string                     64A   const  varying                                     RADDAT
     D  i_decPoint                    1A   const  options(*nopass)                            RADDAT
     D  i_comma                       1A   const  options(*nopass)                            RADDAT
     D  i_curSym                      1A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D value           S              8F   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_decPoint      C                   const(2)                                           RADDAT
     D p_comma         C                   const(3)                                           RADDAT
     D p_curSym        C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D mask            DS                  qualified                                          RADDAT
     d  curSym                        1A   inz                                                RADDAT
     D  comma                         1A   inz                                                RADDAT
     D  decPoint                      1A   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields to determine the decimal point and comma                               RADDAT
     D refVal          C                   const(1000,5)                                      RADDAT
     D refStr          S              7A   inz      static                                    RADDAT
     D dft_comma       S              1A   inz      static                                    RADDAT
     D dft_decPoint    S              1A   inz      static                                    RADDAT
     D dft_curSym      S              1A   inz      static                                    RADDAT
      *                                                                                       RADDAT
      *  Helper fields:                                                                       RADDAT
      *  Result data structure                                                                RADDAT
     D                 ds                                                                     RADDAT
     D result                        30s 9 inz(0)                                             RADDAT
     D resultAsString                30a   overlay(result)                                    RADDAT
      *                                                                                       RADDAT
      *  The parts of the result                                                              RADDAT
     D digits          s             30a   varying inz('')                                    RADDAT
     D fraction        s             30a   varying inz('')                                    RADDAT
     D isFraction      S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D is1NumDigit     S               N   inz(cFalse)                                        RADDAT
     D stringLen       S             10I 0 inz                                                RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D c1              S              1A   inz                                                RADDAT
     D c2              S              2A   inz                                                RADDAT
     D sign            S              1A   inz                                                RADDAT
     D digit1Pos       S             10I 0 inz                                                RADDAT
     D fract1Pos       S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Determine comma and decimal point                                                ///RADD
         if   refStr = '';                                                                  //RADDAT
            refStr = %editc(refVal: '1');                                                   //RADDAT
            dft_comma    = %subst(refStr: 2: 1) ;                                           //RADDAT
            dft_decPoint = %subst(refStr: 6: 1) ;                                           //RADDAT
            dft_curSym   = '$';                                                             //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... decimal point                                                               //RADDAT
         if  %parms >= p_decPoint;                                                          //RADDAT
            mask.decPoint = i_decPoint;                                                     //RADDAT
         else;                                                                              //RADDAT
            mask.decPoint = dft_decPoint;                                                   //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... comma                                                                       //RADDAT
         if  %parms >= p_comma;                                                             //RADDAT
            mask.comma = i_comma;                                                           //RADDAT
         else;                                                                              //RADDAT
            mask.comma = dft_comma;                                                          ///RADD
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... currency symbol                                                             //RADDAT
         if  %parms >= p_curSym;                                                            //RADDAT
            mask.curSym = i_curSym;                                                         //RADDAT
         else;                                                                              //RADDAT
            mask.curSym = dft_curSym;                                                       //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
                                                                                            //RADDAT
         // Initialize                                                                      //RADDAT
         is1NumDigit = cFalse;                                                              //RADDAT
         isFraction  = cFalse;                                                              //RADDAT
         digits      = '';                                                                  //RADDAT
         fraction    = '';                                                                  //RADDAT
         stringLen   = %len(%trimr(i_string));                                              //RADDAT
                                                                                            //RADDAT
         // Spin through input data                                                         //RADDAT
         for x = 1 to stringLen;                                                            //RADDAT
                                                                                            //RADDAT
            // get character of current position                                            //RADDAT
            c1 = %subst(i_string: x: 1);                                                    //RADDAT
                                                                                            //RADDAT
            // get possible CR sign                                                         //RADDAT
            if   x < stringLen;                                                             //RADDAT
               c2 = %subst(i_string: x: 2);                                                 //RADDAT
               c2 = %xlate('cr':'CR': c2);                                                  //RADDAT
            else;                                                                           //RADDAT
               c2 = '';                                                                     //RADDAT
            endif;                                                                          //RADDAT
                                                                                            //RADDAT
            select;                                                                         //RADDAT
            // Ignore BLANKS and currency symbol                                            //RADDAT
            when   (c1 = '') or (c1 = mask.curSym);                                         //RADDAT
               // if we did not yet got a numeric character
               if   not is1NumDigit;                                                        //RADDAT
                  // ... then ignore BLANKS and currency symbol                             //RADDAT
                  iter;                                                                     //RADDAT
               else;                                                                        //RADDAT
                  // ... else cancel processing                                             //RADDAT
                  leave;                                                                    //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
            // Ignore decimal point                                                         //RADDAT
            when   (c1 = mask.decPoint);                                                    //RADDAT
               is1NumDigit = cTrue;                                                         //RADDAT
               iter;                                                                        //RADDAT
                                                                                            //RADDAT
            // Switch do decimal positions                                                  //RADDAT
            when   (c1 = mask.comma);                                                       //RADDAT
               // If we did not yet got decimal positions, ...                              //RADDAT
               if   not isFraction;                                                         //RADDAT
                  // ... then switch to decimal positions                                   //RADDAT
                  isFraction  = cTrue;                                                      //RADDAT
                  is1NumDigit = cTrue;                                                      //RADDAT
                  iter;                                                                     //RADDAT
               else;                                                                        //RADDAT
                  // cancel processing                                                      //RADDAT
                  leave;                                                                    //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
            // Remember sign '+'/'-', leading or trailing                                   //RADDAT
            when   (c1 = '+')  or (c1 = '-');                                               //RADDAT
               // if we did not yet hit the sign                                            //RADDAT
               if   sign = '';                                                              //RADDAT
                  // ... then remember the sign                                             //RADDAT
                  sign        = c1;                                                         //RADDAT
                  is1NumDigit = cTrue;                                                      //RADDAT
                  iter;                                                                     //RADDAT
               else;                                                                        //RADDAT
                  // ... else cancel processing                                             //RADDAT
                  leave;                                                                    //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
            // Remember sign 'CR', always trailing                                          //RADDAT
            when   c2 = 'CR';                                                               //RADDAT
               // if we did not yet hit the sign and if                                     //RADDAT
               // we already got a numeric digit                                            //RADDAT
               if   (sign = '') and is1NumDigit;                                            //RADDAT
                  // ... then remember the sign                                             //RADDAT
                  sign      = '-';                                                          //RADDAT
                  x         = x + 1;                                                        //RADDAT
                  iter;                                                                     //RADDAT
               else;                                                                        //RADDAT
                  // ... else cancel processing                                             //RADDAT
                  leave;                                                                    //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
            // Process digits                                                               //RADDAT
            when   (c1 >= '0') and (c1 <= '9');                                             //RADDAT
               // If we did switched to decimal positions, ...                              //RADDAT
               if   isFraction;                                                             //RADDAT
                  // ... then add digit to decimal portion                                  //RADDAT
                  fraction = fraction + c1;                                                 //RADDAT
               else;                                                                        //RADDAT
                  // ... else add digit to integer portion                                  //RADDAT
                  if   (digits = ' ') and (c1 = '0');                                       //RADDAT
                     // ignore '0'                                                          //RADDAT
                  else;                                                                     //RADDAT
                     digits = digits + c1;                                                  //RADDAT
                  endif;                                                                    //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
               is1NumDigit = cTrue;                                                         //RADDAT
               iter;                                                                        //RADDAT
                                                                                            //RADDAT
            // invalid characters                                                           //RADDAT
            other;                                                                          //RADDAT
               // cancel processing                                                         //RADDAT
               leave;                                                                       //RADDAT
            endsl;                                                                          //RADDAT
                                                                                            //RADDAT
         endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Strip trailling *BLANKS and '0' of decimal portion                              //RADDAT
         %len(fraction) = %checkr('0 ': fraction);                                          //RADDAT
                                                                                            //RADDAT
         // Make sure that the fraction does not exceed the limit                           //RADDAT
         p_assert(%decpos(result) >= %len(fraction):                                        //RADDAT
                  'Numeric value contains too many fraction digits');                       //RADDAT
                                                                                            //RADDAT
         // Make sure that we did not get to many digits                                    //RADDAT
         p_assert((%len(result) - %decpos(result)) >= %len(digits):
                  'Number of significant digits allowed exceeded');                         //RADDAT
                                                                                            //RADDAT
         // Put the result together                                                         //RADDAT
         fract1Pos = %len(result) - %decpos(result) + 1;                                    //RADDAT
         digit1Pos = fract1Pos - %len(digits);                                              //RADDAT
                                                                                            //RADDAT
         %subst(resultAsString: digit1Pos: %len(digits  )) = digits;                        //RADDAT
         %subst(resultAsString: fract1Pos: %len(fraction)) = fraction;                      //RADDAT
                                                                                            //RADDAT
         // Finally set the sign accordingly                                                //RADDAT
         if   sign = '-';                                                                   //RADDAT
            value = result * -1;                                                            //RADDAT
         else;                                                                              //RADDAT
            value = result;                                                                 //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   value;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_val...                                                                               RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Performs word wrapping on a given string.                                            RADDAT
      *  Returns the next line of i_string with each call to f_wordWrap().                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to be word wrapped.                                      RADDAT
      *   i_width       - Line length.                                                        RADDAT
      *   io_startPos   - The position to start from.                                         RADDAT
      *                   (Should not be changed between calls.)                              RADDAT
      *   i_option      - Options to set.                                                     RADDAT
      *                   Default:        cWORDWRAP_PARAGRAPH_NONE +                          RADDAT
      *                                   cWORDWRAP_PARAGRAPH_TRIMR
      *                   cWORDWRAP_PARAGRAPH_NONE   Do not respect                           RADDAT
      *                                              end-of-paragraph markers.                RADDAT
      *                   cWORDWRAP_PARAGRAPH_MSGD   Respect end-of-paragraph                 RADDAT
      *                                              markers of message descriptions:         RADDAT
      *                                              &N, &B and &P.                           RADDAT
      *                   cWORDWRAP_PARAGRAPH_TEXT   Respect standard text                    RADDAT
      *                                              end-of-paragraph markers: \n             RADDAT
      *                   cWORDWRAP_PARAGRAPH_TRIMR  Remove trailing blanks from
      *                                              result string.                           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   text          - The next line of i_string.                                          RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_wordWrap...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_wordWrap...                                                                          RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_width                      10U 0 const                                              RADDAT
     D  io_startPos                  10U 0                                                    RADDAT
     D  i_options                    10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D text            S           4096A   inz    varying                                     RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_options       C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D options         S                   like(i_options) inz                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D theEOP          DS                  qualified
     D  isFound                        N   inz(cFalse)
     D  position                     10I 0
     D  string                        2A   varying
     D x               S             10I 0                     inz
     D tmpEOP          S              2A   varying             inz                            RADDAT
     D numEOP          S             10I 0                     inz                            RADDAT
     D EOP             S                   like(tmpEOP) dim(3) inz                            RADDAT
     D ESC             S              1A                                                      RADDAT
     D startPos        S                   like(io_startPos  ) inz                            RADDAT
     D string          S                   like(i_string     ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(i_width >= 1:
                  'i_width is out of range. It must be greater than 0');                    //RADDAT
                                                                                            //RADDAT
         p_assert(io_startPos >= 1 and io_startPos <= %len(i_string):
                  'io_startPos is out of range. It must be greater than 0 -
                   and less than the length of i_string');                                  //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... options                                                                     //RADDAT
         if %parms >= p_options;                                                            //RADDAT
            options = i_options;                                                            //RADDAT
         else;                                                                              //RADDAT
            options = cWORDWRAP_PARAGRAPH_NONE +
                      cWORDWRAP_PARAGRAPH_TRIMR;
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // TRIM trailing blanks                                                            //RADDAT
         string = %trimR(i_string);                                                         //RADDAT
                                                                                            //RADDAT
         // Determine how to treat end-of-paragraph markers:                                //RADDAT
         select;                                                                            //RADDAT
         // ... do not respect end-of-paragraph marker                                      //RADDAT
         when f_isBitOn(cWORDWRAP_PARAGRAPH_NONE: options);                                 //RADDAT
            clear EOP;                                                                      //RADDAT
            clear ESC;                                                                      //RADDAT
            numEOP = 0;                                                                     //RADDAT
         // ... respect end-of-paragraph marker of message descriptions: &N, &P, &B         //RADDAT
         when f_isBitOn(cWORDWRAP_PARAGRAPH_MSGD: options);
            clear EOP;                                                                      //RADDAT
            EOP(1) = '&N';                                                                  //RADDAT
            EOP(2) = '&P';                                                                  //RADDAT
            EOP(3) = '&B';                                                                  //RADDAT
            ESC    = '&';                                                                   //RADDAT
            numEOP = 3;                                                                     //RADDAT
         // ... respect end-of-paragraph marker of text: \n                                 //RADDAT
         when f_isBitOn(cWORDWRAP_PARAGRAPH_TEXT: options);
            clear EOP;                                                                      //RADDAT
            EOP(1) = '\N';                                                                  //RADDAT
            ESC    = '\';                                                                   //RADDAT
            numEOP = 1;                                                                     //RADDAT
         endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // ---------------------------------------------------                             //RADDAT
         //  Perform word-wrap with no respect to                                           //RADDAT
         //  end-of-paragraph markers.                                                      //RADDAT
         // ---------------------------------------------------                             //RADDAT
         if numEOP = 0;                                                                     //RADDAT
            text = lf_wordWrap(string: i_width: io_startPos);                               //RADDAT
         else;                                                                              //RADDAT
         // ---------------------------------------------------                             //RADDAT
         //  Perform word-wrap with respect to                                              //RADDAT
         //  end-of-paragraph markers.                                                      //RADDAT
         // ---------------------------------------------------                             //RADDAT
                                                                                            //RADDAT
            // Find next end-of-paragraph marker                                            //RADDAT
            reset theEOP;
            theEOP.isFound = cFalse;
            theEOP.position = %scan(ESC: string: io_startPos);
            dow not theEOP.isFound and theEOP.position > 0;
               // If there is an escape character, ...                                      //RADDAT
               if %subst(string: theEOP.position: 1) = ESC;
                  // ... then check it against the list of EOP marker                       //RADDAT
                  for x = 1 to numEOP;
                     // If there is enough space for a EOP after the escape character       //RADDAT
                     // and if it is a known EOP, ...                                       //RADDAT
                     if theEOP.position <= %len(string) - %len(EOP(x)) + 1;                 //RADDAT
                        tmpEOP = %subst(string: theEOP.position: %len(EOP(x)));
                        if f_ucase(tmpEOP) = f_ucase(EOP(x));
                           // ... then set flag "EOP found"
                           theEOP.string  = EOP(x);
                           theEOP.isFound = cTrue;
                           leave;
                        endif;
                     endif;                                                                 //RADDAT
                  endfor;                                                                   //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
               if (not theEOP.isFound);                                                     //RADDAT
                  if (theEOP.position < %len(string));                                      //RADDAT
                     theEOP.position = %scan(ESC: string: theEOP.position + 1);             //RADDAT
                  else;                                                                     //RADDAT
                     theEOP.position = 0;                                                   //RADDAT
                  endif;                                                                    //RADDAT
               endif;                                                                       //RADDAT
            enddo;                                                                          //RADDAT
                                                                                            //RADDAT
            // If no end-of-paragraph marker is found, ...                                  //RADDAT
            if not theEOP.isFound;                                                          //RADDAT
               // ... then perform standard word wrap with no respect to EOP                //RADDAT
               text = lf_wordWrap(string: i_width: io_startPos);                            //RADDAT
            else;                                                                           //RADDAT
               // ... else perform word wrap for text portion                               //RADDAT
               //     before end-of-paragraph marker                                        //RADDAT
               if (theEOP.position - io_startPos) > 0;                                      //RADDAT
                  string   = %subst(string: io_startPos:
                                    theEOP.position - io_startPos);                         //RADDAT
                  startPos = 1;                                                             //RADDAT
                  text = lf_wordWrap(string: i_width: startPos);                            //RADDAT
               else;                                                                        //RADDAT
                  text = '';                                                                //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
               // If all we got is a EOP, ...                                               //RADDAT
               if (%len(text)    = %len(theEOP.string)   ) and
                  (f_ucase(text) = f_ucase(theEOP.string));
                  // ... then delete it                                                     //RADDAT
                  text = '';                                                                //RADDAT
               endif;                                                                       //RADDAT
               // Set new start position. Skip EOP if EOP                                   //RADDAT
               // caused new line.
               io_startPos = io_startPos + %len(text);
               if theEOP.position = io_startPos;
                  io_startPos = io_startPos + %len(theEOP.string);
               endif;
               // Set start position to 0 if new start position                             //RADDAT
               // exceeds maximum length of text.                                           //RADDAT
               if io_startPos > %len(i_string);                                             //RADDAT
                  io_startPos = 0;                                                          //RADDAT
               endif;                                                                       //RADDAT
            endif;                                                                          //RADDAT
                                                                                            //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // If the user requested to remove BLANKS, ...                                     //RADDAT
         if f_isBitOn(cWORDWRAP_PARAGRAPH_TRIMR: options);
            // ... then remove BLANKS.                                                      //RADDAT
            text = %trimR(text);
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   text;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_wordWrap...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Performs word wrapping on a given string without respect to                          RADDAT
      *  end-of-paragraph markers.                                                            RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_wordWrap...                                                                         RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_wordWrap...                                                                         RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_width                      10U 0 const                                              RADDAT
     D  io_startPos                  10U 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D text            S           4096A   inz    varying                                     RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D sPos            S             10I 0 inz                                                RADDAT
     D ePos            S             10I 0 inz                                                RADDAT
     D ePosConst       S             10I 0 inz                                                RADDAT
     D length          S             10I 0 inz                                                RADDAT
     D char            S              1A   inz                                                RADDAT
     D x               S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Valid separater characters                                                           RADDAT
     D cDELIMITER      C                   const(' -/\.:')                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialise helper fields                                                        //RADDAT
         text   = '';                                                                       //RADDAT
         sPos   = io_startPos;                                                              //RADDAT
         ePos   = 0;                                                                        //RADDAT
         length = 0;                                                                        //RADDAT
                                                                                            //RADDAT
         // Set range                                                                       //RADDAT
         ePos      = sPos + i_width;                                                        //RADDAT
         ePosConst = ePos;                                                                  //RADDAT
                                                                                            //RADDAT
         // If the end position is out of range ...                                         //RADDAT
         if   ePos > %len(i_string);                                                        //RADDAT
         // ... then                                                                        //RADDAT
         //     assume the last character to be the delimiter                               //RADDAT
            ePos = %len(i_string);                                                          //RADDAT
         else;                                                                              //RADDAT
         // ... else                                                                        //RADDAT
         //     look backwards for a deliniter.                                             //RADDAT
            dow   ePos >= sPos;                                                             //RADDAT
               char = %subst(i_string: ePos: 1);                                            //RADDAT
               // At position width + 1 ...
               if   ePos = ePosConst;                                                       //RADDAT
               // ... only BLANKS are allowed                                               //RADDAT
                  x = %check(' ': char);                                                    //RADDAT
               else;                                                                        //RADDAT
               // ... else every delimiter is allowed                                       //RADDAT
                  x = %check(cDELIMITER: char);                                             //RADDAT
               endif;
               // If there is a delimiter, ...                                              //RADDAT
               if   x = 0;                                                                  //RADDAT
               // ... then stop searching                                                   //RADDAT
                  leave;                                                                    //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
               ePos = ePos - 1;                                                             //RADDAT
            enddo;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // If there is no delimiter, ...                                                   //RADDAT
         if   ePos < sPos;                                                                  //RADDAT
         // ... then assume the last character to be the delimiter.                         //RADDAT
            ePos = sPos + i_width - 1;                                                      //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve text (incl. delimiter) ...                                             //RADDAT
         length = ePos - sPos + 1;
         text = %subst(i_string: sPos: length);
                                                                                            //RADDAT
         // ... and set new start position.                                                 //RADDAT
         sPos = sPos + length;                                                              //RADDAT
         if sPos <= %len(i_string);
            io_startPos = %check(' ': i_string: sPos);
         else;
            io_startPos = 0;
         endif;
                                                                                            //RADDAT
         return   text;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_wordWrap...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Transforms a numeric from its internal format to a                                   RADDAT
      *  character form suitable for displaying.                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pBuffer     - Address of the internal form of the numeric value.                  RADDAT
      *   i_digits      - Number of digits of the numeric value.                              RADDAT
      *   i_decPos      - Number of decimal positions of the numeric value.                   RADDAT
      *   i_varType     - Type of the numeric value.                                          RADDAT
      *   i_editCode    - Edit code used for translating the numeric value                    RADDAT
      *                   to a character string.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   fmtString     - Formatted string.                                                   RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_editCode...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_editCode...                                                                          RADDAT
     D                 PI            64A          varying                                     RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_decPos                     10I 0 const                                              RADDAT
     D  i_varType                    10A   const                                              RADDAT
     D  i_editCode                    2A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D fmtString       S             64A   varying  inz                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D editCode        S                   like(i_editCode)   inz                             RADDAT
     D isEditCode_X    S               N   inz(cFalse)                                        RADDAT
     D buffer          S             64A   based(i_pBuffer)                                   RADDAT
     D editMask        S            256A   inz                                                RADDAT
     D editMaskLen     S             10I 0 inz                                                RADDAT
     D rcvVar          S             64A   inz                                                RADDAT
     D rcvVarLen       S             10I 0 inz                                                RADDAT
     D zeroBalanceFillChar...                                                                 RADDAT
     D                 S              1A   inz                                                RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         editCode = i_editCode;                                                             //RADDAT
                                                                                            //RADDAT
         // Check whether edit code 'X' was specified or not.                               //RADDAT
         if %subst(editCode: 1: 1) = 'X';                                                   //RADDAT
            isEditCode_X = cTrue;                                                           //RADDAT
            %subst(editCode: 1: 1) = 'Z';                                                   //RADDAT
         else;                                                                              //RADDAT
            isEditCode_X = cFalse;                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Produce edit mask for the given edit code                                       //RADDAT
         errCode = f_newApiErrCode(cFalse);                                                 //RADDAT
                                                                                            //RADDAT
         QECCVTEC(editMask               :
                  editMaskLen            :
                  rcvVarLen              :
                  zeroBalanceFillChar    :
                  %subst(editCode: 1: 1) :
                  %subst(editCode: 2: 1) :
                  i_digits               :
                  i_decPos               :
                  errCode                );                                                 //RADDAT
                                                                                            //RADDAT
         // Translate the numeric value to a character string                               //RADDAT
         QECEDT(rcvVar                                      :
                rcvVarLen                                   :
                buffer                                      :
                lf_cvtRpgVarTypeToEdtAPIVarClass(i_varType) :
                i_digits                                    :
                editMask                                    :
                editMaskLen                                 :
                zeroBalanceFillChar                         :
                errCode                                     );                              //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         fmtString = %subst(rcvVar: 1: rcvVarLen);                                          //RADDAT
                                                                                            //RADDAT
         // Replace blanks with '0' if edit code 'X' was requested                          //RADDAT
         if isEditCode_X;                                                                   //RADDAT
            fmtString = %xlate(' ': '0': fmtString);                                        //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return fmtString;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_editCode...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Transforms a numeric from its internal format to a                                   RADDAT
      *  character form suitable for displaying.                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pBuffer     - Address of the internal form of the numeric value.                  RADDAT
      *   i_digits      - Number of digits of the numeric value.                              RADDAT
      *   i_varType     - Type of the numeric value.                                          RADDAT
      *   i_editWord    - Edit word used for translating the numeric value                    RADDAT
      *                   to a character string.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   fmtString     - Formatted string.                                                   RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_editWord...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_editWord...                                                                          RADDAT
     D                 PI           512A          varying                                     RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_varType                    10A   const                                              RADDAT
     D  i_editWord                  256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D fmtString       S            512A   varying  inz                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D buffer          S             64A   based(i_pBuffer)                                   RADDAT
     D editMask        S            256A   inz                                                RADDAT
     D editMaskLen     S             10I 0 inz                                                RADDAT
     D rcvVar          S            512A   inz                                                RADDAT
     D rcvVarLen       S             10I 0 inz                                                RADDAT
     D zeroBalanceFillChar...                                                                 RADDAT
     D                 S              1A   inz                                                RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         errCode = f_newApiErrCode(cFalse);                                                 //RADDAT
                                                                                            //RADDAT
         // Produce edit mask for the given edit mask                                       //RADDAT
         QECCVTEW(editMask         :
                  editMaskLen      :
                  rcvVarLen        :
                  i_editWord       :
                  %len(i_editWord) :
                  errCode          );                                                       //RADDAT
                                                                                            //RADDAT
         // Translate the numeric value to a character string                               //RADDAT
         QECEDT(rcvVar                                      :
                rcvVarLen                                   :
                buffer                                      :
                lf_cvtRpgVarTypeToEdtAPIVarClass(i_varType) :
                i_digits                                    :
                editMask                                    :
                editMaskLen                                 :
                X'00'                                       :
                errCode                                     );                              //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         fmtString = %subst(rcvVar: 1: rcvVarLen);                                          //RADDAT
                                                                                            //RADDAT
         return fmtString;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_editWord...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets the length of a the formatted string of a given edit code.                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_digits      - Number of digits of the numeric value.                              RADDAT
      *   i_decPos      - Number of decimal positions of the numeric value.                   RADDAT
      *   i_editCode    - Edit code used for translating the numeric value                    RADDAT
      *                   to a character string.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   length        - Length of the formatted string.                                     RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getLengthEditCode...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getLengthEditCode...                                                                 RADDAT
     D                 PI             5U 0                                                    RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_decPos                     10I 0 const                                              RADDAT
     D  i_editCode                    2A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D length          S              5U 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D buffZoned       S            128A   inz(*ALLx'F0')                                     RADDAT
     D fmtString       S             64A   inz    varying                                     RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         fmtString = f_editCode(%addr(buffZoned):
                                i_digits: i_decpos: 'S': i_editCode);                       //RADDAT
                                                                                            //RADDAT
         length = %len(fmtString);                                                          //RADDAT
                                                                                            //RADDAT
         return length;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getLengthEditCode...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets the length of a the formatted string of a given edit word.                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_digits      - Number of digits of the numeric value.                              RADDAT
      *   i_editWord    - Edit word used for translating the numeric value                    RADDAT
      *                   to a character string.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   length        - Length of the formatted string.                                     RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getLengthEditWord...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getLengthEditWord...                                                                 RADDAT
     D                 PI             5U 0                                                    RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_editWord                  256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D length          S              5U 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D buffZoned       S            128A   inz(*ALLx'F0')                                     RADDAT
     D fmtString       S            512A   inz    varying                                     RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         fmtString = f_editWord(%addr(buffZoned): i_digits: 'S': i_editWord);               //RADDAT
                                                                                            //RADDAT
         length = %len(fmtString);                                                          //RADDAT
                                                                                            //RADDAT
         return length;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getLengthEditWord...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes a keyword from a given string.                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_keyword     - The keyword to remove from the string.                              RADDAT
      *   i_string      - The given string.                                                   RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string without the keyword.                                     RADDAT
      *                                                                                       RADDAT
      *  Comment:                                                                             RADDAT
      *   i_string must start with the keyword with no leading spaces.                        RADDAT
      *   Otherwise the keyword is not removed from i_string.                                 RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_rmvKeyword...                                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rmvKeyword...                                                                        RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_keyword                   128A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying  inz                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         // If the keyword is there ...                                                     //RADDAT
         if f_left(i_string: %len(i_keyword)) = i_keyword;                                  //RADDAT
                                                                                            //RADDAT
            // If the string is longer than the keyword ...                                 //RADDAT
            if %len(i_string) > %len(i_keyword) + %len(cOPEN_PARENTHESIS )
 B02                                            + %len(cCLOSE_PARENTHESIS);                 //RADDAT
                                                                                            //RADDAT
               // ... strip the keyword from the string                                     //RADDAT
               string = %subst(i_string: %len(i_keyword) + 1);                              //RADDAT
                                                                                            //RADDAT
               // remove opening parenthesis                                                //RADDAT
               if f_left(string: 1) = cOPEN_PARENTHESIS;                                    //RADDAT
                  string = %subst(string: %len(cOPEN_PARENTHESIS) + 1);                     //RADDAT
               endif;                                                                       //RADDAT
                                                                                            //RADDAT
               // remove closing parenthesis                                                //RADDAT
               if f_right(string: 1) = cCLOSE_PARENTHESIS;                                  //RADDAT
                  string = f_left(string: %len(string) -
                                          %len(cCLOSE_PARENTHESIS));                        //RADDAT
               endif;                                                                       //RADDAT
            else;                                                                           //RADDAT
                                                                                            //RADDAT
               // ... clear the string                                                      //RADDAT
               string = '';                                                                 //RADDAT
            endif;                                                                          //RADDAT
                                                                                            //RADDAT
         else;                                                                              //RADDAT
            // ... return the string unchanged                                              //RADDAT
            string = i_string;                                                              //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rmvKeyword...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Removes quotes from a given string.                                                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The given string.                                                   RADDAT
      *   i_quote       - The quote to be removed from the string.                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string without quotes.                                          RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_rmvQuotes...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rmvQuotes...                                                                         RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_quote                       1A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying  inz                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         string = i_string;                                                                 //RADDAT

         if %len(string) >= 2;

            // If it is a quoted string ...
            if (f_left(string:  1) = i_quote) and
               (f_right(string: 1) = i_quote);

               if %len(string) = 2;
                  string = '';
               else;
                  // ... remove leading quote
                  string = %subst(string: 2);

                  // ... remove trailing quote
                  string = f_left(string: %len(string) - 1);

                  // ... turn 2 immediately following quotes into a quote
                  string = f_replace(i_quote + i_quote: i_quote: string);
               endif;

            endif;

         endif;

         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rmvQuotes...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Adds quotes to a given string.                                                       RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The given string.                                                   RADDAT
      *   i_quote       - The quote to be added to the string.                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The string with quotes.                                             RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_addQuotes...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_addQuotes...                                                                         RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_quote                       1A   const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying  inz                                       RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_quote         C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D quote           S                   like(i_quote) inz                                  RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         if (%parms() >= p_quote);                                                          //RADDAT
            quote = i_quote;                                                                //RADDAT
         else;                                                                              //RADDAT
            quote = cSINGLE_QUOTE;                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         string = i_string;                                                                 //RADDAT
                                                                                            //RADDAT
         // double single quotes                                                            //RADDAT
         string = f_replace(quote: quote + quote: string);                                  //RADDAT
                                                                                            //RADDAT
         // add leading quote                                                               //RADDAT
         string = quote + string;                                                           //RADDAT
                                                                                            //RADDAT
         // add trailing quote                                                              //RADDAT
         string = string + quote;                                                           //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_addQuotes...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** PRIVATE ***                                                                      RADDAT
      *  Converts a RPG variable type to a variable class of the edit APIs.                   RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_cvtRpgVarTypeToEdtAPIVarClass...                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_cvtRpgVarTypeToEdtAPIVarClass...                                                    RADDAT
     D                 PI            10A                                                      RADDAT
     D  i_varType                     1A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D varClass        S             10A   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D cZONED          C                   const('*ZONED')                                    RADDAT
     D cPACKED         C                   const('*PACKED')                                   RADDAT
     D cBINARY         C                   const('*BINARY')                                   RADDAT
     D cINTEGER        C                   const('*BINARY')                                   RADDAT
      *-------------------------------------------------------------------                    RADDAT
      /FREE
                                                                                            //RADDAT
         // Convert RPG type ...                                                            //RADDAT
         select;                                                                            //RADDAT
         // ... zoned                                                                       //RADDAT
         when i_varType = 'S';                                                              //RADDAT
            varClass = cZONED;                                                              //RADDAT
         // ... packed                                                                      //RADDAT
         when i_varType = 'P';                                                              //RADDAT
            varClass = cPACKED;                                                             //RADDAT
         // ... binary                                                                      //RADDAT
         when i_varType = 'B';                                                              //RADDAT
            varClass = cBINARY;                                                             //RADDAT
         // ... integer                                                                     //RADDAT
         when i_varType = 'I';                                                              //RADDAT
            varClass = cINTEGER;                                                            //RADDAT
         endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         return varClass;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_cvtRpgVarTypeToEdtAPIVarClass...                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Centers a string.                                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to be centered.                                          RADDAT
      *   i_length      - The length of the target field.                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The centered string.                                                RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_center...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_center...                                                                            RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10U 0 const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D centeredString  S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for not passed parameters                                                     RADDAT
     D length          S                   like(i_length  ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D spaces          S             10I 0 inz                                                RADDAT
     D string          S           4096A   varying   inz                                      RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if   %parms >= p_length;                                                           //RADDAT
            length = i_length;                                                              //RADDAT
         else;                                                                              //RADDAT
            length = %len(i_string);                                                        //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         string = %trim(i_string);
         spaces = %int((length - %len(string)) / 2);
                                                                                            //RADDAT
         if spaces < 0;
            centeredString = f_left(string: length);
         else;
            %len(centeredString) = length;
            centeredString = %replace(string: centeredString:
                                      spaces + 1: %len(string));
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   centeredString;                                                           //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_center...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Right aligns a string.                                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to be right aligned.                                     RADDAT
      *   i_length      - The length of the target field.                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - The right aligned string.                                           RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_alignR...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_alignR...                                                                            RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10U 0 const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D alignedString   S           4096A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_length        C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for not passed parameters                                                     RADDAT
     D length          S                   like(i_length  ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D spaces          S             10I 0 inz                                                RADDAT
     D string          S           4096A   varying   inz                                      RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if   %parms >= p_length;                                                           //RADDAT
            length = i_length;                                                              //RADDAT
         else;                                                                              //RADDAT
            length = %len(i_string);                                                        //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         string = %trim(i_string);
         spaces = length - %len(%trim(i_string));                                           //RADDAT
                                                                                            //RADDAT
         if spaces < 0;                                                                     //RADDAT
            alignedString = f_right(%trimR(i_string): length);                              //RADDAT
         else;                                                                              //RADDAT
            %len(alignedString) = length;
            alignedString = %replace(string: alignedString:
                                     spaces + 1: %len(string));
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   alignedString;                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_alignR...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Compare strings using wildcard characters. (Compare generic)                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to be compared with i_mask.                              RADDAT
      *   i_pattern     - Mask. Optionally containing wildcard characters.                    RADDAT
      *   i_wildcard    - Wildcard characters:                                                RADDAT
      *                   Position 1-1: Ignore group of characters. Default: *                RADDAT
      *                   Position 2-2: Ignore single character.    Default: ?                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isEqual       - Returns cTrue when the strings are equal.                           RADDAT
      *=========================================================================              RADDAT
     P f_genStrCmp...                                                                         RADDAT
     P                 B                   export                                             RADDAT
     D                 PI              N                                                      RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_pattern                  4096A   const   varying                                    RADDAT
     D  i_wildcard                    2A   const   options(*nopass)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               LOSTAN
      /FREE

         if (%len(i_pattern) = 0);
            return cEQUAL_TRUE;
         endif;

         return lf_genStrCmpInternal(i_string: i_pattern: i_wildcard);
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_genStrCmp...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Compare strings using wildcard characters. (Compare generic)                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to be compared with i_mask.                              RADDAT
      *   i_mask        - Mask. Optionally containing wildcard characters.                    RADDAT
      *   i_wildcard    - Wildcard characters:                                                RADDAT
      *                   Position 1-1: Ignore group of characters. Default: *                RADDAT
      *                   Position 2-2: Ignore single character.    Default: ?                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isEqual       - Returns cTrue when the strings are equal.                           RADDAT
      *=========================================================================              RADDAT
     P f_genStrCmpIgnCase...                                                                  RADDAT
     P                 B                   export                                             RADDAT
     D                 PI              N                                                      RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_mask                     4096A   const   varying                                    RADDAT
     D  i_wildcard                    2A   const   options(*nopass)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isEqual         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_wildcard      C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D string          S                   like(i_string) inz                                 RADDAT
     D mask            S                   like(i_mask  ) inz                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Convert everything to lower case                                                //RADDAT
         mask   = f_lcase(i_mask);                                                          //RADDAT
         string = f_lcase(i_string);                                                        //RADDAT
                                                                                            //RADDAT
         // Call generic string compare procedure                                           //RADDAT
         if   %parms >= p_wildcard;                                                         //RADDAT
            isEqual = f_genStrCmp(string: mask: i_wildcard);                                //RADDAT
         else;                                                                              //RADDAT
            isEqual = f_genStrCmp(string: mask);                                            //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isEqual;
                                                                                            //RADDAT
      /END-FREE
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Compare strings using wildcard characters. (Compare generic)                         RADDAT
      *=========================================================================              RADDAT
     P lf_genStrCmpInternal...
     P                 B
     D                 PI              N                                                      RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_pattern                  4096A   const   varying                                    RADDAT
     D  i_wildcard                    2A   const   options(*nopass)
      *                                                                                       LOSTAN
      *  Parameter positions                                                                  LOSTAN
     D p_wildcard      C                   const(3)                                           LOSTAN
      *                                                                                       LOSTAN
      *  Fields for optional parameters                                                       LOSTAN
     D wildcard        DS                  qualified                                          LOSTAN
     D  group                         1A   inz                                                LOSTAN
     D  single                        1A   inz                                                LOSTAN
      *                                                                                       LOSTAN
      *  Local fields
     D string          S                   like(i_string)
     D pattern         S                   like(i_pattern)
      *
     D genStrCmp       S              1A   inz                                                LOSTAN
     D strPos          S             10U 0 inz                                                LOSTAN
     D maskPos         S             10U 0 inz                                                LOSTAN
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               LOSTAN
      /FREE

         // Process optional parameter values ...
         // ... decimal point
         if (%parms() >= p_wildcard and %addr(i_wildcard) <> *NULL);
            wildcard = i_wildcard;
         else;
            wildcard.group  = '*';   // Ignore group of characters
            wildcard.single = '?';   // Ignore single character
         endif;

         string = i_string;
         pattern = i_pattern;

         if (%len(pattern) = %len(string) and pattern = string);
            return cEQUAL_TRUE;
         elseif (%len(string) = 0);
            if (%check(wildcard.group: pattern) = 0);
               return cEQUAL_TRUE;
            else;
               return cEQUAL_FALSE;
            endif;
         elseif (%len(pattern) = 0);
            if (%len(string) = 0);
               return cEQUAL_TRUE;
            else;
               return cEQUAL_FALSE;
            endif;
         elseif (pattern = wildcard.group);
            return cEQUAL_TRUE;
         elseif (f_startsWith(wildcard.single: pattern)); // ?
            return lf_genStrCmpInternal(f_mid(string: 2)
                                        : f_mid(pattern: 2)
                                        : wildcard);
         elseif (f_endsWith(wildcard.single: pattern));   // ?
            return lf_genStrCmpInternal(%subst(string: 1: %len(string) - 1)
                                        : %subst(pattern: 1: %len(pattern) - 1)
                                        : wildcard);
         elseif (f_startsWith(wildcard.group: pattern));  // *
            if (lf_genStrCmpInternal(string
                                     : f_mid(pattern: 2)
                                     : wildcard));
               return cEQUAL_TRUE;
            else;
               return lf_genStrCmpInternal(f_mid(string: 2)
                                           : pattern
                                           : wildcard);
            endif;
         elseif (f_endsWith(wildcard.group: pattern));    // *
            if (lf_genStrCmpInternal(string
                                     : %subst(pattern: 1: %len(pattern) - 1)
                                     : wildcard));
               return cEQUAL_TRUE;
            else;
               return lf_genStrCmpInternal(%subst(string: 1: %len(string) - 1)
                                  : pattern
                                  : wildcard);
            endif;
         elseif (%subst(pattern: 1: 1) = %subst(string: 1: 1));
               return lf_genStrCmpInternal(f_mid(string: 2)
                                           : f_mid(pattern: 2)
                                           : wildcard);
         endif;

         return cEQUAL_FALSE;

      /END-FREE
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the last position of a search argument in the source string.                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_searchArg   - The search argument that is searched in for.
      *   i_string      - The source string.
      *   i_start       - Start position.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   position      - Returns the start position of the search argument in
      *                   source string on success, else 0.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_scanR...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_scanR...
     D                 PI             5I 0                                                    RADDAT
     D  i_searchArg                4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_start                       5I 0 const   options(*nopass)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D position        S              5I 0 inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_start         C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D start           S                   like(i_start ) inz
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D x               S                   like(i_start ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if   %parms >= p_start;
            start = i_start;
         else;
            start = %len(i_string);
         endif;

         if %len(i_searchArg) > start;
            position = 0;
         else;
            x = start - %len(i_searchArg) + 1;
            dou (position > 0) or (x = 0);
               if %subst(i_string: x: %len(i_searchArg)) = i_searchArg;
                  position = x;
               endif;
               x = x - 1;
            enddo;
         endif;
                                                                                            //RADDAT
         return   position;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_scanR...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a given buffer to a character string of hex values.                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pBuffer     - Pointer to a buffer containing bytes.                               RADDAT
      *   i_size        - Size of buffer.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - Returns the character string of hex values                          RADDAT
      *                   of i_buffer.                                                        RADDAT
      *                                                                                       RADDAT
      *  Sample:                                                                              RADDAT
      *     When i_pBuffer points to a variable that contains 'Hello World',                  RADDAT
      *     then string is set to 'C88593939640E696999384'.                                   RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_cvtBufferToHexString...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_cvtBufferToHexString...                                                              RADDAT
     D                 PI          4096A           varying                                    RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_size                        5U 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value (as varying field)                                                      RADDAT
     D                 DS
     D string                      4096    varying
     D  str_length                    5U 0 overlay(string)
     D  str_data                   4096A   overlay(string: *next)
      *                                                                                       RADDAT
      *  Reference field                                                                      RADDAT
     D string_t        S           4096A   varying based(pDummy)                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert((i_size * 2) <= %size(str_data):
                  'Length of i_buffer exceeded maximum length allowed.');                   //RADDAT
                                                                                            //RADDAT
         p_assert(%size(string) = %size(string_t):
                  'Incorrect definition of structure ''string''.');                         //RADDAT
                                                                                            //RADDAT
         cvthc(%addr(str_data): i_pBuffer: i_size * 2);
         str_length = i_size * 2;
                                                                                            //RADDAT
         return   string;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_cvtBufferToHexString...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a given pointer to a character string of hex values.                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pointer     - Pointer that is converted to its string representation.             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - Returns the character string of hex values                          RADDAT
      *                   of i_pointer.                                                       RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_cvtPtrToHexString...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_cvtPtrToHexString...                                                                 RADDAT
     D                 PI            32A           varying                                    RADDAT
     D  i_pointer                      *   value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S             32A   varying                                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         string = f_cvtBufferToHexString(%addr(i_pointer): %size(i_pointer));               //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_cvtPtrToHexString...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a given character string of hex values to a buffer.                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - Character string of hex values.                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the size of the bytes sequence                              RADDAT
      *                   represented by i_string.                                            RADDAT
      *                                                                                       RADDAT
      *  Sample:                                                                              RADDAT
      *     When i_string contains 'C88593939640E696999384', then buffer                      RADDAT
      *     is set to 'Hello World'.                                                          RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_cvtHexStringToBuffer...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_cvtHexStringToBuffer...                                                              RADDAT
     D                 PI             5U 0 opdesc                                             RADDAT
     D  i_string                   4096A   const   options(*varsize)                          RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_size                        5U 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S              5U 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_string        C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D string          S                   like(i_string    ) inz
     D strInf          DS                  likeds(strInf_t  ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         CEEGSI(p_string: strInf.datatype: strInf.curlen: strInf.maxlen: *omit);            //RADDAT
                                                                                            //RADDAT
         p_assert((strInf.curlen / 2) <= i_size:
                  'Length of i_buffer exceeded maximum length allowed.');                   //RADDAT
                                                                                            //RADDAT
         string = %subst(i_string: 1: strInf.curlen);                                       //RADDAT
         cvtch(i_pBuffer: %addr(string): strInf.curlen);                                    //RADDAT
         size   = strInf.curlen / 2;                                                        //RADDAT
                                                                                            //RADDAT
         if size < i_size;                                                                  //RADDAT
            memset(i_pBuffer + size: x'00': i_size - size);                                 //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   size;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_cvtHexStringToBuffer...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Tests, if a given string contains an invalid character
      *  at a given position.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to test.
      *   i_pos         - The position that specifies the character
      *                   to be tested.                                                       RADDAT
      *   i_chars       - List of valid characters.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isValid       - Returns cTrue, if the character at the specified                    RADDAT
      *                   position is valid, else cFalse.
      *=========================================================================              RADDAT
     P f_containsInvalidCharAt...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_containsInvalidCharAt...
     D                 PI              N
     D  i_string                   4096A   const  varying options(*varsize)
     D  i_pos                        10I 0 const                                              RADDAT
     D  i_chars                     256A   const  varying options(*varsize)                   RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isInvalid       S               N   inz(cFalse)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE

         p_assert(i_pos <= %len(i_string):
                  'i_pos is out of range. It must be less than or equal to ' +
                  %editc(%len(i_string): 'N'));
                                                                                            //RADDAT
         if %check(%subst(i_chars: 1: %len(i_chars))
                   : %subst(i_string: i_pos: 1)) <> 0;
            isInvalid = cTrue;                                                              //RADDAT
         else;                                                                              //RADDAT
            isInvalid = cFalse;                                                             //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isInvalid;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_containsInvalidCharAt...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Tests, if a given string contains a specific string
      *  at a given position.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - The string to test.
      *   i_pos         - The position that specifies the start position
      *                   of the embedded sub string.                                         RADDAT
      *   i_subString   - The sub string.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isAvailable   - Returns cTrue, if the sub string is found at the                    RADDAT
      *                   specified position, else cFalse.
      *=========================================================================              RADDAT
     P f_containsStringAt...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_containsStringAt...
     D                 PI              N
     D  i_string                   4096A   const  varying options(*varsize)                   RADDAT
     D  i_pos                        10I 0 const                                              RADDAT
     D  i_subString                4096A   const  varying options(*varsize)                   RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isAvailable     S               N   inz(cFalse)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if (i_pos + %len(i_subString)) <= %len(i_string);
            if %subst(i_string: i_pos: %len(i_subString)) =
                  %subst(i_subString: 1: %len(i_subString));
               isAvailable = cTrue;                                                         //RADDAT
            else;                                                                           //RADDAT
               isAvailable = cFalse;                                                        //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            isAvailable = cFalse;                                                           //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isAvailable;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_containsStringAt...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the string representation of a qualified object name.                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_qObj        - Qualified object name.                                              RADDAT
      *   i_lib         - Name of the library that contains the object                        RADDAT
      *                   specified at i_qObj. If i_lib is used i_qObj                        RADDAT
      *                   behaves like a 10 byte name field that contains
      *                   the name of the object only.                                        RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   strObjName    - The string represenation of the qualified object name.              RADDAT
      *=========================================================================              RADDAT
     P f_objName...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_objName...                                                                           RADDAT
     D                 PI            21A          varying                                     RADDAT
     D  i_qObj                             const  likeds(qObj_t   )                           RADDAT
     D  i_lib                        10A   const  options(*nopass)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D strObjName      S             21A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if (%parms() >= p_lib);
            strObjName = %trimR(i_lib) + '/' + %trimR(i_qObj);
         else;
            strObjName = %trimR(i_qObj.lib) + '/' + %trimR(i_qObj.name);
         endif;
                                                                                            //RADDAT
         return strObjName;                                                                 //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_objName...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Replaces unprintable characters in a given string.                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - String that may contain unprintable characters.                     RADDAT
      *   i_rplChar     - Substitution character that replaces the                            RADDAT
      *                   unprintable characters.                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - String without any unprintable characters.                          RADDAT
      *=========================================================================              RADDAT
     P f_rplUnPrtChars...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rplUnPrtChars...                                                                     RADDAT
     D                 PI          4096A          varying                                     RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_rplChar                     1A   const  varying options(*nopass)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S           4096A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_rplChar       C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D rplChar         S                   like(i_rplChar ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         if (%parms() >= p_rplChar);                                                        //RADDAT
            rplChar = i_rplChar;                                                            //RADDAT
         else;                                                                              //RADDAT
            rplChar = ' ';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         string = '';                                                                       //RADDAT
                                                                                            //RADDAT
         for x = 1 to %len(i_string);                                                       //RADDAT
            if (%subst(i_string: x: 1) < x'40' or
                %subst(i_string: x: 1) = x'FF');                                            //RADDAT
               if (%len(rplChar) > 0);                                                      //RADDAT
                  string = string + rplChar;                                                //RADDAT
               endif;                                                                       //RADDAT
            else;                                                                           //RADDAT
               string = string + %subst(i_string: x: 1);                                    //RADDAT
            endif;                                                                          //RADDAT
         endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rplUnPrtChars...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Formats a given date according to a given picture string.                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_date        - Date to be formatted.                                               RADDAT
      *   i_pic_str     - Picture string representing the desired format.                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - Formatted date string.                                              RADDAT
      *=========================================================================              RADDAT
     P f_formatDate...                                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_formatDate...                                                                        RADDAT
     D                 PI           128A          varying                                     RADDAT
     D  i_date                         D   const                                              RADDAT
     D  i_pic_str                   128A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S            128A   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D cDATE_ISO       C                   'YYYYMMDD'                                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D tmpDate         S             10A   inz                                                RADDAT
     D tmpLilianDate   S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         tmpDate = %char(i_date: *ISO0);                                                    //RADDAT
         CEEDAYS(tmpDate: cDATE_ISO: tmpLilianDate: *omit);
         CEEDATE(tmpLilianDate: i_pic_str: string: *omit);
                                                                                            //RADDAT
         return %trimR(string);                                                             //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_formatDate...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Parses a string representing a date.                                                 RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_string      - String representing a date.                                         RADDAT
      *   i_pic_str     - Picture string describing the date string.                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   date          - Date.                                                               RADDAT
      *=========================================================================              RADDAT
     P f_parseDate...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_parseDate...                                                                         RADDAT
     D                 PI              D                                                      RADDAT
     D  i_string                    128A   const  varying                                     RADDAT
     D  i_pic_str                   128A   const  varying options(*nopass)                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D date            S               D   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D cDATE_ISO       C                   'YYYYMMDD'                                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D tmpDate         S             10A   inz                                                RADDAT
     D tmpLilianDate   S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         CEEDAYS(i_string: i_pic_str: tmpLilianDate: *omit);
         CEEDATE(tmpLilianDate: cDATE_ISO: tmpDate: *omit);
         date = %date(tmpDate: *ISO0);                                                      //RADDAT
                                                                                            //RADDAT
         return date;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_parseDate...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a given memory size in bytes to string.                                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_memSize     - Memory size in bytes that is converted to string.
      *   io_unit       - Input:  Desired unit of the formatted memory size.
      *                   Output: Unit of the formatted memory size.
      *                   Default (input ): best fit = ''
      *                   cMEM_SIZE_BYTE                                                      RADDAT
      *                   cMEM_SIZE_KILO_BYTE                                                 RADDAT
      *                   cMEM_SIZE_MEGA_BYTE                                                 RADDAT
      *                   cMEM_SIZE_GIGA_BYTE                                                 RADDAT
      *                   cMEM_SIZE_TERA_BYTE                                                 RADDAT
      *                   cMEM_SIZE_PETA_BYTE                                                 RADDAT
      *                   cMEM_SIZE_EXA_BYTE
      *                   cMEM_SIZE_TETTA_BYTE
      *   i_decPos      - Number of decimal positions.                                        RADDAT
      *                   Default: 2                                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   string        - Formatted memory size string.                                       RADDAT
      *=========================================================================              RADDAT
     P f_formatMemSize...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_formatMemSize...                                                                     RADDAT
     D                 PI           128A          varying                                     RADDAT
     D  i_memSize                    20I 0 const                                              RADDAT
     D  io_unit                       2A          options(*nopass: *omit)                     RADDAT
     D  i_decPos                      3I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D string          S            128A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_unit          C                   2                                                  RADDAT
     D p_decPos        C                   3                                                  RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D unit            S                   like(io_unit ) inz                                 RADDAT
     D decPos          S                   like(i_decPos) inz                                 RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D i               S             10I 0 inz                                                RADDAT
     D p               S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
     D                 DS
     D memSize                 1     29S 7 inz                                                RADDAT
     D memSize6                1     28S 6
     D memSize5                1     27S 5
     D memSize4                1     26S 4
     D memSize3                1     25S 3
     D memSize2                1     24S 2
     D memSize1                1     23S 1
      *                                                                                       RADDAT
      *  Static status fields                                                                 RADDAT
     D isInit          S               N   inz(cFalse)                                        RADDAT
     D isUnit          S               N   inz(cFalse)                                        RADDAT
     D units           S              2A   varying dim(8)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE

         if (not isInit);
            units(1) = cMEM_SIZE_BYTE;        //                                   1 Byte
            units(2) = cMEM_SIZE_KILO_BYTE;   //                               1.000 Byte
            units(3) = cMEM_SIZE_MEGA_BYTE;   //                           1.000.000 Byte
            units(4) = cMEM_SIZE_GIGA_BYTE;   //                       1.000.000.000 Byte
            units(5) = cMEM_SIZE_TERA_BYTE;   //                   1.000.000.000.000 Byte
            units(6) = cMEM_SIZE_PETA_BYTE;   //               1.000.000.000.000.000 Byte
            units(7) = cMEM_SIZE_EXA_BYTE;    //           1.000.000.000.000.000.000 Byte
            units(8) = cMEM_SIZE_ZETTA_BYTE;  //       1.000.000.000.000.000.000.000 Byte
            isInit = cTrue;
         endif;
                                                                                            //RADDAT
         // Get values of optional parameters                                               //RADDAT
         // ... unit                                                                        //RADDAT
         if (%parms() >= p_unit);                                                           //RADDAT
            CEETSTA(isPresent: p_unit: *omit);
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);                                                                //RADDAT
            unit = %trim(io_unit);
            isUnit = cTrue;
         else;                                                                              //RADDAT
            unit = '';
            isUnit = cFalse;
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... decPos                                                                      //RADDAT
         if (%parms() >= p_decPos);                                                         //RADDAT
            CEETSTA(isPresent: p_decPos: *omit);
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);                                                                //RADDAT
            decPos = i_decPos;                                                              //RADDAT
         else;                                                                              //RADDAT
            decPos = 2;
         endif;                                                                             //RADDAT

         p_assert(decPos >= 0 and decPos <= %decPos(memSize)
                  : 'Number of decimal positions out of range 1 to ' +
                     %char(decPos));
                                                                                            //RADDAT
         // Determine index of desired unit
         x = %lookup(f_ucase(unit): units);
                                                                                            //RADDAT
         // Divide memory size down to smallest possible value (unit)                       //RADDAT
         i = 1;
         memSize = i_memSize;
         dow (memSize >= 1024 and (x <> i or x = 0));
            i = i + 1;
            eval(H) memSize = memSize / 1024;
         enddo;
                                                                                            //RADDAT
         // Divide memory size down to requested unit
         // (number of bytes is less than 1024)
         dow (i < x);
            i = i + 1;
            eval(H) memSize = memSize / 1024;
         enddo;

         select;
         when (decPos = 1);
            eval(H) memSize1 = memSize;
         when (decPos = 2);
            eval(H) memSize2 = memSize;
         when (decPos = 3);
            eval(H) memSize3 = memSize;
         when (decPos = 4);
            eval(H) memSize4 = memSize;
         when (decPos = 5);
            eval(H) memSize5 = memSize;
         when (decPos = 6);
            eval(H) memSize6 = memSize;
         endsl;

         string = %editc(memSize: 'N');
         string = f_left(string: %len(string) - %decPos(memSize) + decPos);

         if (isUnit);
            io_unit = units(i);
         endif;
                                                                                            //RADDAT
         return string;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_formatMemSize...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R4  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R4 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Assert/This/Caller       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R4  - SrvPgm: Basic Routines - Assert/This/Caller           *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  12.07.2006  Th.Raddatz    Changed f_caller() and f_this() to       *                 RADDAT
      *                            return the statement ID as the next      *                 RADDAT
      *                            optional parameter.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  12.07.2006  Th.Raddatz    Changed p_assert(), f_this() and         *                 RADDAT
      *                            f_caller() to use a static buffer of     *                 RADDAT
      *                            2048 byte to receive the test message    *                 RADDAT
      *                            for better performance.                  *                 RADDAT
      *                                                                     *                 RADDAT
      *  13.06.2008  Th.Raddatz    Added parameter 'offset' to f_caller().  *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      * =================================================================== *                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R4
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================
      *  RPG equivalent of the C Assert macro.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_condition   - The condition that must be TRUE.                                    RADDAT
      *   i_msgText     - The message text that is sent in case that
      *                   i_condition is FALSE.                                               RADDAT
      *                   Default:        *BLANKS                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P p_assert...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D p_assert...                                                                            RADDAT
     D                 PI                                                                     RADDAT
     D  i_condition                    N   const                                              RADDAT
     D  i_msgText                   128A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Make sure that the p_assert procedure is not included
      *  when the condition name COMPILE_NO_DEBUG is specified at                             RADDAT
      *  the CRTRPGMOD command.
      /IF NOT DEFINED (COMPILE_NO_DEBUG)                                                      RADDAT
      *                                                                                       RADDAT
      *  Positions of optional parameters                                                     RADDAT
     D p_msgText       C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D msgText         S                   like(i_msgText ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D cTEXT_MSG       C                   const('Who is before me?')                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHSNDPM/QMHRCVPM                                                      RADDAT
     D qMsgF           DS                  likeds(qObj_t     )  inz                           RADDAT
     D msgKey          S              4A   inz                                                RADDAT
     D errCode         DS                  likeds(errCode_t  )  inz                           RADDAT
     D callStkEQ       DS                  qualified                                          RADDAT
     D  module                 1     10A                      inz                             RADDAT
     D  program               11     20A                      inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHRCVPM                                                               RADDAT
     D memSize         S             10I 0 inz                                                RADDAT
     D sndInf          DS                  likeds(sndInf_t  ) based(pSndInf  )                RADDAT
     D rcvm0300        DS                  likeds(rcvm0300_t) based(pRcvm0300)                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if   not i_condition;                                                              //RADDAT
                                                                                            //RADDAT
            // Process optional parameters                                                  //RADDAT
 B02        if   %parms >= p_msgText;                                                       //RADDAT
               msgText = i_msgText;                                                         //RADDAT
 X02        else;                                                                           //RADDAT
               msgText = '*N';                                                              //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Send a test message                                                          //RADDAT
            clear   qMsgF;                                                                  //RADDAT
            qMsgF.name   = 'QCPFMSG';                                                       //RADDAT
            qMsgF.lib    = '*LIBL';                                                         //RADDAT
            errCode      = f_newApiErrCode(cTrue);                                          //RADDAT
            callStkEQ.module  = '*NONE';                                                    //RADDAT
            callStkEQ.program = '*NONE';                                                    //RADDAT
            qmhsndpm('CPF9897': qMsgF: cTEXT_MSG: %size(cTEXT_MSG): '*INFO':
                     '*': 1: msgKey: errCode: 1: callStkEQ: 0);                             //RADDAT
                                                                                            //RADDAT
 B02        if   not f_isApiError(errCode);                                                 //RADDAT
               memSize   = 2048;                                                            //RADDAT
               pRcvm0300 = %alloc(memSize);                                                 //RADDAT
               errCode   = f_newApiErrCode(cTrue);                                          //RADDAT
               callStkEQ.module  = '*NONE';                                                 //RADDAT
               callStkEQ.program = '*NONE';                                                 //RADDAT
               qmhrcvpm(rcvm0300: memSize: 'RCVM0300':
                        '*': 1: '*INFO': msgKey: 0: '*REMOVE': errCode:
                        1: callStkEQ);                                                      //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // If everything worked as designed, ...                                        //RADDAT
 B02        if   not f_isApiError(errCode) and
                     rcvm0300.bytAvl <= memSize;                                            //RADDAT
               // ... then retrieve sender information                                      //RADDAT
               pSndInf = pRcvm0300 + %size(rcvm0300)
                                   + rcvm0300.lenRplDataR
                                   + rcvm0300.lenMsgR
                                   + rcvm0300.lenMsgHlpR;                                   //RADDAT
 X02        else;                                                                           //RADDAT
               // ... else set sender information to "not available"                        //RADDAT
               pSndInf = %alloc(%size(sndInf));                                             //RADDAT
               clear   sndInf;                                                              //RADDAT
               sndInf.rcvPgm     = '*N';                                                    //RADDAT
               sndInf.rcvModule  = '*N';                                                    //RADDAT
               sndInf.rcvProc    = '*N';                                                    //RADDAT
               sndInf.rcvPgmStmtNbr(1) = '*N';                                              //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Create "assert" message                                                      //RADDAT
            msgText = %trimr(sndInf.rcvPgm    ) + '/'  +
                      %trimr(sndInf.rcvModule ) + '.'  +
                      %trimr(sndInf.rcvProc   ) + ' (' +
                      'Stmt: '                         +
                      %trimr(sndInf.rcvPgmStmtNbr(1)) + ') ' +
                      ': ' + %trim(msgText);                                                //RADDAT
                                                                                            //RADDAT
            // Free memory                                                                  //RADDAT
 B02        if   pRcvm0300 <> *NULL;                                                        //RADDAT
               dealloc(N)   pRcvm0300;                                                      //RADDAT
 X02        else;                                                                           //RADDAT
 B03           if   pSndInf <> *NULL;                                                       //RADDAT
                  dealloc(N) pSndInf;                                                       //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Send "assert" *ESCAPE message                                                //RADDAT
            msgKey  = ' ';                                                                  //RADDAT
            errCode = f_newApiErrCode(cTrue);                                               //RADDAT
            callStkEQ.module  = '*NONE';                                                    //RADDAT
            callStkEQ.program = '*NONE';                                                    //RADDAT
            qmhsndpm('CPF9898': qMsgF: msgText: %size(msgText): '*ESCAPE':
                     '*': 1: msgKey: errCode: 1: callStkEQ: 0);                             //RADDAT
                                                                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
      /END-FREE
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
     C                   return                                                               RADDAT
      *                                                                                       RADDAT
     P p_assert...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the procedure, module and program name
      *  of the current procedure.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   o_module      - The module that contains the procedure.                             RADDAT
      *   o_program     - The program that contains the module.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   procedure     - The name of the procedure that called f_this.                       RADDAT
      *=========================================================================              RADDAT
     P f_this...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_this...
     D                 PI           256A          varying                                     RADDAT
     D  o_module                     10A          options(*nopass: *omit)                     RADDAT
     D  o_program                    10A          options(*nopass: *omit)                     RADDAT
     D  o_stmtID                     10A          options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value
     D procedure       S            256A   inz    varying
      *                                                                                       RADDAT
      *  Positions of optional parameters                                                     RADDAT
     D p_module        C                   const(1)                                           RADDAT
     D p_program       C                   const(2)                                           RADDAT
     D p_stmtID        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D module          S                   like(o_module  ) inz                               RADDAT
     D program         S                   like(o_program ) inz                               RADDAT
     D stmtID          S                   like(o_stmtID  ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D cTEXT_MSG       C                   const('Who is before me?')                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHSNDPM/QMHRCVPM                                                      RADDAT
     D qMsgF           DS                  likeds(qObj_t     )  inz                           RADDAT
     D msgKey          S              4A   inz                                                RADDAT
     D errCode         DS                  likeds(errCode_t  )  inz                           RADDAT
     D callStkEQ       DS                  qualified                                          RADDAT
     D  module                 1     10A                      inz                             RADDAT
     D  program               11     20A                      inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHRCVPM                                                               RADDAT
     D memSize         S             10I 0 inz                                                RADDAT
     D sndInf          DS                  likeds(sndInf_t  ) based(pSndInf  )                RADDAT
     D rcvm0300        DS                  likeds(rcvm0300_t) based(pRcvm0300)                RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Send a test message
         clear   qMsgF;                                                                     //RADDAT
         qMsgF.name   = 'QCPFMSG';                                                          //RADDAT
         qMsgF.lib    = '*LIBL';                                                            //RADDAT
         errCode      = f_newApiErrCode(cTrue);                                             //RADDAT
         callStkEQ.module  = '*NONE';                                                       //RADDAT
         callStkEQ.program = '*NONE';                                                       //RADDAT
         qmhsndpm('CPF9897': qMsgF: cTEXT_MSG: %size(cTEXT_MSG): '*INFO':
                  '*': 1: msgKey: errCode: 1: callStkEQ: 0);                                //RADDAT
                                                                                            //RADDAT
 B01     if   not f_isApiError(errCode);                                                    //RADDAT
            memSize   = 2048;
            pRcvm0300 = %alloc(memSize);
            errCode   = f_newApiErrCode(cTrue);
            callStkEQ.module  = '*NONE';
            callStkEQ.program = '*NONE';
            qmhrcvpm(rcvm0300: memSize: 'RCVM0300':
                     '*': 1: '*INFO': msgKey: 0: '*REMOVE': errCode:
                     1: callStkEQ);
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // If everything worked as designed, ...
 B01     if   not f_isApiError(errCode) and
                  rcvm0300.bytAvl <= memSize;
            // ... then retrieve sender information
            pSndInf = pRcvm0300 + %size(rcvm0300)
                                + rcvm0300.lenRplDataR
                                + rcvm0300.lenMsgR
                                + rcvm0300.lenMsgHlpR;
            procedure = %trimR(sndInf.rcvProc);                                             //RADDAT
            module    = sndInf.rcvModule;
            program   = sndInf.rcvPgm;
            stmtID    = sndInf.rcvPgmStmtNbr(1);                                            //RADDAT
 X01     else;
            procedure = '*N';
            module    = '*N';
            program   = '*N';
            stmtID    = '*N';                                                               //RADDAT
 E01     endif;

         // Free memory
 B01     if   pRcvm0300 <> *NULL;
            dealloc(N)   pRcvm0300;
 E01     endif;

         // Process optional output parameters ...
         // .. o_module
 B01     if   %parms >= p_module;
            CEETSTA(isPresent: p_module: *omit);
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            o_module = module;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT

         // .. o_program
 B01     if   %parms >= p_program;
            CEETSTA(isPresent: p_program: *omit);
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            o_program = program;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // .. o_stmtID                                                                     //RADDAT
 B01     if   %parms >= p_stmtID;                                                           //RADDAT
            CEETSTA(isPresent: p_stmtID: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            o_stmtID = stmtID;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT

         return   procedure;

      /END-FREE
      *                                                                                       RADDAT
     P f_this...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the procedure, module and program name                                       RADDAT
      *  that called the current procedure.                                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   o_module      - The module that contains the procedure.                             RADDAT
      *   o_program     - The program that contains the module.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   procedure     - The name of the caller of the procedure                             RADDAT
      *                   that called f_caller.                                               RADDAT
      *=========================================================================              RADDAT
     P f_caller...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_caller...                                                                            RADDAT
     D                 PI           256A          varying                                     RADDAT
     D  o_module                     10A          options(*nopass: *omit)                     RADDAT
     D  o_program                    10A          options(*nopass: *omit)                     RADDAT
     D  o_stmtID                     10A          options(*nopass: *omit)                     RADDAT
     D  i_offset                      3I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D procedure       S            256A   inz    varying                                     RADDAT
      *                                                                                       RADDAT
      *  Positions of optional parameters                                                     RADDAT
     D p_module        C                   const(1)                                           RADDAT
     D p_program       C                   const(2)                                           RADDAT
     D p_stmtID        C                   const(3)                                           RADDAT
     D p_offset        C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D module          S                   like(o_module  ) inz                               RADDAT
     D program         S                   like(o_program ) inz                               RADDAT
     D stmtID          S                   like(o_stmtID  ) inz                               RADDAT
     D offset          S                   like(i_offset  ) inz(0)                            RADDAT
      *                                                                                       RADDAT
      *  Local constants                                                                      RADDAT
     D cTEXT_MSG       C                   const('Who is before me?')                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHSNDPM/QMHRCVPM                                                      RADDAT
     D qMsgF           DS                  likeds(qObj_t     )  inz                           RADDAT
     D msgKey          S              4A   inz                                                RADDAT
     D errCode         DS                  likeds(errCode_t  )  inz                           RADDAT
     D callStkEQ       DS                  qualified                                          RADDAT
     D  module                 1     10A                      inz                             RADDAT
     D  program               11     20A                      inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields QMHRCVPM                                                               RADDAT
     D memSize         S             10I 0 inz                                                RADDAT
     D sndInf          DS                  likeds(sndInf_t  ) based(pSndInf  )                RADDAT
     D rcvm0300        DS                  likeds(rcvm0300_t) based(pRcvm0300)                RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Get optional input parameters ...                                               //RADDAT
         // .. i_offset                                                                     //RADDAT
 B01     if (%parms() >= p_offset and %addr(i_offset) <> *NULL);                            //RADDAT
            offset = i_offset;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Send a test message                                                             //RADDAT
         clear   qMsgF;                                                                     //RADDAT
         qMsgF.name   = 'QCPFMSG';                                                          //RADDAT
         qMsgF.lib    = '*LIBL';                                                            //RADDAT
         errCode      = f_newApiErrCode(cTrue);                                             //RADDAT
         callStkEQ.module  = '*NONE';                                                       //RADDAT
         callStkEQ.program = '*NONE';                                                       //RADDAT
         qmhsndpm('CPF9897': qMsgF: cTEXT_MSG: %size(cTEXT_MSG): '*INFO':
                  '*': 2+offset: msgKey: errCode: 1: callStkEQ: 0);                         //RADDAT
                                                                                            //RADDAT
 B01     if   not f_isApiError(errCode);                                                    //RADDAT
            // Receive and remove test message                                              //RADDAT
            memSize   = 2048;
            pRcvm0300 = %alloc(memSize);
            errCode   = f_newApiErrCode(cTrue);
            callStkEQ.module  = '*NONE';
            callStkEQ.program = '*NONE';
            qmhrcvpm(rcvm0300: memSize: 'RCVM0300':
                     '*': 2+offset: '*INFO': msgKey: 0: '*REMOVE': errCode:
                     1: callStkEQ);
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // If everything worked as designed, ...                                           //RADDAT
 B01     if   not f_isApiError(errCode) and
                  rcvm0300.bytAvl <= memSize;
            // ... then retrieve sender information                                         //RADDAT
            pSndInf = pRcvm0300 + %size(rcvm0300)
                                + rcvm0300.lenRplDataR
                                + rcvm0300.lenMsgR
                                + rcvm0300.lenMsgHlpR;                                      //RADDAT
            procedure = %trimR(sndInf.rcvProc);                                             //RADDAT
            module    = sndInf.rcvModule;                                                   //RADDAT
            program   = sndInf.rcvPgm;                                                      //RADDAT
            stmtID    = sndInf.rcvPgmStmtNbr(1);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            procedure = '*N';                                                               //RADDAT
            module    = '*N';                                                               //RADDAT
            program   = '*N';                                                               //RADDAT
            stmtID    = '*N';                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Free memory                                                                     //RADDAT
 B01     if   pRcvm0300 <> *NULL;                                                           //RADDAT
            dealloc(N)   pRcvm0300;                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional output parameters ...                                          //RADDAT
         // .. o_module                                                                     //RADDAT
 B01     if   %parms >= p_module;                                                           //RADDAT
            CEETSTA(isPresent: p_module: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            o_module = module;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // .. o_program                                                                    //RADDAT
 B01     if   %parms >= p_program;                                                          //RADDAT
            CEETSTA(isPresent: p_program: *omit);                                           //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            o_program = program;                                                            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // .. o_stmtID                                                                     //RADDAT
 B01     if   %parms >= p_stmtID;                                                           //RADDAT
            CEETSTA(isPresent: p_stmtID: *omit);                                            //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            o_stmtID = stmtID;                                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   procedure;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_caller...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R5  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R5 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Objects                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R5  - SrvPgm: Basic Routines - Objects                      *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  17.12.2008  Th.Raddatz    Added f_getObjLib().                     *                 RADDAT
      *                            Changed parameter i_text of procedure    *                 RADDAT
      *                            f_crtUsrSpc() from 10A to 50A.           *                 RADDAT
      *                                                                     *                 RADDAT
      *  13.01.2009  Th.Raddatz    Added procedures:                        *                 RADDAT
      *                            - f_chgUsrSpcSize()                      *                 RADDAT
      *                            - f_getUsrSpcSize()                      *                 RADDAT
      *                            - f_chgUsrSpcAutoExt()                   *                 RADDAT
      *                            - f_getUsrSpcAutoExt()                   *                 RADDAT
      *                            - f_chgUsrSpcInitValue()                 *                 RADDAT
      *                            - f_getUsrSpcInitValue()                 *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs                                                                     RADDAT
      /COPY QBASICS1,H_SPEC                                                                   RADDAT
      /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,PBASICS1R5
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,QUSRSPC                       User Space APIs                            RADDAT
      /COPY QBASICS1,CEELIB                        CEE APIs
      /COPY QBASICS1,QP0LCVTPAT                    Qp0lCvtPathToQSYSObjName()--Resolve Path
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Retrieves the attributes of a given user space.
     D rtvUsrSpcAttr...
     D                 PR                         likeds(spca0100_t )
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Changes an attribute of a given user space.                                          RADDAT
     D chgUsrSpcAttr...                                                                       RADDAT
     D                 PR              N                                                      RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_attr                      128A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks object existance.                                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_obj         - The object to check for existance.                                  RADDAT
      *   i_lib         - The library that contains the object.
      *                   Default:        *LIBL
      *   i_type        - The type of the object.
      *   i_mbr         - The member that is checked in case of that
      *                   the object is a file.
      *                   Default:        *NONE
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   doesExists    - Returns cTrue when the object exists.                               RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_exist...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_exist...                                                                             RADDAT
     D                 PI              N                                                      RADDAT
     D  i_obj                        10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_type                       10A   const                                              RADDAT
     D  i_mbr                        10A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D doesExist       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_mbr           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D mbr             S                   like(i_mbr       ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D objd0100        DS                  likeds(objd0100_t) inz                             RADDAT
     D mbrd0100        DS                  likeds(mbrd0100_t) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                              //R//RADD
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_mbr                                                                       //RADDAT
         if   %parms >= p_mbr;                                                              //RADDAT
            mbr = i_mbr;                                                                    //RADDAT
         else;                                                                              //RADDAT
            mbr = '*NONE';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve the object description                                                 //RADDAT
         objd0100 = f_rtvObjD(i_obj: lib: i_type: 'OBJD0100': msg);                         //RADDAT
                                                                                            //RADDAT
         // Retrieve member description if object is a file                                 //RADDAT
         // and a member name was given                                                     //RADDAT
         if   (msg.ID = cMSG_ID_OK) and (mbr <> '*NONE');                                   //RADDAT
            mbrd0100 = f_rtvMbrD(i_obj: lib: i_mbr: 'MBRD0100': msg);                       //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if   msg.ID = cMSG_ID_OK;                                                          //RADDAT
            doesExist = cTrue;                                                              //RADDAT
         else;                                                                              //RADDAT
            doesExist = cFalse;                                                             //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   doesExist;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_exist...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieve object description.                                                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_obj         - The object to retrieve information from.                            RADDAT
      *   i_lib         - The library that contains the object.                               RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_type        - The type of the object.                                             RADDAT
      *   i_format      - The format of the object description.                               RADDAT
      *                   Default:        OBJD0100                                            RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   object descr. - Returns the member description of the file member.                  RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_rtvObjD...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvObjD...                                                                           RADDAT
     D                 PI          1024A                                                      RADDAT
     D  i_obj                        10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_type                       10A   const                                              RADDAT
     D  i_format                      8A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D objD            DS          1024    inz    qualified                                   RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
     D  bytAvl                 1      4I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_format        C                   const(4)                                           RADDAT
     D p_msg           C                   const(5)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D format          S                   like(i_format    ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qObj            DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                              //R//RADD
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_format                                                                    //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_format: *omit);                                            //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            format = i_format;                                                              //RADDAT
         else;                                                                              //RADDAT
            format = 'OBJD0100';                                                            //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Call the retrieve object description API                                        //RADDAT
         qObj.name = i_obj;                                                                 //RADDAT
         qObj.lib  = i_lib;                                                                 //RADDAT
         errCode   = f_newApiErrCode(cTrue);                                                //RADDAT
         QUSROBJD(objD: %size(objD): format: qObj: i_type: errCode);                        //RADDAT
                                                                                            //RADDAT
         // Set message value                                                               //RADDAT
         msg = f_cvtApiErrCodeToMsg(errCode);                                               //RADDAT
                                                                                            //RADDAT
         // Check length of receiver variable                                               //RADDAT
         if   not f_isApiError(errCode);                                                    //RADDAT
            p_assert(objD.bytRet <= objD.bytAvl:
                     'Length of receiver variable objD is +
                      to small to hold result');                                            //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   objD;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvObjD...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieve member description.                                                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_file        - The file that contains the member to retrieve                       RADDAT
      *                   information from.                                                   RADDAT
      *   i_lib         - The library that contains the file.                                 RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_mbr         - The name of the member to retrieve information from.                RADDAT
      *   i_format      - The format of the object description.                               RADDAT
      *                   Default:        OBJD0100                                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   object descr. - Returns the object description of the object.                       RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_rtvMbrD...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvMbrD...                                                                           RADDAT
     D                 PI          1024A                                                      RADDAT
     D  i_file                       10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_mbr                        10A   const                                              RADDAT
     D  i_format                      8A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D mbrD            DS          1024    inz    qualified                                   RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
     D  bytAvl                 1      4I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_format        C                   const(4)                                           RADDAT
     D p_msg           C                   const(5)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D format          S                   like(i_format    ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qFile           DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                              //R//RADD
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_format                                                                    //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_format: *omit);                                            //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            format = i_format;                                                              //RADDAT
         else;                                                                              //RADDAT
            format = 'OBJD0100';                                                            //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Call the retrieve object description API                                        //RADDAT
         qFile.name = i_file;                                                               //RADDAT
         qFile.lib  = i_lib;                                                                //RADDAT
         errCode   = f_newApiErrCode(cTrue);                                                //RADDAT
         QUSRMBRD(mbrD: %size(mbrD): format: qFile: i_mbr: '0': errCode);                   //RADDAT
                                                                                            //RADDAT
         // Set message value                                                               //RADDAT
         msg = f_cvtApiErrCodeToMsg(errCode);                                               //RADDAT
                                                                                            //RADDAT
         // Check length of receiver variable                                               //RADDAT
         if   not f_isApiError(errCode);                                                    //RADDAT
            p_assert(mbrD.bytRet <= mbrD.bytAvl:
                     'Length of receiver variable mbrD is +
                      to small to hold result');                                            //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   mbrD;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvMbrD...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Produces a temporary object name.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   qTmpObj       - Returns a qualified temporary object name.                          RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getTmpName...                                                                        RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getTmpName...                                                                        RADDAT
     D                 PI                         like(qObj_t     )                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D qTmpObj         DS                  likeds(qObj_t    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D pTmpNam         S               *   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Produce temporary object name                                                   //RADDAT
         pTmpNam = tmpnam(*NULL);                                                           //RADDAT
                                                                                            //RADDAT
         if   pTmpNam <> *NULL;                                                             //RADDAT
            qTmpObj.lib  = %str(strtok(pTmpNam: '/'));                                      //RADDAT
            qTmpObj.name = %str(strtok(*NULL  : '/'));                                      //RADDAT
         else;                                                                              //RADDAT
            clear   qTmpObj;                                                                //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   qTmpObj;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getTmpName...                                                                        RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Produces a unique object name.  (experimental)                                       RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_type        - The type of the object.                                             RADDAT
      *   i_lib         - The library that will contain the object.                           RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   qUnqObj       - Returns a qualified unique object name.                             RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getUniqueName...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getUniqueName...                                                                     RADDAT
     D                 PI                         like(qObj_t     )                           RADDAT
     D  i_type                       10A   const                                              RADDAT
     D  i_lib                        10A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D qUnqObj         DS                  likeds(qObj_t    ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D tmStmp          S               Z   inz                                                RADDAT
     D date            S               D   inz                                                RADDAT
     D time            S               T   inz                                                RADDAT
     D timeout         S               Z   inz                                                RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D name            DS                  qualified                                          RADDAT
     D  longNbr                      14S 0                                                    RADDAT
     D   julDate                      5S 0 overlay(longNbr: *next)                            RADDAT
     D   time                         6S 0 overlay(longNbr: *next)                            RADDAT
     D   mSec                         3S 0 overlay(longNbr: *next)                            RADDAT
      *                                                                                       RADDAT
     D                 DS                                                                     RADDAT
     D chars                               inz('ABCDEFGHIJKLMNOPQRSTUVWXYZ+                   RADDAT
     D                                          0123456789')                                  RADDAT
     D  char                          1A   dim(36) overlay(chars: *next)                      RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         clear   qUnqObj;                                                                   //RADDAT
                                                                                            //RADDAT
         // Produce unique object name (max. 1 minute):                                     //RADDAT
         timeout = %timestamp() + %minutes(1);                                              //RADDAT
                                                                                            //RADDAT
         dou   (qUnqObj.name <> '') or (%timestamp >= timeOut);                             //RADDAT
                                                                                            //RADDAT
            // Produce unique object name from:                                             //RADDAT
            // Julian date + Time + mSeconds                                                //RADDAT
            tmStmp = %timestamp();                                                          //RADDAT
            time   = %time(tmStmp);                                                         //RADDAT
            date   = %date(tmStmp);                                                         //RADDAT
                                                                                            //RADDAT
            name.julDate = %dec(f_val(
                                %char(date: *JUL0)): %size(name.julDate): 0);
            name.time    = %dec(f_val(
                                %char(time: *HMS0)): %size(name.time)   : 0);
            name.mSec    = %subdt(tmStmp: *MSECONDS) / 1000;
                                                                                            //RADDAT
            // Set library name                                                             //RADDAT
            qUnqObj.lib = i_lib;                                                            //RADDAT
                                                                                            //RADDAT
            // Encode object name to base 36                                                //RADDAT
            %subst(qUnqObj.name: 1: 1) = 'Z';                                               //RADDAT
            x = 2;                                                                          //RADDAT
            dou   name.longNbr = 0;                                                         //RADDAT
               %subst(qUnqObj.name: x: 1) = char(%rem(name.longNbr: 36) + 1);               //RADDAT
               name.longNbr = name.longNbr / 36;                                            //RADDAT
               x = x + 1;                                                                   //RADDAT
            enddo;                                                                          //RADDAT
                                                                                            //RADDAT
            // Check, if object exists                                                      //RADDAT
            if   f_exist(qUnqObj.name: qUnqObj.lib: i_type);                                //RADDAT
               // Create new name if object exists                                          //RADDAT
               clear   qUnqObj;                                                             //RADDAT
            endif;                                                                          //RADDAT
                                                                                            //RADDAT
         enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         p_assert(qUnqObj.name <> '':
                  'Unique object name of type ' + %trim(i_type) +
                  ' could not be produced'                      );                          //RADDAT
                                                                                            //RADDAT
         return   qUnqObj;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getUniqueName...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a user space.                                                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *   i_text        - The text description of the user space.                             RADDAT
      *                   Default:        *BLANKS                                             RADDAT
      *   i_size        - The initial size of the user space.                                 RADDAT
      *                   Default:        65536 (64 kB)                                       RADDAT
      *   i_extAtr      - The extended attribute of the user space.                           RADDAT
      *                   Default:        *BLANKS                                             RADDAT
      *   i_pubAuth     - The public authority of the user space.                             RADDAT
      *                   Default:        *USE                                                RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isCreated     - Returns cTrue on success, else cFalse.                              RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_crtUsrSpc...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_crtUsrSpc...                                                                         RADDAT
     D                 PI              N                                                      RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const                                              RADDAT
     D  i_text                       50A   const  options(*omit: *nopass)                     RADDAT
     D  i_size                       10U 0 const  options(*omit: *nopass)                     RADDAT
     D  i_extAtr                     10A   const  options(*omit: *nopass)                     RADDAT
     D  i_pubAuth                    10A   const  options(*omit: *nopass)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isCreated       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_text          C                   const(3)                                           RADDAT
     D p_size          C                   const(4)                                           RADDAT
     D p_extAtr        C                   const(5)                                           RADDAT
     D p_pubAuth       C                   const(6)                                           RADDAT
     D p_msg           C                   const(7)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D text            S                   like(i_text      ) inz                             RADDAT
     D size            S                   like(i_size      ) inz                             RADDAT
     D extAtr          S                   like(i_extAtr    ) inz                             RADDAT
     D pubAuth         S                   like(i_pubAuth   ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qUsrSpc         DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         isCreated = cFalse;                                                                //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_text                                                                      //RADDAT
         if   %parms >= p_text;                                                             //RADDAT
            CEETSTA(isPresent: p_text: *omit);                                              //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            text = i_text;                                                                  //RADDAT
         else;                                                                              //RADDAT
            text = '';                                                                      //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_size                                                                      //RADDAT
         if   %parms >= p_size;                                                             //RADDAT
            CEETSTA(isPresent: p_size: *omit);                                              //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            size = i_size;                                                                  //RADDAT
         else;                                                                              //RADDAT
            size = 64 * 1024;                                                               //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_extAtr                                                                    //RADDAT
         if   %parms >= p_extAtr;                                                           //RADDAT
            CEETSTA(isPresent: p_extAtr: *omit);                                            //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            extAtr = i_extAtr;                                                              //RADDAT
         else;                                                                              //RADDAT
            extAtr = '';                                                                    //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... i_pubAuth                                                                   //RADDAT
         if   %parms >= p_pubAuth;                                                          //RADDAT
            CEETSTA(isPresent: p_pubAuth: *omit);                                           //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            pubAuth = i_pubAuth;                                                            //RADDAT
         else;                                                                              //RADDAT
            pubAuth = '*USE';                                                               //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Create user space                                                               //RADDAT
         qUsrSpc.name = i_usrSpc;                                                           //RADDAT
         qUsrSpc.lib  = i_lib;                                                              //RADDAT
         errCode      = f_newApiErrCode(cTrue);                                             //RADDAT
         QUSCRTUS(qUsrSpc: extAtr: size: x'00': pubAuth: text: '*NO': errCode);             //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if   f_isApiError(errCode);                                                        //RADDAT
            isCreated = cFalse;                                                             //RADDAT
            msg       = f_cvtApiErrCodeToMsg(errCode);                                      //RADDAT
         else;                                                                              //RADDAT
            isCreated = cTrue;                                                              //RADDAT
            msg       = f_newMsg(cMSG_ID_OK);                                               //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   isCreated;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_crtUsrSpc...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves a pointer to the content of a user space.                                  RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pUsrSpc       - Returns a pointer to the content of a user space                    RADDAT
      *                   on success, else a NULL pointer.                                    RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_rtvUsrSpcPtr...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_rtvUsrSpcPtr...                                                                      RADDAT
     D                 PI              *                                                      RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pUsrSpc         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qUsrSpc         DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         pUsrSpc = *NULL;                                                                   //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrive pointer to content of user space                                        //RADDAT
         qUsrSpc.name = i_usrSpc;                                                           //RADDAT
         qUsrSpc.lib  = i_lib;                                                              //RADDAT
         errCode      = f_newApiErrCode(cTrue);                                             //RADDAT
         QUSPTRUS(qUsrSpc: pUsrSpc: errCode);                                               //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if   f_isApiError(errCode);                                                        //RADDAT
            pUsrSpc = *NULL;                                                                //RADDAT
            msg     = f_cvtApiErrCodeToMsg(errCode);                                        //RADDAT
         else;                                                                              //RADDAT
            msg     = f_newMsg(cMSG_ID_OK);                                                 //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   pUsrSpc;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_rtvUsrSpcPtr...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the current size of a given user space.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the size of a given user space on success,                  RADDAT
      *                   else -1.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getUsrSpcSize...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getUsrSpcSize...                                                                     RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D spca0100        DS                  likeds(SPCA0100_t) inz
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         size = -1;
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve user space attributes
         spca0100 = rtvUsrSpcAttr(i_usrSpc: lib: msg);
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if (msg.ID <> cMSG_ID_OK);
            size = -1;
         else;                                                                              //RADDAT
            size = spca0100.size;
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return size;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getUsrSpcSize...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns cTrue if the user space is extended automatically by the
      *  system when the end of the space is encountered.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isAutoExt     - Returns the automatic extendibility attribute
      *                   of the user space.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getUsrSpcAutoExt...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getUsrSpcAutoExt...                                                                  RADDAT
     D                 PI              N
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isAutoExt       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D spca0100        DS                  likeds(SPCA0100_t) inz
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         isAutoExt = cFalse;
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve user space attributes
         spca0100 = rtvUsrSpcAttr(i_usrSpc: lib: msg);
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if (msg.ID <> cMSG_ID_OK);
            isAutoExt = cFalse;
         else;                                                                              //RADDAT
            if (spca0100.autoExtend = '0');
               isAutoExt = cFalse;
            else;
               isAutoExt = cTrue;
            endif;
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isAutoExt;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getUsrSpcAutoExt...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the initial value of a given user space.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   initValue     - Returns the initialvalue of a given user space.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getUsrSpcInitValue...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getUsrSpcInitValue...                                                                RADDAT
     D                 PI             1A          varying
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D initValue       S              1A   inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D spca0100        DS                  likeds(SPCA0100_t) inz
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         initValue = '';
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve user space attributes
         spca0100 = rtvUsrSpcAttr(i_usrSpc: lib: msg);
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if (msg.ID <> cMSG_ID_OK);
            initValue = '';
         else;                                                                              //RADDAT
            initValue = spca0100.initValue;
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return initValue;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getUsrSpcInitValue...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the size of a given user space.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_size        - The new size of the user space.
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   size          - Returns the new size of the user space.                             RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_chgUsrSpcSize...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_chgUsrSpcSize...                                                                     RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)
     D  i_size                       10I 0 const
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz(-1)                                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields QUSCUSAT: size attribute                                               RADDAT
     D sizeAttr        DS                  likeds(QUSRSPC_attr_size_t) inz                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         size = -1;
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Change the size attribute of the given user space                               //RADDAT
         sizeAttr.key     = QUSRSPC_ATTR_SIZE;
         sizeAttr.dataLen = %size(sizeAttr.size);
         sizeAttr.size    = i_size;

         chgUsrSpcAttr(i_usrSpc: lib: sizeAttr: msg);                                       //RADDAT
                                                                                            //RADDAT
         size = f_getUsrSpcSize(i_usrSpc: lib: *omit);
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return size;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_chgUsrSpcSize...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the automatic extendibility of a given user space.                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_isAutoExt   - cTrue, if the user space is automatically                           RADDAT
      *                   extended by the system when the end of the space                    RADDAT
      *                   is encountered.                                                     RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isAutoExt     - New state of the automatic extendibility attribute                  RADDAT
      *                   of the user space.                                                  RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_chgUsrSpcAutoExt...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_chgUsrSpcAutoExt...                                                                  RADDAT
     D                 PI              N                                                      RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_isAutoExt                    N   const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isAutoExt       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields QUSCUSAT: automatic extendibility                                      RADDAT
     D autoExtAttr     DS                  likeds(QUSRSPC_auto_extend_t) inz                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         isAutoExt = cFalse;                                                                //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);                                                            //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Change the automatic extendibility of the given user space                      //RADDAT
         autoExtAttr.key     = QUSRSPC_ATTR_AUTO_EXTEND;                                    //RADDAT
         autoExtAttr.dataLen = %size(autoExtAttr.autoExtend);                               //RADDAT
         if (i_isAutoExt);                                                                  //RADDAT
            autoExtAttr.autoExtend = '1';                                                   //RADDAT
         else;                                                                              //RADDAT
            autoExtAttr.autoExtend = '0';                                                   //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
0        chgUsrSpcAttr(i_usrSpc: lib: autoExtAttr: msg);                                    //RADDAT
                                                                                            //RADDAT
         isAutoExt = f_getUsrSpcAutoExt(i_usrSpc: lib: *omit);
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);                                                            //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isAutoExt;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_chgUsrSpcAutoExt...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Changes the initial value of a given user space.                                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_initValue   - The initial value of the user space.                                RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   initValue     - Returns the new size of the user space on success,                  RADDAT
      *                   else -1.                                                            RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_chgUsrSpcInitValue...                                                                RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_chgUsrSpcInitValue...                                                                RADDAT
     D                 PI             1A          varying                                     RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_initValue                   1A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D initValue       S              1A   varying inz                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      *                                                                                       RADDAT
      *  Helper fields QUSCUSAT: initial value                                                RADDAT
     D initValueAttr   DS                  likeds(QUSRSPC_initial_value_t) inz                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         initValue = '';                                                                    //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);                                                            //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Change the initial value of the given user space                                //RADDAT
         initValueAttr.key     = QUSRSPC_ATTR_INITIAL_VALUE;                                //RADDAT
         initValueAttr.dataLen = %size(initValueAttr.value);                                //RADDAT
         initValueAttr.value   = i_initValue;                                               //RADDAT
                                                                                            //RADDAT
         chgUsrSpcAttr(i_usrSpc: lib: initValueAttr: msg);                                  //RADDAT
                                                                                            //RADDAT
         initValue = f_getUsrSpcInitValue(i_usrSpc: lib: *omit);
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);                                                            //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return initValue;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_chgUsrSpcInitValue...                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given user space.                                                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isDeleted     - Returns cTrue on success, else cFalse.                              RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_dltUsrSpc...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_dltUsrSpc...                                                                         RADDAT
     D                 PI              N                                                      RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isDeleted       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qUsrSpc         DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         isDeleted = cFalse;                                                                //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Delete user space                                                               //RADDAT
         qUsrSpc.name = i_usrSpc;                                                           //RADDAT
         qUsrSpc.lib  = i_lib;                                                              //RADDAT
         errCode      = f_newApiErrCode(cTrue);                                             //RADDAT
         QUSDLTUS(qUsrSpc: errCode);                                                        //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if   f_isApiError(errCode);                                                        //RADDAT
            isDeleted = cFalse;                                                             //RADDAT
            msg       = f_cvtApiErrCodeToMsg(errCode);                                      //RADDAT
         else;                                                                              //RADDAT
            isDeleted = cTrue;                                                              //RADDAT
            msg       = f_newMsg(cMSG_ID_OK);                                               //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   isDeleted;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_dltUsrSpc...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Activates a service program.                                                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_srvPgm      - The name of the service program.                                    RADDAT
      *   i_lib         - The library that contains the service program.                      RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   actSrvPgm     - Returns a structure that contains the                               RADDAT
      *                   system pointer to the service program and                           RADDAT
      *                   the activation mark.                                                RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_activateSrvPgm...                                                                    RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_activateSrvPgm...                                                                    RADDAT
     D                 PI                         likeds(actSrvPgm_t )                        RADDAT
     D  i_srvPgm                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D actSrvPgm       DS                  likeds(actSrvPgm_t ) inz                           RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D actMark         S                   like(actInf_t.actMark ) inz
     D pSrvPgm         S               *   inz  procptr
     D actInf          DS                  likeds(actInf_t       ) inz
     D errCode         DS                  likeds(errCode_t      ) inz
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D rcvm0200        DS                  likeds(rcvm0200_t     ) inz                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         clear actSrvPgm;                                                                   //RADDAT
         msg = f_newMsg(cMSG_ID_OK);                                                        //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check object exist                                                              //RADDAT
                                                                                            //RADDAT
         // Get system pointer                                                              //RADDAT
         monitor;                                                                           //RADDAT
            pSrvPgm = rslvsp(WLI_SRVPGM: i_srvPgm: lib: AUTH_OBJ_MGMT);                     //RADDAT
         on-error;                                                                          //RADDAT
            rcvm0200 = f_rcvPgmMsg(cMsg_Any: '': cMsg_Act_Rmv);                             //RADDAT
            msg = f_newMsg('CPF9898': 'Object ' + %trim(lib) + '/'
                                                + %trim(i_srvPgm)
                                                + ' not found');                            //RADDAT
         endmon;                                                                            //RADDAT
                                                                                            //RADDAT
         // Actiate service program                                                         //RADDAT
         if pSrvPgm <> *NULL;                                                               //RADDAT
            errCode = f_newApiErrCode(cTrue);                                               //RADDAT
            QleActBndPgm(pSrvPgm: actMark: actInf: %size(actInf): errCode);                 //RADDAT
                                                                                            //RADDAT
            if f_isAPIError(errCode);                                                       //RADDAT
               msg = f_cvtApiErrCodeToMsg(errCode);                                         //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if pSrvPgm <> *NULL;
            actSrvPgm.procptr = pSrvPgm;
            actSrvPgm.actMark = actMark;
            actSrvPgm.name    = i_srvPgm;
            actSrvPgm.lib     = lib;
         endif;
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return actSrvPgm;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_activateSrvPgm...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets a procedure pointer by name.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_srvPgm      - The name of the service program.                                    RADDAT
      *   i_lib         - The library that contains the service program.                      RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_proc        - The name of the procedure.
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   procptr       - Returns a pointer to the procedure on success                       RADDAT
      *                   else *NULL.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getProcPtrByName...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getProcPtrByName...                                                                  RADDAT
     D                 PI                         likeds(actProc_t  )
     D  i_proc                      256A   const                                              RADDAT
     D  i_actSrvPgm                        const  likeds(actSrvPgm_t)                         RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D actProc         DS                  likeds(actProc_t ) inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D typeExpItem     S             10I 0 inz
     D pExpItem        S               *   inz  procptr
     D errCode         DS                  likeds(errCode_t      ) inz
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         clear actProc;
         msg = f_newMsg(cMSG_ID_OK);                                                        //RADDAT
                                                                                            //RADDAT
         // Get procedure pointer by name                                                   //RADDAT
         errCode = f_newApiErrCode(cTrue);
         QleGetExp(i_actSrvPgm.actMark: *omit: %len(%trimR(i_proc))
                   : %trimR(i_proc): pExpItem: typeExpItem: errCode);
         if f_isAPIError(errCode);
            msg = f_cvtApiErrCodeToMsg(errCode);
         endif;                                                                             //RADDAT

         if pExpItem <> *NULL;
            actproc.procptr = pExpItem;
            actproc.actMark = i_actSrvPgm.actMark;
            actproc.name    = i_proc;
            actproc.srvPgm  = i_actSrvPgm.name;
            actproc.lib     = i_actSrvPgm.lib;
         endif;
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return actProc;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getProcPtrByName...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the name of the library that contains a given object.                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_obj         - The name of the object whose library is resolved.                   RADDAT
      *   i_lib         - The special value of the library name that contains                 RADDAT
      *                   the object.                                                         RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_type        - The type of the object.                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rtnLib        - Name of the library that contains the object.                       RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getObjLib...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getObjLib...                                                                         RADDAT
     D                 PI            10A                                                      RADDAT
     D  i_obj                        10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_type                       10A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rtnLib          S             10A   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D objd0100        DS                  likeds(objd0100_t) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if   %parms >= p_lib;                                                              //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                              //R//RADD
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if   isPresent = 1;                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve the object description                                                 //RADDAT
         objd0100 = f_rtvObjD(i_obj: lib: i_type: 'OBJD0100': msg);                         //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if (msg.ID = cMSG_ID_OK);                                                          //RADDAT
            rtnLib = objd0100.rtnLib;                                                       //RADDAT
         else;                                                                              //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToMyself);                                      //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return rtnLib;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getObjLib...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Converts a QSYS object name to a path.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_obj         - The name of the object.
      *   i_lib         - The name of the object library.
      *                   Default:        *LIBL                                               RADDAT
      *   i_mbr         - The name of the member, when the object is a file.                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   path          - IFS path name.
      *=========================================================================              RADDAT
      *  Examples:                                                                            RADDAT
      *   f_cvtQSYSObjNameToPath(qFile)                                                       RADDAT
      *   f_cvtQSYSObjNameToPath(qObj: '*DTAARA');
      *   f_cvtQSYSObjNameToPath(library: '*LIB');
      *   f_cvtQSYSObjNameToPath(object: '*OUTQ');
      *   f_cvtQSYSObjNameToPath(object: library: '*MSGQ');
      *   f_cvtQSYSObjNameToPath(object: library: member: '*FILE');
      *=========================================================================              RADDAT
     P f_cvtQSYSObjNameToPath...
     P                 B                   export                                             RADDAT
     D                 PI          5000A   varying opdesc
     D  i_obj                        40A   const  options(*varsize)                           RADDAT
     D  i_libOrType                  10A   const  options(*nopass: *omit)                     RADDAT
     D  i_mbrOrType                  10A   const  options(*nopass: *omit)                     RADDAT
     D  i_objType                    10A   const  options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D path            S           5000A   varying inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_obj           C                   const(1)                                           RADDAT
     D p_libOrType     C                   const(2)                                           RADDAT
     D p_mbrOrType     C                   const(3)                                           RADDAT
     D p_objType       C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D libOrType       S                   like(i_libOrType ) inz                             RADDAT
     D mbrOrType       S                   like(i_mbrOrType ) inz                             RADDAT
     D objType         S                   like(i_objType   ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D objInf          DS                  likeds(strInf_t  ) inz
     D qQSYSObj        DS                  likeds(qQSYSObj_t) inz
     D qFile           DS                  likeds(qFile_t   ) inz
     D qObj            DS                  likeds(qFile_t   ) inz
      *
     D object          S             10A   inz
     D library         S             10A   inz
     D member          S             10A   inz
     D type            S             10A   inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE

         // Process optional parameter values ...
         if (%parms() >= p_libOrType and %addr(i_libOrType) <> *null);
            libOrType = i_libOrType;
         else;
            libOrType = '';
         endif;

         if (%parms() >= p_mbrOrType and %addr(i_mbrOrType) <> *null);
            mbrOrType = i_mbrOrType;
         else;
            mbrOrType = '';
         endif;

         if (%parms() >= p_objType and %addr(i_objType) <> *null);
            objType = i_objType;
         else;
            objType = '';
         endif;

         CEEGSI(p_obj: objInf.dataType: objInf.curlen: objInf.maxlen: *omit);

         select;
         when (objInf.curlen = 40);   // 1 parameter
            p_assert(%parms() = 1
                     : 'Expected number of parameters: 1');
            qQSYSObj = i_obj;
            object = qQSYSObj.name;
            library = qQSYSObj.lib;
            member = qQSYSObj.mbr;
            type = qQSYSObj.type;

         when (objInf.curlen = 30);   // 2 parameters
            p_assert(%parms() = 1 or %parms() = 2
                     : 'Expected number of parameters: 1 or 2');
            p_assert(%parms() = 1 or (%parms() = 2 and libOrType = '*FILE')
                     : 'Expected number of parameters: 1 or (2 and *FILE)');
            qFile = i_obj;
            object = qFile.name;
            library = qFile.lib;
            member = qFile.mbr;
            if (%parms() = 1);
               type = '*FILE';
            else;
               type = libOrType;
            endif;

         when (objInf.curlen = 20);   // 2 parameters
            p_assert(%parms() = 2
                     : 'Expected number of parameters: 2');
            qObj = i_obj;
            object = qObj.name;
            library = qObj.lib;
            member = '';
            type = libOrType;

         other;                       // 3 or 4 parameters, eg:
            p_assert(%parms() = 2 or %parms() = 3 or
                     (%parms() = 4 and objType = '*FILE')
                     : 'Expected number of parameters: 2, 3 or (4 and *FILE)');
            object = i_obj;
            select;
            when (%parms() = 2);
               library = '';
               member = '';
               type = libOrType;
            when (%parms() = 3);
               library = libOrType;
               member = '';
               type = mbrOrType;
            other;
               library = libOrType;
               member = mbrOrType;
               type = objType;
            endsl;
         endsl;

         if (type = '*LIB');
            library = object;
            object = '';
         else;
            if (library = '');
               library = '*LIBL';
            endif;
         endif;

         path = '/QSYS.LIB';

         if (library <> '' and library <> 'QSYS');
            path += '/';

            select;
            when (library = '*ALL');
               path += '%ALL%';
            when (library = '*ALLUSR');
               path += '%ALLUSR%';
            when (library = '*CURLIB');
               path += '%CURLIB%';
            when (library = '*LIBL');
               path += '%LIBL%';
            when (library = '*USRLIBL');
               path += '%USRLIBL%';
            other;
               path += %trim(library);
            endsl;

            path += '.LIB';
         endif;

         if (object <> '');
            path += '/';

            select;
            when (object = '*ALL');
               path += '%ALL%';
            other;
               path += %trim(object);
            endsl;

            path += '.' + %trimR(%subst(type: 2));
         endif;

         if (member <> '');
            path += '/';

            path += %trim(member);

            path += '.MBR';
         endif;
                                                                                            //RADDAT
         return path;
                                                                                            //RADDAT
      /END-FREE
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Resolve Integrated File System Path Name into
      *  QSYS Object Name
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_path        - Path of the object.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   qQSYSObj      - resolved QSYS object name.
      *=========================================================================              RADDAT
     P f_cvtPathToQSYSObjName...
     P                 B                   export                                             RADDAT
     D                 PI                  likeds(qQSYSObj_t)
     D  i_path                     5000A   const  varying options(*varsize)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D qQSYSObj        DS                  likeds(qQSYSObj_t)
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D pathName        ds                  likeds(Qlg_Path_Name_t) inz
     D qsys_info       ds                  likeds(qsys0100_t) inz
     D errCode         ds                  likeds(errCode_t) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE

         pathName = *ALLx'00';
         pathName.CCSID = QLG_PATH_JOB_CCSID;
         pathName.Country_ID = QLG_PATH_JOB_COUNTRYID;
         pathName.Language_ID = QLG_PATH_JOB_LANGUAGEID;
         pathName.Reserved = *ALLx'00';
         pathName.Path_Type = QLG_CHAR_SINGLE;
         pathName.Path_Length = %len(%trimR(i_path));
         pathName.Path_Name_Delimiter = '/';
         pathName.Reserved2 = *ALLx'00';
         pathName.Path_Name = i_path;
         errCode = f_newApiErrCode(cFalse);

         Qp0lCvtPathToQSYSObjName(
            pathName: qsys_info: 'QSYS0100': %size(qsys_info): 0: errCode);

         if (%trim(qsys_info.obj_type: x'00') = '' and
             %trim(qsys_info.lib_type: x'00') = '*LIB');
            qQSYSObj.name = %trimR(qsys_info.lib_name: x'00');
            qQSYSObj.lib = '';
            qQSYSObj.mbr = '';
            qQSYSObj.type = %trimR(qsys_info.lib_type: x'00');
         else;
            qQSYSObj.name = %trimR(qsys_info.obj_name: x'00');
            qQSYSObj.lib = %trimR(qsys_info.lib_name: x'00');
            qQSYSObj.mbr = %trimR(qsys_info.mbr_name: x'00');
            qQSYSObj.type = %trimR(qsys_info.obj_type: x'00');
         endif;

         select;
         when (qQSYSObj.lib = '%ALL%');
            qQSYSObj.lib = '*ALL';
         when (qQSYSObj.lib = '%ALLUSR%');
            qQSYSObj.lib = '*ALLUSR';
         when (qQSYSObj.lib = '%CURLIB%');
            qQSYSObj.lib = '*CURLIB';
         when (qQSYSObj.lib = '%LIBL%');
            qQSYSObj.lib = '*LIBL';
         when (qQSYSObj.lib = '%USRLIBL%');
            qQSYSObj.lib = '*USRLIBL';
         endsl;

         select;
         when (qQSYSObj.name = '%ALL%');
            qQSYSObj.name = '*ALL';
         endsl;
                                                                                            //RADDAT
         return qQSYSObj;
                                                                                            //RADDAT
      /END-FREE
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***
      *  Retrieves the attributes of a given user space.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   attrs         - Returns the attributes of a given user space.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P rtvUsrSpcAttr...
     P                 B
      *                                                                                       RADDAT
     D rtvUsrSpcAttr...
     D                 PI                         likeds(spca0100_t )
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D spca0100        DS                  likeds(spca0100_t ) inz                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D qUsrSpc         DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0                  inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         clear spca0100;
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Retrive user space attributes
         qUsrSpc.name = i_usrSpc;                                                           //RADDAT
         qUsrSpc.lib  = i_lib;                                                              //RADDAT
         errCode      = f_newApiErrCode(cTrue);                                             //RADDAT
         QUSRUSAT(spca0100: %size(spca0100): 'SPCA0100': qUsrSpc: errCode);
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if (f_isApiError(errCode));
            clear spca0100;
            msg = f_cvtApiErrCodeToMsg(errCode);
         else;                                                                              //RADDAT
            msg = f_newMsg(cMSG_ID_OK);
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return spca0100;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P rtvUsrSpcAttr...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Changes an attribute of a given user space.                                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_usrSpc      - The name of the user space.                                         RADDAT
      *   i_lib         - The library that contains the user space.                           RADDAT
      *                   Default:        *LIBL                                               RADDAT
      *   i_attr        - The attribute to change.                                            RADDAT
      *   o_msg         - The API error message.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isChanged     - Returns cTrue on success, else cFalse.                              RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P chgUsrSpcAttr...                                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D chgUsrSpcAttr...                                                                       RADDAT
     D                 PI              N                                                      RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_attr                      128A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isChanged       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_lib           C                   const(2)                                           RADDAT
     D p_msg           C                   const(4)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D lib             S                   like(i_lib       ) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D rtnLib          S             10A                      inz                             RADDAT
     D qUsrSpc         DS                  likeds(qObj_t    ) inz                             RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields QUSCUSAT                                                               RADDAT
     D userSpaceAttr   DS                  qualified                                          RADDAT
     D  numAttrs                     10I 0 inz                                                RADDAT
     D  attrToChg                   128A   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize return value                                                         //RADDAT
         isChanged = cFalse;                                                                //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_lib                                                                       //RADDAT
         if (%parms() >= p_lib);                                                            //RADDAT
            CEETSTA(isPresent: p_lib: *omit);                                               //RADDAT
         else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         if (isPresent = 1);                                                                //RADDAT
            lib = i_lib;                                                                    //RADDAT
         else;                                                                              //RADDAT
            lib = '*LIBL';                                                                  //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Change the attribute of the given user space                                    //RADDAT
         qUsrSpc.name = i_usrSpc;                                                           //RADDAT
         qUsrSpc.lib  = lib;                                                                //RADDAT
         userSpaceAttr.numAttrs  = 1;                                                       //RADDAT
         userSpaceAttr.attrToChg = i_attr;                                                  //RADDAT
         errCode = f_newApiErrCode(cTrue);                                                  //RADDAT
         QUSCUSAT(rtnLib: qUsrSpc: userSpaceAttr: errCode);                                 //RADDAT
                                                                                            //RADDAT
         // Set return value                                                                //RADDAT
         if (f_isApiError(errCode));                                                        //RADDAT
            isChanged = cFalse;                                                             //RADDAT
            msg       = f_cvtApiErrCodeToMsg(errCode);                                      //RADDAT
         else;                                                                              //RADDAT
            isChanged = cTrue;                                                              //RADDAT
            msg       = f_newMsg(cMSG_ID_OK);                                               //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
         if (%parms() >= p_msg);                                                            //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
            if (isPresent = 1);                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
            endif;                                                                          //RADDAT
         else;                                                                              //RADDAT
            if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
            endif;                                                                          //RADDAT
         endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isChanged;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P chgUsrSpcAttr...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R6  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R6 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Commands/Environment     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R6  - SrvPgm: Basic Routines - Commands                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  10.10.2006  Th.Raddatz    Changed f_getEnvVarByIndex to respect    *                 RADDAT
      *                            the length of the environment variable.  *                 RADDAT
      *                                                                     *                 RADDAT
      *  18.12.2007  Th.Raddatz    Changed f_execute() to receive an error  *                 RADDAT
      *                            message directly rather that trying to   *                 RADDAT
      *                            get it from the errorCode parameter.     *                 RADDAT
      *                                                                     *                 RADDAT
      *  05.02.2009  Th.Raddatz    Added p_wait() procedure.                *                 RADDAT
      *                                                                     *                 RADDAT
      *  24.03.2009  Th.Raddatz    Added prompter action support to         *                 RADDAT
      *                            f_execute().                             *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R6
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      *  len(envVarBuf) = len(name(128)) + len(value(1024)) + len(null-byte(1))               RADDAT
     D envVarBuf_t     S           1153A   based(pDummy)                                      RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Initialize Environment for Variables                                                 RADDAT
     D lf_initEnv...                                                                          RADDAT
     D                 PR            10I 0                                                    RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Executes a CL command.                                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_cmd         - The CL command to execute.
      *   i_typeCmdPrc  - The type of command processing.
      *                   Default:        cCMD_PRC_EXC_QCMDEXC
      *   o_msg         - The API error message.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isExecuted    - Returns cTrue when the command was executed                         RADDAT
      *                   successfully.
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_execute...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_execute...                                                                           RADDAT
     D                 PI              N   opdesc                                             RADDAT
     D  i_cmd                     16384A   const  options(*varsize)                           RADDAT
     D  i_typeCmdPrc                 10I 0 const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isExecuted      S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_cmd           C                   const(1)                                           RADDAT
     D p_typeCmdPrc    C                   const(2)                                           RADDAT
     D p_msg           C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D typeCmdPrc      S                   like(i_typeCmdPrc) inz                             RADDAT
     D msg             DS                  likeds(o_msg     ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEEGSI                                                                 RADDAT
     D si_cmd          DS                  likeds(strInf_t  ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields QCAPCMD                                                                RADDAT
     D optCtrlBlk      DS                  qualified                                          RADDAT
     D  typeCmdPrc             1      4I 0 inz(0)                               QCMDEXC       RADDAT
     D  DBCS_data              5      5A   inz('0')                             ignore DBCS   RADDAT
     D  prmtAction             6      6A   inz('0')                             never prompt  RADDAT
     D  cmdStrSyntax           7      7A   inz('0')                             AS/400 Syntax RADDAT
     D  msgRtvKey              8     11A   inz(*BLANKS)                         no msg key    RADDAT
     D  res_01                12     20A   inz(*ALLx'00')                                     RADDAT
      *                                                                                       RADDAT
     D chgCmd          S            128A   inz                                                RADDAT
     D chgCmdBytAvl    S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
     D errCode         DS                  likeds(errCode_t ) inz                             RADDAT
      *                                                                                       RADDAT
      *  Helper fields CEETSTA                                                                RADDAT
     D isPresent       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D rcvm0200        DS                  likeds(rcvm0200_t) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Retrieve string information of i_cmd                                            //RADDAT
         CEEGSI(p_cmd: si_cmd.datatype: si_cmd.curlen: si_cmd.maxlen: *omit);               //RADDAT
                                                                                            //RADDAT
         // Process optional parameter values ...                                           //RADDAT
         // ... i_typeCmdPrc                                                                //RADDAT
 B01     if   %parms >= p_typeCmdPrc;                                                       //RADDAT
            CEETSTA(isPresent: p_typeCmdPrc: *omit);                                        //RADDAT
 X01     else;                                                                              //RADDAT
            isPresent = 0;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if   isPresent = 1;                                                                //RADDAT
            typeCmdPrc = i_typeCmdPrc;                                                      //RADDAT
 X01     else;                                                                              //RADDAT
            typeCmdPrc = cCMD_PRC_EXC_QCMDEXC;                                              //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Set options control block                                                       //RADDAT
         reset   optCtrlBlk;                                                                //RADDAT
         optCtrlBlk.typeCmdPrc = %bitand(typeCmdPrc: x'0000FFFF');                          //RADDAT
                                                                                            //RADDAT
         // Set prompter action                                                             //RADDAT
 B01     select;                                                                            //RADDAT
         when (f_isBitOn(cCMD_PRC_PROMPT_HELP: typeCmdPrc));                                //RADDAT
            optCtrlBlk.prmtAction = '3';                                                    //RADDAT
                                                                                            //RADDAT
         when (f_isBitOn(cCMD_PRC_PROMPT_ON_REQUEST: typeCmdPrc));                          //RADDAT
            optCtrlBlk.prmtAction = '2';                                                    //RADDAT
                                                                                            //RADDAT
         when (f_isBitOn(cCMD_PRC_PROMPT_ALWAYS: typeCmdPrc));                              //RADDAT
            optCtrlBlk.prmtAction = '1';                                                    //RADDAT
                                                                                            //RADDAT
 X01     other;                                                                             //RADDAT
            optCtrlBlk.prmtAction = '0';                                                    //RADDAT
                                                                                            //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         // Execute the command                                                             //RADDAT
         p_rmvPgmMsg(cMsg_Rmv_All);                                                         //RADDAT
                                                                                            //RADDAT
         monitor;                                                                           //RADDAT
            errCode = f_newApiErrCode(cFalse);                                              //RADDAT
            QCAPCMD(%subst(i_cmd: 1: si_cmd.curlen) :
                    si_cmd.curlen                   :
                    optCtrlBlk                      :
                    %size(optCtrlBlk)               :
                    'CPOP0100'                      :
                    chgCmd                          :
                    0                               :
                    chgCmdBytAvl                    :
                    errCode                         );                                      //RADDAT
            msg = f_newMsg(cMSG_ID_OK);                                                     //RADDAT
            isExecuted = cTrue;                                                             //RADDAT
         on-error;                                                                          //RADDAT
            rcvm0200 = f_rcvPgmMsg(cMsg_Any);                                               //RADDAT
            msg = f_cvtRcvMsgToMsg(rcvm0200: cMsg_Escape);                                  //RADDAT
            isExecuted = cFalse;                                                            //RADDAT
         endmon;                                                                            //RADDAT
                                                                                            //RADDAT
         // Process optional/omissible message parameter                                    //RADDAT
 B01     if   %parms >= p_msg;                                                              //RADDAT
            CEETSTA(isPresent: p_msg: *omit);                                               //RADDAT
 B02        if   isPresent = 1;                                                             //RADDAT
               o_msg = msg;                                                                 //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   msg.ID <> cMSG_ID_OK;                                                      //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv);                                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   isExecuted;                                                               //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_execute...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets an environment variable.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_envVar      - Name of environment variable to read.                               RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   value         - Returns the value of the environment variable.                      RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getEnvVar...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getEnvVar...                                                                         RADDAT
     D                 PI          1024A          varying                                     RADDAT
     D  i_pEnvVar                      *   const  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D value           S           1024A   varying   inz                                      RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D pValue          S               *   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         pValue = getenv(i_pEnvVar);                                                        //RADDAT
                                                                                            //RADDAT
 B01     if   pValue <> *NULL;                                                              //RADDAT
            value = %str(pValue);                                                           //RADDAT
 X01     else;                                                                              //RADDAT
            value = '';                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   value;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getEnvVar...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Sets an environment variable.                                                        RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_envVar      - Name of environment variable to read.                               RADDAT
      *   i_value       - Value of the environment variable.                                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isSet         - Returns cTrue when the variable was set                             RADDAT
      *                   successfully.                                                       RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_setEnvVar...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_setEnvVar...                                                                         RADDAT
     D                 PI              N                                                      RADDAT
     D  i_envVar                           const  like(envVar_t.name )                        RADDAT
     D  i_value                            const  like(envVar_t.value)                        RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D envVarBuf       S                   like(envVarBuf_t) inz                              RADDAT
     D rc              S             10I 0                   inz                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         envVarBuf = i_envVar + '=' + i_value + x'00';                                      //RADDAT
         rc = putenv(%addr(envVarBuf));                                                     //RADDAT

 B01     if   rc = 0;
            isSet = cTrue;
 X01     else;
            isSet = cFalse;
 E01     endif;
                                                                                            //RADDAT
         return   isSet;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_setEnvVar...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given environment variable.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_envVar      - Name of given environment variable to delete.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   value         - Returns the value of the environment variable.                      RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_delEnvVar...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_delEnvVar...                                                                         RADDAT
     D                 PI              N
     D  i_pEnvVar                      *   const  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isDeleted       S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         rc = Qp0zDltEnv(i_pEnvVar);

 B01     if   rc = 0;
            isDeleted = cTrue;
 X01     else;
            isDeleted = cFalse;
 E01     endif;
                                                                                            //RADDAT
         return   isDeleted;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_delEnvVar...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets the number of environment variables.                                            RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   numEnvVar     - Returns the number of environment variables                         RADDAT
      *                   on success, else -1.                                                RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getNumEnvVar...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getNumEnvVar...                                                                      RADDAT
     D                 PI            10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D numEnvVar       S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D ppEnvVar        S               *   based(pEnvVar)                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if lf_initEnv() = 0;                                                               //RADDAT
            pEnvVar = ENVIRON;                                                              //RADDAT
 B02        dow ppEnvVar <> *NULL;                                                          //RADDAT
               numEnvVar = numEnvVar + 1;                                                   //RADDAT
               pEnvVar   = pEnvVar + %size(pEnvVar);                                        //RADDAT
 E02        enddo;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            numEnvVar = -1;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   numEnvVar;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getNumEnvVar...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Gets an environment variable by its index.                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_index       - Index of the environment variable.                                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   envVar        - Returns an envVar structure.                                        RADDAT
      *                   envVar.name is blanks if the environment variable                   RADDAT
      *                   does not exist.                                                     RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_getEnvVarByIndex...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_getEnvVarByIndex...                                                                  RADDAT
     D                 PI                         likeds(envVar_t )                           RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D envVar          DS                  likeds(envVar_t ) inz                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D index           S                   like(i_index    ) inz                              RADDAT
     D ppEnvVar        S               *   based(pEnvVar)                                     RADDAT
     D length          S             10I 0                   inz                              RADDAT
      *                                                                                       RADDAT
      *  len(envVarBuf) = len(name(128)) + len(value(1024)) + len(null-byte(1))               RADDAT
     D envVarBuf       S                   like(envVarBuf_t) inz                              RADDAT
     D x               S             10I 0                   inz                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if lf_initEnv() = 0;                                                               //RADDAT
            pEnvVar = ENVIRON;                                                              //RADDAT
            index = 0;                                                                      //RADDAT
 B02        dow ppEnvVar <> *NULL and index < i_index;                                      //RADDAT
               index = index + 1;                                                           //RADDAT
 B03           if index < i_index;                                                          //RADDAT
                  pEnvVar   = pEnvVar + %size(pEnvVar);                                     //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        enddo;                                                                          //RADDAT
            clear envVar;                                                                   //RADDAT
 B02        if index = i_index;                                                             //RADDAT
               length = strlen(ppEnvVar);                                                   //RADDAT
               envVarBuf = %str(ppEnvVar);                                                  //RADDAT
               x = %scan('=': envVarBuf);                                                   //RADDAT
 B03           if x > 1;                                                                    //RADDAT
                  envVar.name = %subst(envVarBuf: 1: x-1);                                  //RADDAT
 B04              if x < %len(envVarBuf);                                                   //RADDAT
                     envVar.value = %subst(envVarBuf: x+1: length - x);                     //RADDAT
 X04              else;                                                                     //RADDAT
                     envVar.value = '';                                                     //RADDAT
 E04              endif;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   envVar;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_getEnvVarByIndex...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Waits for the specified number of seconds.                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_seconds     - Number of seconds to wait.                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P p_wait...                                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D p_wait...                                                                              RADDAT
     D                 PI                                                                     RADDAT
     D  i_seconds                    10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D mi_time         S              8A   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         mitime(mi_time: 0: 0: i_seconds: 0);                                               //RADDAT
                                                                                            //RADDAT
         waittime(mi_time: cWAIT_NORMAL + cWAIT_SIGNALS);                                   //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P p_wait...                                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** PRIVATE ***                                                                      RADDAT
      *  Initialize Environment for Variables                                                 RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_initEnv...                                                                          RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_initEnv...                                                                          RADDAT
     D                 PI            10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isInit          S               N   inz(cFalse) static                                 RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if not isInit;                                                                     //RADDAT
            rc = Qp0zInitEnv();                                                             //RADDAT
 B02        if rc = 0;                                                                      //RADDAT
               isInit = cTrue;                                                              //RADDAT
 E02        endif;                                                                          //RADDAT
 X01     else;                                                                              //RADDAT
            rc = 0;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   rc;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_initEnv...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R7  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R7 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Mathematics              "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R7  - SrvPgm: Basic Routines - Mathematics                  *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  08.10.2003                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *   4.02.2005  Th.Raddatz    Added f_genUUID() to generate a          *
      *                            Universal Unique Identifier (UUID).      *                 RADDAT
      *   8.03.2005  Th.Raddatz    Added f_genMD5() to generate a           *
      *                            MD5 fingerprint (hash code).             *                 RADDAT
      *   8.03.2005  Th.Raddatz    Added f_genSHA1() to generate a          *
      *                            SHA-1 fingerprint (hash code).           *                 RADDAT
      *   8.03.2005  Th.Raddatz    Added f_genSHA1() to generate a          *
      *                            SHA-1 fingerprint (hash code).           *                 RADDAT
      *  28.12.2005  Th.Raddatz    Added f_genCRC32() to generate a         *
      *                            CRC-32 check sum.                        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/BASICS1R7) +                *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< OPTIMIZE(*FULL );                                    *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R7                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      /if not defined(*V5R3M0)                                                              //RADDAT
 CPY  /COPY QBASICS1,MILIB                                                                    RADDAT
      /endif                                                                                  RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      /if defined(C_COMPILER)
     D c_crc32...                                                                             RADDAT
     D                 PR            10U 0        extproc('crc32')                            RADDAT
     D  crc                          10U 0 value                                              RADDAT
     D  buf                            *   value                                              RADDAT
     D  len                          10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      /else
     D lp_crc32Table...                                                                       RADDAT
     D                 PR                                                                     RADDAT
     D  io_crc32Table                10U 0        dim(256)                                    RADDAT
      *                                                                                       RADDAT
      /endif                                                                                  RADDAT
      /if not defined(*V5R2M0)                                                              //RADDAT
      *  Returns the bit-wise ANDing of the arguments.                                        RADDAT
     D lf_bitAND...                                                                           RADDAT
     D                 PR            10U 0                                                    RADDAT
     D  i_arg1                       10U 0 value                                              RADDAT
     D  i_arg2                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the bit-wise ORing of the arguments.                                         RADDAT
     D lf_bitOR...                                                                            RADDAT
     D                 PR            10U 0                                                    RADDAT
     D  i_arg1                       10U 0 value                                              RADDAT
     D  i_arg2                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the bit-wise exclusive ORing of the arguments.                               RADDAT
     D lf_bitXOR...                                                                           RADDAT
     D                 PR            10U 0                                                    RADDAT
     D  i_arg1                       10U 0 value                                              RADDAT
     D  i_arg2                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the bit-wise inverse of the bits of the argument.                            RADDAT
     D lf_bitNOT...                                                                           RADDAT
     D                 PR            10U 0                                                    RADDAT
     D  i_arg                        10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      /endif                                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Tests for one or more bits.                                                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_testBit     - The bits that are tested.                                           RADDAT
      *   i_value       - The numeric value that is tested for the bits.                      RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isOn          - Returns cTrue when the bits specified at i_testBit                  RADDAT
      *                   are set.                                                            RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_isBitOn...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_isBitOn...                                                                           RADDAT
     D                 PI              N                                                      RADDAT
     D  i_testBit                    10U 0 value                                              RADDAT
     D  i_value                      10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isOn            S               N   inz(cTrue)                                         RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S              3I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(i_testBit > 0:
                  'i_testBit is out of range. It must be greater than 0');                  //RADDAT
                                                                                            //RADDAT
         p_assert(i_value >= 0:
                  'i_value is out of range. It must be greater than/equal 0');              //RADDAT
                                                                                            //RADDAT
         isOn = cTrue;                                                                      //RADDAT
                                                                                            //RADDAT
 B01     for   x = (%size(i_value) * 8) - 1 downTo 0 ;                                      //RADDAT
 B02        if   tstbts(%addr(i_testBit): x) <> 0;                                          //RADDAT
 B03           if   tstbts(%addr(i_value): x) = 0;                                          //RADDAT
                  isOn = cFalse;                                                            //RADDAT
                  leave;                                                                    //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         return   isOn;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_isBitOn...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Computes the logarithm base 10 of a given value.                                     RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_value       - The numeric value.                                                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   log           - The logarithm value of i_value.                                     RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_log10...                                                                             RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_log10...                                                                             RADDAT
     D                 PI             8F                                                      RADDAT
     D  i_value                       8F   value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D log             S              8F   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         CEESDLG1(i_value: log);                                                            //RADDAT
                                                                                            //RADDAT
         return   log;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_log10...                                                                             RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Computes the length of a RPG integer field from its buffer length                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_value       - The numeric value.                                                  RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   log           - The logarithm value of i_value.                                     RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_clcLengthOfRPGIntFieldFromBufSize...                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_clcLengthOfRPGIntFieldFromBufSize...                                                 RADDAT
     D                 PI             5U 0                                                    RADDAT
     D  i_buffSize                    5U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D tempResult      S              8F   inz                                                RADDAT
     D rpgLength       S              5U 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         tempResult = f_log10(2 ** (8 * i_buffSize));                                       //RADDAT
                                                                                            //RADDAT
         // Always round up to the next unsigned integer                                    //RADDAT
         rpgLength  = %unsh(((tempResult * 10) + 5) / 10);                                  //RADDAT
                                                                                            //RADDAT
         return   rpgLength;                                                                //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_clcLengthOfRPGIntFieldFromBufSize...                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Generates a Universal Unique Identifier (UUID).                                      RADDAT
      *=========================================================================              RADDAT
      *  The UUID is unique as an identifier across all time and space and is                 RADDAT
      *  consistent with the Open Systems Foundation (OSF) Distributed Computing              RADDAT
      *  Environments (DCE) version 1 UUID specification described in the DCE's               RADDAT
      *  "Architecture Environment Specification/Distributed Computing: for                   RADDAT
      *  Remote Procedure Calls", Appendix A.                                                 RADDAT
      *  http://publib.boulder.ibm.com/infocenter/iseries/v5r3/ic2924/index.htm               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_option      - Specifies how to return the UUID.                                   RADDAT
      *                   Default:        *HEX                                                RADDAT
      *                   cUUID_HEX     - Returns a hexadecimal UUID with                     RADDAT
      *                                   a length of 16 byte.                                RADDAT
      *                   cUUID_STRING  - Returns the string representation                   RADDAT
      *                                   of a UUID with a length of 32 bytes.                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   uuid          - The UUID of type structure of type uuid_t:                          RADDAT
      *                       uuid.value   - the value of the generated UUID                  RADDAT
      *                       uuid.length  - the length of the generated UUID                 RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_genUUID...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_genUUID...
     D                 PI                         likeds(uuid_t  )                            RADDAT
     D  i_option                      5U 0 value  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D uuid            DS                  likeds(uuid_t) inz                                 RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_option        C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D option          S                   like(i_option) inz                                 RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D uuidHex         S             16A   inz                                                RADDAT
     D uuidString      S             32A   inz                                                RADDAT
     D uuidTemplate    DS                  likeds(uuid_template_t) inz                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Get optional parameters                                                         //RADDAT
 B01     if %parms >= p_option;
            option = i_option;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            option = cUUID_HEX;                                                             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         p_assert((option = cUUID_HEX) or (option = cUUID_STRING):
                  'i_option is not valid.');                                                //RADDAT
                                                                                            //RADDAT
         // Generate UUID:                                                                  //RADDAT
         uuidTemplate.bytPrv   = %size(uuid_t);                                             //RADDAT
         uuidTemplate.bytAvl   = 0;                                                         //RADDAT
         uuidTemplate.reserved = *ALLx'00';                                                 //RADDAT
         uuidTemplate.uuid     = *ALLx'00';                                                 //RADDAT
         genUUID(%addr(uuidTemplate));
                                                                                            //RADDAT
 B01     if uuidTemplate.bytAvl = 0;                                                        //RADDAT
            uuid.value  = '';                                                               //RADDAT
            uuid.length = 0;                                                                //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if option = cUUID_HEX;                                                          //RADDAT
               // Return UUID as hex value                                                  //RADDAT
               uuid.value  = uuidTemplate.uuid;                                             //RADDAT
               uuid.length = %size(uuidTemplate.uuid);                                      //RADDAT
 X02        else;                                                                           //RADDAT
               // Convert hexadecimal UUID to string                                        //RADDAT
               uuid.value  = f_cvtBufferToHexString(%addr(uuidTemplate.uuid):
                                                    %size(uuidTemplate.uuid));              //RADDAT
               uuid.length = %size(uuidTemplate.uuid) * 2;                                  //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   uuid;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_genUUID...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Generates a MD5 fingerprint (hash code).                                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pString     - Pointer to a buffer or a variable or a literal                      RADDAT
      *                   that contains the source string.                                    RADDAT
      *   i_options     - Specifies how to return the MD5.                                    RADDAT
      *                   Default:        cMD5_HEX + cMD5_ONLY                                RADDAT
      *                   cMD5_HEX      - Returns a hexadecimal 16-byte MD5                   RADDAT
      *                                   fingerprint (hash code).                            RADDAT
      *                   cMD5_STRING   - Returns a hexadecimal 32-byte MD5                   RADDAT
      *                                   fingerprint (hash code).                            RADDAT
      *                   cMD5_ONLY     - Use this option to pass the
      *                                   complete buffer.
      *                   cMD5_FIRST    - Use this option to pass the first
      *                                   portion of a multi-part buffer.
      *                   cMD5_MIDDLE   - Use this option to pass the middle
      *                                   portions of a multi-part buffer.
      *                   cMD5_FINAL    - Use this option to pass the final
      *                                   portion of a multi-part buffer.
      *   i_length      - Length of the source string. If a variable or                       RADDAT
      *                   a string is specified at i_pString, length                          RADDAT
      *                   can be omitted.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   md5           - The MD5 of type structure of type md5_t:                            RADDAT
      *                       md5.value    - the value of the generated MD5                   RADDAT
      *                       md5.length   - the length of the generated MD5                  RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_genMD5...                                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_genMD5...                                                                            RADDAT
     D                 PI                         likeds(md5_t   )                            RADDAT
     D  i_pString                      *   const  options(*string)                            RADDAT
     D  i_options                     5U 0 const  options(*nopass)                            RADDAT
     D  i_length                     10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D MD5             DS                  likeds(md5_t  ) inz                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_options       C                   const(2)                                           RADDAT
     D p_length        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D options         S                   like(i_options) inz                                RADDAT
     D length          S                   like(i_length ) inz                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isOutputString  S               N   inz(cFalse)
     D hashContext     S            160A   static   inz(*ALLx'00' )
     D ctrlsSeq        S                   like(controls.sequence) inz                        RADDAT
     D numOptions      DS                  qualified                                          RADDAT
     D  sequence                      5U 0 inz                                                RADDAT
     D  output                        5U 0 inz                                                RADDAT
     D controls        DS                  likeds(cipherCtrls_t  ) inz                        RADDAT
     D msg             DS                  likeds(msg_t          ) inz                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Get optional parameters ...                                                     //RADDAT
         // ... options                                                                     //RADDAT
 B01     if %parms >= p_options;
            options = i_options;
 X01     else;                                                                              //RADDAT
            options = cMD5_HEX + cMD5_ONLY;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... length                                                                      //RADDAT
 B01     if %parms >= p_length;                                                             //RADDAT
            length = i_length;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            length = strlen(i_pString);                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check/get sequence options                                                      //RADDAT
         numOptions.sequence = 0;                                                           //RADDAT
 B01     if f_isBitOn(cMD5_ONLY  : options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cMD5_ONLY;
            ctrlsSeq = cCIPHER_ONLY;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cMD5_FIRST : options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cMD5_FIRST;
            ctrlsSeq = cCIPHER_FIRST;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cMD5_MIDDLE: options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cMD5_MIDDLE;
            ctrlsSeq = cCIPHER_MIDDLE;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cMD5_FINAL : options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cMD5_FINAL;
            ctrlsSeq = cCIPHER_FINAL;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     select;
         when  numOptions.sequence =  0;
            ctrlsSeq = cCIPHER_ONLY;
         when  numOptions.sequence <> 1;
            msg = f_newMsg('CPF9898':
                           'Invalid number of sequence options': cMsg_Escape);
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endsl;
                                                                                            //RADDAT
         // Check/get output options
         numOptions.output = 0;                                                             //RADDAT
 B01     if f_isBitOn(cMD5_STRING: options);
            numOptions.output = numOptions.output + 1;                                      //RADDAT
            options        = options - cMD5_STRING;
            isOutputString = cTrue;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cMD5_HEX: options);
            numOptions.output = numOptions.output + 1;                                      //RADDAT
            options        = options - cMD5_HEX;
            isOutputString = cFalse;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  numOptions.output <> 1;                                                        //RADDAT
            msg = f_newMsg('CPF9898':
                           'Invalid number of output options': cMsg_Escape);
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  options <> 0;
            msg = f_newMsg('CPF9898':
                           'Invalid option flags found': cMsg_Escape);
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Initialize cipher function                                                      //RADDAT
 B01     if (ctrlsSeq = cCIPHER_ONLY) or (ctrlsSeq = cCIPHER_FIRST);
            hashContext = *ALLx'00';
 E01     endif;

         controls.function      = x'0005';                                                  //RADDAT
         controls.hashAlg       = cCIPHER_MD5;   // Hex 00 = MD5
                                                 // Hex 01 = SHA-1                          //RADDAT
         controls.sequence      = ctrlsSeq;      // Hex 00 = Only                           //RADDAT
                                                 // Hex 01 = First                          //RADDAT
                                                 // Hex 02 = Middle                         //RADDAT
                                                 // Hex 03 = Final                          //RADDAT
         controls.dataLength    = length;                                                   //RADDAT
         controls.output        = cCIPHER_HASH;  // Hex 00 =  Hash                          //RADDAT
                                                 // Hex 01 =  HMAC                          //RADDAT
         controls.reserved_1    = *ALLx'00';                                                //RADDAT
         controls.hashContext   = %addr(hashContext);                                       //RADDAT
         controls.HMACKey       = *NULL;                                                    //RADDAT
         controls.HMACKeyLength = 0;                                                        //RADDAT
         controls.reserved_2    = *ALLx'00';                                                //RADDAT
                                                                                            //RADDAT
         // Generate MD5 hash code.
         cipher(%addr(MD5.value): %addr(controls): i_pString);                              //RADDAT
                                                                                            //RADDAT
 B01     if (ctrlsSeq = cCIPHER_ONLY) or (ctrlsSeq = cCIPHER_FINAL);
 B02        if isOutputString;
               // Convert hexadecimal MD5 to string
               MD5.value  = f_cvtBufferToHexString(%addr(MD5.value): 16);
               MD5.length = 32;
 X02        else;
               // Return MD5 as hex value
               MD5.length = 16;
 E02        endif;
 X01     else;
            MD5.value  = '';
            MD5.length = 0;
 E01     endif;
                                                                                            //RADDAT
         return   MD5;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_genMD5...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Generates a SHA-1 fingerprint (hash code).                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pString     - Pointer to a buffer or a variable or a literal                      RADDAT
      *                   that contains the source string.                                    RADDAT
      *   i_options     - Specifies how to return the SHA-1.                                  RADDAT
      *                   Default:        cSHA1_HEX + cSHA1_ONLY                              RADDAT
      *                   cSHA1_HEX     - Returns a hexadecimal 20-byte SHA-1                 RADDAT
      *                                   fingerprint (hash code).                            RADDAT
      *                   cSHA1_STRING  - Returns a hexadecimal 40-byte SHA-1                 RADDAT
      *                                   fingerprint (hash code).                            RADDAT
      *                   cSHA1_ONLY    - Use this option to pass the
      *                                   complete buffer.
      *                   cSHA1_FIRST   - Use this option to pass the first
      *                                   portion of a multi-part buffer.
      *                   cSHA1_MIDDLE  - Use this option to pass the middle
      *                                   portions of a multi-part buffer.
      *                   cSHA1_FINAL   - Use this option to pass the final
      *                                   portion of a multi-part buffer.
      *   i_length      - Length of the source string. If a variable or                       RADDAT
      *                   a string is specified at i_pString, length                          RADDAT
      *                   can be omitted.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   sha1          - The SHA-1 of type structure of type sha1_t:                         RADDAT
      *                       sha1.value   - the value of the generated SHA-1                 RADDAT
      *                       sha1.length  - the length of the generated SHA-1                RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_genSHA1...                                                                           RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_genSHA1...                                                                           RADDAT
     D                 PI                         likeds(sha1_t  )                            RADDAT
     D  i_pString                      *   const  options(*string)                            RADDAT
     D  i_options                     5U 0 const  options(*nopass)                            RADDAT
     D  i_length                     10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D SHA1            DS                  likeds(sha1_t ) inz                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_options       C                   const(2)                                           RADDAT
     D p_length        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D options         S                   like(i_options) inz                                RADDAT
     D length          S                   like(i_length ) inz                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isOutputString  S               N   inz(cFalse)
     D hashContext     S            160A   static   inz(*ALLx'00' )
     D ctrlsSeq        S                   like(controls.sequence) inz                        RADDAT
     D numOptions      DS                  qualified                                          RADDAT
     D  sequence                      5U 0 inz                                                RADDAT
     D  output                        5U 0 inz                                                RADDAT
     D controls        DS                  likeds(cipherCtrls_t) inz                          RADDAT
     D msg             DS                  likeds(msg_t        ) inz                          RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Get optional parameters ...                                                     //RADDAT
         // ... options                                                                     //RADDAT
 B01     if %parms >= p_options;
            options = i_options;
 X01     else;                                                                              //RADDAT
            options = cSHA1_HEX + cSHA1_ONLY;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... length                                                                      //RADDAT
 B01     if %parms >= p_length;                                                             //RADDAT
            length = i_length;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            length = strlen(i_pString);                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check/get sequence options                                                      //RADDAT
         numOptions.sequence = 0;                                                           //RADDAT
 B01     if f_isBitOn(cSHA1_ONLY  : options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cSHA1_ONLY;
            ctrlsSeq = cCIPHER_ONLY;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cSHA1_FIRST : options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cSHA1_FIRST;
            ctrlsSeq = cCIPHER_FIRST;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cSHA1_MIDDLE: options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cSHA1_MIDDLE;
            ctrlsSeq = cCIPHER_MIDDLE;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cSHA1_FINAL : options);
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cSHA1_FINAL;
            ctrlsSeq = cCIPHER_FINAL;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     select;
         when  numOptions.sequence =  0;
            ctrlsSeq = cCIPHER_ONLY;
         when  numOptions.sequence <> 1;
            msg = f_newMsg('CPF9898':
                           'Invalid number of sequence options': cMsg_Escape);
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endsl;
                                                                                            //RADDAT
         // Check output options                                                            //RADDAT
         numOptions.output = 0;                                                             //RADDAT
 B01     if f_isBitOn(cSHA1_STRING: options);
            numOptions.output = numOptions.output + 1;                                      //RADDAT
            options        = options - cSHA1_STRING;
            isOutputString = cTrue;
 E01     endif;                                                                             //RADDAT
 B01     if f_isBitOn(cSHA1_HEX: options);
            numOptions.output = numOptions.output + 1;                                      //RADDAT
            options        = options - cSHA1_HEX;
            isOutputString = cFalse;
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  numOptions.output <> 1;                                                        //RADDAT
            msg = f_newMsg('CPF9898':
                           'Invalid number of output options': cMsg_Escape);
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  options <> 0;
            msg = f_newMsg('CPF9898':
                           'Invalid option flags found': cMsg_Escape);
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Initialize cipher function                                                      //RADDAT
 B01     if (ctrlsSeq = cCIPHER_ONLY) or (ctrlsSeq = cCIPHER_FIRST);
            hashContext = *ALLx'00';
 E01     endif;

         controls.function      = x'0005';                                                  //RADDAT
         controls.hashAlg       = cCIPHER_SHA1;  // Hex 00 = MD5                            //RADDAT
                                                 // Hex 01 = SHA-1                          //RADDAT
         controls.sequence      = ctrlsSeq;      // Hex 00 = Only                           //RADDAT
                                                 // Hex 01 = First                          //RADDAT
                                                 // Hex 02 = Middle                         //RADDAT
                                                 // Hex 03 = Final                          //RADDAT
         controls.dataLength    = length;                                                   //RADDAT
         controls.output        = cCIPHER_HASH;  // Hex 00 =  Hash                          //RADDAT
                                                 // Hex 01 =  HMAC                          //RADDAT
         controls.reserved_1    = *ALLx'00';                                                //RADDAT
         controls.hashContext   = %addr(hashContext);                                       //RADDAT
         controls.HMACKey       = *NULL;                                                    //RADDAT
         controls.HMACKeyLength = 0;                                                        //RADDAT
         controls.reserved_2    = *ALLx'00';                                                //RADDAT
                                                                                            //RADDAT
         // Generate SHA-1 hash code.
         cipher(%addr(SHA1.value): %addr(controls): i_pString);                             //RADDAT
                                                                                            //RADDAT
 B01     if (ctrlsSeq = cCIPHER_ONLY) or (ctrlsSeq = cCIPHER_FINAL);
 B02        if isOutputString;
               // Convert hexadecimal SHA-1 to string
               SHA1.value  = f_cvtBufferToHexString(%addr(SHA1.value): 20);
               SHA1.length = 40;
 X02        else;
               // Return SHA-1 as hex value
               SHA1.length = 20;
 E02        endif;
 X01     else;
            SHA1.value  = '';
            SHA1.length = 0;
 E01     endif;
                                                                                            //RADDAT
         return   SHA1;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_genSHA1...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Calculates a CRC32 checksum for a given string buffer.                               RADDAT
      *=========================================================================              RADDAT
      *  Code was taken and converted to RPG from:
      *  http://www.vbaccelerator.com/home/VB/Code/Libraries/CRC32/article.asp
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pString     - Pointer to a buffer or a variable or a literal                      RADDAT
      *                   that contains the source string.                                    RADDAT
      *   i_options     - Specifies how to return the CRC32.                                  RADDAT
      *                   Default:        cCRC32_ONLY.                                        RADDAT
      *                   cCRC32_ONLY   - Use this option to pass the                         RADDAT
      *                                   complete buffer.                                    RADDAT
      *                   cCRC32_FIRST  - Use this option to pass the first                   RADDAT
      *                                   portion of a multi-part buffer.                     RADDAT
      *                   cCRC32_MIDDLE - Use this option to pass the middle                  RADDAT
      *                                   portions of a multi-part buffer.                    RADDAT
      *                   cCRC32_FINAL  - Use this option to pass the final                   RADDAT
      *                                   portion of a multi-part buffer.                     RADDAT
      *   i_length      - Length of the source string. If a variable or                       RADDAT
      *                   a string is specified at i_pString, length                          RADDAT
      *                   can be omitted.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   crc32         - The CRC32 of type structure of type crc32_t:                        RADDAT
      *                       crc32.value  - the value of the generated CRC32                 RADDAT
      *                       crc32.length - the length of the generated CRC32                RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P f_genCRC32...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D f_genCRC32...                                                                          RADDAT
     D                 PI                         likeds(crc32_t )                            RADDAT
     D  i_pString                      *   const  options(*string)                            RADDAT
     D  i_options                     5U 0 const  options(*nopass)                            RADDAT
     D  i_length                     10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D CRC32           DS                  likeds(crc32_t) inz                                RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_options       C                   const(2)                                           RADDAT
     D p_length        C                   const(3)                                           RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D options         S                   like(i_options) inz                                RADDAT
     D length          S                   like(i_length ) inz                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D ctrlsSeq        S             10I 0                       inz
     D aBufChar        S              3U 0 based(pABufChar     )                              RADDAT
     D i               S             10U 0 inz                                                RADDAT
     D iLookup         S             10U 0 inz                                                RADDAT
     D numOptions      DS                  qualified                                          RADDAT
     D  sequence                      5U 0                       inz
     D msg             DS                  likeds(msg_t        ) inz                          RADDAT
      *
      *  Static helper fields                                                                 RADDAT
     D                 DS                                              static                 RADDAT
      /if defined(C_COMPILER)                                                                 RADDAT
     D  crc32Result                  10U 0 inz                                                RADDAT
      /else                                                                                   RADDAT
     D  crc32Result                  10U 0 inz                                                RADDAT
      /endif                                                                                  RADDAT
      /if not defined(C_COMPILER)                                                             RADDAT
     D crc32Result1_1          1      1A                                                      RADDAT
     D crc32Result1_3          1      3A                                                      RADDAT
     D crc32Result2_4          2      4A                                                      RADDAT
      *                                                                                       RADDAT
     D isInit          S               N   inz(cFalse)                 static                 RADDAT
     D crc32Table      S             10U 0 inz                         static                 RADDAT
     D                                     dim(256)                                           RADDAT
      /endif                                                                                  RADDAT
      /if not defined(*V5R3M0)                                                                RADDAT
     D tmpResult       S             10U 0                                                    RADDAT
     D hex000000FF     S             10U 0 inz(x'FF')                                         RADDAT
      /endif                                                                                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Get optional parameters ...                                                     //RADDAT
         // ... options                                                                     //RADDAT
 B01     if %parms >= p_options;                                                            //RADDAT
            options = i_options;                                                            //RADDAT
 X01     else;                                                                              //RADDAT
            options = cCRC32_ONLY;                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // ... length                                                                      //RADDAT
 B01     if %parms >= p_length;                                                             //RADDAT
            length = i_length;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            length = strlen(i_pString);                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Check/get sequence options                                                      //RADDAT
         numOptions.sequence = 0;                                                           //RADDAT
      /if defined(*V5R2M0)                                                                  //RADDAT
 B01     if %bitAnd(cCRC32_ONLY  : options) = cCRC32_ONLY;                                  //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_ONLY;                                               //RADDAT
            ctrlsSeq = cCIPHER_ONLY;                                                        //RADDAT
 E01     endif;                                                                             //RADDAT
 B01     if %bitAnd(cCRC32_FIRST : options) = cCRC32_FIRST;                                 //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_FIRST;                                              //RADDAT
            ctrlsSeq = cCIPHER_FIRST;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
 B01     if %bitAnd(cCRC32_MIDDLE: options) = cCRC32_MIDDLE;                                //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_MIDDLE;                                             //RADDAT
            ctrlsSeq = cCIPHER_MIDDLE;                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
 B01     if %bitAnd(cCRC32_FINAL : options) = cCRC32_FINAL;                                 //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_FINAL;                                              //RADDAT
            ctrlsSeq = cCIPHER_FINAL;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
      /else                                                                                 //RADDAT
 B01     if lf_bitAnd(cCRC32_ONLY  : options) = cCRC32_ONLY;                                //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_ONLY;                                               //RADDAT
            ctrlsSeq = cCIPHER_ONLY;                                                        //RADDAT
 E01     endif;                                                                             //RADDAT
 B01     if lf_bitAnd(cCRC32_FIRST : options) = cCRC32_FIRST;                               //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_FIRST;                                              //RADDAT
            ctrlsSeq = cCIPHER_FIRST;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
 B01     if lf_bitAnd(cCRC32_MIDDLE: options) = cCRC32_MIDDLE;                              //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_MIDDLE;                                             //RADDAT
            ctrlsSeq = cCIPHER_MIDDLE;                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
 B01     if lf_bitAnd(cCRC32_FINAL : options) = cCRC32_FINAL;                               //RADDAT
            numOptions.sequence = numOptions.sequence + 1;                                  //RADDAT
            options  = options - cCRC32_FINAL;                                              //RADDAT
            ctrlsSeq = cCIPHER_FINAL;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
      /endif                                                                                //RADDAT
                                                                                            //RADDAT
 B01     select;                                                                            //RADDAT
         when  numOptions.sequence =  0;                                                    //RADDAT
            ctrlsSeq = cCIPHER_ONLY;                                                        //RADDAT
         when  numOptions.sequence <> 1;                                                    //RADDAT
            msg = f_newMsg('CPF9898':
                           'Invalid number of sequence options': cMsg_Escape);              //RADDAT
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if  options <> 0;                                                                  //RADDAT
            msg = f_newMsg('CPF9898':
                           'Invalid option flags found': cMsg_Escape);                      //RADDAT
            f_sndPgmMsg(msg);                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Initialize CRC32                                                                //RADDAT
 B01     if (ctrlsSeq = cCIPHER_ONLY) or (ctrlsSeq = cCIPHER_FIRST);
      /if not defined(C_COMPILER)                                                           //RADDAT
            crc32Result = x'FFFFFFFF';                                                      //RADDAT
 B02        if not isInit;                                                                  //RADDAT
               lp_crc32Table(crc32Table);                                                   //RADDAT
               isInit = cTrue;                                                              //RADDAT
 E02        endif;                                                                          //RADDAT
      /else                                                                                 //RADDAT
            crc32Result = x'FFFFFFFF';                                                      //RADDAT
      /endif                                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Compute CRC32 checksum                                                          //RADDAT
      /if defined(C_COMPILER)                                                               //RADDAT
         crc32Result = c_crc32(crc32Result: i_pString: length);                             //RADDAT
      /elseif defined(*V5R2M0)                                                              //RADDAT
 B01     for i = 0 to length - 1;                                                           //RADDAT
            pABufChar = i_pString + i;                                                      //RADDAT
            iLookup   = %bitxor(%bitand(crc32Result: x'FF'): aBufChar);                     //RADDAT
            crc32Result2_4 = crc32Result1_3;                         // nasty shift-right   //RADDAT
            crc32Result1_1 = x'00';                                  // 8-bit               //RADDAT
            crc32Result = %bitxor(crc32Result: crc32Table(iLookup + 1));                    //RADDAT
 E01     endfor;                                                                            //RADDAT
      /else                                                                                 //RADDAT
 B01     for i = 0 to length - 1;                                                           //RADDAT
            pABufChar = i_pString + i;                                                      //RADDAT
            // iLookup   = %bitxor(%bitand(crc32ResultU: x'FF'): aBufChar);                 //RADDAT
            iLookup = 0;                                                                    //RADDAT
            ANDSTR(%addr(tmpResult)  : %addr(crc32Result):
                   %addr(hex000000FF): 4);                                                  //RADDAT
            XORSTR(%addr(iLookup)+3: %addr(tmpResult)+3:
                   %addr(aBufChar): 1);                                                     //RADDAT
            crc32Result2_4 = crc32Result1_3;                         // nasty shift-right   //RADDAT
            crc32Result1_1 = x'00';                                  // 8-bit               //RADDAT
            // crc32Result = %bitxor(crc32Result: crc32Table(iLookup + 1));                 //RADDAT
            tmpResult = crc32Table(iLookup + 1);                                            //RADDAT
            XORSTR(%addr(crc32Result): %addr(crc32Result):
                   %addr(tmpResult  ): 4);                                                  //RADDAT
 E01     endfor;                                                                            //RADDAT
      /endif                                                                                //RADDAT

         // Set return value                                                                //RADDAT
 B01     if (ctrlsSeq = cCIPHER_ONLY) or (ctrlsSeq = cCIPHER_FINAL);                        //RADDAT
      /if defined(*V5R2M0)                                                                  //RADDAT
            crc32Result = %bitnot(crc32Result);                                             //RADDAT
      /else                                                                                 //RADDAT
            COMSTR(%addr(crc32Result): %addr(crc32Result): 4);                              //RADDAT
      /endif                                                                                //RADDAT
            // Convert hexadecimal CRC32 to string
            CRC32.value = f_cvtBufferToHexString(%addr(crc32Result):
                                                 %size(crc32Result));                       //RADDAT
            CRC32.length = 8;                                                               //RADDAT
 X01     else;                                                                              //RADDAT
            CRC32.value  = '';                                                              //RADDAT
            CRC32.length = 0;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   CRC32;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P f_genCRC32...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      /if not defined(C_COMPILER)                                                             RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Initialize crc32Table with official used by CRC32 in PKZip.                          RADDAT
      *  Often the polynomial is shown reversed (04C11DB7).                                   RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lp_crc32Table...                                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lp_crc32Table...                                                                       RADDAT
     D                 PI                                                                     RADDAT
     D  io_crc32Table                10U 0        dim(256)                                    RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D i               S             10I 0 inz                                                RADDAT
     D j               S             10I 0 inz                                                RADDAT
     D dwCrc           S             10U 0 inz                                                RADDAT
     D                 DS                                                                     RADDAT
     D dwPolynomial                  10U 0                                                    RADDAT
     D dwPolynomialH           1      4    inz(x'EDB88320')                                   RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01        for i = 0 to 255;                                                               //RADDAT
               dwCrc = i;                                                                   //RADDAT
 B02           for j = 8 downto 1;                                                          //RADDAT
      /if defined(*V5R2M0)                                                                  //RADDAT
 B03              if %bitand(dwCrc: x'01') <> 0;                                            //RADDAT
                     dwCrc = %bitand(%uns(
                                %bitand(dwCrc: x'FFFFFFFE') / 2): x'7FFFFFFF');             //RADDAT
                     dwCrc = %bitxor(dwCrc: dwPolynomial);                                  //RADDAT
 X03              else;                                                                     //RADDAT
                     dwCrc = %bitand(%uns(
                                %bitand(dwCrc: x'FFFFFFFE') / 2): x'7FFFFFFF');             //RADDAT
 E03              endif;                                                                    //RADDAT
      /else                                                                                 //RADDAT
 B03              if lf_bitand(dwCrc: x'01') <> 0;                                          //RADDAT
                     dwCrc = lf_bitand(%uns(
                               lf_bitand(dwCrc: x'FFFFFFFE') / 2): x'7FFFFFFF');            //RADDAT
                     dwCrc = lf_bitxor(dwCrc: dwPolynomial);                                //RADDAT
 X03              else;                                                                     //RADDAT
                     dwCrc = lf_bitand(%uns(
                               lf_bitand(dwCrc: x'FFFFFFFE') / 2): x'7FFFFFFF');            //RADDAT
 E03              endif;                                                                    //RADDAT
      /endif                                                                                //RADDAT
 E02           endfor;                                                                      //RADDAT
               io_crc32Table(i+1) = dwCrc;                                                  //RADDAT
 E01        endfor;                                                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lp_crc32Table...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      /endif                                                                                  RADDAT
      /if not defined(*V5R2M0)                                                              //RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns the bit-wise ANDing of the arguments.                                        RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_bitAND...                                                                           RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_bitAND...                                                                           RADDAT
     D                 PI            10U 0                                                    RADDAT
     D  i_arg1                       10U 0 value                                              RADDAT
     D  i_arg2                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D result          S             10U 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         ANDSTR(%addr(result): %addr(i_arg1): %addr(i_arg2): %len(result));                 //RADDAT
                                                                                            //RADDAT
         return result;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_bitAND...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns the bit-wise ORing of the arguments.                                         RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_bitOR...                                                                            RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_bitOR...                                                                            RADDAT
     D                 PI            10U 0                                                    RADDAT
     D  i_arg1                       10U 0 value                                              RADDAT
     D  i_arg2                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D result          S             10U 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         XORSTR(%addr(result): %addr(i_arg1): %addr(i_arg2): %len(result));                 //RADDAT
                                                                                            //RADDAT
         return result;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_bitOR...                                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns the bit-wise exclusive ORing of the arguments.                               RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_bitXOR...                                                                           RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_bitXOR...                                                                           RADDAT
     D                 PI            10U 0                                                    RADDAT
     D  i_arg1                       10U 0 value                                              RADDAT
     D  i_arg2                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D result          S             10U 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         XORSTR(%addr(result): %addr(i_arg1): %addr(i_arg2): %len(result));                 //RADDAT
                                                                                            //RADDAT
         return result;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_bitXOR...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
    R *  *** private ***                                                                      RADDAT
      *  Returns the bit-wise inverse of the bits of the argument.                            RADDAT
      *=========================================================================              RADDAT
      *                                                                                       RADDAT
     P lf_bitNOT...                                                                           RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_bitNOT...                                                                           RADDAT
     D                 PI            10U 0                                                    RADDAT
     D  i_arg                        10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D result          S             10U 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         COMSTR(%addr(result): %addr(i_arg): %len(result));                                 //RADDAT
                                                                                            //RADDAT
         return result;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_bitNOT...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      /endif                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R8  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R8 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Handle/Memory            "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R8  - SrvPgm: Basic Routines - Handle/Memory                *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  30.12.2004                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@Tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  27.04.2005  Th.Raddatz    Replaced handle_t.value with             *                 RADDAT
      *                            handle_t.pUserHandle to dynamically      *                 RADDAT
      *                            allocate storage for user handle.        *
      *                                                                     *                 RADDAT
      *  28.04.2005  Th.Raddatz    Fixed problem that let HANDLE_isNULL()   *
      *                            crash, because of wrong assert().        *                 RADDAT
      *                                                                     *                 RADDAT
      *  14.02.2006  Th.Raddatz    Added procedures:  MEMORY_allocate()     *                 RADDAT
      *                                               MEMORY_freeAll()      *                 RADDAT
      *                                                                     *                 RADDAT
      *  21.02.2006  Th.Raddatz    Changed HANDLE_isTypeOf() to return      *                 RADDAT
      *                            'invalid handle' in case the handle      *                 RADDAT
      *                            is *NULL.                                *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN                                                                                 RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R8                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
     D baseHandle_t    DS            32    qualified   based(pDummy)   align                  RADDAT
     D  type                         20A                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      *
      /if not defined(*V5R2M0)                                                                RADDAT
     D handle_t        DS                  qualified   based(pDummy)   align                  RADDAT
     D  baseHandle                         like(baseHandle_t  )                               RADDAT
     D  pUserHandle                    *
      /else                                                                                   RADDAT
     D handle_t        DS                  qualified   based(pDummy)   align                  RADDAT
     D  baseHandle                         likeds(baseHandle_t)                               RADDAT
     D  pUserHandle                    *                                                      RADDAT
      /endif                                                                                  RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported Prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,HEAPAPI
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
     D g_handleList    S               *   dim(32767) inz                                     RADDAT
      *                                                                                       RADDAT
     D g_mmStatus      DS                  qualified                                          RADDAT
     D  numAlloc                     10U 0 inz(0)                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new handle.                                                                RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_type        - The type of the handle.                                             RADDAT
      *   i_size        - The size of memory needed for the handle data.                      RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   aHandle       - Returns the handle on success, else a NULL handle.                  RADDAT
      *=========================================================================              RADDAT
     P HANDLE_new...                                                                          RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D HANDLE_new...                                                                          RADDAT
     D                 PI                         like(HANDLE_handle_t)                       RADDAT
     D  i_type                             value  like(HANDLE_type_t  )                       RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D aHandle         S                   like(HANDLE_handle_t) inz                          RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D handle          DS                  likeds(handle_t    ) based(pHandle)
      *
      * V5R1
     D baseHandle      DS                  likeds(baseHandle_t) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Find a free handle element                                                      //RADDAT
         aHandle = %lookup(*NULL: g_handleList);                                            //RADDAT
                                                                                            //RADDAT
         // If there is no free element, ...                                                //RADDAT
 B01     if   aHandle = 0;                                                                  //RADDAT
            // then return a NULL handle                                                    //RADDAT
            aHandle = HANDLE_null();                                                        //RADDAT
 X01     else;                                                                              //RADDAT
            // else allocate memory for a base handle                                       //RADDAT
            // and the size of memory requested.                                            //RADDAT
            pHandle = %alloc(%size(baseHandle_t) + i_size);                                 //RADDAT
            g_handleList(aHandle) = pHandle;                                                //RADDAT
                                                                                            //RADDAT
            // Initialize handle - V5R3                                                     //RADDAT
            // handle.baseHandle.type = i_type;
            // handle.baseHandle.size = i_size;
            // handle.pUserHandle = %alloc(baseHandle.size);
            // memset(handle.pUserHandle: x'00': baseHandle.size);

            // Initialize handle - V5R1                                                     //RADDAT
            baseHandle.type = i_type;
            baseHandle.size = i_size;
            handle.baseHandle = baseHandle;
            handle.pUserHandle = %alloc(baseHandle.size);
            memset(handle.pUserHandle: x'00': baseHandle.size);
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   aHandle;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P HANDLE_new...                                                                          RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns a NULL handle.                                                               RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   aHandle       - Returns a NULL handle.                                              RADDAT
      *=========================================================================              RADDAT
     P HANDLE_null...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D HANDLE_null...                                                                         RADDAT
     D                 PI                         like(HANDLE_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D aHandle         S                   like(HANDLE_handle_t) inz                          RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Return a NULL handle                                                            //RADDAT
         aHandle = 0;                                                                       //RADDAT
                                                                                            //RADDAT
         return   aHandle;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P HANDLE_null...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks a handle for a NULL value.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_handle      - A given handle.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isNull        - Returns cTrue if the handle is NULL, else cFalse.                   RADDAT
      *=========================================================================              RADDAT
     P HANDLE_isNull...                                                                       RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D HANDLE_isNull...                                                                       RADDAT
     D                 PI              N                                                      RADDAT
     D  i_handle                           value  like(HANDLE_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isNull          S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D handle          DS                  likeds(handle_t) based(pHandle)                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         // Also allow 0 here!
         p_assert(i_handle >= 0 and i_handle <= %elem(g_handleList):
                  'Value of io_handle is out of range');                                    //RADDAT
                                                                                            //RADDAT
         // Get handle adress                                                               //RADDAT
 B01     if   i_handle = 0;
            pHandle = *NULL;
 X01     else;
            pHandle = g_handleList(i_handle);
 E01     endif;
                                                                                            //RADDAT
         // Check handle NULL value                                                         //RADDAT
 B01     if   pHandle = *NULL;                                                              //RADDAT
            isNull = cTrue;                                                                 //RADDAT
 X01     else;                                                                              //RADDAT
            isNull = cFalse;                                                                //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   isNull;                                                                   //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P HANDLE_isNull...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Checks the type of a given handle.                                                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_handle      - A given handle.                                                     RADDAT
      *   i_type        - The type of the handle.                                             RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isValid       - Returns cTrue on success, else cFalse.                              RADDAT
      *=========================================================================              RADDAT
     P HANDLE_isTypeOf...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D HANDLE_isTypeOf...                                                                     RADDAT
     D                 PI              N                                                      RADDAT
     D  i_handle                           value  like(HANDLE_handle_t)                       RADDAT
     D  i_type                             value  like(HANDLE_type_t  )                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isValid         S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D handle          DS                  likeds(handle_t) based(pHandle)                    RADDAT
      *
      /if not defined(*V5R2M0)                                                                RADDAT
     D baseHandle      DS                  likeds(baseHandle_t) inz
      /endif                                                                                  RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_handle < 1 or i_handle > %elem(g_handleList));                               //RADDAT
            isValid = cFalse;                                                               //RADDAT
            return isValid;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get handle adress                                                               //RADDAT
         pHandle = g_handleList(i_handle);                                                  //RADDAT
                                                                                            //RADDAT
 B01     if pHandle <> *NULL;                                                               //RADDAT
                                                                                            //RADDAT
      /if not defined(*V5R2M0)                                                              //RADDAT
            baseHandle = handle.baseHandle;                                                 //RADDAT
 B02        if baseHandle.type = i_type;                                                    //RADDAT
               isValid = cTrue;                                                             //RADDAT
 X02        else;                                                                           //RADDAT
               isValid = cFalse;                                                            //RADDAT
 E02        endif;                                                                          //RADDAT
      /else                                                                                 //RADDAT
 B02        if handle.baseHandle.type = i_type;                                             //RADDAT
               isValid = cTrue;                                                             //RADDAT
 X02        else;                                                                           //RADDAT
               isValid = cFalse;                                                            //RADDAT
 E02        endif;                                                                          //RADDAT
      /endif                                                                                //RADDAT
 X01     else;                                                                              //RADDAT
            isValid = cFalse;                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return   isValid;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P HANDLE_isTypeOf...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Retrieves a pointer to the handle data from a given handle.                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_handle      - A given handle.                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pHandle       - Returns the pointer of a given handle.                              RADDAT
      *=========================================================================              RADDAT
     P HANDLE_getPointer...                                                                   RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D HANDLE_getPointer...                                                                   RADDAT
     D                 PI              *                                                      RADDAT
     D  i_handle                           value  like(HANDLE_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pUserHandle     S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D handle          DS                  likeds(handle_t) based(pHandle)                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(i_handle >= 1 and i_handle <= %elem(g_handleList):
                  'Value of io_handle is out of range');                                    //RADDAT
                                                                                            //RADDAT
         // Get handle adress                                                               //RADDAT
         pHandle = g_handleList(i_handle);                                                  //RADDAT
                                                                                            //RADDAT
         // Get address of user handle
         pUserHandle = handle.pUserHandle;
                                                                                            //RADDAT
         return   pUserHandle;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P HANDLE_getPointer...                                                                   RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes a given handle.                                                              RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_handle      - The handle to delete.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P HANDLE_delete...                                                                       RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D HANDLE_delete...                                                                       RADDAT
     D                 PI                                                                     RADDAT
     D  io_handle                                 like(HANDLE_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D handle          DS                  likeds(handle_t) based(pHandle)                    RADDAT
      *
      * V5R1
     D baseHandle      DS                  likeds(baseHandle_t) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(io_handle >= 1 and io_handle <= %elem(g_handleList):
                  'Value of io_handle is out of range');                                    //RADDAT
                                                                                            //RADDAT
         // Get handle adress                                                               //RADDAT
         pHandle = g_handleList(io_handle);                                                 //RADDAT
                                                                                            //RADDAT
         p_assert(pHandle <> *NULL:
                  'Handle address is already *NULL');                                       //RADDAT
                                                                                            //RADDAT
         // Initialize handle memory - V5R3
         // memset(handle.pUserHandle: x'00': baseHandle.size);
         // handle.baseHandle.size = 0;
         // handle.baseHandle.type = *ALLx'00';
                                                                                            //RADDAT
         // Initialize handle memory - V5R1
         baseHandle = handle.baseHandle;
         memset(handle.pUserHandle: x'00': baseHandle.size);
         dealloc(N) handle.pUserHandle;
         baseHandle.size = 0;
         baseHandle.type = *ALLx'00';
         handle.baseHandle = baseHandle;
                                                                                            //RADDAT
         // Free handle memory                                                              //RADDAT
         dealloc(N) pHandle;                                                                //RADDAT
                                                                                            //RADDAT
         // Free index in handle list                                                       //RADDAT
         g_handleList(io_handle) = *NULL;                                                   //RADDAT
                                                                                            //RADDAT
         // Free user handle                                                                //RADDAT
         io_handle = HANDLE_null();                                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P HANDLE_delete...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Allocates a memory cell and keeps track of it.                                       RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_aMemList    - Pointer to the last cell of the chain of memory call.
      *   i_size        - The number of bytes to allocate.                                    RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pMemory       - A pointer to the memory cell.                                       RADDAT
      *=========================================================================              RADDAT
     P MEMORY_allocate...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MEMORY_allocate...                                                                     RADDAT
     D                 PI              *                                                      RADDAT
     D  io_aMemList                    *
     D  i_size                       10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMemory         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *                                                                                       RADDAT
     D cell            DS                  qualified   based(pCell)                           RADDAT
     D  pPrvCell                       *                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%rem(i_size : %size(pDummy)) <> 0);                                            //RADDAT
            i_size = (%div(i_size : %size(pDummy)) + 1) * %size(pDummy);                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (i_size = 0);                                                                   //RADDAT
            pMemory = *NULL;                                                                //RADDAT
 X01     else;                                                                              //RADDAT
            pMemory = %alloc(i_size + %size(cell));                                         //RADDAT
            pCell   = pMemory + i_size;            // Position cell right after payload     //RADDAT
            cell.pPrvCell    = io_aMemList;        // Remember the address of the prv. cell //RADDAT
            cell.size        = i_size;             // Remember the size of the current cell //RADDAT
            io_aMemList      = pCell;              // Remember this cell                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pMemory;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MEMORY_allocate...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Frees all allocated memory cells.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_aMemList   - Pointer to the last cell of the chain of memory call.
      *                   returned from f_gsoap_Environment_new().                            RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P MEMORY_freeAll...                                                                      RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MEMORY_freeAll...                                                                      RADDAT
     D                 PI                                                                     RADDAT
     D  io_aMemList                    *
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D pMemory         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
     D cell            DS                  qualified   based(pCell)                           RADDAT
     D  pPrvCell                       *                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
 B01     dow (io_aMemList <> *NULL);
            pCell            = io_aMemList;             // Get last cell allocated          //RADDAT
            pMemory          = pCell - cell.size;       // Get start address of this cell   //RADDAT
            io_aMemList      = cell.pPrvCell;           // Go back to prv. cell             //RADDAT
            cell.size        = 0;                       // Clear size of this cell          //RADDAT
            cell.pPrvCell    = *NULL;                   // Clear mem-ptr of this cell       //RADDAT
            free(pMemory);                              // Free memory of this cell         //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MEMORY_freeAll...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Frees a given memory cell.                                                           RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pMem       - Pointer to the memory cell to be free.                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void                                                                                RADDAT
      *=========================================================================              RADDAT
     P MEMORY_free...                                                                         RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MEMORY_free...                                                                         RADDAT
     D                 PI                                                                     RADDAT
     D  io_aMemList                    *                                                      RADDAT
     D  io_pMem                        *                                                      RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D pMemory         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
     D prvCell         DS                  qualified   based(pPrvCell)                        RADDAT
     D  pPrvCell                       *                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
     D cell            DS                  qualified   based(pCell)                           RADDAT
     D  pPrvCell                       *                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
     D nextCell        DS                  qualified   based(pNextCell)                       RADDAT
     D  pPrvCell                       *                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         // Return to caller because there's nothing to do.                                 //RADDAT
 B01     if io_aMemList = *NULL;                                                            //RADDAT
            return;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // When we start searching for the requested cell,                                 //RADDAT
         // there is no cell before the current cell.                                       //RADDAT
         pPrvCell = *NULL;                                                                  //RADDAT
                                                                                            //RADDAT
         // Point "cell" to last allocated cell.                                            //RADDAT
         pCell = io_aMemList;                                                               //RADDAT
                                                                                            //RADDAT
         // Spin through chain on allocated memory cells                                    //RADDAT
         // searching for the cell to free:                                                 //RADDAT
 B01     dow (pCell <> *NULL);                                                              //RADDAT
            pMemory = pCell - cell.size;       // Get start address of this cell
                                                                                            //RADDAT
            // If we hit the cell to delete ...                                             //RADDAT
 B02        if pMemory = io_pMem;                                                           //RADDAT
               // ... let "nextCel" point to next cell in chain of cells.                   //RADDAT
               pNextCell        = cell.pPrvCell;                                            //RADDAT
                                                                                            //RADDAT
               // If there is no cell before the cell to delete ...                         //RADDAT
 B03           if pPrvCell = *NULL;                                                         //RADDAT
                  // ... set pointer of "nextCell" as the start of the list of cells.       //RADDAT
                  io_aMemList = pNextCell;                                                  //RADDAT
 X03           else;                                                                        //RADDAT
                  // ... else link "nextCell" to "prvCell"                                  //RADDAT
                  prvCell.pPrvCell = pNextCell;                                             //RADDAT
 E03           endif;                                                                       //RADDAT
                                                                                            //RADDAT
               // Clear cell data and free memory                                           //RADDAT
               cell.size        = 0;                    // Clear size of this cell          //RADDAT
               cell.pPrvCell    = *NULL;                // Clear mem-ptr of this cell       //RADDAT
               free(pMemory);                           // Free memory of this cell         //RADDAT
                                                                                            //RADDAT
               pNextCell = *NULL;                                                           //RADDAT
               leave;   // Ready => Leave                                                   //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Rememeber this cell as the previous cell.                                    //RADDAT
            pPrvCell  = pCell;                                                              //RADDAT
                                                                                            //RADDAT
            // Goto next cell                                                               //RADDAT
            pCell = cell.pPrvCell;
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MEMORY_free...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Return the Tools/400 default memory manager implementation.                          RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   memMgr        - The default memory manager.
      *=========================================================================              RADDAT
     P MemoryManager_getDefaultManager...                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryManager_getDefaultManager...                                                     RADDAT
     D                 PI                        likeds(MemoryManager_manager_t)
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D memMgr          DS                  likeds(MemoryManager_manager_t) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         memMgr.pAllocate   = %paddr('BASICS1R8_MemoryManager_allocate');                   //RADDAT
         memMgr.pReallocate = %paddr('BASICS1R8_MemoryManager_reallocate');                 //RADDAT
         memMgr.pFree       = %paddr('BASICS1R8_MemoryManager_free');                       //RADDAT
                                                                                            //RADDAT
         return memMgr;                                                                     //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryManager_getDefaultManager...                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Reserve Storage Block
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_size        - The size, in bytes, of the desired memory allocation.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pMemory       - The reserved storage block.
      *=========================================================================              RADDAT
     P MemoryManager_allocate...                                                              RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryManager_allocate...                                                              RADDAT
     D                 PI              *
     D  i_size                       10U 0 value
     D  i_heapID                     10I 0 value  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMemory         S               *   inz
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_heapID        C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  Optional parameter fields                                                            RADDAT
     D heapID          S                   like(i_heapID ) inz                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%parms() >= p_heapID);                                                         //RADDAT
            heapID = i_heapID;                                                              //RADDAT
 X01     else;                                                                              //RADDAT
            heapID = 0;                                                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     select;                                                                            //RADDAT
         when (heapID = -1);                                                                //RADDAT
            // TODO: allocate teraspace memory                                              //RADDAT
         when (heapID > 0);                                                                 //RADDAT
            CEEGTST(heapID: i_size: pMemory: *omit);
 X01     other;                                                                             //RADDAT
            pMemory = malloc(i_size);                                                       //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (pMemory <> *NULL);                                                             //RADDAT
            g_mmStatus.numAlloc = g_mmStatus.numAlloc + 1;                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return pMemory;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryManager_allocate...                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Change Reserved Storage Block Size
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_pMem        - Address of a previously allocated memory block.
      *   i_size        - The number of bytes of storage to be allocated for
      *                   the new storage block.                                              RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   pMemory       - The reserved storage block.
      *=========================================================================              RADDAT
     P MemoryManager_reallocate...                                                            RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryManager_reallocate...                                                            RADDAT
     D                 PI              *
     D  i_pMem                         *   value
     D  i_size                       10U 0 value
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pMemory         S               *   inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         pMemory = realloc(i_pMem: i_size);
                                                                                            //RADDAT
         return pMemory;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryManager_reallocate...                                                            RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Release Storage Blocks
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_pMem       - A previously allocated storage block.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void
      *=========================================================================              RADDAT
     P MemoryManager_free...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryManager_free...
     D                 PI
     D  io_pMem                        *
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(io_pMem <> *NULL);                                                        //RADDAT
                                                                                            //RADDAT
         free(io_pMem);
         io_pMem = *NULL;
                                                                                            //RADDAT
         g_mmStatus.numAlloc = g_mmStatus.numAlloc - 1;                                     //RADDAT
                                                                                            //RADDAT
         return;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryManager_free...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Creates a new heap
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   i_initialSize - The initial amount of storage, in bytes, allocated
      *                   for the new heap.                                                   RADDAT
      *   i_increment   - The number of bytes by which the heap is extended
      *                   when it is necessary to enlarge the heap to satisfy                 RADDAT
      *                   an allocation request.                                              RADDAT
      *   i_allocStrat  - The allocation strategy used.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   headID        - The heap identifier of the created heap.
      *=========================================================================              RADDAT
     P MemoryManager_createHeap...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryManager_createHeap...
     D                 PI            10I 0
     D  i_initialSize                10I 0 const  options(*nopass: *omit)
     D  i_increment                  10I 0 const  options(*nopass: *omit)
     D  i_allocStrat                 10I 0 const  options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Return value
     D heapID          S             10I 0 inz
      *
      *  Parameter positions
     D p_initialSize   C                   1
     D p_increment     C                   2
     D p_allocStrat    C                   3
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D initialSize     S                   like(i_initialSize) inz
     D increment       S                   like(i_increment  ) inz
     D allocStrat      S                   like(i_allocStrat ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE

 B01     if (%parms() >= p_initialSize and %addr(i_initialSize) <> *NULL);
            initialSize = i_initialSize;
 X01     else;
            initialSize = 0;
 E01     endif;

 B01     if (%parms() >= p_increment and %addr(i_increment) <> *NULL);
            increment = i_increment;
 X01     else;
            increment = 0;
 E01     endif;

 B01     if (%parms() >= p_allocStrat and %addr(i_allocStrat) <> *NULL);
            allocStrat = i_allocStrat;
 X01     else;
            allocStrat = 0;
 E01     endif;
                                                                                            //RADDAT
         CEECRHP(heapID: initialSize: increment: allocStrat: *omit);
                                                                                            //RADDAT
         return heapID;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryManager_createHeap...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Deletes an existing heap.
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   io_heapID     - The heap identifier of the heap to be deleted.
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   void
      *=========================================================================              RADDAT
     P MemoryManager_deleteHeap...
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D MemoryManager_deleteHeap...
     D                 PI
     D  io_heapID                    10I 0
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                   RADDAT
      /FREE
                                                                                            //RADDAT
         CEEDSHP(io_heapID: *omit);
         io_heapID = 0;
                                                                                            //RADDAT
         return;
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P MemoryManager_deleteHeap...
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing BASICS1R9  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "BASICS1R9 "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Display Information      "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *=====================================================================*                 RADDAT
      *  BASICS1R9  - SrvPgm: Basic Routines - Display Information          *                 RADDAT
      *=====================================================================*                 RADDAT
      *  Author  :  Thomas Raddatz                                          *                 RADDAT
      *  Date    :  22.06.2005                                              *                 RADDAT
      *  E-mail  :  thomas.raddatz@tools400.de                              *                 RADDAT
      *  Homepage:  www.tools400.de                                         *                 RADDAT
      *=====================================================================*                 RADDAT
      *                                                                     *                 RADDAT
      *  This software is free software, you can redistribute it and/or     *                 RADDAT
      *  modify it under the terms of the GNU General Public License (GPL)  *                 RADDAT
      *  as published by the Free Software Foundation.                      *                 RADDAT
      *                                                                     *                 RADDAT
      *  See GNU General Public License for details.                        *                 RADDAT
      *          http://www.opensource.org                                  *                 RADDAT
      *          http://www.opensource.org/licenses/gpl-license.html        *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *  History:                                                           *                 RADDAT
      *                                                                     *                 RADDAT
      *  Datum       Name          nderung                                 *                 RADDAT
      *  ----------  ------------  ---------------------------------------  *                 RADDAT
      *  23.01.2009  Th.Raddatz    Renamed f_getDisplayMode() to            *                 RADDAT
      *                            Display_getMode().                       *                 RADDAT
      *                            Added Display_supportsDS4().             *                 RADDAT
      *                                                                     *                 RADDAT
      *  26.01.2009  Th.Raddatz    Added Display_getRows() and              *                 RADDAT
      *                            Display_getColumns().                    *                 RADDAT
      *                                                                     *                 RADDAT
      *=====================================================================*                 RADDAT
      *   >>PRE-COMPILER<<                                                  *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                      *                 RADDAT
      *                              SRCFILE(&SL/&SF) +                     *                 RADDAT
      *                              SRCMBR(&SM);                           *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>COMPILE<<                                                     *                 RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                       *                 RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                      *                 RADDAT
      *       >>PARM<< TGTRLS(V6R1M0);                                      *                 RADDAT
      *     >>END-COMPILE<<                                                 *                 RADDAT
      *                                                                     *                 RADDAT
      *     >>EXECUTE<<                                                     *                 RADDAT
      *                                                                     *                 RADDAT
      *   >>END-PRE-COMPILER<<                                              *                 RADDAT
      *=====================================================================*                 RADDAT
     H NOMAIN BNDDIR('QSNAPI')                                                                RADDAT
      *  Standard H-Specs                                                                     RADDAT
 CPY  /COPY QBASICS1,H_SPEC                                                                   RADDAT
 CPY  /COPY QBASICS1,COPYRIGHT                                                                RADDAT
      *=====================================================================*                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Exported functions                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R9                                                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,BASICS1R0                                                                RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Private prototypes                                                                   RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes
      * -----------------------------------------                                             RADDAT
      *
      *  Retrieve Display Mode       Return value: Display Mode
     D QsnRtvMod...
     D                 PR             1A          extproc('QsnRtvMod')
     D  o_dspMode                     1A          options(*omit)
     D  i_hLowLvlEnv                 10I 0 const  options(*omit)
     D  io_errCode                32767A          options(*omit: *varsize)
      *                                                                                       RADDAT
      *  Query 5250 (QsnQry5250) API Return value: return code 0=succes, -1=error             RADDAT
     D QsnQry5250...                                                                          RADDAT
     D                 PR            10I 0        extproc('QsnQry5250')                       RADDAT
     D  o_rcvVar                  32767A          options(*varsize)                           RADDAT
     D  i_lenRcvVar                  10I 0 const                                              RADDAT
     D  io_errCode                32767A          options(*omit: *varsize)                    RADDAT
      *                                                                                       RADDAT
      *  Data structure of QsnQry5250 API.                                                    RADDAT
     D QSN_Q5250_t     DS                  based(pDummy)  qualified                           RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  qrySts                 9      9A                                                      RADDAT
     D  wrksCtlUnit           10     11I 0                                                    RADDAT
     D  codeLevel             12     14A                                                      RADDAT
     D  reserved_1            15     30A                                                      RADDAT
     D  wrksTypCde            31     31A                                                      RADDAT
     D  mschnTypCde           32     35A                                                      RADDAT
     D  mdlNbr                36     38A                                                      RADDAT
     D  kbd_ID                39     39A                                                      RADDAT
     D  extKbd_ID             40     40A                                                      RADDAT
     D  PC_kbd_ID             41     41A                                                      RADDAT
     D  srlNbr                42     45A                                                      RADDAT
     D  maxInpFlds            46     47I 0                                                    RADDAT
     D  ctlUnitCust           49     50A                                                      RADDAT
     D  reserved_2            51     51A                                                      RADDAT
     D  devCpblts             51     62A                                                      RADDAT
     D   devCpblts_0                  1A   overlay(devCpblts)                                 RADDAT
     D   devCpblts_1                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_2                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_3                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_4                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_5                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_6                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_7                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_8                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_9                  1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_10                 1A   overlay(devCpblts: *next)                          RADDAT
     D   devCpblts_11                 1A   overlay(devCpblts: *next)                          RADDAT
     D  gridBufs              63     63A                                                      RADDAT
     D  typGrdLnSup           64     64A                                                      RADDAT
     D  reserved_3            65     65A                                                      RADDAT
     D  imgFax                66     66A                                                      RADDAT
     D  imgFaxScl             67     67A                                                      RADDAT
     D  imgFaxRtg             68     68A                                                      RADDAT
     D  imgFaxSpt             69     69A                                                      RADDAT
     D  invTags               70     70A                                                      RADDAT
     D  reserved_4            71     72A                                                      RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global constants                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Global fields                                                                        RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the current display mode.                                                    RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   dspMode       - Current display mode:                                               RADDAT
      *                   cDISPLAY_MODE_DS3   24x80                                           RADDAT
      *                   cDISPLAY_MODE_DS4   27x132                                          RADDAT
      *=========================================================================              RADDAT
     P Display_getMode...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Display_getMode...                                                                     RADDAT
     D                 PI                         like(display_mode_t)                        RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D dspMode         S                   like(display_mode_t) inz                           RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D dspModeRaw      S              1A                        inz                           RADDAT
     D errCode         DS                  likeds(errCode_t   ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         clear errCode;                                                                     //RADDAT
         QsnRtvMod(dspModeRaw: *omit: errCode);                                             //RADDAT
                                                                                            //RADDAT
 B01     if dspModeRaw = '3';                                                               //RADDAT
            dspMode = cDISPLAY_MODE_DS3;                                                    //RADDAT
 X01     else;                                                                              //RADDAT
            dspMode = cDISPLAY_MODE_DS4;                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return dspMode;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Display_getMode...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns cTrue if the display device support 27x132 mode.                             RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isDS4         - cTrue if the device support 27x132 mode, else cFalse.               RADDAT
      *=========================================================================              RADDAT
     P Display_supportsDS4...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Display_supportsDS4...                                                                 RADDAT
     D                 PI              N                                                      RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isDS4           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
     D QSN_Q5250       DS                  likeds(QSN_Q5250_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         rc = QsnQry5250(QSN_Q5250: %size(QSN_Q5250): *omit);
 B01     if (%bitand(QSN_Q5250.devCpblts_1: x'20') = x'20');                                //RADDAT
            isDS4 = cTrue;                                                                  //RADDAT
 X01     else;                                                                              //RADDAT
            isDS4 = cFalse;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isDS4;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Display_supportsDS4...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns cTrue if the display device supports GUI characters.                         RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   void                                                                                RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   isGUI         - cTrue if the device support GUI characters,                         RADDAT
      *                   else cFalse.                                                        RADDAT
      *=========================================================================              RADDAT
     P Display_supportsGUI...                                                                 RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Display_supportsGUI...                                                                 RADDAT
     D                 PI              N                                                      RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D isGUI           S               N   inz(cFalse)                                        RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D rc              S             10I 0 inz                                                RADDAT
     D QSN_Q5250       DS                  likeds(QSN_Q5250_t ) inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
         rc = QsnQry5250(QSN_Q5250: %size(QSN_Q5250): *omit);
 B01     if (%bitand(QSN_Q5250.devCpblts_4: x'04') = x'04');                                //RADDAT
            isGUI = cTrue;                                                                  //RADDAT
 X01     else;                                                                              //RADDAT
            isGUI = cFalse;                                                                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return isGUI;                                                                      //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Display_supportsGUI...                                                                 RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the number of rows that can be displayed on the screen.                      RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   dspMode       - Display mode.                                                       RADDAT
      *                   Default: current display mode                                       RADDAT
      *                   cDISPLAY_MODE_DS3   24x80                                           RADDAT
      *                   cDISPLAY_MODE_DS4   27x132                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   rows          - Number of rows that can be displayed.                               RADDAT
      *=========================================================================              RADDAT
     P Display_getRows...                                                                     RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Display_getRows...                                                                     RADDAT
     D                 PI             5I 0                                                    RADDAT
     D  i_dspMode                          const  like(display_mode_t)                        RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_dspMode       C                   1                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D dspMode         S                   like(i_dspMode ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rows            S              5I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%parms() >= p_dspMode);                                                        //RADDAT
            dspMode = i_dspMode;                                                            //RADDAT
 X01     else;                                                                              //RADDAT
            dspMode = Display_getMode();                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (dspMode = cDISPLAY_MODE_DS3);                                                  //RADDAT
            rows = 24;                                                                      //RADDAT
 X01     else;                                                                              //RADDAT
            rows = 27;                                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return rows;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Display_getRows...                                                                     RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *=========================================================================              RADDAT
      *  Returns the number of columns that can be displayed on the screen.                   RADDAT
      *=========================================================================              RADDAT
      *  Parameters:                                                                          RADDAT
      *   dspMode       - Display mode.                                                       RADDAT
      *                   Default: current display mode                                       RADDAT
      *                   cDISPLAY_MODE_DS3   24x80                                           RADDAT
      *                   cDISPLAY_MODE_DS4   27x132                                          RADDAT
      *                                                                                       RADDAT
      *  Returns:                                                                             RADDAT
      *   columns       - Number of columns that can be displayed.                            RADDAT
      *=========================================================================              RADDAT
     P Display_getColumns...                                                                  RADDAT
     P                 B                   export                                             RADDAT
      *                                                                                       RADDAT
     D Display_getColumns...                                                                  RADDAT
     D                 PI             5I 0                                                    RADDAT
     D  i_dspMode                          const  like(display_mode_t)                        RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Parameter positions                                                                  RADDAT
     D p_dspMode       C                   1                                                  RADDAT
      *                                                                                       RADDAT
      *  Fields for optional parameters                                                       RADDAT
     D dspMode         S                   like(i_dspMode ) inz                               RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D columns         S              5I 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -               RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%parms() >= p_dspMode);                                                        //RADDAT
            dspMode = i_dspMode;                                                            //RADDAT
 X01     else;                                                                              //RADDAT
            dspMode = Display_getMode();                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (dspMode = cDISPLAY_MODE_DS3);                                                  //RADDAT
            columns = 80;                                                                   //RADDAT
 X01     else;                                                                              //RADDAT
            columns = 132;                                                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return columns;                                                                    //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P Display_getColumns...                                                                  RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing CEELIB  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "CEELIB    "
mbrtype =  "RPGLE     "
mbrtext =  "Prototypes of CEE APIs                   (include)"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
 DEF  /IF NOT DEFINED(CEELIB)                                                                 RADDAT
 DEF  /DEFINE CEELIB                                                                          RADDAT
      *                                                                                       RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *   Program or Procedure Call APIs                                                      RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *                                                                                       RADDAT
      *  Condition token, used as feedback code                                               RADDAT
     D cee_fc_t        DS                  qualified               based(pDummy)              RADDAT
     D  Condition_ID...                                                                       RADDAT
     D                         1      4A                                                      RADDAT
     D   MsgSev                1      2I 0                                                    RADDAT
     D   Msg_No                3      4U 0                                                    RADDAT
     D  Flags                  5      5A                                                      RADDAT
     D  Facility_ID...                                                                        RADDAT
     D                         6      8A                                                      RADDAT
     D  I_S_Info               9     12A                                                      RADDAT
      *                                                                                       RADDAT
      *  Retrieve Operational Descriptor Information (CEEDOD)                                 RADDAT
     D CEEDOD...                                                                              RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('CEEDOD')                           RADDAT
     D  i_posn                       10I 0 const                                              RADDAT
     D  o_desctype                   10I 0                                                    RADDAT
     D  o_datatype                   10I 0                                                    RADDAT
     D  o_descinf1                   10I 0                                                    RADDAT
     D  o_descinf2                   10I 0                                                    RADDAT
     D  o_datalen                    10I 0                                                    RADDAT
     D  o_fc                         12A          options(*omit   )                           RADDAT
      *                                                                                       RADDAT
      *  Reference fields for CEEDOD API                                                      RADDAT
     D descInf_t       DS                  based(pDummy)   qualified                          RADDAT
     D  desctype                     10I 0                                                    RADDAT
     D  datatype                     10I 0                                                    RADDAT
     D  descinf1                     10I 0                                                    RADDAT
     D  descinf2                     10I 0                                                    RADDAT
     D  datalen                      10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Test for Omitted Argument (CEETSTA) API                                              RADDAT
     D CEETSTA...                                                                             RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('CEETSTA')                          RADDAT
     D  io_isPresent                 10I 0                                                    RADDAT
     D  i_argNum                     10I 0 const                                              RADDAT
     D  o_fc                         12A          options(*omit   )                           RADDAT
      *                                                                                       RADDAT
      *  Get String Information (CEEGSI) API                                                  RADDAT
     D CEEGSI...                                                                              RADDAT
     D                 PR                                                                     RADDAT
     D                                            extproc('CEEGSI')                           RADDAT
     D  i_posn                       10I 0 const                                              RADDAT
     D  o_datatype                   10I 0                                                    RADDAT
     D  o_curlen                     10I 0                                                    RADDAT
     D  o_maxlen                     10I 0                                                    RADDAT
     D  o_fb                         12A          options(*omit   )                           RADDAT
      *                                                                                       RADDAT
      *  Reference fields for CEEGSI API                                                      RADDAT
     D strInf_t        DS                  based(pDummy)   qualified                          RADDAT
     D  datatype                     10I 0                                                    RADDAT
     D  curlen                       10I 0                                                    RADDAT
     D  maxlen                       10I 0                                                    RADDAT
      *                                                                                       RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *   Math APIs                                                                           RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *                                                                                       RADDAT
      *  Logarithm base 10 (double float)                                                     RADDAT
     D CEESDLG1...                                                                            RADDAT
     D                 PR                  extproc('CEESDLG1')                                RADDAT
     D  i_value                       8F   const                                              RADDAT
     D  o_result                      8F                                                      RADDAT
      *                                                                                       RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *   ILE CEE Date and Time APIs                                                          RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *                                                                                       RADDAT
      *  Calculate Day of Week from Lilian Date (CEEDYWK) API                                 RADDAT
     D CEEDYWK         PR                  opdesc extproc('CEEDYWK')                          RADDAT
     D   lilian_date                 10I 0 const                                              RADDAT
     D   day_no                      10I 0                                                    RADDAT
     D   feedback                    12A   options(*omit)                                     RADDAT
      *                                                                                       RADDAT
      *  Convert Lilian Date to Character Format (CEEDATE) API                                RADDAT
     D CEEDATE         PR                  opdesc extproc('CEEDATE')                          RADDAT
     D   lilian_date                 10I 0 const                                              RADDAT
     D   date_format                 80A   const options(*varsize)                            RADDAT
     D   char_date                   80A   options(*varsize)                                  RADDAT
     D   feedback                    12A   options(*omit)                                     RADDAT
      *                                                                                       RADDAT
      *  Convert Date to Lilian Format (CEEDAYS) API                                          RADDAT
     D CEEDAYS         PR                  opdesc extproc('CEEDAYS')                          RADDAT
     D   char_date                   80A   const options(*varsize)                            RADDAT
     D   date_format                 80A   const options(*varsize)                            RADDAT
     D   lilian_date                 10I 0                                                    RADDAT
     D   feedback                    12A   options(*omit)                                     RADDAT
      *                                                                                       RADDAT
      *  Convert Seconds to Character Timestamp (CEEDATM) API                                 RADDAT
     D CEEDATM         PR                  opdesc extproc('CEEDATM')
     D  input_seconds                 8F   const
     D  picture_string...
     D                               80A   const options(*varsize)
     D  output_timestamp...
     D                               80A         options(*varsize)
     D   feedback                    12A   options(*omit)                                     RADDAT
      *                                                                                       RADDAT
      *  Get Offset from Universal Time Coordinated to Local Time (CEEUTCO) API               RADDAT
     D CEEUTCO         pr                  extproc('CEEUTCO')
     D  offsethours                  10i 0
     D  offsetminutes                10i 0
     D  offsetseconds                 8f
     D  feedback                     12a   options(*nopass)
      *                                                                                       RADDAT
     D cee_utco_t      ds                  qualified   based(pDummy)
     D  offhours                     10i 0
     D  offmins                      10i 0
     D  offsecs                       8f
      *                                                                                       RADDAT
      *  Convert Timestamp to Number of Seconds (CEESECS) API                                 RADDAT
     D CEESECS         pr                  extproc('CEESECS') opdesc
     D  inTimestamp                 255a   const options(*varsize)
     D  inPicture                   255a   const options(*varsize)
     D  outSeconds                    8f
     D  outFC                        12a         options(*omit)
      *                                                                                       RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *   Activation Group and Control Flow APIs                                              RADDAT
      * ---------------------------------------------------------------                       RADDAT
      *                                                                                       RADDAT
      *  Register Activation Group Exit Procedure (CEE4RAGE) API                              RADDAT
     D CEE4RAGE...                                                                            RADDAT
     D                 PR                  extproc('CEE4RAGE')                                RADDAT
     D  i_pProc                        *   const procptr                                      RADDAT
     D   fc                          12A         options(*OMIT)                               RADDAT
      *                                                                                       RADDAT
     D END_ACTGRP_CODE_EXCEPTION_MESSAGE...                                                   RADDAT
     D                 C                   x'40000000'                                        RADDAT
     D END_ACTGRP_CODE_ABNORMAL_END...                                                        RADDAT
     D                 C                   x'00008000'                                        RADDAT
     D END_ACTGRP_CODE_ACTGRP_IS_ENDING...                                                    RADDAT
     D                 C                   x'00004000'                                        RADDAT
     D END_ACTGRP_CODE_INIT_BY_RCLACTGRP...                                                   RADDAT
     D                 C                   x'00002000'                                        RADDAT
     D END_ACTGRP_CODE_INIT_BY_JOB_END...                                                     RADDAT
     D                 C                   x'00001000'                                        RADDAT
     D END_ACTGRP_CODE_INIT_BY_EXIT_VERB...                                                   RADDAT
     D                 C                   x'00000800'                                        RADDAT
     D END_ACTGRP_CODE_INIT_BY_FUNCTION_CHECK...                                              RADDAT
     D                 C                   x'00000400'                                        RADDAT
     D END_ACTGRP_CODE_INIT_BY_OUT_OF_SCOPE_JUMP...                                           RADDAT
     D                 C                   x'00000200'                                        RADDAT
      *
     D CEE4RAGE_user_exit...
     D                 PR                         extproc('CEE4RAGE_user_exit')
     D  i_ag_mark                    10U 0 const
     D  i_reason                     10U 0 const
     D  io_result_code...
     D                               10U 0 const
     D  io_user_rc                   10I 0 const
      *                                                                                       RADDAT
      *  Register Call Stack Entry Termination User Exit Procedure (CEERTX)                   RADDAT
     D CEERTX...                                                                              RADDAT
     D                 PR                         extproc('CEERTX')                           RADDAT
     D  i_procPtr                      *   const  procptr                                     RADDAT
     D  i_rtxToken                     *   const  options(*omit)                              RADDAT
     D  o_fc                         12A          options(*omit)                              RADDAT
      *                                                                                       RADDAT
     D CEERTX_user_exit...                                                                    RADDAT
     D                 PR                         extproc('CEERTX_user_exit')                 RADDAT
     D  i_rtxToken                     *   const                                              RADDAT
      *
      *  Unregister Call Stack Entry Termination User Exit Procedure (CEEUTX)
     D CEEUTX...
     D                 PR                         extproc('CEEUTX')
     D  i_procPtr                      *   const  procptr
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
 DEF  /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing CLIB  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "CLIB      "
mbrtype =  "RPGLE     "
mbrtext =  "Prototypes of C-Library                  (include)"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
 DEF  /IF NOT DEFINED(CLIB)                                                                   RADDAT
 DEF  /DEFINE CLIB                                                                            RADDAT
      *                                                                                       RADDAT
      *  Basic C data types                                                                   RADDAT
      /IF NOT DEFINED(C_DATA_TYPES)                                                           RADDAT
      /DEFINE C_DATA_TYPES                                                                    RADDAT
      * C Data Types                                                                          RADDAT
     D char_t          S              1A   based(pDummy)                                      RADDAT
     D short_t         S              5I 0 based(pDummy)                                      RADDAT
     D ushort_t        S              5U 0 based(pDummy)                                      RADDAT
     D int_t           S             10I 0 based(pDummy)                                      RADDAT
     D uint_t          S             10U 0 based(pDummy)                                      RADDAT
     D long_t          S             10I 0 based(pDummy)                                      RADDAT
     D ulong_t         S             10U 0 based(pDummy)                                      RADDAT
     D float_t         S              4F   based(pDummy)                                      RADDAT
     D double_t        S              8F   based(pDummy)                                      RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      *  stdin, stdout and stderr                                                             RADDAT
     D stdin           S               *   import('_C_IFS_stdin')                             RADDAT
     D stdout          S               *   import('_C_IFS_stdout')                            RADDAT
     D stderr          S               *   import('_C_IFS_stderr')                            RADDAT
      *                                                                                       RADDAT
      *  system -- Execute a Command                                                          RADDAT
      *     Return value       Meaning                                                        RADDAT
      *     ----------------   --------------------------------------                         RADDAT
      *     0                  the command is successful                                      RADDAT
      *     -1                 for a NULL pointer                                             RADDAT
      *     1                  the command fails                                              RADDAT
     D system          PR            10I 0 extproc('system')                                  RADDAT
     D  i_clCommand                    *   value options(*string)                             RADDAT
      *                                                                                       RADDAT
     D EXCP_MSGID      S              7A   import('_EXCP_MSGID')                              RADDAT
      *                                                                                       RADDAT
      *  time -- Determine Current Time                                                       RADDAT
      *     The time() function returns the current calendar time.                            RADDAT
      *     The return value is also stored in the location that                              RADDAT
      *     is given by timeptr.                                                              RADDAT
     D time...                                                                                RADDAT
     D                 PR            10i 0 extproc('time')                                    RADDAT
     D  timeptr                        *   value                                              RADDAT
      *                                                                                       RADDAT
      *  strftime -- Convert to Formatted Time                                                RADDAT
      *     strftime() returns the number of bytes placed into the                            RADDAT
      *     array pointed to by 'dest'.                                                       RADDAT
     D strftime...                                                                            RADDAT
     D                 PR            10i 0 extproc('strftime')                                RADDAT
     D  dest                           *   value                                              RADDAT
     D  maxsize                      10i 0 value                                              RADDAT
     D  format                         *   value options(*string)                             RADDAT
     D  timeptr                            const  likeds(tm_t)                                RADDAT
      *                                                                                       RADDAT
     D tm_t            DS                  qualified  based(pDummy)                           RADDAT
     D  tm_sec                       10I 0                                                    RADDAT
     D  tm_min                       10I 0                                                    RADDAT
     D  tm_hour                      10I 0                                                    RADDAT
     D  tm_mday                      10I 0                                                    RADDAT
     D  tm_mon                       10I 0                                                    RADDAT
     D  tm_year                      10I 0                                                    RADDAT
     D  tm_wday                      10I 0                                                    RADDAT
     D  tm_yday                      10I 0                                                    RADDAT
     D  tm_isdst                     10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  localtime() -- Correct Local Time, returns tm_t*                                     RADDAT
      *     The localtime() function converts a time value, in                                RADDAT
      *     seconds, to a structure of type tm.                                               RADDAT
     D localtime...                                                                           RADDAT
     D                 PR              *   extproc('localtime')                               RADDAT
     D  time                         10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  localtime_r() -- Correct Local Time                                                  RADDAT
      *     It is the same as localtime() except that it passes                               RADDAT
      *     in the place to store the returned structure result.                              RADDAT
     D localtime_r...                                                                         RADDAT
     D                 PR              *   extproc('localtime_r')                             RADDAT
     D  time                         10I 0 const                                              RADDAT
     D  tm                                 const  likeds(tm_t)                                RADDAT
      *                                                                                       RADDAT
      *  strtok -- Tokenize String                                                            RADDAT
      *     The first time the strtok() function is called, it returns                        RADDAT
      *     a pointer to the first token in i_string. In later calls                          RADDAT
      *     it returns a pointer to the next token. A null pointer is                         RADDAT
      *     returned when there are no more tokens.                                           RADDAT
     D strtok          PR              *          extproc('strtok')                           RADDAT
     D  i_string                       *   value  options(*string)                            RADDAT
     D  i_delimiters                   *   value  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  atoi -- Convert Character String to Integer                                          RADDAT
      *     The atoi() function returns an int value of the                                   RADDAT
      *     interpreted input string.                                                         RADDAT
     D atoi            PR            10I 0        extproc('atoi')                             RADDAT
     D  i_string                       *   value  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  memcpy -- Copy Bytes                                                                 RADDAT
      *     The behavior is undefined if copying takes place                                  RADDAT
      *     between objects that overlap.                                                     RADDAT
      *     The memcpy() function returns a pointer to dest.                                  RADDAT
     D memcpy          PR              *          extproc('memcpy')                           RADDAT
     D  i_pDest                        *   value                                              RADDAT
     D  i_pSrc                         *   value                                              RADDAT
     D  i_count                      10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  memset -- Set Bytes to Value                                                         RADDAT
      *     The memset() function returns a pointer to dest.                                  RADDAT
     D memset          PR              *          extproc('memset')                           RADDAT
     D  i_pDest                        *   value                                              RADDAT
     D  i_char                       10I 0 value                                              RADDAT
     D  i_count                      10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  memmove -- Copy Bytes                                                                RADDAT
      *     memmove allows copying between objects that may overlap                           RADDAT
      *     as if src is first copied into a temporary array.                                 RADDAT
      *     The memmove() function returns a pointer to dest.                                 RADDAT
     D memmove         PR              *          extproc('memmove')                          RADDAT
     D  pMemDest                       *   value                                              RADDAT
     D  pMemSrc                        *   value                                              RADDAT
     D  memSize                            value like(size_t)                                 RADDAT
      *                                                                                       RADDAT
      *  memcmp -- Compare Buffers                                                            RADDAT
      *     Return value       Meaning                                                        RADDAT
      *     ----------------   --------------------------------------                         RADDAT
      *     Less than 0        buf1 less than buf2                                            RADDAT
      *     0                  buf1 identical to buf2                                         RADDAT
      *     Greater than 0     buf1 greater than buf2                                         RADDAT
     D memcmp          PR            10I 0        extproc('memcmp')                           RADDAT
     D  pBuf1                          *   value                                              RADDAT
     D  pBuf2                          *   value                                              RADDAT
     D  count                              value like(size_t)                                 RADDAT
      *                                                                                       RADDAT
      *  memicmp -- Compare Bytes (ignore case)                                               RADDAT
      *     Return value       Meaning                                                        RADDAT
      *     ----------------   --------------------------------------                         RADDAT
      *     Less than 0        buf1 less than buf2                                            RADDAT
      *     0                  buf1 identical to buf2                                         RADDAT
      *     Greater than 0     buf1 greater than buf2                                         RADDAT
     D memicmp         PR            10I 0        extproc('__memicmp')                        RADDAT
     D  pBuf1                          *   value                                              RADDAT
     D  pBuf2                          *   value                                              RADDAT
     D  count                        10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  strcmp() -- Compare Strings                                                          RADDAT
      *     Return value       Meaning                                                        RADDAT
      *     ----------------   --------------------------------------                         RADDAT
      *     Less than 0        string 1 less than string 2                                    RADDAT
      *     0                  string 1 equivalent to string 2                                RADDAT
      *     Greater than 0     string 1 greater than string 2                                 RADDAT
     D strcmp...                                                                              RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('strcmp')                           RADDAT
     D  string1                        *   value  options(*string)                            RADDAT
     D  string2                        *   value  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  strcasecmp() -- Compare Strings without Case Sensitivity                             RADDAT
      *     Return value       Meaning                                                        RADDAT
      *     ----------------   --------------------------------------                         RADDAT
      *     Less than 0        string 1 less than string 2                                    RADDAT
      *     0                  string 1 equivalent to string 2                                RADDAT
      *     Greater than 0     string 1 greater than string 2                                 RADDAT
     D strcasecmp...                                                                          RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                            extproc('strcasecmp')                       RADDAT
     D  string1                        *   value  options(*string)                            RADDAT
     D  string2                        *   value  options(*string)                            RADDAT
      /IF NOT DEFINED(TESTPTR)                                                                RADDAT
      /DEFINE TESTPTR                                                                         RADDAT
      *                                                                                       RADDAT
      *  Test Pointer (TESTPTR)                                                               RADDAT
     D testptr         PR            10I 0 extproc('_TESTPTR')                                RADDAT
     D  i_ptr                          *   value                                              RADDAT
     D  i_test_type                  10I 0 value                                              RADDAT
      *                                                                                       RADDAT
     D cTESTPTR_TYPE_PROCPTR...                                                               RADDAT
     D                 C                   0                                                  RADDAT
     D cTESTPTR_NO_OPTIMIZED_PARAMETER_PASSING...                                             RADDAT
     D                 C                   0                                                  RADDAT
     D cTESTPTR_OPTIMIZED_PARAMETER_PASSING...                                                RADDAT
     D                 C                   1                                                  RADDAT
      *                                                                                       RADDAT
     D cTESTPTR_TYPE_MEMPTR...                                                                RADDAT
     D                 C                   1                                                  RADDAT
     D cTESTPTR_NON_TERASPACE...                                                              RADDAT
     D                 C                   0                                                  RADDAT
     D cTESTPTR_TERASPACE...                                                                  RADDAT
     D                 C                   1                                                  RADDAT
      *                                                                                       RADDAT
     D cTESTPTR_ERROR_NOT_EXIST...                                                            RADDAT
     D                 C                   x'2401'                                            RADDAT
     D cTESTPTR_ERROR_INVALID...                                                              RADDAT
     D                 C                   x'2402'                                            RADDAT
     D cTESTPTR_ERROR_OBJECT_DESTROYED...                                                     RADDAT
     D                 C                   x'2202'                                            RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      *  malloc() - Reserve Storage Block                                                     RADDAT
     D TS_malloc...                                                                           RADDAT
     D                 PR              *   extproc('_C_TS_malloc')                            RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  realloc() - Change Reserved Storage Block Size                                       RADDAT
     D TS_realloc...                                                                          RADDAT
     D                 PR              *   extproc('_C_TS_realloc')                           RADDAT
     D  i_pMem                         *   value                                              RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  free() - Release Storage Blocks                                                      RADDAT
     D TS_free...                                                                             RADDAT
     D                 PR                  extproc('_C_TS_free')                              RADDAT
     D  i_pMem                         *   value                                              RADDAT
      *                                                                                       RADDAT
      *  _C_TS_malloc_info() - Determine amount of teraspace memory used                      RADDAT
     D TS_malloc_info...                                                                      RADDAT
     D                 PR            10I 0 extproc('_C_TS_malloc_info')                       RADDAT
     D  o_c_mallinfo                       const  likeds(C_mallinfo_t)                        RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  _C_TS_malloc_debug() - Determine amount of teraspace memory                          RADDAT
      *                         used (with optional dumps and verification)                   RADDAT
     D TS_malloc_debug...                                                                     RADDAT
     D                 PR            10I 0 extproc('_C_TS_malloc_debug')                      RADDAT
     D  i_dump_level                 10U 0 value                                              RADDAT
     D  i_vrfy_level                 10U 0 value                                              RADDAT
     D  o_c_mallinfo                       const  likeds(C_mallinfo_t)                        RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      * The following are possible values for the dump_level parameter                        RADDAT
     D C_NO_DUMPS      C                   0                                                  RADDAT
      *  Dumps the _C_mallinfo_t structure:                                                   RADDAT
     D C_DUMP_TOTALS   C                   1                                                  RADDAT
      *  Does a hex dump of all allocated chunks of teraspace storage,                        RADDAT
      *  this is the entire 512K chunk of storage:                                            RADDAT
     D C_DUMP_CHUNKS   C                   2                                                  RADDAT
      *  Dumps each of the allocated nodes.                                                   RADDAT
      *  There is a node for each malloc performed with the header                            RADDAT
      *  associated with that malloc:                                                         RADDAT
     D C_DUMP_NODES    C                   3                                                  RADDAT
      *  Dumps the cartesian tree used to keep track of the freed nodes:                      RADDAT
     D C_DUMP_TREE     C                   4                                                  RADDAT
     D C_DUMP_ALL      C                   9999                                               RADDAT
      *                                                                                       RADDAT
      *  The following are possible values for the verify_level parameter                     RADDAT
     D C_NO_CHECKS     C                   0                                                  RADDAT
     D C_CHECK_TOTALS  C                   1                                                  RADDAT
     D C_CHECK_CHUNKS  C                   2                                                  RADDAT
     D C_CHECK_NODES   C                   3                                                  RADDAT
     D C_CHECK_TREE    C                   4                                                  RADDAT
     D C_CHECK_ALL     C                   9998                                               RADDAT
      *  Will call abort() if verification fails                                              RADDAT
     D C_CHECK_ALL_AND_ABORT...                                                               RADDAT
     D                 C                   9999                                               RADDAT
      *                                                                                       RADDAT
      * The following structure is used to return information                                 RADDAT
      * from the _C_TS_malloc_info routine.  The fields are:                                  RADDAT
      *   total_bytes        - bytes allocated from system                                    RADDAT
      *                        (high water mark)                                              RADDAT
      *   allocated_bytes    - number of allocated bytes                                      RADDAT
      *   unallocated_bytes  - number of unallocated bytes                                    RADDAT
      *   allocated_blocks   - number of allocated blocks                                     RADDAT
      *   unallocated_blocks - number of unallocated blocks                                   RADDAT
      *   requested_bytes    - bytes actually requested from malloc                           RADDAT
      *   pad_bytes          - bytes used to pad allocation length                            RADDAT
      *                        to a multiple of 16                                            RADDAT
      *   overhead_bytes     - bytes used for malloc overhead                                 RADDAT
     D C_mallinfo_t...                                                                        RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  total_bytes...                                                                        RADDAT
     D                               20I 0                                                    RADDAT
     D  allocated_bytes...                                                                    RADDAT
     D                               20I 0                                                    RADDAT
     D  unallocated_bytes...                                                                  RADDAT
     D                               20I 0                                                    RADDAT
     D  allocated_blocks...                                                                   RADDAT
     D                               20I 0                                                    RADDAT
     D  unallocated_blocks...                                                                 RADDAT
     D                               20I 0                                                    RADDAT
     D  requested_bytes...                                                                    RADDAT
     D                               20I 0                                                    RADDAT
     D  pad_bytes...                                                                          RADDAT
     D                               20I 0                                                    RADDAT
     D  overhead_bytes...                                                                     RADDAT
     D                               20I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  malloc -- Reserve Storage Block                                                      RADDAT
     D malloc          PR              *          extproc('malloc')                           RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  realloc -- Change Reserved Storage Block Size                                        RADDAT
     D realloc         PR              *          extproc('realloc')                          RADDAT
     D  i_pMem                         *   value                                              RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  free -- Release Storage Blocks                                                       RADDAT
     D free            PR                         extproc('free')
     D  i_pMem                         *   value                                              RADDAT
      *                                                                                       RADDAT
      *  srand -- Set Seed for rand Function   e.g.:   srand(getSeed(*null))                  RADDAT
     D srand           PR                         extproc('srand')                            RADDAT
     D  i_seed                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  rand -- Generate Random Number                x = rand()                             RADDAT
     D rand            PR            10I 0        extproc('rand')                             RADDAT
      *                                                                                       RADDAT
     D RAND_MAX        C                   const(32767)                                       RADDAT
      *                                                                                       RADDAT
      *  getSeed -- Get Seed for srand function                                               RADDAT
     D getSeed         PR            10I 0        extproc('time')                             RADDAT
     D  i_timePtr                      *   value                                              RADDAT
      *                                                                                       RADDAT
      *  strlen -- Determine String Length                                                    RADDAT
     D strlen...                                                                              RADDAT
     D                 PR            10U 0 extproc('strlen')                                  RADDAT
     D  i_string                       *   value                                              RADDAT
      *                                                                                       RADDAT
      *  tmpnam -- Produce Temporary File Name                                                RADDAT
     D tmpnam          PR              *          extproc('tmpnam')                           RADDAT
     D  pTmpNme                        *   value                                              RADDAT
      *                                                                                       RADDAT
      *  _C_IFS_tmpnam -- Produce Temporary File Name for the IFS file system                 RADDAT
     D ifs_tmpnam      PR              *          extproc('_C_IFS_tmpnam')                    RADDAT
     D  fileName                       *   value                                              RADDAT
      *                                                                                       RADDAT
     D L_tmpnam        C                   const(39)                            ! <stdio.h>   RADDAT
      *                                                                                       RADDAT
     D TMP_MAX         C                   const(32767)                         ! <stdio.h>   RADDAT
      *                                                                                       RADDAT
      *  qsort -- Sort Array                                                                  RADDAT
     D qsort           PR              *                       extproc('qsort')               RADDAT
     D  memPtr                         *   value                                              RADDAT
     D  numElem                            value  like(size_t)                                RADDAT
     D  width                              value  like(size_t)                                RADDAT
     D  pSortFunc                      *   value  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  bsearch -- Search Arrays                                                             RADDAT
     D bsearch         PR              *          extproc('bsearch')                          RADDAT
     D  keyPtr                         *   value                                              RADDAT
     D  memPtr                         *   value                                              RADDAT
     D  numElem                            value  like(size_t)                                RADDAT
     D  width                              value  like(size_t)                                RADDAT
     D  pSearchFnc                     *   value  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  iconv_open()--Code Conversion Allocation API                                         RADDAT
     D iconv_open...                                                                          RADDAT
     D                 PR                  extproc('iconv_open')                              RADDAT
     D                                     like(iconv_t   )                                   RADDAT
     D  i_toCode                       *   value                                              RADDAT
     D  i_fromCode                     *   value                                              RADDAT
      *                                                                                       RADDAT
     D iconv_t         DS                  qualified   based(pDummy)   align                  RADDAT
     D  return_value                 10I 0                                                    RADDAT
     D  cd                           10I 0 dim(12)                                            RADDAT
      *                                                                                       RADDAT
     D iconv_fromcode_t...                                                                    RADDAT
     D                 DS                  qualified   based(pDummy)                          RADDAT
     D  ibmccsid                      8A                                                      RADDAT
     D  ccsid                         5A                                                      RADDAT
     D  convAlt                       3A                                                      RADDAT
     D  substAlt                      1A                                                      RADDAT
     D  shiftStateAlt                 1A                                                      RADDAT
     D  inpLengthOpt                  1A                                                      RADDAT
     D  errOption                     1A                                                      RADDAT
     D  reserved                     12A                                                      RADDAT
      *                                                                                       RADDAT
     D iconv_tocode_t...                                                                      RADDAT
     D                 DS                  qualified   based(pDummy)                          RADDAT
     D  ibmccsid                      8A                                                      RADDAT
     D  ccsid                         5A                                                      RADDAT
     D  reserved                     19A                                                      RADDAT
      *                                                                                       RADDAT
      *  QtqIconvOpen()--Code Conversion Allocation API                                       RADDAT
     D QtqIconv_open...                                                                       RADDAT
     D                 PR                  extproc('QtqIconvOpen')                            RADDAT
     D                                     likeds(iconv_t )                                   RADDAT
     D  i_toCode                           const  likeds(QtqCode_t)                           RADDAT
     D  i_fromCode                         const  likeds(QtqCode_t)                           RADDAT
      *                                                                                       RADDAT
     D QtqCode_t...                                                                           RADDAT
     D                 DS                  qualified   based(pDummy)                          RADDAT
     D  ccsid                        10I 0                                                    RADDAT
     D  conversionA                  10I 0                                                    RADDAT
     D  substitutionA                10I 0                                                    RADDAT
     D  shiftStateA                  10I 0                                                    RADDAT
     D  inpLenOpt                    10I 0                                                    RADDAT
     D  errOptMxdDta                 10I 0                                                    RADDAT
     D  reserved                     12A                                                      RADDAT
      *                                                                                       RADDAT
      *  iconv()--Code Conversion API                                                         RADDAT
     D iconv...                                                                               RADDAT
     D                 PR            10U 0        extproc('iconv')                            RADDAT
     D  i_cd                               value likeds(iconv_t  )                            RADDAT
     D  i_pInBuf                       *                                                      RADDAT
     D  i_inBytLeft                  10U 0                                                    RADDAT
     D  i_pOutBuf                      *                                                      RADDAT
     D  i_outBytLeft                 10U 0                                                    RADDAT
      *                                                                                       RADDAT
     D cICONV_ERROR    C                   const(4294967295)                                  RADDAT
      *                                                                                       RADDAT
      *  iconv_close()--Code Conversion Deallocation API                                      RADDAT
     D iconv_close...                                                                         RADDAT
     D                 PR            10I 0        extproc('iconv_close')                      RADDAT
     D  i_cd                               value likeds(iconv_t  )                            RADDAT
      *                                                                                       RADDAT
      *  0/-1 = stat()--Get File Information                include <sys/stat.h>              RADDAT
     D stat...                                                                                RADDAT
     D                 PR            10I 0        extproc('stat')               = int         RADDAT
     D  i_pPath                        *   value options(*string)               = *path       RADDAT
     D  i_pStat                        *   value                                = *buf        RADDAT
      *                                                                                       RADDAT
      *  0/-1 = fstat()--Get File Information by Descriptor include <sys/stat.h>              RADDAT
     D fstat...                                                                               RADDAT
     D                 PR            10I 0        extproc('fstat')              = int         RADDAT
     D  i_fd                         10I 0 value                                = int         RADDAT
     D  i_stat                             const likeds(st_stat_t)              = *buf        RADDAT
      *                                                                                       RADDAT
      *  0/-1 = lstat()--Get File or Link Information       include <sys/stat.h>              RADDAT
     D lstat...                                                                               RADDAT
     D                 PR            10I 0        extproc('lstat')              = int         RADDAT
     D  i_pPath                        *   value options(*string)               = *path       RADDAT
     D  i_pStat                        *   value                                = *buf        RADDAT
      *                                                                                       RADDAT
     D st_stat_t       DS                  qualified   based(pDummy)   align                  RADDAT
     D  mode                         10U 0                                      mode_t =uint  RADDAT
     D  ino                          10U 0                                      ino_t  =uint  RADDAT
     D  nlink                         5U 0                                      nlink_t=ushortRADDAT
     D  reserved2                     2A                                                      RADDAT
     D  uid                          10U 0                                      uid_t  =uint  RADDAT
     D  gid                          10U 0                                      gid_t  =uint  RADDAT
     D  size                         10I 0                                      off_t  =int   RADDAT
     D  atime                        10I 0                                      time_t =long  RADDAT
     D  mtime                        10I 0                                      time_t =long  RADDAT
     D  ctime                        10I 0                                      time_t =long  RADDAT
     D  dev                          10U 0                                      dev_t  =uint  RADDAT
     D  blksize                      10U 0                                      size_t =uint  RADDAT
     D  allocsize                    10U 0                                      ulong         RADDAT
     D  objtype                      11A                                        qp0l_objtype_tRADDAT
     D  reserved3                     1A                                                      RADDAT
     D  codepage                      5U 0                                      ushort        RADDAT
     D  ccsid                         5U 0                                      ushort        RADDAT
     D  rdev                         10U 0                                      dev_t  =uint  RADDAT
     D  nlink32                      10U 0                                      nlink32_t=ulngRADDAT
     D  rdev64                       20U 0                                      dev64_t=ullng RADDAT
     D  dev64                        20U 0                                      dev64_t=ullng RADDAT
     D  reserved1                    36A                                                      RADDAT
     D  ino_gen_id                   10U 0                                      uint          RADDAT
      *                                                                                       RADDAT
      *  Qp0lGetAttr()--Get Attributes                                                        RADDAT
     D Qp0lGetAttr...                                                                         RADDAT
     D                 PR            10I 0 extproc('Qp0lGetAttr')                             RADDAT
     D  i_path                             const  likeds(Qlg_Path_Name_t)                     RADDAT
     D  i_attrArray                        const  like(Qlg_attrArray_t  )                     RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_bytPrv                     10U 0 value                                              RADDAT
     D  o_sizeNeeded                 10U 0                                                    RADDAT
     D  o_bytRet                     10U 0                                                    RADDAT
     D  i_followLnk                  10U 0 value                                              RADDAT
      *
      /if not defined(Qlg_Path_Name)
      /define Qlg_Path_Name
     D Qlg_Path_Name_t...                                                                     RADDAT
     D                 DS                  qualified align         based(pDummy)              RADDAT
     D   CCSID                       10I 0                                                    RADDAT
     D   Country_ID                   2A                                                      RADDAT
     D   Language_ID                  3A                                                      RADDAT
     D   Reserved                     3A                                                      RADDAT
     D   Path_Type                   10U 0                                                    RADDAT
     D   Path_Length                 10I 0                                                    RADDAT
     D   Path_Name_Delimiter...                                                               RADDAT
     D                                2A                                                      RADDAT
     D   Reserved2                   10A                                                      RADDAT
     D   Path_Name                  256A                                                      RADDAT
      *                                                                                       RADDAT
     D QLG_PATH_JOB_CCSID...                                                                  RADDAT
     D                 C                   const(0)                                           RADDAT
     D QLG_PATH_JOB_COUNTRYID...                                                              RADDAT
     D                 C                   const(X'0000')                                     RADDAT
     D QLG_PATH_JOB_LANGUAGEID...                                                             RADDAT
     D                 C                   const(X'000000')                                   RADDAT
      *                                                                                       RADDAT
      *  The Path_Name is a character string and the delimiter is one byte long.              RADDAT
     D QLG_CHAR_SINGLE...                                                                     RADDAT
     D                 C                   const(0)                                           RADDAT
      *                                                                                       RADDAT
      *  The Path_Name is a pointer and the delimiter is one byte long.                       RADDAT
     D QLG_PTR_SINGLE...                                                                      RADDAT
     D                 C                   const(1)                                           RADDAT
      *                                                                                       RADDAT
      *  The Path_Name is a character string and the delimiter is two bytes long.             RADDAT
     D QLG_CHAR_DOUBLE...                                                                     RADDAT
     D                 C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
      *  The Path_Name is a pointer and the delimiter is two bytes long.                      RADDAT
     D QLG_PTR_DOUBLE...                                                                      RADDAT
     D                 C                   const(3)                                           RADDAT
      *
      /endif
      *                                                                                       RADDAT
     D Qlg_attrArray_t...                                                                     RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  numE                         10I 0                                                    RADDAT
     D  attr                         10I 0 dim(64)                                            RADDAT
      *                                                                                       RADDAT
     D Qlg_rtnAttr_t...                                                                       RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  ofsNextAttr                  10I 0                                                    RADDAT
     D  ID                           10I 0                                                    RADDAT
     D  size                         10I 0                                                    RADDAT
     D  reserved                      4A                                                      RADDAT
      *                                                                                       RADDAT
     D QP0L_ATTR_OBJTYPE...                                                                   RADDAT
     D                 C                   const(0)                             CHAR(10)      RADDAT
     D QP0L_ATTR_DATA_SIZE...                                                                 RADDAT
     D                 C                   const(1)                             UINT(4)       RADDAT
     D QP0L_ATTR_ALLOC_SIZE...                                                                RADDAT
     D                 C                   const(2)                             UINT(4)       RADDAT
     D QP0L_ATTR_EXTENDED_ATTR_SIZE...                                                        RADDAT
     D                 C                   const(3)                             UINT(4)       RADDAT
     D QP0L_ATTR_CREATE_TIME...                                                               RADDAT
     D                 C                   const(4)                             UINT(4)       RADDAT
     D QP0L_ATTR_ACCESS_TIME...                                                               RADDAT
     D                 C                   const(5)                             UINT(4)       RADDAT
     D QP0L_ATTR_CHANGE_TIME...                                                               RADDAT
     D                 C                   const(6)                             UINT(4)       RADDAT
     D QP0L_ATTR_MODIFY_TIME...                                                               RADDAT
     D                 C                   const(7)                             UINT(4)       RADDAT
     D QP0L_ATTR_STG_FREE...                                                                  RADDAT
     D                 C                   const(8)                             CHAR(1)       RADDAT
     D QP0L_ATTR_CHECKED_OUT...                                                               RADDAT
     D                 C                   const(9)                             chkOut Fmt    RADDAT
     D QP0L_ATTR_LOCAL_REMOTE...                                                              RADDAT
     D                 C                   const(10)                            CHAR(1)       RADDAT
      *                                                                                       RADDAT
     D QP0L_DONOT_FOLLOW_SYMLNK...                                                            RADDAT
     D                 C                   const(x'00')                                       RADDAT
     D QP0L_FOLLOW_SYMLNK...                                                                  RADDAT
     D                 C                   const(x'01')                                       RADDAT
      *                                                                                       RADDAT
     D QP0L_NOT_CHECKED_OUT...                                                                RADDAT
     D                 C                   const(x'00')                                       RADDAT
     D QP0L_CHECKED_OUT...                                                                    RADDAT
     D                 C                   const(x'01')                                       RADDAT
      *                                                                                       RADDAT
     D QP0L_LOCAL_OBJ...                                                                      RADDAT
     D                 C                   const(x'01')                                       RADDAT
     D QP0L_REMOTE_OBJ...                                                                     RADDAT
     D                 C                   const(x'02')                                       RADDAT
      *                                                                                       RADDAT
      *  QlgGetcwd()--Get Current Directory (using NLS-enabled path name)                     RADDAT
      *  Returns: Qlg_Path_Name_T                                                             RADDAT
     D QlgGetcwd...                                                                           RADDAT
     D                 PR              *   extproc('QlgGetcwd')                               RADDAT
     D  o_path                             const  likeds(Qlg_Path_Name_t)                     RADDAT
     D  i_size                             value  like(size_t)                                RADDAT
      *                                                                                       RADDAT
      *  getcwd()--Get Current Directory
     D getcwd...
     D                 PR              *   extproc('getcwd')
     D  o_path                    65535A   const  options(*varsize)                           RADDAT
     D  i_size                             value  like(size_t)                                RADDAT
      *                                                                                       RADDAT
      *  QlgChdir()--Change Current Directory (using NLS-enabled path name)                   RADDAT
      *  Returns: Qlg_Path_Name_T                                                             RADDAT
     D QlgChdir...                                                                            RADDAT
     D                 PR            10I 0 extproc('QlgChdir')                                RADDAT
     D  i_path                             const  likeds(Qlg_Path_Name_t)                     RADDAT
      *                                                                                       RADDAT
      *  chdir()--Change Current Directory
     D chdir...
     D                 PR            10I 0 extproc('chdir')
     D  i_path                         *   value  options(*string)
      *                                                                                       RADDAT
      *  QSYSINC/SYS.TYPES                                                                    RADDAT
     D off_t           S             10I 0 based(pDummy)                                      RADDAT
     D size_t          S             10U 0 based(pDummy)                                      RADDAT
     D ssize_t         S             10I 0 based(pDummy)                                      RADDAT
     D time_t          S             10I 0 based(pDummy)                                      RADDAT
      *                                                                                       RADDAT
      *  0/-1 = chmod()--Change File Authorizations         include <sys/stat.h>
     D chmod...                                                                               RADDAT
     D                 PR            10I 0        extproc('chmod')              = int         RADDAT
     D  i_pPath                        *   value  options(*string)              = *path       RADDAT
     D  i_mode                       10U 0 value                                = mode_t =uint
      *                                                                                       RADDAT
      *  mkdir()--Make Directory                            include <sys/stat.h>              RADDAT
     D mkdir...
     D                 PR            10I 0        extproc('mkdir')              = rc
     D  i_pPath                        *   value options(*string)               = *path
     D  i_mode                       10U 0 value                                = mode_t =uint
      *                                                                                       RADDAT
      *  rmdir()--Remove Directory                          include <sys/stat.h>              RADDAT
     D rmdir...
     D                 PR            10I 0        extproc('rmdir')              = rc
     D  i_pPath                        *   value options(*string)               = *path
      *                                                                                       RADDAT
      *  opendir()--Open Directory                          include <dirent.h>                RADDAT
     D opendir...                                                                             RADDAT
     D                 PR              *          extproc('opendir')            = *DIR        RADDAT
     D  i_pDirName                     *   value options(*string)               = *dirname    RADDAT
      *                                                                                       RADDAT
      *  readdir()--Read Directory Entry                                                      RADDAT
     D readdir...                                                                             RADDAT
     D                 PR              *          extproc('readdir')            = *dirent     RADDAT
     D  i_dirp                         *   value                                = *DIR        RADDAT
      *                                                                                       RADDAT
     D dirent_t        DS                  qualified  based(pDummy)                           RADDAT
     D   d_reserv1                   16A                                                      RADDAT
     D   d_fileno_gen_id...                                                                   RADDAT
     D                               10U 0                                                    RADDAT
     D   d_fileno                    10U 0                                                    RADDAT
     D   d_reclen                    10U 0                                                    RADDAT
     D   d_reserv3                   10I 0                                                    RADDAT
     D   d_reserv4                    8A                                                      RADDAT
      /if not defined(*V5R2M0)                                                                RADDAT
     D   d_nlsinfo                         like(qlg_nls_t)                                    RADDAT
      /else                                                                                   RADDAT
     D   d_nlsinfo                         likeds(qlg_nls_t)                                  RADDAT
      /endif                                                                                  RADDAT
     D   d_namelen                   10U 0                                                    RADDAT
     D   d_name                     640A                                                      RADDAT
      *                                                                                       RADDAT
     D qlg_nls_t       DS                  qualified  based(pDummy)    align                  RADDAT
     D  ccsid                        10I 0                                                    RADDAT
     D  country_id                    2A                                                      RADDAT
     D  language_id                   3A                                                      RADDAT
     D  nls_reserved                  3A                                                      RADDAT
      *                                                                                       RADDAT
      *  rewinddir()--Reset Directory Stream to Beginning                                     RADDAT
     D rewinddir...                                                                           RADDAT
     D                 PR                  extproc('rewinddir')                               RADDAT
     D  i_dirp                         *   value                                = *DIR        RADDAT
      *                                                                                       RADDAT
      *  closedir()--Close Directory                                                          RADDAT
     D closedir...                                                                            RADDAT
     D                 PR            10I 0        extproc('closedir')           = rc          RADDAT
     D  i_dirp                         *   value                                = *DIR        RADDAT
      *                                                                                       RADDAT
      *  fd/-1 = open()--Open File                          include <fcntl.h>                 RADDAT
     D open...                                                                                RADDAT
     D                 PR            10I 0        extproc('open')               = int         RADDAT
     D  i_pPath                        *   value  options(*string)              = *path       RADDAT
     D  i_opnFLag                    10I 0 value                                = int         RADDAT
     D  i_mode                       10U 0 value  options(*nopass)              = uint        RADDAT
     D  i_codePage                   10U 0 value  options(*nopass)              = uint        RADDAT
     D  i_crtCodePage                10U 0 value  options(*nopass)              = uint        RADDAT
      *                                                                                       RADDAT
      *  <sys/stat.h>                                                                         RADDAT
     D S_IRUSR         C                   const(         256)                  ! Read For OwnRADDAT
     D S_IWUSR         C                   const(         128)                  ! Write For OwRADDAT
     D S_IXUSR         C                   const(          64)                  ! Exc/Srch ForRADDAT
     D S_IRWXU         C                   const(         448)                  ! Rd/Wrt/Exc ORADDAT
      *                                                                                       RADDAT
     D S_IRGRP         C                   const(          32)                  ! Read For GroRADDAT
     D S_IWGRP         C                   const(          16)                  ! Write For GrRADDAT
     D S_IXGRP         C                   const(           8)                  ! Exc/Srch ForRADDAT
     D S_IRWXG         C                   const(          56)                  ! Rd/Wrt/Exc GRADDAT
      *                                                                                       RADDAT
     D S_IROTH         C                   const(           4)                  ! Read For OthRADDAT
     D S_IWOTH         C                   const(           2)                  ! Write For OtRADDAT
     D S_IXOTH         C                   const(           1)                  ! Exc/Srch ForRADDAT
     D S_IRWXO         C                   const(           7)                  ! Rd/Wrt/Exc ORADDAT
      *                                                                                       RADDAT
     D S_ISUID         C                   const(        2048)
     D S_ISGID         C                   const(        1024)
     D S_ISVTX         C                   const(         512)
      *                                                                                       RADDAT
      *  <h/fcntl.h>                                                                          RADDAT
     D O_CREAT         C                   const( 8)                            ! Append Mode RADDAT
     D O_EXCL          C                   const(16)                            ! Exclusive UsRADDAT
     D O_TRUNC         C                   const(64)                            ! Truncate FlaRADDAT
      *                                                                                       RADDAT
     D O_APPEND        C                   const(256)                           ! Append Mode RADDAT
      *                                                                                       RADDAT
     D O_CODEPAGE      C                   const(  8388608)                     ! Codepage FlaRADDAT
     D O_TEXTDATA      C                   const( 16777216)                     ! Text Data FlRADDAT
     D O_FORCE_SCAN    C                   const( 67108864)                     ! Force scan  RADDAT
     D O_INHERITMODE   C                   const(134217728)                     ! Inherit ModeRADDAT
     D O_CCSID         C                   const(       32)                     ! CCSID       RADDAT
     D O_TEXT_CREAT    C                   const( 33554432)                     !             RADDAT
      *                                                                                       RADDAT
     D O_SHARE_RDONLY  C                   const( 65536)                        ! Shared Read RADDAT
     D O_SHARE_WRONLY  C                   const(131072)                        ! Shared WriteRADDAT
     D O_SHARE_RDWR    C                   const(262144)                        ! Shared Rd/WrRADDAT
     D O_SHARE_NONE    C                   const(524288)                        ! No Share    RADDAT
      *                                                                                       RADDAT
     D O_RDONLY        C                   const(1)                             ! Read Only   RADDAT
     D O_WRONLY        C                   const(2)                             ! Write Only  RADDAT
     D O_RDWR          C                   const(4)                             ! Read/Write  RADDAT
      *                                                                                       RADDAT
      *  value/-1 = read()--Write from Descriptor           include <unistd.h>                RADDAT
     D read...                                                                                RADDAT
     D                 PR                  extproc('read')   like(ssize_t   )   = ssize_t     RADDAT
     D  i_fd                         10I 0 value                                = int         RADDAT
     D  i_pBuffer                      *   value                                = *buf        RADDAT
     D  i_buflen                           value like(size_t    )               = size_t      RADDAT
      *                                                                                       RADDAT
      *  value/-1 = write()--Write to Descriptor            include <unistd.h>                RADDAT
     D write...                                                                               RADDAT
     D                 PR                  extproc('write')  like(ssize_t   )   = ssize_t     RADDAT
     D  i_fd                         10I 0 value                                = int         RADDAT
     D  i_pBuffer                      *   value                                = *buf        RADDAT
     D  i_buflen                           value like(size_t    )               = size_t      RADDAT
      *                                                                                       RADDAT
      *  0/-1 = ftruncate()--Truncate File                  include <unistd.h>                RADDAT
     D ftruncate...                                                                           RADDAT
     D                 PR            10I 0 extproc('ftruncate')                 = int         RADDAT
     D  i_fd                         10I 0 value                                = int         RADDAT
     D  i_length                           value like(off_t     )               = off_t       RADDAT
      *                                                                                       RADDAT
      *  off_t = lseek()--Set File Read/Write Offset        include <unistd.h>                RADDAT
     D lseek...                                                                               RADDAT
     D                 PR                  extproc('lseek')  like(off_t     )   = off_t       RADDAT
     D  i_fd                         10I 0 value                                = int         RADDAT
     D  i_offset                           value like(off_t     )               = off_t       RADDAT
     D  i_whence                     10I 0 value                                = int         RADDAT
      *                                                                                       RADDAT
      *  <h/unistd.h>                                                                         RADDAT
     D SEEK_SET        C                   const(0)                             ! seek start  RADDAT
     D SEEK_CUR        C                   const(1)                             ! seek curPos RADDAT
     D SEEK_END        C                   const(2)                             ! seek end    RADDAT
      *                                                                                       RADDAT
      *  0/-1 = unlink()--Remove Link to File               include <unistd.h>                RADDAT
     D unlink...                                                                              RADDAT
     D                 PR            10I 0 extproc('unlink')                    = int         RADDAT
     D  i_pPath                        *   value options(*string)               = *path       RADDAT
      *                                                                                       RADDAT
      *  0/-1 = Qp0lRenameKeep()--Rename File or Directory, Keep "new" If It Exists           RADDAT
     D Qp0lRenameKeep...                                                                      RADDAT
     D                 PR            10I 0 extproc('Qp0lRenameKeep')            = int         RADDAT
     D  i_pOldPath                     *   value options(*string)               = *path       RADDAT
     D  i_pNewPath                     *   value options(*string)               = *path       RADDAT
      *                                                                                       RADDAT
      *  0/-1 = Qp0lRenameUnlink()--Rename File or Directory, Unlink "new" If It Exists       RADDAT
     D Qp0lRenameUnlink...                                                                    RADDAT
     D                 PR            10I 0 extproc('Qp0lRenameUnlink')          = int         RADDAT
     D  i_pOldPath                     *   value options(*string)               = *path       RADDAT
     D  i_pNewPath                     *   value options(*string)               = *path       RADDAT
      *                                                                                       RADDAT
      *  0/-1 = close()--Close File or Socket Descriptor    include <unistd.h>                RADDAT
      /IF NOT DEFINED(c_close_function)                                                       RADDAT
      /DEFINE c_close_function                                                                RADDAT
     D close...                                                                               RADDAT
     D                 PR            10I 0 extproc('close')                     = int         RADDAT
     D  i_fd                         10I 0 value                                = int         RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      *  erno--Set Pointer to Runtime Error Code                                              RADDAT
     D errno           PR              *                     extproc('__errno')               RADDAT
      *                                                                                       RADDAT
      *  strerror -- Set Pointer to Runtime Error Message                                     RADDAT
     D strerror        PR              *                     extproc('strerror')              RADDAT
     D  errno                        10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  <sys/errno.h>                                                                        RADDAT
     D EDOM_C          C                   const(3001)                          domain error iRADDAT
     D ERANGE_C        C                   const(3002)                          range error inRADDAT
     D ETRUNC_C        C                   const(3003)                          truncation on RADDAT
     D ENOTOPEN_C      C                   const(3004)                          file has not bRADDAT
     D ENOTREAD_C      C                   const(3005)                          file not openeRADDAT
     D ERECIO_C        C                   const(3008)                          file opened foRADDAT
     D ENOTWRITE_C     C                   const(3009)                          file not openeRADDAT
     D ESTDIN_C        C                   const(3010)                          stdin cannot bRADDAT
     D ESTDOUT_C       C                   const(3011)                          stdout cannot RADDAT
     D ESTDERR_C       C                   const(3012)                          stderr cannot RADDAT
     D EBADSEEK_C      C                   const(3013)                          bad offset to RADDAT
     D EBADNAME_C      C                   const(3014)                          invalid file nRADDAT
     D EBADMODE_C      C                   const(3015)                          invalid file mRADDAT
     D EBADPOS_C       C                   const(3017)                          invalid positiRADDAT
     D ENOPOS_C        C                   const(3018)                          no record at sRADDAT
     D ENUMMBRS_C      C                   const(3019)                          no ftell if moRADDAT
     D ENUMRECS_C      C                   const(3020)                          no ftell if toRADDAT
     D EBADFUNC_C      C                   const(3022)                          invalid functiRADDAT
     D ENOREC_C        C                   const(3026)                          record not fouRADDAT
     D EBADDATA_C      C                   const(3028)                          message data iRADDAT
     D EBADOPT_C       C                   const(3040)                          bad option on RADDAT
     D ENOTUPD_C       C                   const(3041)                          file not openeRADDAT
     D ENOTDLT_C       C                   const(3042)                          file not openeRADDAT
     D EPAD_C          C                   const(3043)                          padding occurrRADDAT
     D EBADKEYLN_C     C                   const(3044)                          bad key lengthRADDAT
     D EPUTANDGET_C    C                   const(3080)                          illegal write RADDAT
     D EGETANDPUT_C    C                   const(3081)                          illegal read aRADDAT
     D EIOERROR_C      C                   const(3101)                          I/O exception RADDAT
     D EIORECERR_C     C                   const(3102)                          I/O exception RADDAT
      *                                                                                       RADDAT
      *  The following values are defined by POSIX ISO/IEC 9945-1:1990.                       RADDAT
     D EINVAL_C        C                   const(3021)                          invalid argumeRADDAT
     D EIO_C           C                   const(3006)                          input/output eRADDAT
     D ENODEV_C        C                   const(3007)                          no such deviceRADDAT
     D EBUSY_C         C                   const(3029)                          resource busy RADDAT
     D ENOENT_C        C                   const(3025)                          no such file oRADDAT
     D EPERM_C         C                   const(3027)                          operation not RADDAT
      *                                                                                       RADDAT
      *  AS/400 specific error numbers                                                        RADDAT
     D EACCES_C        C                   const(3401)                          Permission denRADDAT
     D ENOTDIR_C       C                   const(3403)                          Not a directorRADDAT
     D ENOSPC_C        C                   const(3404)                          No space availRADDAT
     D EXDEV_C         C                   const(3405)                          Improper link.RADDAT
     D EWOULDBLOCK_C   C                   const(3406)                          Operation woulRADDAT
     D EAGAIN_C        C                   const(3406)                          Operation woulRADDAT
     D EINTR_C         C                   const(3407)                          Interrupted fuRADDAT
     D EFAULT_C        C                   const(3408)                          The address usRADDAT
     D ETIME_C         C                   const(3409)                          Operation timeRADDAT
     D ENXIO_C         C                   const(3415)                          No such deviceRADDAT
     D ECLOSED_C       C                   const(3417)                          Socket closed RADDAT
     D EADDRINUSE_C    C                   const(3420)                          Address alreadRADDAT
     D EADDRNOTAVAIL_C...                                                                     RADDAT
     D                 C                   const(3421)                          Address not avRADDAT
     D EAFNOSUPPORT_C  C                   const(3422)                          The type of soRADDAT
     D EALREADY_C      C                   const(3423)                          Operation alreRADDAT
     D ECONNABORTED_C  C                   const(3424)                          Connection endRADDAT
     D ECONNREFUSED_C  C                   const(3425)                          A remote host RADDAT
     D ECONNRESET_C    C                   const(3426)                          A connection wRADDAT
     D EDESTADDRREQ_C  C                   const(3427)                          Operation requRADDAT
     D EHOSTDOWN_C     C                   const(3428)                          A remote host RADDAT
     D EHOSTUNREACH_C  C                   const(3429)                          A route to theRADDAT
     D EINPROGRESS_C   C                   const(3430)                          Operation in pRADDAT
     D EISCONN_C       C                   const(3431)                          A connection hRADDAT
     D EMSGSIZE_C      C                   const(3432)                          Message size oRADDAT
     D ENETDOWN_C      C                   const(3433)                          The network isRADDAT
     D ENETRESET_C     C                   const(3434)                          A socket is coRADDAT
     D ENETUNREACH_C   C                   const(3435)                          Cannot reach tRADDAT
     D ENOBUFS_C       C                   const(3436)                          There is not eRADDAT
     D ENOPROTOOPT_C   C                   const(3437)                          The protocol dRADDAT
     D ENOTCONN_C      C                   const(3438)                          Requested operRADDAT
     D ENOTSOCK_C      C                   const(3439)                          The specified RADDAT
     D ENOTSUP_C       C                   const(3440)                          Operation not RADDAT
     D EOPNOTSUPP_C    C                   const(3440)                          Operation not RADDAT
     D EPFNOSUPPORT_C  C                   const(3441)                          The socket proRADDAT
     D EPROTONOSUPPORT_C...                                                                   RADDAT
     D                 C                   const(3442)                          No protocol ofRADDAT
     D EPROTOTYPE_C    C                   const(3443)                          The socket typRADDAT
     D ERCVDERR_C      C                   const(3444)                          An error indicRADDAT
     D ESHUTDOWN_C     C                   const(3445)                          Cannot send daRADDAT
     D ESOCKTNOSUPPORT_C...                                                                   RADDAT
     D                 C                   const(3446)                          The specified RADDAT
     D ETIMEDOUT_C     C                   const(3447)                          A remote host RADDAT
     D EUNATCH_C       C                   const(3448)                          The protocol rRADDAT
     D EBADF_C         C                   const(3450)                          Descriptor notRADDAT
     D EMFILE_C        C                   const(3452)                          Too many open RADDAT
     D ENFILE_C        C                   const(3453)                          Too many open RADDAT
     D EPIPE_C         C                   const(3455)                          Broken pipe.  RADDAT
     D EEXIST_C        C                   const(3457)                          File exists.  RADDAT
     D EDEADLK_C       C                   const(3459)                          Resource deadlRADDAT
     D ENOMEM_C        C                   const(3460)                          Storage allocaRADDAT
     D EOWNERTERM_C    C                   const(3462)                          The mutex no lRADDAT
     D EDESTROYED_C    C                   const(3463)                          he synchronizaRADDAT
     D ETERM_C         C                   const(3464)                          Operation termRADDAT
     D EMLINK_C        C                   const(3468)                          Maximum link cRADDAT
     D ESPIPE_C        C                   const(3469)                          Seek request nRADDAT
     D ENOSYS_C        C                   const(3470)                          Function not iRADDAT
     D EISDIR_C        C                   const(3471)                          Specified targRADDAT
     D EROFS_C         C                   const(3472)                          Read-only fileRADDAT
     D EUNKNOWN_C      C                   const(3474)                          Unknown systemRADDAT
     D EITERBAD_C      C                   const(3475)                          Iterator is inRADDAT
     D EDAMAGE_C       C                   const(3484)                          A damaged objeRADDAT
     D ELOOP_C         C                   const(3485)                          A loop exists RADDAT
     D ENAMETOOLONG_C  C                   const(3486)                          A path name isRADDAT
     D ENOLCK_C        C                   const(3487)                          No locks availRADDAT
     D ENOTEMPTY_C     C                   const(3488)                          Directory not RADDAT
     D ENOSYSRSC_C     C                   const(3489)                          System resourcRADDAT
     D ECONVERT_C      C                   const(3490)                          Conversion errRADDAT
     D E2BIG_C         C                   const(3491)                          Argument list RADDAT
     D EILSEQ_C        C                   const(3492)                          Conversion stoRADDAT
     D ESOFTDAMAGE_C   C                   const(3497)                          Object has sofRADDAT
     D ENOTENROLL_C    C                   const(3498)                          User not enrolRADDAT
     D EOFFLINE_C      C                   const(3499)                          Object is suspRADDAT
     D EROOBJ_C        C                   const(3500)                          Object is a reRADDAT
     D ELOCKED_C       C                   const(3506)                          Area being reaRADDAT
     D EFBIG_C         C                   const(3507)                          Object too larRADDAT
     D EIDRM_C         C                   const(3509)                          The semaphore,RADDAT
     D ENOMSG_C        C                   const(3510)                          The queue doesRADDAT
     D EFILECVT_C      C                   const(3511)                          File ID converRADDAT
     D EBADFID_C       C                   const(3512)                          A File ID coulRADDAT
     D ESTALE_C        C                   const(3513)                          A File ID coulRADDAT
     D ESRCH_C         C                   const(3515)                          No such procesRADDAT
     D ENOTSIGINIT_C   C                   const(3516)                          Process not enRADDAT
     D ECHILD_C        C                   const(3517)                          No child proceRADDAT
     D EBADH_C         C                   const(3520)                          Handle is not RADDAT
     D ETOOMANYREFS_C  C                   const(3523)                          The operation RADDAT
     D ENOTSAFE_C      C                   const(3524)                          Function not aRADDAT
     D EOVERFLOW_C     C                   const(3525)                          Object is too RADDAT
     D EJRNDAMAGE_C    C                   CONST(3526)                          Journal damageRADDAT
     D EJRNINACTIVE_C  C                   CONST(3527)                          Journal inactiRADDAT
     D EJRNRCVSPC_C    C                   CONST(3528)                          Journal space RADDAT
     D EJRNRMT_C       C                   CONST(3529)                          Journal is remRADDAT
     D ENEWJRNRCV_C    C                   CONST(3530)                          New journal reRADDAT
     D ENEWJRN_C       C                   CONST(3531)                          New journal isRADDAT
     D EJOURNALED_C    C                   CONST(3532)                          Object alreadyRADDAT
     D EJRNENTTOOLONG_C...                                                                    RADDAT
     D                 C                   CONST(3533)                          Entry too largRADDAT
     D EDATALINK_C     C                   CONST(3534)                          Object is a DaRADDAT
     D ENOTAVAIL_C     C                   CONST(3535)                          Independent ASRADDAT
     D ENOTTY_C        C                   CONST(3536)                          Inappropriate RADDAT
     D EFBIG2_C        C                   CONST(3540)                          Write or truncRADDAT
     D ETXTBSY_C       C                   CONST(3543)                          Text file busyRADDAT
     D EASPGRPNOTSET_C...                                                                     RADDAT
     D                 C                   CONST(3544)                          ASP group not RADDAT
     D ERESTART_C      C                   CONST(3545)                          System call caRADDAT
     D ESCANFAILURE_C  C                   CONST(3546)                          Object marked RADDAT
      *                                                                                       RADDAT
      *  Unix return codes                                                                    RADDAT
     D RC_OK           C                   const(0)                                           RADDAT
     D RC_ERROR        C                   const(-1)                                          RADDAT
      *                                                                                       RADDAT
      *  Convert External Form to Numeric Value (CVTEFN)                                      RADDAT
     D cvtefnd...                                                                             RADDAT
     D                 PR             8F   extproc('cvtefnd')                                 RADDAT
     D  i_source                       *   value                                              RADDAT
     D  i_len                        10U 0 value                                              RADDAT
     D  i_mask                         *   value                                              RADDAT
      *                                                                                       RADDAT
      *  Test Bit in String (TSTBTS)                                                          RADDAT
     D tstbts...                                                                              RADDAT
     D                 PR            10I 0 extproc('tstbts')                                  RADDAT
     D  bit_string                     *   value                                              RADDAT
     D  bit_offset                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  getenv()--Get Value of Environment Variable                                          RADDAT
     D getenv...                                                                              RADDAT
     D                 PR              *   extproc('getenv')                                  RADDAT
     D  name                           *   value  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  putenv()--Change or Add Environment Variable                                         RADDAT
     D putenv...                                                                              RADDAT
     D                 PR            10I 0 extproc('putenv')                                  RADDAT
     D  string                         *   value  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  Qp0zDltEnv()--Delete an Environment Variable                                         RADDAT
     D Qp0zDltEnv...                                                                          RADDAT
     D                 PR            10I 0 extproc('Qp0zDltEnv')                              RADDAT
     D  name                           *   value  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  Qp0zInitEnv()--Initialize Environment for Variables                                  RADDAT
     D Qp0zInitEnv...                                                                         RADDAT
     D                 PR            10I 0 extproc('Qp0zInitEnv')                             RADDAT
      *                                                                                       RADDAT
     D ENVIRON         S               *   import('environ')                                  RADDAT
      *                                                                                       RADDAT
      *  Generate Universal Unique Identifier (GENUUID)                                       RADDAT
     D genUUID...                                                                             RADDAT
     D                 PR                  extproc('_GENUUID')                                RADDAT
     D  uuid_template                  *   value                                              RADDAT
      *                                                                                       RADDAT
     D uuid_template_t...                                                                     RADDAT
     D                 DS                  qualified  based(pDummy)                           RADDAT
     D  bytPrv                       10U 0                                                    RADDAT
     D  bytAvl                       10U 0                                                    RADDAT
     D  reserved                      8A                                                      RADDAT
     D  uuid                         16A                                                      RADDAT
      *                                                                                       RADDAT
      *  Convert Hex to Character (CVTHC)                                                     RADDAT
     D cvthc...                                                                               RADDAT
     D                 PR                  extproc('cvthc')                                   RADDAT
     D  pResult                        *   value                                              RADDAT
     D  pSource                        *   value                                              RADDAT
     D  sourceSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Convert Eight Bit Character to Hex Nibbles (CVTCH)                                   RADDAT
     D cvtch...                                                                               RADDAT
     D                 PR                  extproc('cvtch')                                   RADDAT
     D  pResult                        *   value                                              RADDAT
     D  pSource                        *   value                                              RADDAT
     D  sourceLen                    10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Cipher (CIPHER)                                                                      RADDAT
     D cipher...                                                                              RADDAT
     D                 PR                  extproc('_CIPHER')                                 RADDAT
     D                                 *   const                                              RADDAT
     D                                 *   value                                              RADDAT
     D                                 *   const                                              RADDAT
      *                                                                                       RADDAT
     D cipherCtrls_t   DS                  qualified  based(pDummy)  align                    RADDAT
     D  function               1      2A                                                      RADDAT
     D  hashAlg                3      3A                                                      RADDAT
     D  sequence               4      4A                                                      RADDAT
     D  dataLength             5      8U 0                                                    RADDAT
     D  output                 9      9A                                                      RADDAT
     D  reserved_1            10     16A                                                      RADDAT
     D  hashContext           17     32*                                                      RADDAT
     D  HMACKey               33     48*                                                      RADDAT
     D  HMACKeyLength         49     52U 0                                                    RADDAT
     D  reserved_2            53     96A                                                      RADDAT
      *                                                                                       RADDAT
     D cCIPHER_MD5...                                                                         RADDAT
     D                 C                   const(x'00')                                       RADDAT
     D cCIPHER_SHA1...                                                                        RADDAT
     D                 C                   const(x'01')                                       RADDAT
      *                                                                                       RADDAT
     D cCIPHER_ONLY...                                                                        RADDAT
     D                 C                   const(x'00')                                       RADDAT
     D cCIPHER_FIRST...                                                                       RADDAT
     D                 C                   const(x'01')                                       RADDAT
     D cCIPHER_MIDDLE...                                                                      RADDAT
     D                 C                   const(x'02')                                       RADDAT
     D cCIPHER_FINAL...                                                                       RADDAT
     D                 C                   const(x'03')                                       RADDAT
      *                                                                                       RADDAT
     D cCIPHER_HASH...                                                                        RADDAT
     D                 C                   const(x'00')                                       RADDAT
     D cCIPHER_HMAC...                                                                        RADDAT
     D                 C                   const(x'01')                                       RADDAT
      *                                                                                       RADDAT
 DEF  /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing COPYRIGHT  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "COPYRIGHT "
mbrtype =  "RPGLE     "
mbrtext =  "Copyright information                             "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /if not defined(COPYRIGHT_DSPEC)
     H COPYRIGHT('V1.15 - 12.05.2015 - mailto:thomas.raddatz@tools400.de')
      /eof
      /endif
     D cTMU_VERSION...
     D                 C                   '1.15'
     D cTMU_DATE...
     D                 C                   '12.05.2015'
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDENVVAR  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDENVVAR  "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : Environment variable                    "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(envVar_t  )                                                             RADDAT
      /DEFINE envVar_t                                                                        RADDAT
      * ============================================================= *                       RADDAT
      *   Environment variable.                                       *                       RADDAT
      * ============================================================= *                       RADDAT
      *                                                                                       RADDAT
     D envVar_t        DS                  qualified           based(pDummy)                  RADDAT
     D  name                        128A   varying
     D  value                      1024A   varying                                            RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDERRCODE  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDERRCODE "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : API error code                          "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(errCode_t )                                                             RADDAT
      /DEFINE errCode_t                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  API error code                                               *                       RADDAT
      *===============================================================*                       RADDAT
     D errCode_t       DS                  qualified           based(pDummy)                  RADDAT
     D  bytPrv                       10I 0                                                    RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
     D  excID                         7A                                                      RADDAT
     D  reserved_1                    1A                                                      RADDAT
     D  excDta                      256A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDINFDS  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDINFDS   "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : File information data structure         "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(fileInfDS_t)                                                            RADDAT
      /DEFINE fileInfDS_t                                                                     RADDAT
      *===============================================================*                       RADDAT
      *  File information data structure                              *                       RADDAT
      *===============================================================*                       RADDAT
     D fileInfDS_t     DS                  based(pDummy)   qualified                          RADDAT
      * Reserved 01                                                                           RADDAT
     D  reserved_01            1      8A                                                      RADDAT
      * Open indication 1=open                                                                RADDAT
     D  isOpen                 9      9A                                                      RADDAT
      * End of file 1=EOF                                                                     RADDAT
     D  isEOF                 10     10A                                                      RADDAT
      * Status                                                                                RADDAT
     D  status                11     15S 0                                                    RADDAT
      * Operation code, first 5 pos.                                                          RADDAT
     D  opCode                16     20A                                                      RADDAT
      * IO-Type:                                                                              RADDAT
      *   F=The last operation was specified for a file name                                  RADDAT
      *   R=The last operation was specified for a record                                     RADDAT
      *   I=The last operation was an implicit file operation.                                RADDAT
     D  IO_type               21     21A                                                      RADDAT
      * Routine of operation code                                                             RADDAT
     D  routine               22     29A                                                      RADDAT
      * RPG source listing line nbr                                                           RADDAT
     D  srcSeq                30     37A                                                      RADDAT
      * Record format                                                                         RADDAT
     D  rcdFormat             38     45A                                                      RADDAT
      * System message number                                                                 RADDAT
     D  sysMsgNbr             46     52A                                                      RADDAT
      * Reserved 02                                                                           RADDAT
     D  reserved_02           53     66A                                                      RADDAT
      *                                                                                       RADDAT
      * Valid after post:                                                                     RADDAT
      *    Screen size (product of the number of rows                                         RADDAT
      *    and the number of columns on the device screen).                                   RADDAT
     D  screenSize            67     70S 0                                                    RADDAT
      *    The display's keyboard type.                                                       RADDAT
      *       00 = alphanumeric or katakana                                                   RADDAT
      *       10 = ideographic                                                                RADDAT
     D  kbdType               71     72S 0                                                    RADDAT
      *    The display type.                                                                  RADDAT
      *       00 = alphanumeric or katakana                                                   RADDAT
      *       10 = ideographic                                                                RADDAT
      *       20 = DBCS                                                                       RADDAT
     D  displayType           73     74S 0                                                    RADDAT
      *    Always set to 00.                                                                  RADDAT
     D  mode                  75     76S 0                                                    RADDAT
      * Reserved_03                                                                           RADDAT
     D  reserved_03           77     80A                                                      RADDAT
      *                                                                                       RADDAT
      *  -------------------------------                                                      RADDAT
      *    Open Feedback                                                                      RADDAT
      *  -------------------------------                                                      RADDAT
     D  openFeedback                       likeds(openFeedback_t)                             RADDAT
      *                                                                                       RADDAT
      *  -------------------------------                                                      RADDAT
      *    Input/Output Feedback                                                              RADDAT
      *  -------------------------------                                                      RADDAT
     D  IO_feedback                        likeds(IO_feedback_t )                             RADDAT
      *                                                                                       RADDAT
      *  -------------------------------                                                      RADDAT
      *    I/O Feedback, File specific                                                        RADDAT
      *  -------------------------------                                                      RADDAT
     D  IO_feedback_file...                                                                   RADDAT
     D                              256A                                                      RADDAT
      *    I/O Feedback Database File                                                         RADDAT
     D  IO_feedback_DB...                                                                     RADDAT
     D                                     likeds(IO_feedback_DB_t)                           RADDAT
     D                                     overlay(IO_feedback_file)                          RADDAT
      *                                                                                       RADDAT
      *  -------------------------------                                                      RADDAT
      *    Open Feedback                                                                      RADDAT
      *  -------------------------------                                                      RADDAT
     D openFeedback_t...                                                                      RADDAT
     D                 DS           160    qualified                                          RADDAT
      * DS=Display DB=File SP=Spooled File                                                    RADDAT
     D  ODP_type               1      2A                                                      RADDAT
      * File name                                                                             RADDAT
     D  file                   3     12A                                                      RADDAT
      * Library                                                                               RADDAT
     D  lib                   13     22A                                                      RADDAT
      * Spool file name                                                                       RADDAT
     D  spoolFile             23     32A                                                      RADDAT
      * Spool file library                                                                    RADDAT
     D  spoolLib              33     42A                                                      RADDAT
      * Spool file number                                                                     RADDAT
     D  spoolNbr              43     44I 0                                                    RADDAT
      * Record length                                                                         RADDAT
     D  maxRcdLength          45     46I 0                                                    RADDAT
      * Key length                                                                            RADDAT
     D  maxKeyLength          47     48I 0                                                    RADDAT
      * Member                                                                                RADDAT
     D  mbr                   49     58A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_01           59     62I 0                                                    RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_02           63     66I 0                                                    RADDAT
      * File type                                                                             RADDAT
      *     1  =  Display                                                                     RADDAT
      *     2  =  Printer                                                                     RADDAT
      *     4  =  Diskette                                                                    RADDAT
      *     5  =  Tape                                                                        RADDAT
      *     9  =  Save                                                                        RADDAT
      *    10  =  DDM                                                                         RADDAT
      *    11  =  ICF                                                                         RADDAT
      *    20  =  Inline data                                                                 RADDAT
      *    21  =  Database                                                                    RADDAT
     D  fileType              67     68I 0                                                    RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_03           69     71A                                                      RADDAT
      * Number of lines on a display screen or       (Display, printer)                       RADDAT
      * number of lines on a printed page.                                                    RADDAT
     D  rows                  72     73I 0                                                    RADDAT
      * Length of the null field byte map.           (Database)                               RADDAT
     D  lenNullFldMap         72     73I 0                                                    RADDAT
      * Number of positions on a display screen or   (Display, printer)                       RADDAT
      * number of characters on a printed line.                                               RADDAT
     D  columns               74     75I 0                                                    RADDAT
      * Length of the null key field byte map.       (Database)                               RADDAT
     D  lenKeyFldMap          74     75I 0                                                    RADDAT
      * Number of records in the member at open                                               RADDAT
      * at open time.                                                                         RADDAT
     D numRcdsAtOpen          76     79I 0                                                    RADDAT
      * Access type                                                                           RADDAT
     D accessType             80     81A                                                      RADDAT
      * Duplicate key?                                                                        RADDAT
     D isDupKey               82     82A                                                      RADDAT
      * Source file?                                                                          RADDAT
     D isSrcFile              83     83A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D reserved_04            84     93A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D reserved_05            94    103A                                                      RADDAT
      * Offset to volume label fields of open                                                 RADDAT
      * feedback area.                                                                        RADDAT
     D ofsVolLblFld          104    105I 0                                                    RADDAT
      * Max rcds in blk                                                                       RADDAT
     D maxBlkRcds            106    107I 0                                                    RADDAT
      * Overflow line                                                                         RADDAT
     D overflow              108    109I 0                                                    RADDAT
      * Blk increment                                                                         RADDAT
     D blkInc                110    111I 0                                                    RADDAT
      * Reserved                                                                              RADDAT
     D reserved_06           112    115A                                                      RADDAT
      * Miscellaneous flags                                                                   RADDAT
     D flags1                116    116A                                                      RADDAT
      * Requester name                                                                        RADDAT
     D requester             117    126A                                                      RADDAT
      * Open count                                                                            RADDAT
     D openCount             127    128I 0                                                    RADDAT
      * Reserved                                                                              RADDAT
     D reserved_07           129    129A                                                      RADDAT
      * Num based mbrs                                                                        RADDAT
     D numBasedMbrs          131    132I 0                                                    RADDAT
      * Miscellaneous flags                                                                   RADDAT
     D flags2                133    133A                                                      RADDAT
      * Open identifier                                                                       RADDAT
     D openID                134    135A                                                      RADDAT
      * Max rcd fmt length                                                                    RADDAT
     D maxRcdFmtLen          136    137I 0                                                    RADDAT
      * Database CCSID                                                                        RADDAT
     D CCSID                 138    139I 0                                                    RADDAT
      * Miscellaneous flags                                                                   RADDAT
     D flags3                140    140A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D reserved_08           141    146A                                                      RADDAT
      * Num devs defined                                                                      RADDAT
     D numDevices            147    148I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  -------------------------------                                                      RADDAT
      *    Input/Output Feedback                                                              RADDAT
      *  -------------------------------                                                      RADDAT
     D IO_feedback_t...                                                                       RADDAT
     D                 DS           126    qualified                                          RADDAT
      * Offset to file dependant feedback                                                     RADDAT
     D ofsFileDepFB            1      2I 0                                                    RADDAT
      * Write count                                                                           RADDAT
     D writeCount              3      6I 0                                                    RADDAT
      * Read count                                                                            RADDAT
     D readCount               7     10I 0                                                    RADDAT
      * Write/read count                                                                      RADDAT
     D writeReadCount         11     14I 0                                                    RADDAT
      * Other I/O count                                                                       RADDAT
     D otherCount             15     18I 0                                                    RADDAT
      * Reserved                                                                              RADDAT
     D reserved_01            19     19A                                                      RADDAT
      * Current operation                                                                     RADDAT
      *   hex 01 =  Read or read block or read from invited devices                           RADDAT
      *   hex 02 =  Read direct                                                               RADDAT
      *   hex 03 =  Read by key                                                               RADDAT
      *   hex 05 =  Write or write block                                                      RADDAT
      *   hex 06 =  Write-read                                                                RADDAT
      *   hex 07 =  Update                                                                    RADDAT
      *   hex 08 =  Delete                                                                    RADDAT
      *   hex 09 =  Force-end-of-data                                                         RADDAT
      *   hex 0A =  Force-end-of-volume                                                       RADDAT
      *   hex 0D =  Release record lock                                                       RADDAT
      *   hex 0E =  Change end-of-data                                                        RADDAT
      *   hex 0F =  Put deleted record                                                        RADDAT
      *   hex 11 =  Release device                                                            RADDAT
      *   hex 12 =  Acquire device                                                            RADDAT
     D operation              20     20A                                                      RADDAT
      * Rcd format name                                                                       RADDAT
     D IO_rcdFmt              21     30A                                                      RADDAT
      * Device class                                                                          RADDAT
     D deviceClass            31     32A                                                      RADDAT
      * Pgm device name                                                                       RADDAT
     D IO_pgmDevice           33     42A                                                      RADDAT
      * Rcd len of I/O                                                                        RADDAT
     D IO_rcdLength           43     46I 0                                                    RADDAT
      * Reserved                                                                              RADDAT
     D reserved_02            47    126A                                                      RADDAT
      *                                                                                       RADDAT
      *  -------------------------------                                                      RADDAT
      *    I/O Feedback Database File                                                         RADDAT
      *  -------------------------------                                                      RADDAT
     D IO_feedback_DB_t...                                                                    RADDAT
     D                 DS                  qualified                                          RADDAT
      * Number of locked records                                                              RADDAT
     D  numLckRcds            11     12I 0                                                    RADDAT
      * Maximum number of fields                                                              RADDAT
     D  maxNumFlds            13     14I 0                                                    RADDAT
      * Nbr of key fields                                                                     RADDAT
     D  nbrOfKeyFlds          21     22I 0                                                    RADDAT
      * Key length                                                                            RADDAT
     D  keyLength             27     28I 0                                                    RADDAT
      * Data member number.                                                                   RADDAT
     D  dtaMbrNum             29     30I 0                                                    RADDAT
      * Relative record number in data member.                                                RADDAT
     D  rcdNbr                31     34U 0                                                    RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDMBRD0100  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDMBRD0100"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QUSRMBRD API - MBRD0100                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(mbrd0100_t)                                                             RADDAT
      /DEFINE mbrd0100_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QUSRMBRD API - MBRD0100                                      *                       RADDAT
      *===============================================================*                       RADDAT
     D mbrd0100_t      DS                  qualified           based(pDummy)                  RADDAT
     D  bytePrv                      10I 0                                                    RADDAT
     D  byteAvl                      10I 0                                                    RADDAT
     D  filNme                       10A                                                      RADDAT
     D  filLib                       10A                                                      RADDAT
     D  mbr                          10A                                                      RADDAT
     D  attr                         10A                                                      RADDAT
     D  srcTyp                       10A                                                      RADDAT
     D  crtDatTim                    13A                                                      RADDAT
     D  chgDatTim                    13A                                                      RADDAT
     D  text                         50A                                                      RADDAT
     D  isSrcFile                     1A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDMBRD0200  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDMBRD0200"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QUSRMBRD API - MBRD0200                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(mbrd0200_t)                                                             RADDAT
      /DEFINE mbrd0200_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QUSRMBRD API - MBRD0200                                      *                       RADDAT
      *===============================================================*                       RADDAT
     D mbrd0200_t      DS                  qualified           based(pDummy)                  RADDAT
     D  bytePrv                      10I 0                                                    RADDAT
     D  byteAvl                      10I 0                                                    RADDAT
     D  filNme                       10A                                                      RADDAT
     D  filLib                       10A                                                      RADDAT
     D  mbr                          10A                                                      RADDAT
     D  attr                         10A                                                      RADDAT
     D  srcTyp                       10A                                                      RADDAT
     D  crtDatTim                    13A                                                      RADDAT
     D  chgDatTim                    13A                                                      RADDAT
     D  text                         50A                                                      RADDAT
     D  isSrcFile                     1A                                                      RADDAT
      * - - - - - - - - - - - - - - - - -                                                     RADDAT
     D rmtFile                        1A                                                      RADDAT
     D lglFile                        1A                                                      RADDAT
     D odpSharing                     1A                                                      RADDAT
     D reserved_1                     2A                                                      RADDAT
     D numRcdAllMbr                  10I 0                                                    RADDAT
     D numDltRcd                     10I 0                                                    RADDAT
     D dtaSpcSize                    10I 0                                                    RADDAT
     D accPthSize                    10I 0                                                    RADDAT
     D numPhyMbrs                    10I 0                                                    RADDAT
     D mbrChgDatTim                  13A                                                      RADDAT
     D mbrSavDatTim                  13A                                                      RADDAT
     D mbrRstDatTim                  13A                                                      RADDAT
     D mbrExpDate                     7A                                                      RADDAT
     D reserved_2                     6A                                                      RADDAT
     D numDaysUsed                   10I 0                                                    RADDAT
     D dateLastUsed                   7A                                                      RADDAT
     D useResetDate                   7A                                                      RADDAT
     D reserved_3                     2A                                                      RADDAT
     D dtaSpcSizeMult                10I 0                                                    RADDAT
     D accPthSizeMult                10I 0                                                    RADDAT
     D mbrTextCCSID                  10I 0                                                    RADDAT
     D ofsAddInf                     10I 0                                                    RADDAT
     D lenAddInf                     10I 0                                                    RADDAT
     D numRcdAllMbrU                 10U 0                                                    RADDAT
     D numDltRcdU                    10U 0                                                    RADDAT
     D reserved_4                     6A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDMSG  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDMSG     "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : Message                                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(msg_t     )                                                             RADDAT
      /DEFINE msg_t                                                                           RADDAT
      * ============================================================= *                       RADDAT
      *   Message structure                                           *                       RADDAT
      * ============================================================= *                       RADDAT
      *                                                                                       RADDAT
     D msg_t           DS                  qualified           based(pDummy)                  RADDAT
      /if defined(*V5R3M0)                                                                    RADDAT
     D  ID                                 likeds(msgID_t)                                    RADDAT
      /else                                                                                   RADDAT
     D  ID                            7A                                                      RADDAT
      /endif                                                                                  RADDAT
     D  data                        512A                                                      RADDAT
     D  type                         10A                                                      RADDAT
     D  file                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      /if defined(*V5R3M0)                                                                    RADDAT
     D msgID_t         DS                  qualified           based(pDummy)                  RADDAT
     D  prefix                        3A                                                      RADDAT
     D  nbr                           4S 0                                                    RADDAT
      /endif                                                                                  RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDOBJD0100  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDOBJD0100"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QUSROBJD API - OBJD0100                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(objd0100_t)                                                             RADDAT
      /DEFINE objd0100_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QUSROBJD API - OBJD0300                                      *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D objd0100_t      DS                  qualified           based(pDummy)                  RADDAT
     D  bytRet                       10I 0                                                    RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
     D  type                         10A                                                      RADDAT
     D  rtnLib                       10A                                                      RADDAT
     D  auxStgP                      10I 0                                                    RADDAT
     D  owner                        10A                                                      RADDAT
     D  domain                        2A                                                      RADDAT
     D  crtDatTim                    13A                                                      RADDAT
     D  chgDatTim                    13A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDQFILE  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDQFILE   "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : Qualified file name                     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(qFile_t   )                                                             RADDAT
      /DEFINE qFile_t                                                                         RADDAT
      * ============================================================= *                       RADDAT
      *   Qualified file name                                         *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D qFile_t         DS                  qualified           based(pDummy)                  RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
     D  mbr                          10A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDQOBJ  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDQOBJ    "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : Qualified object name                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(qObj_t    )                                                             RADDAT
      /DEFINE qObj_t                                                                          RADDAT
      * ============================================================= *                       RADDAT
      *   Qualified object name                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D qObj_t          DS                  qualified           based(pDummy)                  RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDQQSYSOBJ  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDQQSYSOBJ"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : Qualified QSYS object name              "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(qQSYSObj_t)                                                             RADDAT
      /DEFINE qQSYSObj_t                                                                      RADDAT
      * ============================================================= *                       RADDAT
      *   Qualified QSYS object name                                  *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D qQSYSObj_t      DS                  qualified           based(pDummy)                  RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
     D  mbr                          10A                                                      RADDAT
     D  type                         10A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDRCVM0200  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDRCVM0200"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QMHRCVM  API - RCVM0200                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(rcvm0200_t)                                                             RADDAT
      /DEFINE rcvm0200_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QMHRCVM API - RCVM0200                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D rcvm0200_t      DS                  qualified           based(pDummy)                  RADDAT
      * Bytes returned                                                                        RADDAT
     D  bytRet                       10I 0                                                    RADDAT
      * Bytes available                                                                       RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
      * Message Severity                                                                      RADDAT
     D  msgSev                       10I 0                                                    RADDAT
      * Message ID                                                                            RADDAT
     D  msgID                         7A                                                      RADDAT
      * Message Type                                                                          RADDAT
     D  msgType                       2A                                                      RADDAT
      * Message Key                                                                           RADDAT
     D  msgKey                        4A                                                      RADDAT
      * Message File                                                                          RADDAT
     D  msgF                         10A                                                      RADDAT
      * Message Library Specified                                                             RADDAT
     D  msgLS                        10A                                                      RADDAT
      * Message Library Used                                                                  RADDAT
     D  msgLU                        10A                                                      RADDAT
      * Sending Job                                                                           RADDAT
     D  sndJob                       10A                                                      RADDAT
      * Sending User Profile                                                                  RADDAT
     D  sndUsr                       10A                                                      RADDAT
      * Sending Job Number                                                                    RADDAT
     D  sndNbr                        6A                                                      RADDAT
      * Sending Program                                                                       RADDAT
     D  sndPgm                       12A                                                      RADDAT
      * Sending program Instr. Nbr.                                                           RADDAT
     D  sndINb                        4A                                                      RADDAT
      * Sending Date                                                                          RADDAT
     D  sndDat                        7A                                                      RADDAT
      * Sending Time                                                                          RADDAT
     D  sndTim                        6A                                                      RADDAT
      * Receiving program                                                                     RADDAT
     D  rcvPgm                       10A                                                      RADDAT
      * Receiving Program Instr. Nbr                                                          RADDAT
     D  rcvINb                        4A                                                      RADDAT
      * Sending Type                                                                          RADDAT
     D  sndTyp                        1A                                                      RADDAT
      * Receiving Type                                                                        RADDAT
     D  rcvTyp                        1A                                                      RADDAT
      * Reserved 01                                                                           RADDAT
     D  reserved_01                   1A                                                      RADDAT
      * Conversion Status ID Text                                                             RADDAT
     D  cStIDTx                      10I 0                                                    RADDAT
      * Conversion Status ID Data                                                             RADDAT
     D  cStIDDt                      10I 0                                                    RADDAT
      * Alert Option                                                                          RADDAT
     D  alrOpt                        9A                                                      RADDAT
      * CCSID of msg and help                                                                 RADDAT
     D  ccsidMH                      10I 0                                                    RADDAT
      * CCSID of replacement data                                                             RADDAT
     D  ccsidRD                      10I 0                                                    RADDAT
      * Length replacement data ret.                                                          RADDAT
     D  lnRplDtR                     10I 0                                                    RADDAT
      * Length replacement data avl.                                                          RADDAT
     D  lnRplDtA                     10I 0                                                    RADDAT
      * Length message ret.                                                                   RADDAT
     D  lnMgR                        10I 0                                                    RADDAT
      * Length message avl.                                                                   RADDAT
     D  lnMgA                        10I 0                                                    RADDAT
      * Length message help ret.                                                              RADDAT
     D  lnMgHR                       10I 0                                                    RADDAT
      * Length message help avl.                                                              RADDAT
     D  lnMgHA                       10I 0                                                    RADDAT
      * Value of varying length!                                                              RADDAT
     D  value                      4096A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDRCVM0300  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDRCVM0300"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QMHRCVM  API - RCVM0300                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(rcvm0300_t)                                                             RADDAT
      /DEFINE rcvm0300_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QMHRCVM API - RCVM0300                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D rcvm0300_t      DS                  qualified           based(pDummy)                  RADDAT
      * Bytes returned                                                                        RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
      * Bytes available                                                                       RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
      * Message Severity                                                                      RADDAT
     D  msgSev                 9     12I 0                                                    RADDAT
      * Message ID                                                                            RADDAT
     D  msgID                 13     19A                                                      RADDAT
      * Message Type                                                                          RADDAT
     D  msgType               20     21A                                                      RADDAT
      * Message Key                                                                           RADDAT
     D  msgKey                22     25A                                                      RADDAT
      * Message File                                                                          RADDAT
     D  msgF                  26     35A                                                      RADDAT
      * Message Library Specified                                                             RADDAT
     D  msgLS                 36     45A                                                      RADDAT
      * Message Library Used                                                                  RADDAT
     D  msgLU                 46     55A                                                      RADDAT
      * Alert option                                                                          RADDAT
     D  alertOpt              56     64A
      * CCSID conversion status indicator of message and message help
     D  ccsidConvStatMsg...
     D                        65     68I 0
      * CCSID conversion status indicator of message data or text
     D  ccsidConvStatMsgData...
     D                        69     72I 0
      * CCSID of replacement data or impromptu message text
     D  ccsidRplData...
     D                        73     76I 0
      * CCSID of replacement data and message help
     D  ccsidMsgHlp...
     D                        77     80I 0
      * Length of replacement data or impromptu message text returned
     D  lenRplDataR...
     D                        81     84I 0
      * Length of replacement data or impromptu message text available
     D  lenRplDataA...
     D                        85     88I 0
      * Length of message returned
     D  lenMsgR...
     D                        89     92I 0
      * Length of message available
     D  lenMsgA...
     D                        93     96I 0
      * Length of message help returned
     D  lenMsgHlpR...
     D                        97    100I 0
      * Length of message help available
     D  lenMsgHlpA...
     D                       101    104I 0
      * Length of sender information returned
     D  lenSndInfR...
     D                       105    108I 0
      * Length of sender information available
     D  lenSndInfA...
     D                       109    112I 0
      *
      * The offsets to       CHAR(*)      Replacement data or impromptu message text
      * these fields         CHAR(*)      Message
      * equal the offset     CHAR(*)      Message help
      * to the last          CHAR(*)      Sender information
      * fixed-length                                                                          RADDAT
      * field plus the                                                                        RADDAT
      * length of the                                                                         RADDAT
      * previous variable                                                                     RADDAT
      * length fields.                                                                        RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      /IF NOT DEFINED(sndInf_t)
      /DEFINE sndInf_t
      *===============================================================*                       RADDAT
      *  QMHRCVM API - Sender Information Format                      *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D sndInf_t        DS                  based(pDummy) qualified
      * Sending job                                                                           RADDAT
     D  job...
     D                         1     10A
      * Sending user profile                                                                  RADDAT
     D  user...
     D                        11     20A
      * Sending job's number                                                                  RADDAT
     D  jobNbr...
     D                        21     26A
      * Date sent                                                                             RADDAT
     D  date...
     D                        27     33A
      * Time sent                                                                             RADDAT
     D  time...
     D                        34     39A
      * Sending type                                                                          RADDAT
     D  sndType...
     D                        40     40A
      * Receiving type                                                                        RADDAT
     D  rcvType...
     D                        41     41A
      * Sending program name                                                                  RADDAT
     D  sndPgm...
     D                        42     53A
      * Sending module name                                                                   RADDAT
     D  sndModule...
     D                        54     63A
      * Sending procedure name                                                                RADDAT
     D  sndProc...
     D                        64    319A
      * Reserved                                                                              RADDAT
     D  reserved_01...
     D                       320    320A
      * Number of statement numbers or instruction numbers                                    RADDAT
      * available for the sending program or procedure
     D  sndPgmNumStmtNbrs...
     D                       321    324A
      * Sending program's statement numbers or
      * instruction numbers
     D  sndPgmStmtNbrs...
     D                       325    354A
     D   sndPgmStmtNbr...                                                                     RADDAT
     D                               10A   dim(3) overlay(sndPgmStmtNbrs)                     RADDAT
      * Receiving program name                                                                RADDAT
     D  rcvPgm...
     D                       355    364A
      * Receiving module name                                                                 RADDAT
     D  rcvModule...
     D                       365    374A
      * Receiving procedure name                                                              RADDAT
     D  rcvProc...
     D                       375    630A
      * Reserved                                                                              RADDAT
     D  reserved_02...
     D                       631    640A
      * Number of statement numbers or instruction numbers                                    RADDAT
      * available for the receiving program or procedure.
     D  rcvPgmNumStmtNbrs...
     D                       641    644I 0
      * Receiving program's statement number or                                               RADDAT
      * instruction number                                                                    RADDAT
     D  rcvPgmStmtNbrs...
     D                       645    674A
     D   rcvPgmStmtNbr...                                                                     RADDAT
     D                               10A   dim(3) overlay(rcvPgmStmtNbrs)                     RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_03...
     D                       675    676A
      * Displacement to long sending program name                                             RADDAT
     D  ofsSndPgmLName...
     D                       677    680I 0
      * Length of long sending program name
     D  lenSndPgmLName...
     D                       681    684I 0
      * Displacement to long sending procedure name
     D  ofsSndPrcLName...
     D                       685    688I 0
      * Length of long sending procedure name
     D  lenSndPrcLName...
     D                       689    692I 0
      * Displacement to long receiving procedure name
     D  ofsRcvPrcLName...
     D                       693    696I 0
      * Length of long receiving procedure name
     D  lenRcvPrcLName...
     D                       697    700I 0
      *                                                                                       RADDAT
      * The                  CHAR(*)      Reserved
      * offsets              CHAR(*)      Long sending program name
      * to these             CHAR(*)      Long sending procedure name                         RADDAT
      * fields               CHAR(*)      Long receiving procedure name                       RADDAT
      * are found                                                                             RADDAT
      * in the                                                                                RADDAT
      * displacemet                                                                           RADDAT
      * fields                                                                                RADDAT
      * identified                                                                            RADDAT
      * in this                                                                               RADDAT
      * table.                                                                                RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDRTVM0100  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDRTVM0100"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QMHRTVM  API - RTVM0100                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(rtvm0100_t)                                                             RADDAT
      /DEFINE rtvm0100_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QMHRTVM API - RTVM0100                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D rtvm0100_t      DS                  qualified           based(pDummy)                  RADDAT
      *  Bytes returned                                                                       RADDAT
     D  BYTRET                        9B 0                                                    RADDAT
      *  Bytes available                                                                      RADDAT
     D  BYTAVL                        9B 0                                                    RADDAT
      *  Length of message returned                                                           RADDAT
     D  LENMSGRET                     9B 0                                                    RADDAT
      *  Length of message available                                                          RADDAT
     D  LENMSGAVL                     9B 0                                                    RADDAT
      *  Length of msg help returned                                                          RADDAT
     D  LENHLPRET                     9B 0                                                    RADDAT
      *  Length of msg help available                                                         RADDAT
     D  LENHLPAVL                     9B 0                                                    RADDAT
      *  Msg text and data of varying length!                                                 RADDAT
     D  DATA                       2048A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDRTVM0300  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDRTVM0300"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QMHRTVM  API - RTVM0300                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(rtvm0300_t)                                                             RADDAT
      /DEFINE rtvm0300_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QMHRTVM API - RTVM0300                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D rtvm0300_t      DS                  qualified           based(pDummy)                  RADDAT
      *  Bytes returned                                                                       RADDAT
     D  bytRet                       10I 0                                                    RADDAT
      *  Bytes available                                                                      RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
      *  Message severity                                                                     RADDAT
     D  msgSev                       10I 0                                                    RADDAT
      *  Alert index                                                                          RADDAT
     D  altIdx                       10I 0                                                    RADDAT
      * Alert Option                                                                          RADDAT
     D  altOpt                        9A                                                      RADDAT
      * Log indicator                                                                         RADDAT
     D  logInd                        1A                                                      RADDAT
      * Message ID                                                                            RADDAT
     D  msgID                         7A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_01                   3A                                                      RADDAT
      * Nbr. of subst. var. formats                                                           RADDAT
     D  numVarFmt                    10I 0                                                    RADDAT
      * CCSID conv. stat. ind. text                                                           RADDAT
     D  csIndTxt                     10I 0                                                    RADDAT
      * CCSID conv. stat. ind. data                                                           RADDAT
     D  csIndDta                     10I 0                                                    RADDAT
      * CCSID of Text returned                                                                RADDAT
     D  ccsidTxt                     10I 0                                                    RADDAT
      * Offset of default reply                                                               RADDAT
     D  ofsDftR                      10I 0                                                    RADDAT
      * Length of default reply ret.                                                          RADDAT
     D  lenDftRpyR                   10I 0                                                    RADDAT
      * Length of default reply avl.                                                          RADDAT
     D  lenDftRpyA                   10I 0                                                    RADDAT
      * Offset of message                                                                     RADDAT
     D  ofsMsg                       10I 0                                                    RADDAT
      * Length of message returned                                                            RADDAT
     D  lenMsgR                      10I 0                                                    RADDAT
      * Length of message available                                                           RADDAT
     D  lenMsgA                      10I 0                                                    RADDAT
      * Offset of message                                                                     RADDAT
     D  ofsMsgHlp                    10I 0                                                    RADDAT
      * Length of message help ret.                                                           RADDAT
     D  lenMsgHlpR                   10I 0                                                    RADDAT
      * Length of message help avl.                                                           RADDAT
     D  lenMsgHlpA                   10I 0                                                    RADDAT
      * Ofs. of subst. var. formats                                                           RADDAT
     D  ofsVarFmt                    10I 0                                                    RADDAT
      * Length subst. var. fmt. ret.                                                          RADDAT
     D  lenVarFmtR                   10I 0                                                    RADDAT
      * Length subst. var. fmt. avl.                                                          RADDAT
     D  lenVarFmtA                   10I 0                                                    RADDAT
      * Length subst. var. element                                                            RADDAT
     D  lenVarFmtE                   10I 0                                                    RADDAT
      * Data                                                                                  RADDAT
     D  data                       4096A                                                      RADDAT
      *                       CHAR(*)  Default reply                                          RADDAT
      *                       CHAR(*)  Message                                                RADDAT
      *                       CHAR(*)  Message help                                           RADDAT
      *                       CHAR(*)  Substitution variable formats                          RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDRTVM0400  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDRTVM0400"
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : QMHRTVM  API - RTVM0400                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(rtvm0400_t)                                                             RADDAT
      /DEFINE rtvm0400_t                                                                      RADDAT
      *===============================================================*                       RADDAT
      *  QMHRTVM API - RTVM0400                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D rtvm0400_t      DS                  qualified           based(pDummy)                  RADDAT
      *  Bytes returned                                                                       RADDAT
     D  bytRet                       10I 0                                                    RADDAT
      *  Bytes available                                                                      RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
      *  Message severity                                                                     RADDAT
     D  msgSev                       10I 0                                                    RADDAT
      *  Alert index                                                                          RADDAT
     D  altIdx                       10I 0                                                    RADDAT
      * Alert Option                                                                          RADDAT
     D  altOpt                        9A                                                      RADDAT
      * Log indicator                                                                         RADDAT
     D  logInd                        1A                                                      RADDAT
      * Message ID                                                                            RADDAT
     D  msgID                         7A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_01                   3A                                                      RADDAT
      * Nbr. of subst. var. formats                                                           RADDAT
     D  numVarFmt                    10I 0                                                    RADDAT
      * CCSID conv. stat. ind. text                                                           RADDAT
     D  csIndTxt                     10I 0                                                    RADDAT
      * CCSID conv. stat. ind. data                                                           RADDAT
     D  csIndDta                     10I 0                                                    RADDAT
      * CCSID of Text returned                                                                RADDAT
     D  ccsidTxt                     10I 0                                                    RADDAT
      * Offset of default reply                                                               RADDAT
     D  ofsDftR                      10I 0                                                    RADDAT
      * Length of default reply ret.                                                          RADDAT
     D  lenDftRpyR                   10I 0                                                    RADDAT
      * Length of default reply avl.                                                          RADDAT
     D  lenDftRpyA                   10I 0                                                    RADDAT
      * Offset of message                                                                     RADDAT
     D  ofsMsg                       10I 0                                                    RADDAT
      * Length of message returned                                                            RADDAT
     D  lenMsgR                      10I 0                                                    RADDAT
      * Length of message available                                                           RADDAT
     D  lenMsgA                      10I 0                                                    RADDAT
      * Offset of message                                                                     RADDAT
     D  ofsMsgHlp                    10I 0                                                    RADDAT
      * Length of message help ret.                                                           RADDAT
     D  lenMsgHlpR                   10I 0                                                    RADDAT
      * Length of message help avl.                                                           RADDAT
     D  lenMsgHlpA                   10I 0                                                    RADDAT
      * Ofs. of subst. var. formats                                                           RADDAT
     D  ofsVarFmt                    10I 0                                                    RADDAT
      * Length subst. var. fmt. ret.                                                          RADDAT
     D  lenVarFmtR                   10I 0                                                    RADDAT
      * Length subst. var. fmt. avl.                                                          RADDAT
     D  lenVarFmtA                   10I 0                                                    RADDAT
      * Length subst. var. element                                                            RADDAT
     D  lenVarFmtE                   10I 0                                                    RADDAT
      * Reply type                                                                            RADDAT
     D  rpyType                      10A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_02                   2A                                                      RADDAT
      * Maximum reply length                                                                  RADDAT
     D  maxRpyLen                    10I 0                                                    RADDAT
      * Maximum reply decimal positions                                                       RADDAT
     D  maxRpyDecPos                 10I 0                                                    RADDAT
      * Offset of valid reply value entries                                                   RADDAT
     D  ofsRpyE                      10I 0                                                    RADDAT
      * Number of valid reply values entries returned                                         RADDAT
     D  numRpyER                     10I 0                                                    RADDAT
      * Length of valid reply value entries returned                                          RADDAT
     D  lenRpyER                     10I 0                                                    RADDAT
      * Length of valid reply value entries available                                         RADDAT
     D  lenRpyEA                     10I 0                                                    RADDAT
      * Length of valid reply value entry                                                     RADDAT
     D  lenRpyE                      10I 0                                                    RADDAT
      * Offset of special reply value entries                                                 RADDAT
     D  ofsSpcRpyE                   10I 0                                                    RADDAT
      * Number of special reply values returned                                               RADDAT
     D  numSpcRpyER                  10I 0                                                    RADDAT
      * Length of special reply value entries returned                                        RADDAT
     D  lenSpcRpyER                  10I 0                                                    RADDAT
      * Length of special reply value entries available                                       RADDAT
     D  lenSpcRpyEA                  10I 0                                                    RADDAT
      * Length of special reply value entry                                                   RADDAT
     D  lenSpcRpyE                   10I 0                                                    RADDAT
      * Offset of lower range reply value                                                     RADDAT
     D  ofsLowRpyE                   10I 0                                                    RADDAT
      * Length of lower range reply value returned                                            RADDAT
     D  lenLowRpyER                  10I 0                                                    RADDAT
      * Length of lower range reply value available                                           RADDAT
     D  lenLowRpyEA                  10I 0                                                    RADDAT
      * Offset of upper range reply value                                                     RADDAT
     D  ofsUpRpyE                    10I 0                                                    RADDAT
      * Length of upper range reply value returned                                            RADDAT
     D  ofsUpRpyER                   10I 0                                                    RADDAT
      * Length of upper range reply value available                                           RADDAT
     D  ofsUpRpyEA                   10I 0                                                    RADDAT
      * Offset of relational test entry                                                       RADDAT
     D  ofsRelTestE                  10I 0                                                    RADDAT
      * Length of relational test entry returned                                              RADDAT
     D  lenRelTestER                 10I 0                                                    RADDAT
      * Length of relational test entry available                                             RADDAT
     D  lenRelTestEA                 10I 0                                                    RADDAT
      * Message creation date                                                                 RADDAT
     D  crtDate                       7A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_03                   1A                                                      RADDAT
      * Message creation level number                                                         RADDAT
     D  crtLvlNbr                    10I 0                                                    RADDAT
      * Message modification date                                                             RADDAT
     D  modDate                       7A                                                      RADDAT
      * Reserved                                                                              RADDAT
     D  reserved_04                   1A                                                      RADDAT
      * Message modification level number                                                     RADDAT
     D  modLvlNbr                    10I 0                                                    RADDAT
      * Stored CCSID of message                                                               RADDAT
     D  storedCCSID                  10I 0                                                    RADDAT
      * Offset of dump list entries                                                           RADDAT
     D  ofsDmpListE                  10I 0                                                    RADDAT
      * Number of dump list entries returned                                                  RADDAT
     D  numDmpListER                 10I 0                                                    RADDAT
      * Length of dump list entries returned                                                  RADDAT
     D  lenDmpListER                 10I 0                                                    RADDAT
      * Length of dump list entries available                                                 RADDAT
     D  lenDmpListEA                 10I 0                                                    RADDAT
      * Default program name                                                                  RADDAT
     D  dftPgmName                   10A                                                      RADDAT
      * Default program library name                                                          RADDAT
     D  dftPgmLib                    10A                                                      RADDAT
      * Data                                                                                  RADDAT
     D  data                       4096A                                                      RADDAT
      *                       CHAR(*)  Default reply                                          RADDAT
      *                       CHAR(*)  Message                                                RADDAT
      *                       CHAR(*)  Message help                                           RADDAT
      *                       CHAR(*)  Substitution variable formats                          RADDAT
      *                       CHAR(*)  Valid reply value entries                              RADDAT
      *                       CHAR(*)  Special reply value entries                            RADDAT
      *                       CHAR(*)  Lower range reply value                                RADDAT
      *                       CHAR(*)  Upper range reply value                                RADDAT
      *                       CHAR(*)  Relational test entry                                  RADDAT
      *                       CHAR(*)  Dump list entries                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing FDURL  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "FDURL     "
mbrtype =  "RPGLE     "
mbrtext =  "cpybk   : URL                                     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(url_t)                                                                  RADDAT
      /DEFINE url_t                                                                           RADDAT
      *                                                                                       RADDAT
      *  URL                                                                                  RADDAT
     D url_t           S            446A   varying                                            RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing H_SPEC  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "H_SPEC    "
mbrtype =  "RPGLE     "
mbrtext =  "H-Specifications                                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
     H DEBUG
     H OPTION(*SRCSTMT : *NODEBUGIO)
      /IF NOT DEFINED(NO_DECEDIT)
     H DECEDIT('0,')
      /ENDIF
     H DATEDIT(*DMY.)
     H DATFMT(*ISO ) TIMFMT(*ISO )
     H EXPROPTS(*RESDECPOS)
     H EXTBININT(*YES)
     H CCSID(*CHAR: *JOBRUN)                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing HEAPAPI  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "HEAPAPI   "
mbrtype =  "RPGLE     "
mbrtext =  "Storage Management APIs                           "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
 DEF  /IF NOT DEFINED(HEAPAPI)                                                                RADDAT
 DEF  /DEFINE HEAPAPI
      *                                                                                       RADDAT
      *  Get Heap Storage (CEEGTST) API
     D CEEGTST...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEEGTST')
     D  i_heap_id                    10I 0 const
     D  i_size                       10I 0 const                                              RADDAT
     D  o_address                      *
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
      *  Reallocate Storage (CEECZST) API
     D CEECZST...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEECZST')
     D  io_address                     *
     D  i_new_size                   10I 0 const                                              RADDAT
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
      *  Free Storage (CEEFRST) API
     D CEEFRST...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEEFRST')
     D  i_address                      *   const
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
      *  Allocation Strategy Type (CEE4ALC)
     D CEE4ALC         DS
     D   MaxSglAloc                  10I 0
     D   MinBdy                      10I 0
     D   CrtSiz                      10I 0
     D   ExtSiz                      10I 0
     D   res1                         5I 0
     D   AllocBits                    3U 0
     D   InitValue                    3U 0
     D   res2                         5A
      *
      *  Use BITON to set on the appropriate bit.
      *  For example:   BITON     AllocInit     AllocBits
     D ALC_ABITS_AllocStrat...
     D                 C                    x'80'
     D ALC_BITS_NoMark...
     D                 C                    x'40'
     D ALC_ABITS_BlkXfer...
     D                 C                    x'20'
     D ALC_ABITS_PAG...
     D                 C                    x'10'
     D ALC_ABITS_AllocInit...
     D                 C                    x'08'
      *                                                                                       RADDAT
      *  Create Heap (CEECRHP) API
     D CEECRHP...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEECRHP')
     D  o_heap_id                    10I 0
     D  i_initial_size...
     D                               10I 0 const  options(*omit)
     D  i_increment                  10I 0 const  options(*omit)
     D  i_alloc_start_id...
     D                               10I 0 const  options(*omit)
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
      *  Mark Heap (CEEMKHP) API
     D CEEMKHP...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEEMKHP')
     D  i_heap_id                    10I 0 const
     D  o_mark                         *
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
      *  Release Heap (CEERLHP) API
     D CEERLHP...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEERLHP')
     D  i_mark                         *   const
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
      *  Discard Heap (CEEDSHP) API
     D CEEDSHP...
     D                 PR                                                                     RADDAT
     D                                            extproc('CEEDSHP')
     D  i_heap_id                    10I 0 const
     D  o_fc                         12A          options(*omit)
      *                                                                                       RADDAT
 DEF  /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing MEMMGR  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "MEMMGR    "
mbrtype =  "RPGLE     "
mbrtext =  "BasicList - Memory Manager Prototypes             "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *                                                                                       RADDAT
     D mm_memMgr       DS                  likeds(MemoryManager...                            RADDAT
     D                                            _manager_t)                                 RADDAT
      *                                                                                       RADDAT
     D mm_allocate...                                                                         RADDAT
     D                 PR              *   extproc(mm_memMgr.pAllocate)                       RADDAT
     D  i_size                       10U 0 value                                              RADDAT
     D  i_heap                       10I 0 value  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
     D mm_reallocate...                                                                       RADDAT
     D                 PR              *   extproc(mm_memMgr.pReallocate)                     RADDAT
     D  i_pMem                         *   value                                              RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
     D mm_free...                                                                             RADDAT
     D                 PR                  extproc(mm_memMgr.pFree)                           RADDAT
     D  io_pMem                        *                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing MILIB  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "MILIB     "
mbrtype =  "RPGLE     "
mbrtext =  "Prototypes for MI-Library                (include)"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
 DEF  /IF NOT DEFINED(MILIB)                                                                  RADDAT
 DEF  /DEFINE MILIB                                                                           RADDAT
      *                                                                                       RADDAT
      *  QSYSINC/MIH.MICOMMON: Requested Authority bitmasks and typedef                       RADDAT
      *                        The bitmasks are or'd together to give                         RADDAT
      *                        desired combinations                                           RADDAT
     D AUTH_OBJ_CTRL   C                   const(x'8000')                                     RADDAT
     D AUTH_OBJ_MGMT   C                   const(x'4000')                                     RADDAT
     D AUTH_POINTER    C                   const(x'2000')                                     RADDAT
     D AUTH_SPACE      C                   const(x'1000')                                     RADDAT
     D AUTH_RETRIEVE   C                   const(x'0800')                                     RADDAT
     D AUTH_INSERT     C                   const(x'0400')                                     RADDAT
     D AUTH_DELETE     C                   const(x'0200')                                     RADDAT
     D AUTH_UPDATE     C                   const(x'0100')                                     RADDAT
     D AUTH_OWNER      C                   const(x'0080')                                     RADDAT
     D AUTH_EXCLUDED   C                   const(x'0040')                                     RADDAT
     D AUTH_LST_MGMT   C                   const(x'0020')                                     RADDAT
     D AUTH_EXECUTE    C                   const(x'0010')                                     RADDAT
     D AUTH_ALTER      C                   const(x'0008')                                     RADDAT
     D AUTH_REF        C                   const(x'0004')                                     RADDAT
     D AUTH_ALL        C                   const(x'FF1C')                                     RADDAT
     D AUTH_NONE       C                   const(x'0000')                                     RADDAT
      *                                                                                       RADDAT
      *  QSYSINC/MIH.MIOBJTYP:  MI Object Type                                                RADDAT
     D MI_Program      C                   const(x'0201')                                     RADDAT
     D MI_Library      C                   const(x'0401')                                     RADDAT
     D MI_Usrspc       C                   const(x'1934')                                     RADDAT
     D MI_Usrq         C                   const(x'0A02')                                     RADDAT
     D MI_Usridx       C                   const(x'0E0A')                                     RADDAT
     D WLI_ALRTBL      C                   const(x'0E09')                                     RADDAT
     D WLI_AUTL        C                   const(x'1B01')                                     RADDAT
     D WLI_BLKSF       C                   const(x'1E05')                                     RADDAT
     D WLI_BNDDIR      C                   const(x'1937')                                     RADDAT
     D WLI_CFGL        C                   const(x'0E0D')                                     RADDAT
     D WLI_CHTFMT      C                   const(x'190D')                                     RADDAT
     D WLI_CLD         C                   const(x'190B')                                     RADDAT
     D WLI_CLS         C                   const(x'1904')                                     RADDAT
     D WLI_CMD         C                   const(x'1905')                                     RADDAT
     D WLI_CNNL        C                   const(x'1701')                                     RADDAT
     D WLI_COSD        C                   const(x'1401')                                     RADDAT
     D WLI_CRG         C                   const(x'192C')                                     RADDAT
     D WLI_CRQD        C                   const(x'0E0F')                                     RADDAT
     D WLI_CSI         C                   const(x'1935')                                     RADDAT
     D WLI_CSPMAP      C                   const(x'1922')                                     RADDAT
     D WLI_CSPTBL      C                   const(x'1923')                                     RADDAT
     D WLI_CTLD        C                   const(x'1201')                                     RADDAT
     D WLI_DDIR        C                   const(x'1F02')                                     RADDAT
     D WLI_DEVD        C                   const(x'1001')                                     RADDAT
     D WLI_DIR         C                   const(x'0C01')                                     RADDAT
     D WLI_DOC         C                   const(x'190E')                                     RADDAT
     D WLI_DSTMF       C                   const(x'1F01')                                     RADDAT
     D WLI_DTAARA      C                   const(x'190A')                                     RADDAT
     D WLI_DTADCT      C                   const(x'1920')                                     RADDAT
     D WLI_DTAQ        C                   const(x'0A01')                                     RADDAT
     D WLI_EDTD        C                   const(x'1908')                                     RADDAT
     D WLI_EXITRG      C                   const(x'1913')                                     RADDAT
     D WLI_FCT         C                   const(x'0E04')                                     RADDAT
     D WLI_FILE        C                   const(x'1901')                                     RADDAT
     D WLI_FLR         C                   const(x'1912')                                     RADDAT
     D WLI_FNTRSC      C                   const(x'1926')                                     RADDAT
     D WLI_FNTTBL      C                   const(x'192B')                                     RADDAT
     D WLI_FORMDF      C                   const(x'1928')                                     RADDAT
     D WLI_FTR         C                   const(x'0E0B')                                     RADDAT
     D WLI_GSS         C                   const(x'190C')                                     RADDAT
     D WLI_IGCDCT      C                   const(x'0E06')                                     RADDAT
     D WLI_IGCSRT      C                   const(x'191A')                                     RADDAT
     D WLI_IGCTBL      C                   const(x'1910')                                     RADDAT
     D WLI_IPXD        C                   const(x'191E')                                     RADDAT
     D WLI_JOBD        C                   const(x'1903')                                     RADDAT
     D WLI_JOBQ        C                   const(x'0E01')                                     RADDAT
     D WLI_JOBSCD      C                   const(x'0E0C')                                     RADDAT
     D WLI_JRN         C                   const(x'0901')                                     RADDAT
     D WLI_JRNRCV      C                   const(x'0701')                                     RADDAT
     D WLI_LIB         C                   const(x'0401')                                     RADDAT
     D WLI_LIND        C                   const(x'1101')                                     RADDAT
     D WLI_LOCALE      C                   const(x'1921')                                     RADDAT
     D WLI_MEDDFN      C                   const(x'191C')                                     RADDAT
     D WLI_MENU        C                   const(x'1916')                                     RADDAT
     D WLI_MGTCOL      C                   const(x'192D')                                     RADDAT
     D WLI_MODD        C                   const(x'1501')                                     RADDAT
     D WLI_MODULE      C                   const(x'0301')                                     RADDAT
     D WLI_MSGF        C                   const(x'0E03')                                     RADDAT
     D WLI_MSGQ        C                   const(x'1902')                                     RADDAT
     D WLI_M36         C                   const(x'1E04')                                     RADDAT
     D WLI_M36CFG      C                   const(x'1924')                                     RADDAT
     D WLI_NODL        C                   const(x'0E0E')                                     RADDAT
     D WLI_NTBD        C                   const(x'1914')                                     RADDAT
     D WLI_NWID        C                   const(x'1601')                                     RADDAT
     D WLI_NWSD        C                   const(x'1D01')                                     RADDAT
     D WLI_NODGRP      C                   const(x'192A')                                     RADDAT
     D WLI_OOPOOL      C                   const(x'2002')                                     RADDAT
     D WLI_OUTQ        C                   const(x'0E02')                                     RADDAT
     D WLI_OVL         C                   const(x'1929')                                     RADDAT
     D WLI_PAGDFN      C                   const(x'1936')                                     RADDAT
     D WLI_PAGSEG      C                   const(x'1927')                                     RADDAT
     D WLI_PDG         C                   const(x'1930')                                     RADDAT
     D WLI_PGM         C                   const(x'0201')                                     RADDAT
     D WLI_PNLGRP      C                   const(x'1915')                                     RADDAT
     D WLI_PRDAVL      C                   const(x'1933')                                     RADDAT
     D WLI_PRDDFN      C                   const(x'191B')                                     RADDAT
     D WLI_PRDLOD      C                   const(x'191D')                                     RADDAT
     D WLI_PSFCFG      C                   const(x'1925')                                     RADDAT
     D WLI_QMFORM      C                   const(x'1932')                                     RADDAT
     D WLI_QMQRY       C                   const(x'1931')                                     RADDAT
     D WLI_QRYDFN      C                   const(x'1911')                                     RADDAT
     D WLI_RCT         C                   const(x'0E08')                                     RADDAT
     D WLI_S36         C                   const(x'1919')                                     RADDAT
     D WLI_SBSD        C                   const(x'1909')                                     RADDAT
     D WLI_SCHIDX      C                   const(x'0E07')                                     RADDAT
     D WLI_SOCKET      C                   const(x'1E03')                                     RADDAT
     D WLI_SOMOBJ      C                   const(x'2001')                                     RADDAT
     D WLI_SPADCT      C                   const(x'1C01')                                     RADDAT
     D WLI_SQLPKG      C                   const(x'0202')                                     RADDAT
     D WLI_SQLUDT      C                   const(x'191F')                                     RADDAT
     D WLI_SRVPGM      C                   const(x'0203')                                     RADDAT
     D WLI_SSND        C                   const(x'0E05')                                     RADDAT
     D WLI_STMF        C                   const(x'1E01')                                     RADDAT
     D WLI_SVRSTG      C                   const(x'1917')                                     RADDAT
     D WLI_SYMLNK      C                   const(x'1E02')                                     RADDAT
     D WLI_TBL         C                   const(x'1906')                                     RADDAT
     D WLI_USRPRF      C                   const(x'0801')                                     RADDAT
     D WLI_USRIDX      C                   const(x'0E0A')                                     RADDAT
     D WLI_USRQ        C                   const(x'0A02')                                     RADDAT
     D WLI_USRSPC      C                   const(x'1934')                                     RADDAT
     D WLI_VLDL        C                   const(x'0E10')                                     RADDAT
     D WLI_WSCST       C                   const(x'1938')                                     RADDAT
      *                                                                                       RADDAT
      *  Activate Bound Program, Returned value: Activation mark                              RADDAT
     D QleActBndPgm    PR            10I 0 extproc('QleActBndPgm')                            RADDAT
     D  i_pgmPtr                       *   const   procptr                                    RADDAT
     D  i_actMark                    10I 0 const   options(*omit)                             RADDAT
     D  i_actInf                  32767A   const   options(*omit: *varsize)                   RADDAT
     D  i_actInfLen                  10I 0 const   options(*omit)                             RADDAT
     D  io_errCode                32767A           options(*omit: *varsize)                   RADDAT
      *                                                                                       RADDAT
      *  Type definitions                                                                     RADDAT
     D actInf_t        DS                  qualified      based(pDummy)                       RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  reserved_1             9     16A                                                      RADDAT
     D  actGrpMark            17     20I 0                                                    RADDAT
     D  actMark               21     24I 0                                                    RADDAT
     D  reserved_2            25     31A                                                      RADDAT
     D  flags                 32     32A                                                      RADDAT
     D  reserved_3            33     48A                                                      RADDAT
      *                                                                                       RADDAT
      *  Get Export, Returned value: Exported item - PTR(OPN)                                 RADDAT
     D QleGetExp       PR              *   extproc('QleGetExp')                               RADDAT
     D  i_actMark                    10I 0 const   options(*omit)                             RADDAT
     D  i_expNum                     10I 0 const   options(*omit)                             RADDAT
     D  i_expNameLen                 10I 0 const   options(*omit)                             RADDAT
     D  i_expName                 32767A   const   options(*omit: *varsize)                   RADDAT
     D  o_pExpItem                     *           options(*omit) procptr                     RADDAT
     D  o_expItmType                 10I 0         options(*omit)                             RADDAT
     D  io_errCode                32767A           options(*omit: *varsize)                   RADDAT
      /IF NOT DEFINED(TESTPTR)                                                                RADDAT
      /DEFINE TESTPTR                                                                         RADDAT
      *                                                                                       RADDAT
      *  Test Pointer (TESTPTR)                                                               RADDAT
     D testptr         PR            10I 0 extproc('_TESTPTR')                                RADDAT
     D  i_ptr                          *   value                                              RADDAT
     D  i_test_type                  10I 0 value                                              RADDAT
      *                                                                                       RADDAT
     D cTESTPTR_TYPE_PROCPTR...                                                               RADDAT
     D                 C                   0                                                  RADDAT
     D cTESTPTR_NO_OPTIMIZED_PARAMETER_PASSING...                                             RADDAT
     D                 C                   0                                                  RADDAT
     D cTESTPTR_OPTIMIZED_PARAMETER_PASSING...                                                RADDAT
     D                 C                   1                                                  RADDAT
      *                                                                                       RADDAT
     D cTESTPTR_TYPE_MEMPTR...                                                                RADDAT
     D                 C                   1                                                  RADDAT
     D cTESTPTR_NON_TERASPACE...                                                              RADDAT
     D                 C                   0                                                  RADDAT
     D cTESTPTR_TERASPACE...                                                                  RADDAT
     D                 C                   1                                                  RADDAT
      *                                                                                       RADDAT
     D cTESTPTR_ERROR_NOT_EXIST...                                                            RADDAT
     D                 C                   x'2401'                                            RADDAT
     D cTESTPTR_ERROR_INVALID...                                                              RADDAT
     D                 C                   x'2402'                                            RADDAT
     D cTESTPTR_ERROR_OBJECT_DESTROYED...                                                     RADDAT
     D                 C                   x'2202'                                            RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      *  Materialize Pointer (MATPTR)                                                         RADDAT
     D matptr          PR            10I 0 extproc('matptr')                                  RADDAT
     D  i_MPTR_Template_T...                                                                  RADDAT
     D                                 *   value                                              RADDAT
     D  i_anyPtr                       *   value                                              RADDAT
      *                                                                                       RADDAT
     D matptr_TPL_t    DS                  qualified               based(pDummy)              RADDAT
     D  bytPrv                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  type                   9      9A                                                      RADDAT
      *                                                                                       RADDAT
     D matptr_spacePtr_TPL_t...                                                               RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  baseInf                            likeds(matptr_TPL_t )                              RADDAT
     D  ContextID             10     41A                                                      RADDAT
     D   ContextType          10     10A                                                      RADDAT
     D   ContextSubType...                                                                    RADDAT
     D                        11     11A                                                      RADDAT
     D   ContextName          12     41A                                                      RADDAT
     D  ObjectID              42     73A                                                      RADDAT
     D   ObjectType           42     42A                                                      RADDAT
     D   ObjectSubType...                                                                     RADDAT
     D                        43     43A                                                      RADDAT
     D   ObjectName           44     73A                                                      RADDAT
     D  offSpace              74     77I 0                                                    RADDAT
     D  PtrTragetInf          78     79A                                                      RADDAT
     D  reserved_1            80     80A                                                      RADDAT
     D  extOffSpace           81     88I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Resolve System Pointer (RSLVSP)                                                      RADDAT
     D rslvsp...                                                                              RADDAT
     D                 PR              *   extproc('rslvsp') procptr                          RADDAT
     D  i_objtype                     5U 0 value                                              RADDAT
     D  i_obj                          *   value   options(*string)                           RADDAT
     D  i_lib                          *   value   options(*string)                           RADDAT
     D  i_auth                        5U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Convert Type (QLICVTTP) API                                                          RADDAT
     D QLICVTTP...                                                                            RADDAT
     D                 PR                  extpgm('QLICVTTP')                                 RADDAT
     D  i_conversion                 10A   const                                              RADDAT
     D  io_symObjType                10A                                                      RADDAT
     D  io_hexObjType                 5U 0                                                    RADDAT
     D  io_errCode                32767A          options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  AND String (ANDSTR)                                                                  RADDAT
     D ANDSTR...                                                                              RADDAT
     D                 PR                  extproc('_ANDSTR')                                 RADDAT
     D  i_pReceiver                    *   value                                              RADDAT
     D  i_pFirstSrc                    *   value                                              RADDAT
     D  i_pSecondSrc                   *   value                                              RADDAT
     D  i_length                     10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  OR String (ORSTR)                                                                    RADDAT
     D ORSTR...                                                                               RADDAT
     D                 PR                  extproc('_ORSTR')                                  RADDAT
     D  i_pReceiver                    *   value                                              RADDAT
     D  i_pFirstSrc                    *   value                                              RADDAT
     D  i_pSecondSrc                   *   value                                              RADDAT
     D  i_length                     10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  XOR (Exclusive Or) String (XORSTR)                                                   RADDAT
     D XORSTR...                                                                              RADDAT
     D                 PR                  extproc('_XORSTR')                                 RADDAT
     D  i_pReceiver                    *   value                                              RADDAT
     D  i_pFirstSrc                    *   value                                              RADDAT
     D  i_pSecondSrc                   *   value                                              RADDAT
     D  i_length                     10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Complement String (COMSTR)                                                           RADDAT
     D COMSTR...                                                                              RADDAT
     D                 PR                  extproc('_COMSTR')                                 RADDAT
     D  i_pReceiver                    *   value                                              RADDAT
     D  i_pSource                      *   value                                              RADDAT
     D  i_length                     10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  The standard definition for time in the MI library (QSYSINC/MIH.MICOMMON):           RADDAT
     D mi_time_t       S              8A   inz                                                RADDAT
      *                                                                                       RADDAT
      *  The following values can be OR'd for the Wait Options parameter                      RADDAT
      *  on the WAITTIME invocation.                                                          RADDAT
     D cWAIT_NORMAL...                                                                        RADDAT
     D                 C                   0                                    x'0000'       RADDAT
     D cWAIT_MOD_AS_ENTER...                                                                  RADDAT
     D                 C                   32768                                x'8000'       RADDAT
     D cWAIT_MOD_AS_LEAVE...                                                                  RADDAT
     D                 C                   16384                                x'4000'       RADDAT
     D cWAIT_MPL_SET...                                                                       RADDAT
     D                 C                   8192                                 x'2000'       RADDAT
     D cWAIT_SIGNALS...                                                                       RADDAT
     D                 C                   4096                                 x'1000'       RADDAT
      *                                                                                       RADDAT
      *  Wait On Time (WAITTIME)                                                              RADDAT
     D waitTime        PR                  extproc('waittime')                                RADDAT
     D  pmi_time                           const  like(mi_time_t)                             RADDAT
     D  option                        5I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Use mitime function to form an AS/400 system value for time                          RADDAT
     D mitime          PR              *   extproc('mitime')                                  RADDAT
     D  mi_time                            const  like(mi_time_t)                             RADDAT
     D  hour                         10I 0 value                                              RADDAT
     D  min                          10I 0 value                                              RADDAT
     D  sec                          10I 0 value                                              RADDAT
     D  hsec                         10I 0 value                                              RADDAT
      *                                                                                       RADDAT
 DEF  /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1  "
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Include             cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(D_BASIC)                                                                RADDAT
      /DEFINE D_BASIC                                                                         RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Constants                                                                            RADDAT
      * -----------------------------------------                                             RADDAT
      /IF NOT DEFINED(cTrue)                                                                  RADDAT
      /DEFINE cTrue                                                                           RADDAT
     D cTrue           C                   const(*on )                                        RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      /IF NOT DEFINED(cFalse)                                                                 RADDAT
      /DEFINE cFalse                                                                          RADDAT
     D cFalse          C                   const(*off)                                        RADDAT
      /ENDIF                                                                                  RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Reference fields                                                                     RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Prototypes                                                                           RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R1                   Messages
 CPY  /COPY QBASICS1,PBASICS1R2                   API Error Handling
 CPY  /COPY QBASICS1,PBASICS1R3                   Strings
 CPY  /COPY QBASICS1,PBASICS1R4                   Assert/This
 CPY  /COPY QBASICS1,PBASICS1R5                   Objects
 CPY  /COPY QBASICS1,PBASICS1R6                   Commands
 CPY  /COPY QBASICS1,PBASICS1R7                   Mathematics
 CPY  /COPY QBASICS1,PBASICS1R8                   Handle/Memory                               RADDAT
 CPY  /COPY QBASICS1,PBASICS1R9                   Display Information                         RADDAT
 CPY  /COPY QBASICS1,PBASICS1RA                   BasicList                                   RADDAT
 CPY  /COPY QBASICS1,PBASICS1RB                   BasicStack
 CPY  /COPY QBASICS1,PBASICS1RC                   BasicMap
 CPY  /COPY QBASICS1,PBASICS1RD                   Url                                         RADDAT
 CPY  /COPY QBASICS1,PBASICS1RE                   Date and Time                               RADDAT
 CPY  /COPY QBASICS1,PBASICS1RF                   System Values                               RADDAT
 CPY  /COPY QBASICS1,PBASICS1RG                   BasicProperties                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RH                   MemoryBufferRdrWtr                          RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1C7  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1C7"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - C-Helpers           cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1C7)                                                              RADDAT
      /DEFINE BASICS1C7                                                                       RADDAT
      *                                                                                       RADDAT
      *  Returns a table of CRC-32's of all single-byte values (made by make_crc_table)       RADDAT
     D get_crc_table...                                                                       RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('get_crc_table')                           RADDAT
      *                                                                                       RADDAT
      *  Returns a table of CRC-32's of all single-byte values (made by make_crc_table)       RADDAT
     D crc32...                                                                               RADDAT
     D                 PR                         like(uLong_t)                               RADDAT
     D                                     extproc('crc32')                                   RADDAT
     D  i_crc                              value  like(uLong_t)                               RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_length                           value  like(uInt_t )                               RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,CLIB                         C-Library                                   RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RA  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RA"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicList           cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RA)                                                              RADDAT
      /DEFINE BASICS1RA                                                                       RADDAT
      *                                                                                       RADDAT
     D BasicList_handle_t...
     D                 S               *                      based(pDummy)
     D BasicList_type_t...
     D                 S             32A                      based(pDummy)                   RADDAT
      *                                                                                       RADDAT
     D cBASICLIST_REMOVE_ALL...
     D                 C                          const(-1)                                   RADDAT
      *                                                                                       RADDAT
     D cBASICLIST_TYPE_UNKNOWN...
     D                 C                          const('*N')
     D cBASICLIST_TYPE_VSTRING...
     D                 C                          const('*VSTRING')
     D cBASICLIST_TYPE_CHARACTER...
     D                 C                          const('*CHAR')
     D cBASICLIST_TYPE_INTEGER...
     D                 C                          const('*INT')                               RADDAT
     D cBASICLIST_TYPE_UINTEGER...
     D                 C                          const('*UINT')                              RADDAT
     D cBASICLIST_TYPE_POINTER...
     D                 C                          const('*POINTER')                           RADDAT
      *                                                                                       RADDAT
      *  Creates a new BasicList.                                                             RADDAT
     D BasicList_new...                                                                       RADDAT
     D                 PR                         like(BasicList_handle_t)                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_new+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  i_extType                          const  like(BasicList_type_t  )
     D                                            options(*nopass: *omit)                     RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)
     D  i_heapID                     10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Clones a given BasicList.                                                            RADDAT
     D BasicList_clone...                                                                     RADDAT
     D                 PR                         like(BasicList_handle_t)                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_clone+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Returns the element from the specified position.                                     RADDAT
     D BasicList_get...                                                                       RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_get+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the string element from the specified position.                              RADDAT
     D BasicList_getString...                                                                 RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getString+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the pointer element from the specified position.                             RADDAT
     D BasicList_getPointer...                                                                RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getPointer+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the type of the list.                                                        RADDAT
     D BasicList_getListType...
     D                 PR                         like(BasicList_type_t  )                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getListType+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Returns the type of the list.                                                        RADDAT
     D BasicList_isListTypeOf...
     D                 PR              N
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_isListTypeOf+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_type                             const  like(BasicList_type_t  )
      *                                                                                       RADDAT
      *  Checks an list entry for a given type.
     D BasicList_isTypeOf...
     D                 PR              N
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_isTypeOf+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const
     D  i_type                             const  like(BasicList_type_t  )
      *                                                                                       RADDAT
      *  Returns the type of the specified list entry.
     D BasicList_getType...
     D                 PR                         like(BasicList_type_t  )
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getType+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const
      *                                                                                       RADDAT
      *  Returns the size of of an element.                                                   RADDAT
     D BasicList_getSize...                                                                   RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getSize+                                RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Adds an element to a given BasicList.
     D BasicList_add...                                                                       RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_add+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_type                             const  like(BasicList_type_t  )
     D                                            options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Adds a NULL value to a given BasicList.                                              RADDAT
     D BasicList_addNull...                                                                   RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_addNull+                                RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Adds a string element to a given BasicList.
     D BasicList_addString...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_addString+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Adds a pointer element to a given BasicList.
     D BasicList_addPointer...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_addPointer+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pointer                      *   const                                              RADDAT
      *                                                                                       RADDAT
      *  Searches the list for a given element.                                               RADDAT
     D BasicList_find...                                                                      RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_find+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Searches the list for a given string.
     D BasicList_findString...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_findString+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Changes the element at the specified position in this list.                          RADDAT
     D BasicList_set...                                                                       RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_set+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_type                             const  like(BasicList_type_t  )                    RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Changes the element at the specified position to NULL.                               RADDAT
     D BasicList_setNull...                                                                   RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_setNull+                                RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Changes the string at the specified position in this list.                           RADDAT
     D BasicList_setString...                                                                 RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_setString+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Changes the pointer at the specified position in this list.                          RADDAT
     D BasicList_setPointer...                                                                RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_setPointer+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pointer                      *   const                                              RADDAT
      *                                                                                       RADDAT
      *  Specifies an auto-sort function for this list.                                       RADDAT
     D BasicList_setAutoSort...                                                               RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_setAutoSort+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Removes the element at the specified position in this list.                          RADDAT
     D BasicList_remove...                                                                    RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_remove+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the number of lements in this list.                                          RADDAT
     D BasicList_getNumE...                                                                   RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getNumE+                                RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Returns the heap ID of a given BasicList.                                            RADDAT
     D BasicList_getHeapID...                                                                 RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getHeapID+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Sorts a list using the specified sort function.                                      RADDAT
     D BasicList_sort...                                                                      RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_sort+                                   RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Returns cTrue if a given list is sorted.
     D BasicList_isSorted...
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_isSorted+
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Removes all entries from a given list.                                               RADDAT
     D BasicList_clear...                                                                     RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_clear+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Returns the total size of memory used by this list.                                  RADDAT
     D BasicList_getTotalSize...                                                              RADDAT
     D                 PR            20I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_getTotalSize+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Deletes a given BasicList.                                                           RADDAT
     D BasicList_delete...                                                                    RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_delete+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  io_pList                                  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Returns a BasicList NULL handle.                                                     RADDAT
     D BasicList_null...                                                                      RADDAT
     D                 PR                         like(BasicList_handle_t)                    RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_null+                                   RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Checks a given BasicList handle for a NULL value.
     D BasicList_isNull...                                                                    RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_isNull+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
      *                                                                                       RADDAT
      *  Checks a given BasicList entry for a NULL value.
     D BasicList_isNullValue...                                                               RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RA+                                RADDAT
     D                                     _BasicList_isNullValue+                            RADDAT
     D                                     ')                                                 RADDAT
     D  i_pList                            const  like(BasicList_handle_t)                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R4
 CPY  /COPY QBASICS1,PBASICS1R8                                                               RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RB  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RB"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicStack          cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RB)                                                              RADDAT
      /DEFINE BASICS1RB                                                                       RADDAT
      *                                                                                       RADDAT
     D BasicStack_handle_t...
     D                 S                   like(BasicList_handle_t)
     D                                     based(pDummy)
      *                                                                                       RADDAT
      *  Creates a new BasicStack.                                                            RADDAT
     D BasicStack_new...                                                                      RADDAT
     D                 PR                         like(BasicStack_handle_t  )                 RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_new+
     D                                     ')                                                 RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10U 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Clones a given BasicStack.   (not yet implemented)                                   RADDAT
     D BasicStack_clone...                                                                    RADDAT
     D                 PR                         like(BasicStack_handle_t  )                 RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_clone+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Gets the last entry from top of the stack without removing it from stack.            RADDAT
     D BasicStack_peek...                                                                     RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_peek+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Removes the element at the top of the stack and returnns that element.
     D BasicStack_pop...
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_pop+
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
     D  i_pEntry                       *   const
     D  i_length                     10I 0 const
      *                                                                                       RADDAT
      *  Pushes an item onto the top of the stack.
     D BasicStack_push...                                                                     RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_push+
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the size of of the element that is on top of this stack.                     RADDAT
     D BasicStack_getSize...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_getSize+
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      *  Returns the number of elements in this stack.                                        RADDAT
     D BasicStack_getNumE...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_getNumE+
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      *  Returns the heap ID of a given BasicList.                                            RADDAT
     D BasicStack_getHeapID...                                                                RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_getHeapID+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Removes all entries from a given stack.                                              RADDAT
     D BasicStack_clear...                                                                    RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_clear+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Deletes a given BasicStack.
     D BasicStack_delete...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_delete+
     D                                     ')                                                 RADDAT
     D  io_pStack                                 like(BasicStack_handle_t  )                 RADDAT
      *                                                                                       RADDAT
      *  Returns a BasicStack NULL handle.
     D BasicStack_null...
     D                 PR                         like(BasicStack_handle_t  )
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_null+
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Checks a given BasicStack handle for a NULL value.
     D BasicStack_isNull...
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RB+                                RADDAT
     D                                     _BasicStack_isNull+
     D                                     ')                                                 RADDAT
     D  i_pStack                           const  like(BasicStack_handle_t  )
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RA                    BasicList
 CPY  /COPY QBASICS1,PBASICS1R4                    Assert/This/Caller
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RC  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RC"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicMap            cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RC)                                                              RADDAT
      /DEFINE BASICS1RC                                                                       RADDAT
      *                                                                                       RADDAT
     D BasicMap_handle_t...
     D                 S                   like(BasicList_handle_t)
     D                                                     based(pDummy)
     D BasicMap_key_t...
     D                 S           4096A   varying         based(pDummy)
      *                                                                                       RADDAT
     D BasicKeySet_handle_t...                                                                RADDAT
     D                 S               *                   based(pDummy)
      *                                                                                       RADDAT
      *  Creates a new BasicMap.
     D BasicMap_new...
     D                 PR                         like(BasicMap_handle_t )
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_new+
     D                                     ')                                                 RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Clones a given BasicMap.                                                             RADDAT
     D BasicMap_clone...                                                                      RADDAT
     D                 PR                         like(BasicMap_handle_t )                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_clone+                                   RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Removes the mapping for this key from this map if it is present.
     D BasicMap_remove...
     D                 PR            10I 0
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_remove+
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Returns true if this map contains a mapping for the specified key.                   RADDAT
     D BasicMap_containsKey...                                                                RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_containsKey+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Returns the value to which this map maps the specified key.
     D BasicMap_get...
     D                 PR              *
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_get+
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)
      *                                                                                       RADDAT
      *  Returns the string value to which this map maps the specified key.                   RADDAT
     D BasicMap_getString...                                                                  RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getString+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Returns the integer value to which this map maps the specified key.                  RADDAT
     D BasicMap_getInteger...                                                                 RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getInteger+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Returns the value addressed by a given index.                                        RADDAT
     D BasicMap_getValueByIndex...                                                            RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getValueByIndex+                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
     D  i_pEntry                       *   const  options(*nopass)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the key addressed by a given index.                                          RADDAT
     D BasicMap_getKeyByIndex...                                                              RADDAT
     D                 PR                         like(BasicMap_key_t )                       RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getKeyByIndex+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Associates the specified value with the specified key in this map.
      *  If the map previously contained a mapping for this key, the old
      *  value is replaced by the specified value.
     D BasicMap_put...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_put+
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
     D  i_pEntry                       *   const  options(*string)                            RADDAT
     D  i_length                     10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Associates the specified value with the specified key in this map.                   RADDAT
      *  If the map previously contained a mapping for this key, the old                      RADDAT
      *  value is replaced by the specified value.                                            RADDAT
     D BasicMap_putString...                                                                  RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_putString+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Associates the specified value with the specified key in this map.                   RADDAT
      *  If the map previously contained a mapping for this key, the old                      RADDAT
      *  value is replaced by the specified value.                                            RADDAT
     D BasicMap_putInteger...                                                                 RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_putInteger+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_integer                    10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the size of of the element that is associated with this key.
     D BasicMap_getSize...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getSize+
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
     D  i_key                              const  like(BasicMap_key_t    )
     D                                            options(*varsize)
      *                                                                                       RADDAT
      *  Returns the size of of the element that is addressed by a given index.               RADDAT
     D BasicMap_getSizeByIndex...                                                             RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getSizeByIndex+                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the number of key-value mappings in this map.
     D BasicMap_getNumE...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getNumE+
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Returns the heap ID of a given BasicMap.                                             RADDAT
     D BasicMap_getHeapID...                                                                  RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getHeapID+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Returns a list of all keys that are in a given map.                                  RADDAT
     D BasicMap_getKeys...                                                                    RADDAT
     D                 PR                         like(BasicList_handle_t)                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getKeys+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns a list of all values that are in a given map.                                RADDAT
     D BasicMap_getValues...                                                                  RADDAT
     D                 PR                         like(BasicList_handle_t)                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_getValues+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
     D  i_pSortFnc                     *   const  procptr                                     RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Removes all entries from a given map.                                                RADDAT
     D BasicMap_clear...                                                                      RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_clear+                                   RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Deletes a given BasicMap.
     D BasicMap_delete...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_delete+
     D                                     ')                                                 RADDAT
     D  io_pMap                                   like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Returns a BasicMap NULL handle.
     D BasicMap_null...
     D                 PR                         like(BasicMap_handle_t )
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_null+
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Checks a given BasicMap handle for a NULL value.
     D BasicMap_isNull...
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_isNull+
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )
      *                                                                                       RADDAT
      *  Produces a list of keys from a given map.                                            RADDAT
     D BasicMap_newKeySet...                                                                  RADDAT
     D                 PR                         like(BasicKeySet_handle_t)                  RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicMap_newKeySet+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMap                             const  like(BasicMap_handle_t )                    RADDAT
      *                                                                                       RADDAT
      *  Returns the first entry of a given key set.
     D BasicKeySet_getFirst...                                                                RADDAT
     D                 PR                         like(BasicMap_key_t    )
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicKeySet_getFirst+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_pKeySet                          const  like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  Returns the next entry of a given key set.
     D BasicKeySet_getNext...                                                                 RADDAT
     D                 PR                         like(BasicMap_key_t    )
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicKeySet_getNext+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pKeySet                          const  like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      *  Deletes the key list associated to a given map.                                      RADDAT
     D BasicKeySet_delete...                                                                  RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RC+                                RADDAT
     D                                     _BasicKeySet_delete+                               RADDAT
     D                                     ')                                                 RADDAT
     D  io_pKeySet                                like(BasicKeySet_handle_t)                  RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1RA                    BasicList
 CPY  /COPY QBASICS1,PBASICS1R4                    Assert/This/Caller
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RD  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RD"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - URL                 cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RD)                                                              RADDAT
      /DEFINE BASICS1RD                                                                       RADDAT
      *                                                                                       RADDAT
 CPY  /COPY QBASICS1,FDURL                                                                    RADDAT
      *                                                                                       RADDAT
      *  Error ocdes                                                                          RADDAT
     D cURL_ERROR_EMPTY_URL...                                                                RADDAT
     D                 C                   -1                                                 RADDAT
     D cURL_ERROR_NO_PROTOCOL...                                                              RADDAT
     D                 C                   -2                                                 RADDAT
     D cURL_ERROR_UNSUPPORTED_PROTOCOL...                                                     RADDAT
     D                 C                   -3                                                 RADDAT
     D cURL_ERROR_INVALID_PORT_NUMBER...                                                      RADDAT
     D                 C                   -4                                                 RADDAT
     D cURL_ERROR_UNSUPPORTED_OPERATION...                                                    RADDAT
     D                 C                   -5                                                 RADDAT
     D cURL_ERROR_INVALID_OBJECT_DATA...                                                      RADDAT
     D                 C                   -6                                                 RADDAT
      *                                                                                       RADDAT
      *  Creates a new URL.                                                                   RADDAT
     D Url_new...                                                                             RADDAT
     D                 PR                         like(url_t )                                RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_new+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t )                                RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the protocol of a given URL.                                                 RADDAT
     D Url_getProtocol...                                                                     RADDAT
     D                 PR                         like(url_t )                                RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getProtocol+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t )                                RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Sets the protocol of a given URL.                                                    RADDAT
     D Url_setProtocol...                                                                     RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_setProtocol+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  io_url                                    like(url_t )                                RADDAT
     D  i_protocol                         const  like(url_t ) options(*varsize)              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the host name of a given URL.                                                RADDAT
     D Url_getHost...                                                                         RADDAT
     D                 PR                         like(url_t )                                RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getHost+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t )                                RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Sets the host name of a given URL.                                                   RADDAT
     D Url_setHost...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_setHost+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  io_url                                    like(url_t )                                RADDAT
     D  i_host                             const  like(url_t ) options(*varsize)              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the port of a given URL.                                                     RADDAT
     D Url_getPort...                                                                         RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getPort+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Sets the port number of a given URL.                                                 RADDAT
     D Url_setPort...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_setPort+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  io_url                                    like(url_t )                                RADDAT
     D  i_port                       10I 0 const                                              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the path name of a given URL.                                                RADDAT
     D Url_getPath...                                                                         RADDAT
     D                 PR                         like(url_t    )                             RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getPath+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Sets the path of a given URL.                                                        RADDAT
     D Url_setPath...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_setPath+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  io_url                                    like(url_t )                                RADDAT
     D  i_path                             const  like(url_t ) options(*varsize)              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the file name of a given URL.                                                RADDAT
     D Url_getFile...                                                                         RADDAT
     D                 PR                         like(url_t    )                             RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getFile+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Sets the file of a given URL.                                                        RADDAT
     D Url_setFile...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_setFile+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  io_url                                    like(url_t )                                RADDAT
     D  i_file                             const  like(url_t ) options(*varsize)              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the query part of a given URL.                                               RADDAT
     D Url_getQuery...                                                                        RADDAT
     D                 PR                         like(url_t    )                             RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getQuery+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Sets the query part of a given URL.                                                  RADDAT
     D Url_setQuery...                                                                        RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_setQuery+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  io_url                                    like(url_t )                                RADDAT
     D  i_query                            const  like(url_t ) options(*varsize)              RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the string representation of a given URL.                                    RADDAT
     D Url_toString...                                                                        RADDAT
     D                 PR           512A          varying                                     RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_toString+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the library, file and member of a URL of type 'mbr'.                         RADDAT
     D Url_getMbr...                                                                          RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RD+                                RADDAT
     D                                     _Url_getMbr+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_url                              const  like(url_t    )                             RADDAT
     D  o_file                       10A          options(*nopass: *omit)                     RADDAT
     D  o_lib                        10A          options(*nopass: *omit)                     RADDAT
     D  o_mbr                        10A          options(*nopass: *omit)                     RADDAT
     D  o_rc                         10I 0        options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RE  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RE"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Date and Time       cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RE)                                                              RADDAT
      /DEFINE BASICS1RE                                                                       RADDAT
      *                                                                                       RADDAT
      *  Produces a date from a given year, month and day.                                    RADDAT
     D f_dateSerial...                                                                        RADDAT
     D                 PR              d                                                      RADDAT
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_dateSerial+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_year                       10i 0 const                                              RADDAT
     D  i_month                      10i 0 const                                              RADDAT
     D  i_day                        10i 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Converts an epoch date to a RPG timestamp.
     D f_cvtEpochTS...
     D                 PR              z
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_cvtEpochTS+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_epochSecs                  10i 0 const
     D  i_adjustUTC                    n   const options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Converts a RPG timestamp to an epoch value.
     D f_cvtTSEpoch...
     D                 PR            10i 0
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_cvtTSEpoch+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_timestamp                    z   const
     D  i_adjustUTC                    n   const options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Converts a MI time value to a RPG timestamp.
     D f_cvtMiTimeTS...
     D                 PR              z
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_cvtMiTimeTS+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  i_miTime                     20a   const
     D  i_adjustUTC                    n   const options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Converts a RPG timestamp to a MI time value.
     D f_cvtTSMiTime...
     D                 PR            20a
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_cvtTSMiTime+
     D                                     ')                                                 RADDAT
     D  i_timestamp                    z   const
     D  i_adjustUTC                    n   const options(*nopass: *omit)
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RF  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RF"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - System Values       cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RF)                                                              RADDAT
      /DEFINE BASICS1RF                                                                       RADDAT
      *                                                                                       RADDAT
      *  Retrieves an alpha-numeric system value.                                             RADDAT
     D f_rtvSysVal_char...                                                                    RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_rtvSysVal_char+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_name                       10A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t )                              RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieves a numeric system value.                                                    RADDAT
     D f_rtvSysVal_num...                                                                     RADDAT
     D                 PR            15P 5                                                    RADDAT
     D                                     extproc('BASICS1RE+                                RADDAT
     D                                     _f_rtvSysVal_num+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_name                       10A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t )                              RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RG  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RG"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - BasicProperties     cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RG)                                                              RADDAT
      /DEFINE BASICS1RG                                                                       RADDAT
      *                                                                                       RADDAT
     D BasicProperties_handle_t...                                                            RADDAT
     D                 S               *                      based(pDummy)                   RADDAT
      *                                                                                       RADDAT
     D BasicProperties_decVal_t...
     D                 S             31P10                    based(pDummy)
      *                                                                                       RADDAT
      *  Creates a new BasicProperties.                                                       RADDAT
     D BasicProperties_new...                                                                 RADDAT
     D                 PR                         like(BasicProperties_handle_t)              RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_new+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_increment                  10U 0 const  options(*nopass: *omit)                     RADDAT
     D  i_heapID                     10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Clones a given BasicProperties.                                                      RADDAT
     D BasicProperties_clone...                                                               RADDAT
     D                 PR                         like(BasicProperties_handle_t)              RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_clone+                            RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Load properties from a given physical file member.
     D BasicProperties_loadFromMember...                                                      RADDAT
     D                 PR            10I 0
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_loadFromMember+                   RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_file                       10A   const  varying
     D  i_lib                        10A   const  varying
     D                                            options(*nopass: *omit)
     D  i_mbr                        10A   const  varying
     D                                            options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Load properties from a given stream file.
     D BasicProperties_loadFromStmf...
     D                 PR            10I 0
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_loadFromStmf+                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_stmf                     5000A   const  varying options(*varsize)
      *                                                                                       RADDAT
      *  Removes the entry that is associated to the specified key.                           RADDAT
     D BasicProperties_remove...                                                              RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_remove+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t    )                    RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Returns true if the list of properties contains a entry matching                     RADDAT
      *  the specified key value.                                                             RADDAT
     D BasicProperties_containsKey...                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_containsKey+                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Returns the string that is associated to the specified key.                          RADDAT
     D BasicProperties_getString...                                                           RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_getString+                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_default                  4096A   const  varying                                     RADDAT
     D                                            options(*nopass: *varsize)                  RADDAT
      *                                                                                       RADDAT
      *  Returns the integer value that is associated to the specified key.                   RADDAT
     D BasicProperties_getInteger...                                                          RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_getInteger+                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_default                    10I 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the boolean value that is associated to the specified key.                   RADDAT
     D BasicProperties_getBoolean...                                                          RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_getBoolean+                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_default                      N   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the decimal value that is associated to the specified key.                   RADDAT
     D BasicProperties_getDecimal...                                                          RADDAT
     D                 PR                         like(BasicProperties_decVal_t)
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_getDecimal+                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_default                          const  like(BasicProperties_decVal_t)
     D                                            options(*nopass)
      *                                                                                       RADDAT
      *  Associates the specified string value to a given key.                                RADDAT
     D BasicProperties_putString...                                                           RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_putString+                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D                                            options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Associates the specified integer value to a given key.                               RADDAT
     D BasicProperties_putInteger...                                                          RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_putInteger+                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_integer                    10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Associates the specified boolean value to a given key.                               RADDAT
     D BasicProperties_putBoolean...                                                          RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_putBoolean+                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_boolean                      N   const                                              RADDAT
      *                                                                                       RADDAT
      *  Associates the specified decimal value to a given key.                               RADDAT
     D BasicProperties_putDecimal...                                                          RADDAT
     D                 PR                         like(BasicProperties_decVal_t)
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_putDecimal+                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
     D  i_key                              const  like(BasicMap_key_t          )              RADDAT
     D                                            options(*varsize)                           RADDAT
     D  i_decimal                          const  like(BasicProperties_decVal_t)              RADDAT
      *                                                                                       RADDAT
      *  Returns the number of key-value mappings in this properties list.                    RADDAT
     D BasicProperties_getNumE...                                                             RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_getNumE+                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Returns the heap ID of a given BasicProperties.                                      RADDAT
     D BasicProperties_getHeapID...                                                           RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_getHeapID+                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Removes all entries from a given properties list.                                    RADDAT
     D BasicProperties_clear...                                                               RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_clear+                            RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Deletes a given BasicProperties.                                                     RADDAT
     D BasicProperties_delete...                                                              RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_delete+                           RADDAT
     D                                     ')                                                 RADDAT
     D  io_pProperties...                                                                     RADDAT
     D                                            like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Returns a BasicProperties NULL handle.                                               RADDAT
     D BasicProperties_null...                                                                RADDAT
     D                 PR                         like(BasicProperties_handle_t)              RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_null+                             RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Checks a given BasicProperties handle for a NULL value.                              RADDAT
     D BasicProperties_isNull...                                                              RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_isNull+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      *  Returns the list of key values from a given properties list.                         RADDAT
     D BasicProperties_newKeySet...                                                           RADDAT
     D                 PR                         like(BasicKeySet_handle_t)                  RADDAT
     D                                     extproc('BASICS1RG+                                RADDAT
     D                                     _BasicProperties_newKeySet+                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_pProperties                      const  like(BasicProperties_handle_t)              RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1RH  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1RH"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - MemoryBufferRdrWtr  cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1RH)                                                              RADDAT
      /DEFINE BASICS1RH                                                                       RADDAT
      *                                                                                       RADDAT
 CPY  /COPY QBASICS1,CLIB                          C Runtime Library                          RADDAT
      *                                                                                       RADDAT
     D memWtr_handle_t...                                                                     RADDAT
     D                 S             10I 0                    based(pDummy)                   RADDAT
     D memRdr_handle_t...                                                                     RADDAT
     D                 S             10I 0                    based(pDummy)                   RADDAT
      *                                                                                       RADDAT
      *  Creates a memory buffer writer.                                                      RADDAT
     D MemoryWriter_new...                                                                    RADDAT
     D                 PR                         like(memWtr_handle_t)                       RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryWriter_new+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_maxSize                          value  like(size_t         )                       RADDAT
      *                                                                                       RADDAT
      *  Write to a given memory buffer descriptor.                                           RADDAT
     D MemoryWriter_write...                                                                  RADDAT
     D                 PR                          like(ssize_t       )         = ssize_t     RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryWriter_write+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_fd                               value  like(memWtr_handle_t)         = int         RADDAT
     D  i_pBuffer                      *   value                                = *buf        RADDAT
     D  i_buflen                           value  like(size_t         )         = size_t      RADDAT
      *                                                                                       RADDAT
      *  Deletes a given memory buffer writer.                                                RADDAT
     D MemoryWriter_delete...                                                                 RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryWriter_delete+                              RADDAT
     D                                     ')                                                 RADDAT
     D  io_fd                                     like(memWtr_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Returns the 'write' procedure of a MemoryWriter.                                     RADDAT
     D MemoryWriter_writeProc...                                                              RADDAT
     D                 PR              *          procptr                                     RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryWriter_writeProc+                           RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Creates a memory buffer reader.                                                      RADDAT
     D MemoryReader_new...                                                                    RADDAT
     D                 PR                         like(memRdr_handle_t)                       RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryReader_new+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_pBuffer                      *   value                                              RADDAT
     D  i_size                             value  like(size_t         )
      *                                                                                       RADDAT
      *  Reads from a given memory buffer descriptor.                                         RADDAT
     D MemoryReader_read...                                                                   RADDAT
     D                 PR                         like(ssize_t        )         = ssize_t     RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryReader_read+                                RADDAT
     D                                     ')                                                 RADDAT
     D  i_fd                               value  like(memRdr_handle_t)         = int         RADDAT
     D  i_pBuffer                      *   value                                = *buf        RADDAT
     D  i_nByte                            value  like(size_t    )              = size_t      RADDAT
      *                                                                                       RADDAT
      *  Deletes a given memory buffer Reader.                                                RADDAT
     D MemoryReader_delete...                                                                 RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryReader_delete+                              RADDAT
     D                                     ')                                                 RADDAT
     D  io_fd                                     like(memRdr_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Returns the 'read' procedure of a MemoryReader.                                      RADDAT
     D MemoryReader_readProc...                                                               RADDAT
     D                 PR              *          procptr                                     RADDAT
     D                                     extproc('BASICS1RH+                                RADDAT
     D                                     _MemoryReader_readProc+                            RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R1  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R1"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Messages            cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(PBASICSR1)
      /DEFINE PBASICSR1
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
 CPY  /COPY QBASICS1,FDMSG                                                                    RADDAT
 CPY  /COPY QBASICS1,FDRCVM0200                                                               RADDAT
 CPY  /COPY QBASICS1,FDRCVM0300                                                               RADDAT
 CPY  /COPY QBASICS1,FDRTVM0100                                                               RADDAT
 CPY  /COPY QBASICS1,FDRTVM0300                                                               RADDAT
 CPY  /COPY QBASICS1,FDRTVM0400                                                               RADDAT
      *                                                                                       RADDAT
      *  Constants                                                                            RADDAT
      *                                                                                       RADDAT
      *  Message ID special values:                                                           RADDAT
     D cMSG_ID_OK      C                   const('*OK')
     D cMSG_ID_NONE    C                   const('')
     D cMSG_ID_NULL    C                   const('*NULL')                                     RADDAT
      *                                                                                       RADDAT
      *  Parameter: Stack Counter
     D cMsg_AllInact   C                   const(-4)                             - / - /rmv   RADDAT
     D cMsg_Ext        C                   const(-1)                            snd/rcv/rmv   RADDAT
     D cMsg_Prv        C                   const(-2)                            snd/rcv/rmv   RADDAT
     D cMsg_Same       C                   const(-3)                            snd/rcv/rmv   RADDAT
      *                                                                                       RADDAT
      *  Parameter: Procedure                                                                 RADDAT
     D cMsg_ToMyself   C                   const('*')                           snd/rcv/rmv   RADDAT
     D cMsg_ToPgmBdy   C                   const('*PGMBDY')                     snd/ - / -    RADDAT
     D cMsg_ToCtlBdy   C                   const('*CTLBDY')                     snd/ - / -    RADDAT
     D cMsg_ToPgm      C                   const('*PGMNAME')                    snd/ - / -    RADDAT
      *                                                                                       RADDAT
      *  Parameter: Message Type
     D cMsg_Any        C                   const('*ANY')                         - /rcv/ -    RADDAT
     D cMsg_Comp       C                   const('*COMP')                       snd/rcv/ -    RADDAT
     D cMsg_Copy       C                   const('*COPY')                        - /rcv/ -    RADDAT
     D cMsg_Diag       C                   const('*DIAG')                       snd/rcv/ -    RADDAT
     D cMsg_Escape     C                   const('*ESCAPE')                     snd/rcv/ -    RADDAT
     D cMsg_Escp       C                   const('*EXCP')                        - /rcv/ -    RADDAT
     D cMsg_First      C                   const('*FIRST')                       - /rcv/ -    RADDAT
     D cMsg_Info       C                   const('*INFO')                       snd/rcv/ -    RADDAT
     D cMsg_Inq        C                   const('*INQ')                        snd/ - / -    RADDAT
     D cMsg_Last       C                   const('*LAST')                        --/rcv/ -    RADDAT
     D cMsg_Next       C                   const('*NEXT')                        --/rcv/ -    RADDAT
     D cMsg_Notify     C                   const('*NOTIFY')                     snd/rcv/ -    RADDAT
     D cMsg_Previous   C                   const('*PRV')                         --/rcv/ -    RADDAT
     D cMsg_Rpy        C                   const('*RPY')                         --/rcv/ -    RADDAT
     D cMsg_Rqs        C                   const('*RQS')                        snd/rcv/ -    RADDAT
     D cMsg_Status     C                   const('*STATUS')                     snd/ - / -    RADDAT
      *                                                                                       RADDAT
      *  Parameter: Action                                                                    RADDAT
     D cMsg_Act_Old    C                   const('*OLD')                         - /rcv/ -    RADDAT
     D cMsg_Act_Rmv    C                   const('*REMOVE')                      - /rcv/ -    RADDAT
     D cMsg_Act_Same   C                   const('*SAME')                        - /rcv/ -    RADDAT
      *                                                                                       RADDAT
      *  Parameter: Message to remove                                                         RADDAT
     D cMsg_Rmv_All    C                   const('*ALL')                         - / - /rmv   RADDAT
     D cMsg_Rmv_ByKey  C                   const('*BYKEY')                       - / - /rmv   RADDAT
     D cMsg_Rmv_New    C                   const('*NEW')                         - / - /rmv   RADDAT
     D cMsg_Rmv_Old    C                   const('*OLD')                         - / - /rmv   RADDAT
     D cMsg_Rmv_Scope  C                   const('*SCOPE')                       - / - /rmv   RADDAT
      *                                                                                       RADDAT
      *  Retrieve message help text                                                           RADDAT
     D cMsg_RtnCtrlChar_Yes...                                                                RADDAT
     D                 C                   const('*YES')                                      RADDAT
     D cMsg_RtnCtrlChar_No...                                                                 RADDAT
     D                 C                   const('*NO')                                       RADDAT
      *                                                                                       RADDAT
      *  Sets the application message file.                                                   RADDAT
     D p_setAppMsgFile...                                                                     RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _p_setAppMsgFile+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_file                       10A   const  options(*nopass)                            RADDAT
     D  i_lib                        10A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Creates a new message.                                                               RADDAT
     D f_newMsg...                                                                            RADDAT
     D                 PR                         likeds(msg_t     )                          RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_newMsg+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_ID                               const  like(msg_t.id    )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_data                      512A   const  varying                                     RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_type                             const  like(msg_t.type  )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_file                             const  like(msg_t.file  )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
     D  i_lib                              const  like(msg_t.lib   )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
      *                                                                                       RADDAT
      *  Sends a program message.                                                             RADDAT
     D f_sndPgmMsg...                                                                         RADDAT
     D                 PR             4A                                                      RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_sndPgmMsg+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_msg                              const  likeds(msg_t   )                            RADDAT
     D  i_toStkC                     10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_toProc                    256A   const  options(*nopass: *omit)                     RADDAT
     D  i_toMod                      10A   const  options(*nopass: *omit)                     RADDAT
     D  i_toPgm                      10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Receives a program message.                                                          RADDAT
     D f_rcvPgmMsg...                                                                         RADDAT
     D                 PR                         likeds(rcvm0200_t)                          RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_rcvPgmMsg+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_msgType                    10A   const                                              RADDAT
     D  i_msgKey                      4A   const  options(*nopass: *omit)                     RADDAT
     D  i_action                     10A   const  options(*nopass: *omit)                     RADDAT
     D  i_wait                       10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromStkC                   10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromProc                  256A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromMod                    10A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromPgm                    10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Removes a program message.                                                           RADDAT
     D p_rmvPgmMsg...                                                                         RADDAT
     D                 PR
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _p_rmvPgmMsg+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_msgToRemove                10A   const                                              RADDAT
     D  i_msgKey                      4A   const  options(*nopass: *omit)
     D  i_fromStkC                   10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromProc                  256A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromMod                    10A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromPgm                    10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieves the message text of a given message.                                       RADDAT
      *  Replaces substitution variables with message data.
     D f_rtvMsgText...                                                                        RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_rtvMsgText+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieves the message help text of a given message.                                  RADDAT
      *  Replaces substitution variables with message data.
     D f_rtvMsgHelpText...                                                                    RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_rtvMsgHelpText+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  i_rtnCtrlChr                 10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieves the message text of a given message.                                       RADDAT
      *  Does not replace substitution variables with message data.
     D f_rtvMsgTextRaw...
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_rtvMsgTextRaw+
     D                                     ')                                                 RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieves the message help text of a given message.                                  RADDAT
      *  Does not replace substitution variables with message data.
     D f_rtvMsgHelpTextRaw...
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_rtvMsgHelpTextRaw+
     D                                     ')                                                 RADDAT
     D  i_msg                              const  likeds(msg_t    )                           RADDAT
     D  i_rtnCtrlChr                 10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Converts a received message of format RCVM0200 to a message.                         RADDAT
     D f_cvtRcvMsgToMsg...                                                                    RADDAT
     D                 PR                         likeds(msg_t     )                          RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_cvtRcvMsgToMsg+
     D                                     ')                                                 RADDAT
     D  i_rcvm0200                         const  likeds(rcvm0200_t)
     D  i_type                             const  like(msg_t.type  )                          RADDAT
     D                                            options(*omit: *nopass)                     RADDAT
      *                                                                                       RADDAT
      *  Receives a program message and returns a message structure.                          RADDAT
     D f_rcvPgmMsgObj...                                                                      RADDAT
     D                 PR                         likeds(msg_t )                              RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_rcvPgmMsgObj+                                   RADDAT
     D                                     ')                                                 RADDAT
     D  i_msgType                    10A   const                                              RADDAT
     D  i_msgKey                      4A   const  options(*nopass: *omit)                     RADDAT
     D  i_action                     10A   const  options(*nopass: *omit)                     RADDAT
     D  i_wait                       10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromStkC                   10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_fromProc                  256A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromMod                    10A   const  options(*nopass: *omit)                     RADDAT
     D  i_fromPgm                    10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the sender information of a receives program message.                        RADDAT
     D f_getSndInfOfRcvMsg...                                                                 RADDAT
     D                 PR                         likeds(sndInf_t  )                          RADDAT
     D                                     extproc('BASICS1R1+                                RADDAT
     D                                     _f_getSndInfOfRcvMsg+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_rcvm0200                         const  likeds(rcvm0200_t)                          RADDAT
     D  o_longSndPgm                256A          options(*nopass: *omit)                     RADDAT
     D  o_longSndPrc                256A          options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2                   API Error Handling                          RADDAT
 CPY  /COPY QBASICS1,PBASICS1R4                   Assert/THIS                                 RADDAT
 CPY  /COPY QBASICS1,PBASICS1R5                   Objects                                     RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R2  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R2"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - API Error Handling  cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R2)
      /DEFINE BASICS1R2
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
 CPY  /COPY QBASICS1,FDERRCODE                                                                RADDAT
      *                                                                                       RADDAT
      *  Creates a new API error code.                                                        RADDAT
     D f_newApiErrCode...                                                                     RADDAT
     D                 PR                         likeds(errCode_t )                          RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_newApiErrCode+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_monMsg                       N   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Is API error?                                                                        RADDAT
     D f_isApiError...                                                                        RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_isApiError+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_errCode                          const  likeds(errCode_t )                          RADDAT
      *                                                                                       RADDAT
      *  Converts an API error code to a messsage.                                            RADDAT
     D f_cvtApiErrCodeToMsg...                                                                RADDAT
     D                 PR                         like(msg_t     )                            RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_cvtApiErrCodeToMsg+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_errCode                          const  likeds(errCode_t )                          RADDAT
      *                                                                                       RADDAT
      *  Returns the C runtime error number.                                                  RADDAT
     D f_errno...                                                                             RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_errno+                                          RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Sets the C runtime error number to ZERO (no error).                                  RADDAT
     D f_clrErrno...                                                                          RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_clrErrno+                                       RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Sets the C runtime error number to a given error code.                               RADDAT
     D f_setErrno...                                                                          RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_setErrno+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_errno                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Returns the message text of a C runtime error number.                                RADDAT
     D f_strerror...                                                                          RADDAT
     D                 PR           128A          varying                                     RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_strerror+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_errno                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Converts a C runtime error number to a message.                                      RADDAT
     D f_cvtErrnoToMsg...                                                                     RADDAT
     D                 PR                         like(msg_t     )                            RADDAT
     D                                     extproc('BASICS1R2+                                RADDAT
     D                                     _f_cvtErrnoToMsg+
     D                                     ')                                                 RADDAT
     D  i_errno                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R1                   Messages                                    RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R3  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R3"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Strings             cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R3)
      /DEFINE BASICS1R3
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
      *                                                                                       RADDAT
      *  Konstants: f_wordWrap()                                                              RADDAT
     D cWORDWRAP_PARAGRAPH_NONE...                                                            RADDAT
     D                 C                   const(1)                                           RADDAT
     D cWORDWRAP_PARAGRAPH_MSGD...                                                            RADDAT
     D                 C                   const(2)                                           RADDAT
     D cWORDWRAP_PARAGRAPH_TEXT...                                                            RADDAT
     D                 C                   const(4)                                           RADDAT
     D cWORDWRAP_PARAGRAPH_TRIMR...                                                           RADDAT
     D                 C                   const(8)                                           RADDAT
      *                                                                                       RADDAT
      *  Returns the left portion of a string.                                                RADDAT
     D f_left...                                                                              RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_left+                                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10I 0 const                                              RADDAT
      *
      *  Returns the sub string that starts at a given position.                              RADDAT
     D f_mid...
     D                 PR          4096A           varying
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_mid+
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying
     D                                             options(*varsize)
     D  i_start                      10I 0 const
     D  i_length                     10I 0 const   options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Tests if the specified string starts with the specified prefix.                      RADDAT
     D f_startsWith...                                                                        RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_startsWith+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_prefix                   4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Tests if the specified string starts with the specified prefix,                      RADDAT
      *  ignoring case considerations.                                                        RADDAT
     D f_startsWithIgnoreCase...                                                              RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_startsWithIgnoreCase+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_prefix                   4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Returns the right portion of a string.                                               RADDAT
     D f_right...                                                                             RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_right+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Tests if the specified string ends with the specified suffix.                        RADDAT
     D f_endsWith...                                                                          RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_endsWith+
     D                                     ')                                                 RADDAT
     D  i_suffix                   4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Produces an empty string.                                                            RADDAT
     D f_space...                                                                             RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_space+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_char                        1A   const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Converts a given string to lower case.                                               RADDAT
     D f_lcase...                                                                             RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_lcase+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Converts a given string to upper case.                                               RADDAT
     D f_ucase...                                                                             RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_ucase+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Replaces all occurences of a search argument by                                      RADDAT
      *  a replacement string in a given string.                                              RADDAT
     D f_replace...                                                                           RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_replace+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_searchArg                4096A   const  varying                                     RADDAT
     D  i_rplString                4096A   const  varying                                     RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_startPos                   10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the EBCDIC value of a given character.                                       RADDAT
     D f_ebcdic...                                                                            RADDAT
     D                 PR             3U 0                                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_ebcdic+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_char                        1A   const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Returns the numeric value of a string.
     D f_val...                                                                               RADDAT
     D                 PR             8F                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_val+                                            RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                     64A   const  varying                                     RADDAT
     D  i_decPoint                    1A   const  options(*nopass)                            RADDAT
     D  i_comma                       1A   const  options(*nopass)                            RADDAT
     D  i_currSym                     1A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Performs word wrapping on a given string.
      *  Returns the next line of i_string with each call to f_wordWrap().                    RADDAT
     D f_wordWrap...                                                                          RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_wordWrap+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_width                      10U 0 const                                              RADDAT
     D  io_startPos                  10U 0                                                    RADDAT
     D  i_options                    10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Transforms a numeric from its internal format to a                                   RADDAT
      *  character form suitable for displaying.                                              RADDAT
     D f_editCode...                                                                          RADDAT
     D                 PR            64A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_editCode+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_decPos                     10I 0 const                                              RADDAT
     D  i_varClass                   10A   const                                              RADDAT
     D  i_editCode                    2A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Transforms a numeric from its internal format to a                                   RADDAT
      *  character form suitable for displaying.                                              RADDAT
     D f_editWord...                                                                          RADDAT
     D                 PR           512A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_editWord+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_varClass                   10A   const                                              RADDAT
     D  i_editWord                  256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Gets the length of a the formatted string of a given edit code.                      RADDAT
     D f_getLengthEditCode...                                                                 RADDAT
     D                 PR             5U 0                                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_getLengthEditCode+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_decPos                     10I 0 const                                              RADDAT
     D  i_editCode                    2A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Gets the length of a the formatted string of a given edit word.                      RADDAT
     D f_getLengthEditWord...                                                                 RADDAT
     D                 PR             5U 0                                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_getLengthEditWord+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_digits                     10I 0 const                                              RADDAT
     D  i_editWord                  256A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Removes a keyword from a given string.                                               RADDAT
     D f_rmvKeyword...                                                                        RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_rmvKeyword+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_keyword                   128A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
      *                                                                                       RADDAT
      *  Removes quotes from a given string.                                                  RADDAT
     D f_rmvQuotes...                                                                         RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_rmvQuotes+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_quote                       1A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Adds quotes to a given string.                                                       RADDAT
     D f_addQuotes...                                                                         RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_addQuotes+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_quote                       1A   const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Centers a string.                                                                    RADDAT
     D f_center...                                                                            RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_center+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10U 0 const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Right aligns a string.                                                               RADDAT
     D f_alignR...                                                                            RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_alignR+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_length                     10U 0 const   options(*nopass)                           RADDAT
      *                                                                                       RADDAT
      *  Compare strings using wildcard characters. (Compare generic)                         RADDAT
     D f_genStrCmp...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_genStrCmp+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_mask                     4096A   const   varying                                    RADDAT
     D  i_wildcard                    2A   const   options(*nopass)
      *                                                                                       RADDAT
      *  Compare strings using wildcard characters.                                           RADDAT
     D f_genStrCmpIgnCase...                                                                  RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_genStrCmpIgnCase+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_mask                     4096A   const   varying                                    RADDAT
     D  i_wildcard                    2A   const   options(*nopass)
      *                                                                                       RADDAT
      *  Returns the last position of a search argument in the source string.                 RADDAT
     D f_scanR...
     D                 PR             5I 0                                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_scanR+
     D                                     ')                                                 RADDAT
     D  i_searchArg                4096A   const   varying                                    RADDAT
     D  i_string                   4096A   const   varying                                    RADDAT
     D  i_start                       5I 0 const   options(*nopass)
      *                                                                                       RADDAT
      *  Converts a given buffer to a character string of hex values.                         RADDAT
     D f_cvtBufferToHexString...                                                              RADDAT
     D                 PR          4096A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_cvtBufferToHexString+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_size                        5U 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Converts a given pointer to a character string of hex values.                        RADDAT
     D f_cvtPtrToHexString...                                                                 RADDAT
     D                 PR            32A           varying                                    RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_cvtPtrToHexString+                              RADDAT
     D                                     ')                                                 RADDAT
     D  i_pointer                      *   value                                              RADDAT
      *                                                                                       RADDAT
      *  Converts a given character string of hex values to a buffer.                         RADDAT
     D f_cvtHexStringToBuffer...                                                              RADDAT
     D                 PR             5U 0 opdesc
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_cvtHexStringToBuffer+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const   options(*varsize)                          RADDAT
     D  i_pBuffer                      *   const                                              RADDAT
     D  i_size                        5U 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Tests, if a given string contains an invalid character
      *  at a given position.
     D f_containsInvalidCharAt...
     D                 PR              N
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_containsInvalidCharAt+                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const  varying options(*varsize)
     D  i_pos                        10I 0 const                                              RADDAT
     D  i_chars                     256A   const  varying options(*varsize)                   RADDAT
      *                                                                                       RADDAT
      *  Tests, if a given string contains a specific string
      *  at a given position.
     D f_containsStringAt...
     D                 PR              N
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_containsStringAt+
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const  varying options(*varsize)                   RADDAT
     D  i_pos                        10I 0 const                                              RADDAT
     D  i_subString                4096A   const  varying options(*varsize)                   RADDAT
      *                                                                                       RADDAT
      *  Returns the string representation of a qualified object name.                        RADDAT
     D f_objName...                                                                           RADDAT
     D                 PR            21A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_objName+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_qObj                             const  likeds(qObj_t   )                           RADDAT
     D  i_lib                        10A   const  options(*nopass)
      *                                                                                       RADDAT
      *  Replaces unprintable characters in a given string.                                   RADDAT
     D f_rplUnPrtChars...                                                                     RADDAT
     D                 PR          4096A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_rplUnPrtChars+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                   4096A   const  varying                                     RADDAT
     D  i_rplChar                     1A   const  varying options(*nopass)                    RADDAT
      *                                                                                       RADDAT
      *  Formats a given date according to a given puicture string.                           RADDAT
     D f_formatDate...                                                                        RADDAT
     D                 PR           128A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_formatDate+                                     RADDAT
     D                                     ')                                                 RADDAT
     D  i_date                         D   const                                              RADDAT
     D  i_picture                   128A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Parses a string representing a date.                                                 RADDAT
     D f_parseDate...                                                                         RADDAT
     D                 PR              D                                                      RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_parseDate+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_string                    128A   const  varying                                     RADDAT
     D  i_picture                   128A   const  varying options(*nopass)                    RADDAT
      *                                                                                       RADDAT
      *  Konstants: f_formatMemSize                                                           RADDAT
     D cMEM_SIZE_BYTE...
     D                 C                   'B'
     D cMEM_SIZE_KILO_BYTE...
     D                 C                   'KB'
     D cMEM_SIZE_MEGA_BYTE...
     D                 C                   'MB'
     D cMEM_SIZE_GIGA_BYTE...
     D                 C                   'GB'
     D cMEM_SIZE_TERA_BYTE...
     D                 C                   'TB'
     D cMEM_SIZE_PETA_BYTE...
     D                 C                   'PB'
     D cMEM_SIZE_EXA_BYTE...
     D                 C                   'EB'
     D cMEM_SIZE_ZETTA_BYTE...
     D                 C                   'ZB'
      *                                                                                       RADDAT
      *  Converts a given memory size in bytes to string.                                     RADDAT
     D f_formatMemSize...                                                                     RADDAT
     D                 PR           128A          varying                                     RADDAT
     D                                     extproc('BASICS1R3+                                RADDAT
     D                                     _f_formatMemSize+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_memSize                    20I 0 const                                              RADDAT
     D  io_unit                       2A          options(*nopass: *omit)                     RADDAT
     D  i_decPos                      3I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2                   API Error Handling                          RADDAT
 CPY  /COPY QBASICS1,PBASICS1R4                   Assert/This/Caller                          RADDAT
 CPY  /COPY QBASICS1,PBASICS1R7                   Mathematics                                 RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R4  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R4"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Assert/This/Caller  cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R4)
      /DEFINE BASICS1R4
      *                                                                                       RADDAT
      *  RPG equivalent of the C Assert macro.                                                RADDAT
     D p_assert...                                                                            RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R4+                                RADDAT
     D                                     _p_assert+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_condition                    N   const                                              RADDAT
     D  i_msgText                   128A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the procedure, module and program name                                       RADDAT
      *  of the current procedure.                                                            RADDAT
     D f_this...
     D                 PR           256A          varying                                     RADDAT
     D                                     extproc('BASICS1R4+                                RADDAT
     D                                     _f_this+
     D                                     ')                                                 RADDAT
     D  o_module                     10A          options(*nopass: *omit)                     RADDAT
     D  o_program                    10A          options(*nopass: *omit)                     RADDAT
     D  o_stmtID                     10A          options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the procedure, module and program name                                       RADDAT
      *  that called the current procedure.                                                   RADDAT
     D f_caller...                                                                            RADDAT
     D                 PR           256A          varying                                     RADDAT
     D                                     extproc('BASICS1R4+                                RADDAT
     D                                     _f_caller+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  o_module                     10A          options(*nopass: *omit)                     RADDAT
     D  o_program                    10A          options(*nopass: *omit)                     RADDAT
     D  o_stmtID                     10A          options(*nopass: *omit)                     RADDAT
     D  i_offset                      3I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2                   API Error Handling                          RADDAT
 CPY  /COPY QBASICS1,PBASICS1R5                   Objects                                     RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R5  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R5"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Objects             cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R5)
      /DEFINE BASICS1R5
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
      /COPY QBASICS1,FDQFILE                                                                  RADDAT
      /COPY QBASICS1,FDQOBJ                                                                   RADDAT
      /COPY QBASICS1,FDQQSYSOBJ                                                               RADDAT
      /COPY QBASICS1,FDOBJD0100                                                               RADDAT
      /COPY QBASICS1,FDMBRD0100                                                               RADDAT
      /COPY QBASICS1,FDMBRD0200                                                               RADDAT
      *                                                                                       RADDAT
     D qProc_t         DS                  qualified      based(pDummy)                       RADDAT
     D  name                        256A   varying                                            RADDAT
     D  module                       10A                                                      RADDAT
     D  qPgm                               likeds(qObj_t)                                     RADDAT
      *                                                                                       RADDAT
     D actSrvPgm_t     DS                  qualified      based(pDummy)                       RADDAT
     D  procptr                        *   procptr                                            RADDAT
     D  actMark                      10I 0                                                    RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
     D actProc_t       DS                  qualified      based(pDummy)                       RADDAT
     D  procptr                        *   procptr                                            RADDAT
     D  actMark                      10I 0                                                    RADDAT
     D  name                        256A   varying                                            RADDAT
     D  srvPgm                       10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  Checks object existance.
     D f_exist...                                                                             RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_exist+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_obj                        10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_type                       10A   const                                              RADDAT
     D  i_mbr                        10A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Retrieve object description.                                                         RADDAT
     D f_rtvObjD...                                                                           RADDAT
     D                 PR          1024A                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_rtvObjD+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_obj                        10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_type                       10A   const                                              RADDAT
     D  i_format                      8A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieve member description.                                                         RADDAT
     D f_rtvMbrD...                                                                           RADDAT
     D                 PR          1024A                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_rtvMbrD+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_file                       10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_mbr                        10A   const                                              RADDAT
     D  i_format                      8A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Produces a temporary object name.                                                    RADDAT
     D f_getTmpName...                                                                        RADDAT
     D                 PR                         like(qObj_t     )                           RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getTmpName+                                     RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Produces a unique object name.  (experimental)                                       RADDAT
     D f_getUniqueName...                                                                     RADDAT
     D                 PR                         like(qObj_t     )                           RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getUniqueName+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_type                       10A   const                                              RADDAT
     D  i_lib                        10A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Creates a user space.                                                                RADDAT
     D f_crtUsrSpc...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_crtUsrSpc+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const                                              RADDAT
     D  i_text                       50A   const  options(*omit: *nopass)                     RADDAT
     D  i_size                       10U 0 const  options(*omit: *nopass)                     RADDAT
     D  i_extAtr                     10A   const  options(*omit: *nopass)                     RADDAT
     D  i_pubAuth                    10A   const  options(*omit: *nopass)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Retrieves a pointer to the content of a user space.                                  RADDAT
     D f_rtvUsrSpcPtr...                                                                      RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_rtvUsrSpcPtr+                                   RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the current size of a given user space.                                      RADDAT
     D f_getUsrSpcSize...                                                                     RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getUsrSpcSize+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns cTrue if the user space is extended automatically by the                     RADDAT
      *  system when the end of the space is encountered.                                     RADDAT
     D f_getUsrSpcAutoExt...                                                                  RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getUsrSpcAutoExt+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the initial value of a given user space.                                     RADDAT
     D f_getUsrSpcInitValue...                                                                RADDAT
     D                 PR             1A          varying                                     RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getUsrSpcInitValue+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Changes the size of a given user space.                                              RADDAT
     D f_chgUsrSpcSize...                                                                     RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_chgUsrSpcSize+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_size                       10I 0 const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Changes the automatic extendibility of a given user space.                           RADDAT
     D f_chgUsrSpcAutoExt...                                                                  RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_chgUsrSpcAutoExt+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_isAutoExt                    N   const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Changes the initial value of a given user space.                                     RADDAT
     D f_chgUsrSpcInitValue...                                                                RADDAT
     D                 PR             1A          varying                                     RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_chgUsrSpcInitValue+                             RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_initValue                   1A   const                                              RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Deletes a given user space.                                                          RADDAT
     D f_dltUsrSpc...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_dltUsrSpc+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_usrSpc                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Activates a service program.                                                         RADDAT
     D f_activateSrvPgm...                                                                    RADDAT
     D                 PR                         likeds(actSrvPgm_t )                        RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_activateSrvPgm+                                 RADDAT
     D                                     ')                                                 RADDAT
     D  i_srvPgm                     10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Gets a procedure pointer by name.                                                    RADDAT
     D f_getProcPtrByName...                                                                  RADDAT
     D                 PR                         likeds(actProc_t  )                         RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getProcPtrByName+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_proc                      256A   const                                              RADDAT
     D  i_actSrvPgm                        const  likeds(actSrvPgm_t)                         RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Returns the name of the library that contains a given object.                        RADDAT
     D f_getObjLib...                                                                         RADDAT
     D                 PR            10A                                                      RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_getObjLib+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_obj                        10A   const                                              RADDAT
     D  i_lib                        10A   const  options(*omit)                              RADDAT
     D  i_type                       10A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Converts a QSYS object name to a path.
     D f_cvtQSYSObjNameToPath...                                                              RADDAT
     D                 PR          5000A   varying opdesc                                     RADDAT
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_cvtQSYSObjNameToPath+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_obj                        40A   const  options(*varsize)                           RADDAT
     D  i_libOrType                  10A   const  options(*nopass: *omit)
     D  i_mbrOrType                  10A   const  options(*nopass: *omit)
     D  i_objType                    10A   const  options(*nopass: *omit)
      *                                                                                       RADDAT
      *  Resolve Integrated File System Path Name into
      *  QSYS Object Name                                                                     RADDAT
     D f_cvtPathToQSYSObjName...                                                              RADDAT
     D                 PR                  likeds(qQSYSObj_t)
     D                                     extproc('BASICS1R5+                                RADDAT
     D                                     _f_cvtPathToQSYSObjName+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_path                     5000A   const  varying options(*varsize)                   RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
      /COPY QBASICS1,MILIB                        MI-Library                                  RADDAT
      /COPY QBASICS1,PBASICS1R1                   Messages
      /COPY QBASICS1,PBASICS1R7                   Mathematics
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R6  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R6"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Commands/Environmentcpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R6)
      /DEFINE BASICS1R6
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
 CPY  /COPY QBASICS1,FDENVVAR                                                                 RADDAT
      *                                                                                       RADDAT
      *  Constants                                                                            RADDAT
      *  f_execute:            Refer to description of QCAPCMD API for details                RADDAT
     D cCMD_PRC_EXC_QCMDEXC...                                                                RADDAT
     D                 C                   const(0)                                           RADDAT
     D cCMD_PRC_CHK_QCMDCHK...                                                                RADDAT
     D                 C                   const(1)                                           RADDAT
     D cCMD_PRC_EXC_CMDLINE...                                                                RADDAT
     D                 C                   const(2)                                           RADDAT
     D cCMD_PRC_CHK_CMDLINE...                                                                RADDAT
     D                 C                   const(3)                                           RADDAT
     D cCMD_PRC_CHK_CL_STMT...                                                                RADDAT
     D                 C                   const(4)                                           RADDAT
     D cCMD_PRC_CHK_SEU_CL...                                                                 RADDAT
     D                 C                   const(5)                                           RADDAT
     D cCMD_PRC_CHK_SEU_CMD...                                                                RADDAT
     D                 C                   const(6)                                           RADDAT
     D cCMD_PRC_CHK_SEU_BND...                                                                RADDAT
     D                 C                   const(7)                                           RADDAT
     D cCMD_PRC_CHK_UDO...                                                                    RADDAT
     D                 C                   const(8)                                           RADDAT
     D cCMD_PRC_CHK_SEU_CLLE...                                                               RADDAT
     D                 C                   const(9)                                           RADDAT
      *                                                                                       RADDAT
     D cCMD_PRC_PROMPT_NEVER...                                                               RADDAT
     D                 C                   const(0)                                           RADDAT
     D cCMD_PRC_PROMPT_ALWAYS...                                                              RADDAT
     D                 C                   const(x'00010000')                    65536        RADDAT
     D cCMD_PRC_PROMPT_ON_REQUEST...                                                          RADDAT
     D                 C                   const(x'00020000')                   131072        RADDAT
     D cCMD_PRC_PROMPT_HELP...                                                                RADDAT
     D                 C                   const(x'00040000')                   262144        RADDAT
      *                                                                                       RADDAT
      *  Executes a CL command.                                                               RADDAT
     D f_execute...                                                                           RADDAT
     D                 PR              N   opdesc                                             RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _f_execute+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_cmd                     16384A   const  options(*varsize)                           RADDAT
     D  i_typeCmdPrc                 10I 0 const  options(*nopass: *omit)                     RADDAT
     D  o_msg                                     likeds(msg_t    )                           RADDAT
     D                                            options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Gets an environment variable.
     D f_getEnvVar...                                                                         RADDAT
     D                 PR          1024A          varying                                     RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _f_getEnvVar+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_pEnvVar                      *   const  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  Sets an environment variable.                                                        RADDAT
     D f_setEnvVar...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _f_setEnvVar+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_envVar                           const  like(envVar_t.name )                        RADDAT
     D  i_value                            const  like(envVar_t.value)                        RADDAT
      *                                                                                       RADDAT
      *  Deletes an environment variable.                                                     RADDAT
     D f_delEnvVar...                                                                         RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _f_delEnvVar+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  i_pEnvVar                      *   const  options(*string)                            RADDAT
      *                                                                                       RADDAT
      *  Gets the number of environment variables.                                            RADDAT
     D f_getNumEnvVar...                                                                      RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _f_getNumEnvVar+                                   RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Gets an environment variable by its index.                                           RADDAT
     D f_getEnvVarByIndex...                                                                  RADDAT
     D                 PR                         likeds(envVar_t )                           RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _f_getEnvVarByIndex+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_index                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Waits for the specified number of seconds.                                           RADDAT
     D p_wait...                                                                              RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R6+                                RADDAT
     D                                     _p_wait+                                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_seconds                    10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R1                   Messages                                    RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2                   API Error Handling                          RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R7  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R7"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Mathematics         cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R7)                                                              RADDAT
      /DEFINE BASICS1R7                                                                       RADDAT
      *                                                                                       RADDAT
      *  Constants                                                                            RADDAT
      *                                                                                       RADDAT
      *  Generate UUID:                                                                       RADDAT
     D cUUID_HEX...                                                                           RADDAT
     D                 C                   const(1)                                           RADDAT
     D cUUID_STRING...                                                                        RADDAT
     D                 C                   const(2)                                           RADDAT
      *                                                                                       RADDAT
     D uuid_t          DS                  qualified                                          RADDAT
     D  length                        5U 0                                                    RADDAT
     D  value                        32A                                                      RADDAT
      *                                                                                       RADDAT
      *  Generate MD5:                                                                        RADDAT
     D cMD5_HEX...                                                                            RADDAT
     D                 C                   const(4352)                           256 + 4096   RADDAT
     D cMD5_STRING...                                                                         RADDAT
     D                 C                   const(4608)                           512 + 4096   RADDAT
     D cMD5_ONLY...                                                                           RADDAT
     D                 C                   const(17)                               1 +   16   RADDAT
     D cMD5_FIRST...                                                                          RADDAT
     D                 C                   const(18)                               2 +   16   RADDAT
     D cMD5_MIDDLE...                                                                         RADDAT
     D                 C                   const(20)                               4 +   16   RADDAT
     D cMD5_FINAL...                                                                          RADDAT
     D                 C                   const(24)                               8 +   16   RADDAT
      *                                                                                       RADDAT
     D md5_t           DS                  qualified                                          RADDAT
     D  length                        5U 0                                                    RADDAT
     D  value                        32A                                                      RADDAT
      *                                                                                       RADDAT
      *  Generate SHA-1:                                                                      RADDAT
     D cSHA1_HEX...                                                                           RADDAT
     D                 C                   const(8448)                           256 + 8192   RADDAT
     D cSHA1_STRING...                                                                        RADDAT
     D                 C                   const(8704)                           512 + 8192   RADDAT
     D cSHA1_ONLY...                                                                          RADDAT
     D                 C                   const(33)                               1 +   32   RADDAT
     D cSHA1_FIRST...                                                                         RADDAT
     D                 C                   const(34)                               2 +   32   RADDAT
     D cSHA1_MIDDLE...                                                                        RADDAT
     D                 C                   const(36)                               4 +   32   RADDAT
     D cSHA1_FINAL...                                                                         RADDAT
     D                 C                   const(40)                               8 +   32   RADDAT
      *                                                                                       RADDAT
     D sha1_t          DS                  qualified                                          RADDAT
     D  length                        5U 0                                                    RADDAT
     D  value                        40A                                                      RADDAT
      *                                                                                       RADDAT
      *  Generate CRC32:                                                                      RADDAT
     D cCRC32_ONLY...                                                                         RADDAT
     D                 C                   const(33)                               1 +   64   RADDAT
     D cCRC32_FIRST...                                                                        RADDAT
     D                 C                   const(34)                               2 +   64   RADDAT
     D cCRC32_MIDDLE...                                                                       RADDAT
     D                 C                   const(36)                               4 +   64   RADDAT
     D cCRC32_FINAL...                                                                        RADDAT
     D                 C                   const(40)                               8 +   64   RADDAT
      *                                                                                       RADDAT
     D crc32_t         DS                  qualified                                          RADDAT
     D  length                        5U 0                                                    RADDAT
     D  value                        40A                                                      RADDAT
      *                                                                                       RADDAT
      *  Tests for one or more bits.                                                          RADDAT
     D f_isBitOn...                                                                           RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_isBitOn+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_testBit                    10U 0 value                                              RADDAT
     D  i_value                      10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Computes the logarithm base 10 of a given value.                                     RADDAT
     D f_log10...                                                                             RADDAT
     D                 PR             8F                                                      RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_log10+                                          RADDAT
     D                                     ')                                                 RADDAT
     D  i_value                       8F   value                                              RADDAT
      *                                                                                       RADDAT
      *  Computes the length of a RPG integer field from its buffer length                    RADDAT
     D f_clcLengthOfRPGIntFieldFromBufSize...                                                 RADDAT
     D                 PR             5U 0                                                    RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_clcLengthOfRPGIntFieldFromBufSize+              RADDAT
     D                                     ')                                                 RADDAT
     D  i_buffSize                    5U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Generates a Universal Unique Identifier (UUID).
     D f_genUUID...                                                                           RADDAT
     D                 PR                         likeds(uuid_t  )                            RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_genUUID+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_option                      5U 0 value  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Generates a MD5 fingerprint (hash code).                                             RADDAT
     D f_genMD5...                                                                            RADDAT
     D                 PR                         likeds(md5_t   )                            RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_genMD5+                                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_pString                      *   const  options(*string)                            RADDAT
     D  i_option                      5U 0 const  options(*nopass)                            RADDAT
     D  i_length                     10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Generates a SHA-1 fingerprint (hash code).                                           RADDAT
     D f_genSHA1...                                                                           RADDAT
     D                 PR                         likeds(sha1_t  )                            RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_genSHA1+                                        RADDAT
     D                                     ')                                                 RADDAT
     D  i_pString                      *   const  options(*string)                            RADDAT
     D  i_option                      5U 0 const  options(*nopass)                            RADDAT
     D  i_length                     10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Generates a CRC32 checksum.                                                          RADDAT
     D f_genCRC32...                                                                          RADDAT
     D                 PR                         likeds(crc32_t )                            RADDAT
     D                                     extproc('BASICS1R7+                                RADDAT
     D                                     _f_genCRC32+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_pString                      *   const  options(*string)                            RADDAT
     D  i_option                      5U 0 const  options(*nopass)                            RADDAT
     D  i_length                     10U 0 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R3                   Strings                                     RADDAT
 CPY  /COPY QBASICS1,PBASICS1R4                   Assert/This/Caller                          RADDAT
      *                                                                                       RADDAT
      /if defined(C_COMPILER)
 CPY  /COPY QBASICS1,PBASICS1C7                   C-Helpers                                   RADDAT
      /endif
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R8  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R8"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Handle/Memory       cpybk"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R8)                                                              RADDAT
      /DEFINE BASICS1R8                                                                       RADDAT
      *                                                                                       RADDAT
     D HANDLE_handle_t...                                                                     RADDAT
     D                 S             10I 0                         based(pDummy)              RADDAT
     D HANDLE_type_t...                                                                       RADDAT
     D                 S             20A                           based(pDummy)              RADDAT
      *                                                                                       RADDAT
      *  Creates a new handle.                                                                RADDAT
     D HANDLE_new...                                                                          RADDAT
     D                 PR                         like(HANDLE_handle_t)                       RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _HANDLE_new+                                       RADDAT
     D                                     ')                                                 RADDAT
     D  i_type                             value  like(HANDLE_type_t  )                       RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Creates a NULL handle.                                                               RADDAT
     D HANDLE_null...                                                                         RADDAT
     D                 PR                         like(HANDLE_handle_t)                       RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _HANDLE_null+                                      RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Checks a handle for a NULL value.                                                    RADDAT
     D HANDLE_isNull...                                                                       RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _HANDLE_isNull+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  i_handle                           value  like(HANDLE_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Checks the type of a given handle.                                                   RADDAT
     D HANDLE_isTypeOf...                                                                     RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _HANDLE_isTypeOf+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_handle                           value  like(HANDLE_handle_t)                       RADDAT
     D  i_type                             value  like(HANDLE_type_t  )                       RADDAT
      *                                                                                       RADDAT
      *  Gets the pointer of a given handle.                                                  RADDAT
     D HANDLE_getPointer...                                                                   RADDAT
     D                 PR              *                                                      RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _HANDLE_getPointer+                                RADDAT
     D                                     ')                                                 RADDAT
     D  i_handle                           value  like(HANDLE_handle_t)                       RADDAT
      *                                                                                       RADDAT
      *  Deletes a given handle.                                                              RADDAT
     D HANDLE_delete...                                                                       RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _HANDLE_delete+                                    RADDAT
     D                                     ')                                                 RADDAT
     D  io_handle                                 like(HANDLE_handle_t)                       RADDAT
      *                                                                                       SCHOLZ
      *  Allocates a memory cell and keeps track of it.                                       SCHOLZ
     D MEMORY_allocate...                                                                     SCHOLZ
     D                 PR              *                                                      SCHOLZ
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _MEMORY_allocate+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  io_aMemList                    *
     D  i_size                       10I 0 value                                              SCHOLZ
      *                                                                                       SCHOLZ
      *  Frees all allocated memory cells.                                                    SCHOLZ
     D MEMORY_freeAll...                                                                      SCHOLZ
     D                 PR                                                                     SCHOLZ
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _MEMORY_freeAll+
     D                                     ')                                                 RADDAT
     D  io_aMemList                    *
      *                                                                                       RADDAT
      *  Frees all given memory cell.                                                         RADDAT
     D MEMORY_free...                                                                         RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _MEMORY_free+                                      RADDAT
     D                                     ')                                                 RADDAT
     D  io_aMemList                    *                                                      RADDAT
     D  io_pMem                        *                                                      RADDAT
      *                                                                                       RADDAT
     D MemoryManager_manager_t...                                                             RADDAT
     D                 DS                         qualified   based(pDummy)                   RADDAT
     D  pAllocate                      *          procptr                                     RADDAT
     D  pReallocate                    *          procptr                                     RADDAT
     D  pFree                          *          procptr                                     RADDAT
      *                                                                                       RADDAT
      *  Memory Manager -- Returns the default memory manager                                 RADDAT
     D MemoryManager_getDefaultManager...                                                     RADDAT
     D                 PR                  likeds(MemoryManager_manager_t)                    RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _MemoryManager_getDefaultManager+                  RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Memory Manager -- Reserve Storage Block                                              RADDAT
     D MemoryManager_allocate...                                                              RADDAT
     D                 PR              *   extproc('BASICS1R8+                                RADDAT
     D                                     _MemoryManager_allocate+                           RADDAT
     D                                     ')                                                 RADDAT
     D  i_size                       10U 0 value                                              RADDAT
     D  i_heap                       10I 0 value  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Memory Manager -- Change Reserved Storage Block Size                                 RADDAT
     D MemoryManager_reallocate...                                                            RADDAT
     D                 PR              *   extproc('BASICS1R8+                                RADDAT
     D                                     _MemoryManager_reallocate+                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_pMem                         *   value                                              RADDAT
     D  i_size                       10U 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Memory Manager -- Release Storage Blocks                                             RADDAT
     D MemoryManager_free...                                                                  RADDAT
     D                 PR                  extproc('BASICS1R8+                                RADDAT
     D                                     _MemoryManager_free+                               RADDAT
     D                                     ')                                                 RADDAT
     D  io_pMem                        *                                                      RADDAT
      *                                                                                       RADDAT
      *  Memory Manager -- Creates a new heap.                                                RADDAT
     D MemoryManager_createHeap...                                                            RADDAT
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _MemoryManager_createHeap+                         RADDAT
     D                                     ')                                                 RADDAT
     D  i_initialSize                10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_increment                  10I 0 const  options(*nopass: *omit)                     RADDAT
     D  i_allocStrat                 10I 0 const  options(*nopass: *omit)                     RADDAT
      *                                                                                       RADDAT
      *  Memory Manager -- Deletes an existing heap.                                          RADDAT
     D MemoryManager_deleteHeap...                                                            RADDAT
     D                 PR                                                                     RADDAT
     D                                     extproc('BASICS1R8+                                RADDAT
     D                                     _MemoryManager_deleteHeap+                         RADDAT
     D                                     ')                                                 RADDAT
     D  io_heapID                    10I 0                                                    RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R4                   Assert/This                                 RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing PBASICS1R9  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "PBASICS1R9"
mbrtype =  "RPGLE     "
mbrtext =  "SrvPgm: Basic Routines - Display Information      "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(BASICS1R9)
      /DEFINE BASICS1R9
      *                                                                                       RADDAT
      *  Reference Fields                                                                     RADDAT
     D display_mode_t  S              4A   based(pDummy)                                      RADDAT
      *                                                                                       RADDAT
      *  Constants                                                                            RADDAT
     D cDISPLAY_MODE_DS3...                                                                   RADDAT
     D                 C                   const('*DS3')                                      RADDAT
     D cDISPLAY_MODE_DS4...                                                                   RADDAT
     D                 C                   const('*DS4')                                      RADDAT
      *                                                                                       RADDAT
      *  Returns the current display mode.                                                    RADDAT
     D Display_getMode...                                                                     RADDAT
     D                 PR                         like(display_mode_t)                        RADDAT
     D                                     extproc('BASICS1R9+                                RADDAT
     D                                     _Display_getMode+                                  RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Returns cTrue if the display device support 27x132 mode.                             RADDAT
     D Display_supportsDS4...                                                                 RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R9+                                RADDAT
     D                                     _Display_supportsDS4+                              RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Returns cTrue if the display device supports GUI characters.                         RADDAT
     D Display_supportsGUI...                                                                 RADDAT
     D                 PR              N                                                      RADDAT
     D                                     extproc('BASICS1R9+                                RADDAT
     D                                     _Display_supportsGUI+                              RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      *  Returns the number of rows that can be displayed on the screen.                      RADDAT
     D Display_getRows...                                                                     RADDAT
     D                 PR             5I 0                                                    RADDAT
     D                                     extproc('BASICS1R9+                                RADDAT
     D                                     _Display_getRows+                                  RADDAT
     D                                     ')                                                 RADDAT
     D  i_dspMode                          const  like(display_mode_t)                        RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Returns the number of columns that can be displayed on the screen.                   RADDAT
     D Display_getColumns...                                                                  RADDAT
     D                 PR             5I 0                                                    RADDAT
     D                                     extproc('BASICS1R9+                                RADDAT
     D                                     _Display_getColumns+                               RADDAT
     D                                     ')                                                 RADDAT
     D  i_dspMode                          const  like(display_mode_t)                        RADDAT
     D                                            options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Deprecated procedure names                                                           RADDAT
      * -----------------------------------------                                             RADDAT
      *                                                                                       RADDAT
      *  Ermittelt den aktuellen Bildschirmmodus: *DS3 oder *DS4                              RADDAT
     D f_getDisplayMode...                                                                    RADDAT
     D                 PR                         like(display_mode_t)                        RADDAT
     D                                     extproc('BASICS1R9+                                RADDAT
     D                                     _Display_getMode+                                  RADDAT
     D                                     ')                                                 RADDAT
      *                                                                                       RADDAT
      * -----------------------------------------                                             RADDAT
      *  Imported prototypes                                                                  RADDAT
      * -----------------------------------------                                             RADDAT
 CPY  /COPY QBASICS1,PBASICS1R2                   API Error Handling                          RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing QP0LCVTPAT  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "QP0LCVTPAT"
mbrtype =  "RPGLE     "
mbrtext =  "Qp0lCvtPathToQSYSObjName()--Resolve Path          "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
 DEF  /IF NOT DEFINED(Qp0lCvtPathToQSYSObjName)
 DEF  /DEFINE Qp0lCvtPathToQSYSObjName
      *
      *  Qp0lCvtPathToQSYSObjName()--Resolve Integrated File System Path Name
      *                              into QSYS Object Name
     D Qp0lCvtPathToQSYSObjName...
     D                 PR            10I 0 extproc('Qp0lCvtPathToQSYSObjName')
     D  i_path                             const  likeds(Qlg_Path_Name_t)
     D  o_qsys_info               65535A          options(*varsize)
     D  i_format                      8A   const
     D  i_bytPrv                     10I 0 value
     D  i_ccsid                      10I 0 value
     D  io_errCode                65535A          options(*varsize)
      *
     D qsys0100_t      DS                  qualified based(pDummy)
     D  bytRet                 1      4i 0
     D  bytAvl                 5      8i 0
     D  ccsid                  9     12i 0
     D  lib_name              13     40a
     D  lib_type              41     60a
     D  obj_name              61     88a
     D  obj_type              89    108a
     D  mbr_name             109    136a
     D  mbr_type             137    156a
     D  asp_name             157    184a
      *
      /if not defined(Qlg_Path_Name)
      /define Qlg_Path_Name
     D Qlg_Path_Name_t...
     D                 DS                  qualified align         based(pDummy)
     D   CCSID                       10I 0
     D   Country_ID                   2A
     D   Language_ID                  3A
     D   Reserved                     3A
     D   Path_Type                   10U 0
     D   Path_Length                 10I 0
     D   Path_Name_Delimiter...
     D                                2A
     D   Reserved2                   10A
     D   Path_Name                  256A
      *
     D QLG_PATH_JOB_CCSID...
     D                 C                   0
     D QLG_PATH_JOB_COUNTRYID...
     D                 C                   x'0000'
     D QLG_PATH_JOB_LANGUAGEID...
     D                 C                   x'000000'
      *
      *  The Path_Name is a character string and the delimiter is one byte long.
     D QLG_CHAR_SINGLE...
     D                 C                   0
      *
      *  The Path_Name is a pointer and the delimiter is one byte long.
     D QLG_PTR_SINGLE...
     D                 C                   1
      *
      *  The Path_Name is a character string and the delimiter is two bytes long.
     D QLG_CHAR_DOUBLE...
     D                 C                   2
      *
      *  The Path_Name is a pointer and the delimiter is two bytes long.
     D QLG_PTR_DOUBLE...
     D                 C                   3
      *
      /endif
      *
 DEF  /ENDIF
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing QUSRSPC  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "QUSRSPC   "
mbrtype =  "RPGLE     "
mbrtext =  "User Space APIs                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(QUSRSPC)                                                                RADDAT
      /DEFINE QUSRSPC                                                                         RADDAT
      *
      *  Create User Space (QUSCRTUS) API                                                     RADDAT
     D QUSCRTUS...                                                                            RADDAT
     D                 PR                  extpgm('QUSCRTUS')                                 RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  i_extAttr                    10A   const                                              RADDAT
     D  i_initSize                   10I 0 const                                              RADDAT
     D  i_initValue                   1A   const                                              RADDAT
     D  i_pubAuth                    10A   const                                              RADDAT
     D  i_text                       50A   const                                              RADDAT
     D  i_replace                    10A   const options(*nopass)               | optGrp 1    RADDAT
     D  io_ErrCode                65535A         options(*nopass: *varsize)     |             RADDAT
     D  i_domain                     10A   const options(*nopass)               | optGrp 2    RADDAT
     D  i_tfrSizeReq                 10I 0 const options(*nopass)               | optGrp 3    RADDAT
     D  i_optSpcAlgn                  1A   const options(*nopass)               | optGrp 3    RADDAT
      *                                                                                       RADDAT
      *  Change User Space (QUSCHGUS) API                                                     RADDAT
     D QUSCHGUS...                                                                            RADDAT
     D                 PR                  extpgm('QUSCHGUS')                                 RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  i_start                      10I 0 const                                              RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  i_data                    65535A   const options(*varsize)                            RADDAT
     D  i_force                       1A   const                                              RADDAT
     D  io_ErrCode                65535A         options(*nopass: *varsize)     | optGrp 1    RADDAT
      *                                                                                       RADDAT
      *  Retrieve User Space (QUSRTVUS) API                                                   RADDAT
     D QUSRTVUS...                                                                            RADDAT
     D                 PR                  extpgm('QUSRTVUS')                                 RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  i_start                      10I 0 const                                              RADDAT
     D  i_length                     10I 0 const                                              RADDAT
     D  o_rcvVar                  65535A   const options(*varsize)                            RADDAT
     D  io_ErrCode                65535A         options(*nopass: *varsize)     | optGrp 1    RADDAT
      *                                                                                       RADDAT
      *  Retrieve Pointer to User Space (QUSPTRUS) API                                        RADDAT
     D QUSPTRUS...                                                                            RADDAT
     D                 PR                  extpgm('QUSPTRUS')                                 RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  o_pUsrSpc                      *                                                      RADDAT
     D  io_ErrCode                65535A         options(*nopass: *varsize)     | optGrp 1    RADDAT
      *                                                                                       RADDAT
      *  Change User Space Attributes (QUSCUSAT) API                                          RADDAT
     D QUSCUSAT...                                                                            RADDAT
     D                 PR                  extpgm('QUSCUSAT')                                 RADDAT
     D  o_rtnLib                     10A                                                      RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  i_attrs                   65535A   const options(*varsize)                            RADDAT
     D  io_ErrCode                65535A         options(*varsize)                            RADDAT
      *                                                                                       RADDAT
     D QUSRSPC_ATTR_SIZE...                                                                   RADDAT
     D                 C                   1                                    BINARY(4)     RADDAT
     D QUSRSPC_ATTR_INITIAL_VALUE...                                                          RADDAT
     D                 C                   2                                    CHAR(1)       RADDAT
     D QUSRSPC_ATTR_AUTO_EXTEND...                                                            RADDAT
     D                 C                   3                                    CHAR(1)       RADDAT
     D QUSRSPC_ATTR_TRANSFER_SIZE_REQ...                                                      RADDAT
     D                 C                   4                                    BINARY(4)     RADDAT
      *                                                                                       RADDAT
     D QUSRSPC_attr_size_t...                                                                 RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  key                          10I 0                                                    RADDAT
     D  dataLen                      10I 0                                                    RADDAT
     D  size                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
     D QUSRSPC_initial_value_t...                                                             RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  key                          10I 0                                                    RADDAT
     D  dataLen                      10I 0                                                    RADDAT
     D  value                         1A                                                      RADDAT
      *                                                                                       RADDAT
     D QUSRSPC_auto_extend_t...                                                               RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  key                          10I 0                                                    RADDAT
     D  dataLen                      10I 0                                                    RADDAT
     D  autoExtend                    1A                                                      RADDAT
      *                                                                                       RADDAT
     D QUSRSPC_ztansfer_size_req_t...                                                         RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  key                          10I 0                                                    RADDAT
     D  dataLen                      10I 0                                                    RADDAT
     D  tfrSizeReq                   10I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Retrieve User Space Attributes (QUSRUSAT) API                                        RADDAT
     D QUSRUSAT...                                                                            RADDAT
     D                 PR                  extpgm('QUSRUSAT')                                 RADDAT
     D  o_rcvVar                  65535A         options(*varsize)                            RADDAT
     D  i_lenRcvVar                  10I 0 const                                              RADDAT
     D  i_format                      8A   const                                              RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  io_ErrCode                65535A         options(*varsize)                            RADDAT
      *                                                                                       RADDAT
      *  SPCA0100 Format                                                                      RADDAT
     D SPCA0100_t      DS                  qualified               based(pDummy)              RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  size                   9     12I 0                                                    RADDAT
     D  autoExtend            13     13A                                                      RADDAT
     D  initValue             14     14A                                                      RADDAT
     D  usrSpcLib             15     24A                                                      RADDAT
      *                                                                                       RADDAT
      *  Delete User Space (QUSDLTUS) API                                                     RADDAT
     D QUSDLTUS...                                                                            RADDAT
     D                 PR                  extpgm('QUSDLTUS')                                 RADDAT
     D  i_qUsrSpc                    20A   const                                              RADDAT
     D  io_ErrCode                65535A         options(*varsize)                            RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing QWCCVTDT  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "QWCCVTDT  "
mbrtype =  "RPGLE     "
mbrtext =  "Convert Date and Time Format (QWCCVTDT) API       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(QWCCVTDT)                                                               RADDAT
      /DEFINE QWCCVTDT                                                                        RADDAT
      *                                                                                       RADDAT
      *  Convert Date and Time Format (QWCCVTDT) API                                          RADDAT
     D QWCCVTDT...                                                                            RADDAT
     D                 PR                         extpgm('QWCCVTDT')                          RADDAT
     D  i_iFormat                    10A   const                                              RADDAT
     D  i_iValue                  65535A   const options(*varsize)                            RADDAT
     D  i_oFormat                    10A   const                                              RADDAT
     D  o_oValue                  65535A          options(*varsize)                           RADDAT
     D  io_errCode                65535A          options(*varsize)                           RADDAT
     D  i_iTimezone                  10A   const  options(*nopass)              | optGrp 1    RADDAT
     D  i_oTimezone                  10A   const  options(*nopass)              |             RADDAT
     D  o_timezone                65535A          options(*nopass: *varsize)    |             RADDAT
     D  i_lenTimezone                10I 0 const  options(*nopass)              |             RADDAT
     D  i_precInd                     1A   const  options(*nopass)              |             RADDAT
     D  i_iTimeInd                    1A   const  options(*nopass)              | optGrp 2    RADDAT
      *                                                                                       RADDAT
      *  Time Zone Information Value Structure                                                RADDAT
     D QWCCVTDT_timezone_t...                                                                 RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  bytRet                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  desc                   9     18A                                                      RADDAT
     D  reserved_1            19     19A                                                      RADDAT
     D  dayLightInd           20     20A                                                      RADDAT
     D  curOffset             21     24I 0                                                    RADDAT
     D  curFullName           25     74A                                                      RADDAT
     D  curAbbrevName         75     84A                                                      RADDAT
     D  curMsgInd             85     91A                                                      RADDAT
     D  msgFile               92    101A                                                      RADDAT
     D  msgFileLib           102    111A                                                      RADDAT
      *                                                                                       RADDAT
      *  This table shows the structure used for the input and output variables when          RADDAT
      *  the format is *JOB, *SYSVAL, *YMD, *MDY, *DMY, and *JUL and the precision            RADDAT
      *  indicator specifies milliseconds.                                                    RADDAT
     D QWCCVTDT_dateTime_16_t...                                                              RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  century                1      1A                                                      RADDAT
     D  date                   2      7A                                                      RADDAT
     D  time                   8     13A                                                      RADDAT
     D  mSecs                 14     16A                                                      RADDAT
      *                                                                                       RADDAT
      *  This table shows the structure used for the input and output variables when          RADDAT
      *  the format is *YYMD, *MDYY, *DMYY, and *LONGJUL and the precision indicator          RADDAT
      *  specifies milliseconds.                                                              RADDAT
     D QWCCVTDT_dateTime_17_t...                                                              RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  date                   1      8A                                                      RADDAT
     D  time                   9     14A                                                      RADDAT
     D  mSecs                 15     17A                                                      RADDAT
      *                                                                                       RADDAT
      *  This table shows the structure used for the input and output variables when          RADDAT
      *  the format is *JOB, *SYSVAL, *YMD, *MDY, *DMY, and *JUL and the precision            RADDAT
      *  indicator specifies microseconds.                                                    RADDAT
     D QWCCVTDT_dateTime_19_t...                                                              RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  century                1      1A                                                      RADDAT
     D  date                   2      7A                                                      RADDAT
     D  time                   8     13A                                                      RADDAT
     D  mSecs                 14     19A                                                      RADDAT
      *                                                                                       RADDAT
      *  This table shows the structure used for the input and output variables when          RADDAT
      *  the format is *YYMD, *MDYY, *DMYY, and *LONGJUL and the precision indicator          RADDAT
      *  specifies microseconds.                                                              RADDAT
     D QWCCVTDT_dateTime_20_t...                                                              RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  date                   1      8A                                                      RADDAT
     D  time                   9     14A                                                      RADDAT
     D  mSecs                 15     20A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing QWCRSVAL  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "QWCRSVAL  "
mbrtype =  "RPGLE     "
mbrtext =  "Retrieve System Values (QWCRSVAL) API             "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      /IF NOT DEFINED(QWCRSVAL)                                                               RADDAT
      /DEFINE QWCRSVAL                                                                        RADDAT
      *                                                                                       RADDAT
      *  Retrieve System Values (QWCRSVAL) API                                                RADDAT
     D QWCRSVAL...                                                                            RADDAT
     D                 PR                         extpgm('QWCRSVAL')                          RADDAT
     D  o_rcvVar                  65535A          options(*varsize)                           RADDAT
     D  i_lenRcvVar                  10I 0 const                                              RADDAT
     D  i_numSysVal                  10I 0 const                                              RADDAT
     D  i_arySysVal                  10A   const  options(*varsize) dim(128)                  RADDAT
     D  io_errCode                65535A          options(*varsize)                           RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D QWCRSVAL_rtnValue_t...                                                                 RADDAT
     D                 DS          4096    qualified               based(pDummy)              RADDAT
     D  numSysValRtn                 10I 0                                                    RADDAT
     D  ofsSysValTbl                 10I 0 dim(128)                                           RADDAT
      *                                                                                       RADDAT
     D QWCRSVAL_sysValInfTbl_t...                                                             RADDAT
     D                 DS                  qualified   based(pSysValTbl)                      RADDAT
     D  sysVal                       10A                                                      RADDAT
     D  type                          1A                                                      RADDAT
     D  infStatus                     1A                                                      RADDAT
     D  length                       10I 0                                                    RADDAT
     D  data                       4096A                                                      RADDAT
      *                                                                                       RADDAT
      * --------------------------------------------------                                    RADDAT
      *  Pre-defined structures for complex system values                                     RADDAT
      * --------------------------------------------------                                    RADDAT
      *                                                                                       RADDAT
      *  QACGLVL:         Accounting level                                                    RADDAT
     D QWCRSVAL_acgLvl_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(8)                                             RADDAT
      *                                                                                       RADDAT
      *  QALWOBJRST:      Allow object restore options                                        RADDAT
     D QWCRSVAL_alwObjRst_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(15)                                            RADDAT
      *                                                                                       RADDAT
      *  QALWUSRDMN:      Allow user domain                                                   RADDAT
     D QWCRSVAL_alwUsrDmn_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  lib                          10A   dim(50)                                            RADDAT
      *                                                                                       RADDAT
      *  QATNPGM:        Attention program                                                    RADDAT
     D QWCRSVAL_atnPgm_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QAUDCTL:         Auditing control                                                    RADDAT
     D QWCRSVAL_audCtl_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(5)                                             RADDAT
      *                                                                                       RADDAT
      *  QAUDLVL:         Auditing level                                                      RADDAT
     D QWCRSVAL_audLvl_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(16)                                            RADDAT
      *                                                                                       RADDAT
      *  QAUDLVL2:        Auditing level extension                                            RADDAT
     D QWCRSVAL_audLvl2_t...                                                                  RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(99)                                            RADDAT
      *                                                                                       RADDAT
      *  QBOOKPATH:      Book and bookshelf search path                                       RADDAT
     D QWCRSVAL_bookPath_t...                                                                 RADDAT
     D                 DS                  qualified                                          RADDAT
     D  path                         63A   dim(5)                                             RADDAT
      *                                                                                       RADDAT
      *  QCFGMSGQ:       Configuration message queue                                          RADDAT
     D QWCRSVAL_cfgMsgQ_t...                                                                  RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QCHRID:         Character set and code page                                          RADDAT
     D QWCRSVAL_chrID_t...                                                                    RADDAT
     D                 DS                  qualified                                          RADDAT
     D  ccsid                        10A                                                      RADDAT
     D  codePage                     10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QCMNRCYLMT:     Communications recovery limit                                        RADDAT
     D QWCRSVAL_cmnRcyLmt_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  count                        10A                                                      RADDAT
     D  interval                     10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QCTLSBSD:       Controlling subsystem                                                RADDAT
     D QWCRSVAL_ctlSbsD_t...                                                                  RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QDATETIME:      System date and time       (YYYYMMDDHHNNSSXXXXXX)                    RADDAT
     D QWCRSVAL_dateTime_t...                                                                 RADDAT
     D                 DS                  qualified                                          RADDAT
     D  date                          8A                                                      RADDAT
     D  time                          6A                                                      RADDAT
     D  mSecs                         6A                                                      RADDAT
      *                                                                                       RADDAT
      *  QIGCCDEFNT:     Double-byte coded font name                                          RADDAT
     D QWCRSVAL_igcCdeFnt_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QINACTMSGQ:   Inactive message queue                                                 RADDAT
     D QWCRSVAL_inActMsgQ_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QIPLDATTIM:   Automatic IPL date and time  (value = CYYMMDDHHMMSS)                   RADDAT
     D QWCRSVAL_iplDatTim_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  spcVal                 1     10A                                                      RADDAT
     D  value                  1     13A                                                      RADDAT
      *                                                                                       RADDAT
      *  QPRBFTR:      Problem filter                                                         RADDAT
     D QWCRSVAL_prbFtr_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QPWDVLDPGM:   Password validation program                                            RADDAT
     D QWCRSVAL_pwdVldPgm_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QRMTSIGN:     Remote sign-on                                                         RADDAT
     D QWCRSVAL_rmtSign_t...                                                                  RADDAT
     D                 DS                  qualified                                          RADDAT
     D  spcVal                       10A                                                      RADDAT
     D  pgm                          10A   overlay(spcVal)                                    RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QSCANFS:      Scan file systems                                                      RADDAT
     D QWCRSVAL_scanFS_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(20)                                            RADDAT
      *                                                                                       RADDAT
      *  QSCANFSCTL:   Scan file systems control                                              RADDAT
     D QWCRSVAL_scanFSCtl_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  option                       10A   dim(20)                                            RADDAT
      *                                                                                       RADDAT
      *  QSETJOBATR:   Set job attributes from locale                                         RADDAT
     D QWCRSVAL_setJobAtr_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  attr                         10A   dim(16)                                            RADDAT
      *                                                                                       RADDAT
      *  QSRTSEQ:      Sort sequence table                                                    RADDAT
     D QWCRSVAL_srtSeq_t...                                                                   RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QSTRUPPGM:    Startup program name                                                   RADDAT
     D QWCRSVAL_strUpPgm_t...                                                                 RADDAT
     D                 DS                  qualified                                          RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
      *  QSYSLIBL:     System library list                                                    RADDAT
     D QWCRSVAL_sysLibl_t...                                                                  RADDAT
     D                 DS                  qualified                                          RADDAT
     D  lib                          10A   dim(15)                                            RADDAT
      *                                                                                       RADDAT
      *  QUSRLIBL:     User library list                                                      RADDAT
     D QWCRSVAL_usrLibl_t...                                                                  RADDAT
     D                 DS                  qualified                                          RADDAT
     D  lib                          10A   dim(25)                                            RADDAT
      *                                                                                       RADDAT
      *  QUTCOFFSET:   Coordinated universal time offset                                      RADDAT
     D QWCRSVAL_utcOffset_t...                                                                RADDAT
     D                 DS                  qualified                                          RADDAT
     D  timeZoneID                    1A                                                      RADDAT
     D  hours                         2A                                                      RADDAT
     D  minutes                       2A                                                      RADDAT
      *                                                                                       RADDAT
      /ENDIF                                                                                  RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_F000  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_F000 "
mbrtype =  "RPGLE     "
mbrtext =  "Test: Template fr Testprogramme                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
 RAD  *===============================================================*                       RADDAT
 RAD  *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
 RAD  *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
 RAD  *                              SRCFILE(&SL/&SF) +               *                       RADDAT
 RAD  *                              SRCMBR(&SM);                     *                       RADDAT
 RAD  *                                                               *                       RADDAT
 RAD  *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *                       RADDAT
 RAD  *     >>END-COMPILE<<                                           *                       RADDAT
 RAD  *                                                               *                       RADDAT
 RAD  *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
 RAD  *                                                               *                       RADDAT
 RAD  *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_F000')                         RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RA_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RA_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicList_*                                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RA_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
     D cTYPE_TEST...
     D                 C                   const('*TEST')
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RA_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
     D sort...
     D                 PR            10I 0                                                    RADDAT
     D                                     extproc('sort')
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                            inz
     D hList           S                   like(BasicList_handle_t )  inz
     D isValid         S               N                              inz
     D isSorted        S               N                              inz
     D listType        S                   like(BasicList_type_t  )   inz
     D entryType       S                   like(BasicList_type_t  )   inz
     D aString         S           4096A   varying                    inz
     D aField          S             20A                        based(paField)
     D numE            S             10I 0                            inz                     RADDAT
     D aSize           S             10I 0                            inz                     RADDAT
     D anArray         DS                  dim(10)   qualified
     D  size                               like(aSize        )        inz
     D  trimSize                           like(aSize        )        inz
     D  data                               like(aField       )        inz
     D bufferCheck     S            128A                                                      RADDAT
      *                                                                                       RADDAT
     D aSortedArray    S             20A   dim(10) inz
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      )        inz                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize Array                                                                //RADDAT
         anArray( 1).data = 'Donald Duck';
         anArray( 2).data = 'Dagobert Duck';
         anArray( 3).data = 'Tick';
         anArray( 4).data = 'Trick';
         anArray( 5).data = 'Track';
         anArray( 6).data = 'Daisy';
         anArray( 7).data = 'Klaas Klever';
         anArray( 8).data = 'Daniel Dsentrieb';
         anArray( 9).data = 'Micky Maus';
         anArray(10).data = 'Goofy';
                                                                                            //RADDAT
         // Initialize the sort Array
 B01     for x = 1 to %elem(anArray);
            aSortedArray(x) = anArray(x).data;
 E01     endfor;
         sorta aSortedArray;
                                                                                            //RADDAT
         // Set size of trimmed field data                                                  //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            anArray(x).size     = %len(anArray(x).data);
            anArray(x).trimSize = %len(%trimR(anArray(x).data));
            p_assert(anArray(x).size <> anArray(x).trimSize
                     : 'Size and trimmed size must be different');
 E01     endfor;
                                                                                            //RADDAT
         // Create BasicList                                                                //RADDAT
         hList = BasicList_new(cTYPE_TEST);
                                                                                            //RADDAT
         // Add elements to list                                                            //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            BasicList_add(hList: anArray(x).data);
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Verify elements in list                                                         //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            paField = BasicList_get(hList: x);
            aSize   = BasicList_getSize(hList: x);
            p_assert(aSize = %len(anArray(1).data)
                     : 'Field size does not match expected size of 20');
            p_assert(%subst(aField: 1: aSize) = anArray(x).data
                     : 'Field contents do not match');                                      //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Trim elements in list
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            paField = BasicList_get(hList: x);
            BasicList_set(hList: x: %addr(anArray(x).data):anArray(x).trimSize);
 E01     endfor;
                                                                                            //RADDAT
         // Verify elements in list                                                         //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            paField = BasicList_get(hList: x);
            aSize   = BasicList_getSize(hList: x);
            p_assert(aSize = anArray(x).trimSize
                     : 'Field size does not match expected size');
            p_assert(%subst(aField: 1: aSize) = anArray(x).data
                     : 'Field contents do not match');                                      //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Sort list
         isSorted = BasicList_sort(hList: %paddr('sort'));
         isSorted = BasicList_sort(hList: %paddr('sort'));
         p_assert(isSorted = cTrue:
                  'Variable isSorted does not match expected value: cTrue');
                                                                                            //RADDAT
         // Verify element order
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            paField = BasicList_get(hList: x);
            p_assert(%str(paField) = aSortedArray(x)
                     : 'List order does not match expected order');
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Find a liste entry
         x = BasicList_find(hList: 'Trick');
         p_assert(x > 0
                  : 'List entry ''Trick'' not found');
         paField = BasicList_get(hList: x);
         p_assert(%str(paField) = 'Trick'
                  : 'List entry ''Trick'' contains invalid data');
                                                                                            //RADDAT
         // Change elements to new size 3
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            paField = BasicList_get(hList: x);
            BasicList_set(hList: x: %addr(anArray(x).data): 3);
 E01     endfor;
                                                                                            //RADDAT
         // Verify elements in list                                                         //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            paField = BasicList_get(hList: x);
            aSize   = BasicList_getSize(hList: x);
            p_assert(aSize = 3
                     : 'Field size does not match expected size');
            p_assert(%subst(aField: 1: aSize) = %subst(anArray(x).data: 1: 3)
                     : 'Field contents do not match');                                      //RADDAT
            p_assert(%subst(aField: 4: 13) = *ALLx'00'
                     : 'Field has not been properly cleared');
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Verify number of elements in list                                               //RADDAT
         p_assert(BasicList_getNumE(hList) = 10
                  : 'Number of elements in list does not match +
                     expected number of 10');                                               //RADDAT
                                                                                            //RADDAT
         // Add a string to the list                                                        //RADDAT
         x = BasicList_addString(hList: 'Hello World');                                     //RADDAT

         isValid = BasicList_isTypeOf(hList: x: cBASICLIST_TYPE_VSTRING);
         p_assert(isValid
                  : '''Hello World'' is not of type VARYING');

         entryType = BasicList_getType(hList: x);
         p_assert(entryType = cBASICLIST_TYPE_VSTRING
                  : '''Hello World'' is not of type STRING (varying)');
                                                                                            //RADDAT
         // Get a string from the list                                                      //RADDAT
         aString = BasicList_getString(hList: x);                                           //RADDAT
                                                                                            //RADDAT
         p_assert(aString = 'Hello World'
                  : 'String contains wrong value');                                         //RADDAT
                                                                                            //RADDAT
         // Search the list for a string
         x = BasicList_findString(hList: 'Hello World');
         p_assert(x > 0
                  : 'List entry ''Hello World'' not found');
         aString = BasicList_getString(hList: x);
         p_assert(aString = 'Hello World'
                  : 'List entry ''Hello World'' contains invalid data');
                                                                                            //RADDAT
         // Remove the string from the list                                                 //RADDAT
         BasicList_remove(hList: x);
                                                                                            //RADDAT
         // Check invalid values                                                            //RADDAT
         paField = BasicList_get(hList: 99);
         p_assert(paField = *NULL
                  : 'paField should be NULL');
                                                                                            //RADDAT
         aString = BasicList_getString(hList: 99);
         p_assert(aString = ''
                  : 'aString should be empty');
                                                                                            //RADDAT
         aSize = BasicList_getSize(hList: 99);
         p_assert(aSize = -1
                  : 'aSize should be -1');
                                                                                            //RADDAT
         // Check list type                                                                 //RADDAT
         isValid = BasicList_isListTypeOf(hList: '*TEST');
         p_assert(isValid
                  : 'List type does not match expected value of ' + cTYPE_TEST);
         listType = BasicList_getListType(hList);
         p_assert(listType = cTYPE_TEST
                  : 'List type does not match expected value of ' + cTYPE_TEST);
                                                                                            //RADDAT
         // Set auto-sort option
         BasicList_setAutoSort(hList: %paddr('sort'));
                                                                                            //RADDAT
         // Add some more entries
         x = BasicList_add(hList: 'aaa');
         x = BasicList_add(hList: 'bbb');
         x = BasicList_add(hList: 'ccc');
                                                                                            //RADDAT
         // These entries should be the first entries in the list.
         paField = BasicList_get(hList: 3);
         p_assert(%str(paField) = 'ccc'
                  : 'ccc is not at the expected position in the list');
                                                                                            //RADDAT
         paField = BasicList_get(hList: 2);
         p_assert(%str(paField) = 'bbb'
                  : 'bbb is not at the expected position in the list');
                                                                                            //RADDAT
         paField = BasicList_get(hList: 1);
         p_assert(%str(paField) = 'aaa'
                  : 'aaa is not at the expected position in the list');
                                                                                            //RADDAT
         // Buffer resize check                                                             //RADDAT
         bufferCheck = *ALL'*';                                                             //RADDAT
         x = BasicList_add(hList: %addr(bufferCheck): 32);                                  //RADDAT
         BasicList_get(hList: x:  %addr(bufferCheck): %size(bufferCheck) - 1);              //RADDAT
         p_assert(%subst(bufferCheck:  1: 32) = *ALL'*');                                   //RADDAT
         p_assert(%subst(bufferCheck: 33: %size(bufferCheck) - 33)= *ALLx'00');             //RADDAT
         p_assert(%subst(bufferCheck: %size(bufferCheck): 1) = *ALL'*');                    //RADDAT
                                                                                            //RADDAT
         // Add element and increase its size                                               //RADDAT
         BasicList_setAutoSort(hList: *NULL);

         x = BasicList_add(hList: 'HelloWorld');
         aSize   = BasicList_getSize(hList: x);
         p_assert(aSize = 10
                  : 'Field size does not match expected size of 10');

         BasicList_set(hList: x: 'Hello World!');
         aSize   = BasicList_getSize(hList: x);
         p_assert(aSize = 12
                  : 'Field size does not match expected size of 12');

         BasicList_set(hList: x: 'Hello World! I love you.');
         aSize   = BasicList_getSize(hList: x);
         p_assert(aSize = 24
                  : 'Field size does not match expected size of 24');
                                                                                            //RADDAT
         // Delete list                                                                     //RADDAT
         BasicList_delete(hList);                                                           //RADDAT
                                                                                            //RADDAT
         p_assert(hList = BasicList_null()
                  : 'List handle not set to NULL');                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Sort procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P sort...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D sort...                                                                                RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D rc              S             10I 0 inz
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D key             S            128A   based(i_pKeyData )
     D elem            S            128A   based(i_pElemData)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     select;
         when %subst(key: 1: i_keySize) > %subst(elem: 1: i_elemSize);
            rc = 1;
         when %subst(key: 1: i_keySize) < %subst(elem: 1: i_elemSize);
            rc = -1;
 X01     other;
            rc = 0;
 E01     endsl;
                                                                                            //RADDAT
         return rc;                                                                         //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sort...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RA_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RA_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicList_*  (NULL)                         "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RA_02)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
     D cTYPE_TEST...
     D                 C                   const('*TEST')
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RA_02')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                            inz
     D numE            S             10I 0                            inz
     D hList           S                   like(BasicList_handle_t )  inz
     D anArray         DS                  dim(10)   qualified                                RADDAT
     D  data                               like(aString      )        inz                     RADDAT
     D aString         S             32A   varying                    inz                     RADDAT
      *                                                                                       RADDAT
     D elem            DS                  qualified
     D  isNull                       10I 0 inz
     D  isNotNull                    10I 0 inz
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      )        inz                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize Array                                                                //RADDAT
         anArray( 1).data = 'Donald Duck';
         anArray( 2).data = 'Dagobert Duck';
         anArray( 3).data = 'Tick';
         anArray( 4).data = 'Trick';
         anArray( 5).data = 'Track';
         anArray( 6).data = 'Daisy';
         anArray( 7).data = 'Klaas Klever';
         anArray( 8).data = 'Daniel Dsentrieb';
         anArray( 9).data = 'Micky Maus';
         anArray(10).data = 'Goofy';
                                                                                            //RADDAT
         // Create BasicList                                                                //RADDAT
         hList = BasicList_new(cTYPE_TEST);
                                                                                            //RADDAT
         // Add elements to list                                                            //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            BasicList_addString(hList: anArray(x).data);                                    //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Verify elements in list                                                         //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            aString = BasicList_getString(hList: x);                                        //RADDAT
            p_assert(aString = anArray(x).data
                     : 'Field contents do not match');                                      //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Add a NULL values
         x = BasicList_addNull(hList);
         p_assert(x = %elem(anArray) + 1
                  : 'Unexpected number of elements in BasicList');                          //RADDAT

         x = BasicList_getNumE(hList);
         p_assert(x = %elem(anArray) + 1
                  : 'Unexpected number of elements in BasicList');                          //RADDAT
                                                                                            //RADDAT
         // Test the latest element for a NULL value
         p_assert(BasicList_isNullValue(hList: x)
                  : 'BasicList_isNullValue returned invalid value');
                                                                                            //RADDAT
         // Test the last string element for a NULL value
         p_assert(not BasicList_isNullValue(hList: %elem(anArray))
                  : 'BasicList_isNullValue returned invalid value');
                                                                                            //RADDAT
         // Set some element to NULL
         numE = BasicList_getNumE(hList);
         BasicList_setNull(hList: 3);
         BasicList_setNull(hList: 6);
         BasicList_setNull(hList: 8);
                                                                                            //RADDAT
         // Verify number of elements                                                       //RADDAT
         p_assert(BasicList_getNumE(hList) = numE
                  : 'List contains invalid number of elements');
                                                                                            //RADDAT
         // Count NULL and non-NULL values                                                  //RADDAT
 B01     for x = 1 to BasicList_getNumE(hList);
 B02        if (BasicList_isNullValue(hList: x));
               elem.isNull = elem.isNull + 1;
               p_assert(x = 3 or x = 6 or x = 8 or x = 11
                        : 'Found element that should not be NULL');
 X02        else;
               elem.isNotNull = elem.isNotNull + 1;
 E02        endif;
 E01     endfor;

         p_assert(elem.isNull = 4
                  : 'List contains invalid number of NULL elements');
         p_assert(elem.isNotNull = 7
                  : 'List contains invalid number of non-NULL elements');
                                                                                            //RADDAT
         // Delete list                                                                     //RADDAT
         BasicList_delete(hList);                                                           //RADDAT
                                                                                            //RADDAT
         p_assert(hList = BasicList_null()
                  : 'List handle not set to NULL');                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RA_03  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RA_03"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicList_clone                             "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RA_03)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D hList_t         DS                  qualified   based(pDummy)   align                  RADDAT
     D  intType                      20U 0                                                    RADDAT
     D  intSize                      10U 0                                                    RADDAT
     D  extType                            like(BasicList_type_t  )                           RADDAT
     D  memSize                      10U 0                                                    RADDAT
     D  numE                         10U 0                                                    RADDAT
     D  maxNumE                      10U 0                                                    RADDAT
     D  totalMemSize                 10U 0                                                    RADDAT
     D  increment                    10U 0                                                    RADDAT
      /IF NOT DEFINED(*V5R2M0)                                                                RADDAT
     D  signature                          like(signature_t)                                  RADDAT
     D  sortSignature                      like(signature_t)                                  RADDAT
      /ELSE                                                                                   RADDAT
     D  signature                          likeds(signature_t)                                RADDAT
     D  sortSignature                      likeds(signature_t)                                RADDAT
      /ENDIF                                                                                  RADDAT
     D  pBase                          *                                                      RADDAT
     D  pAutoSortFnc                   *   procptr                                            RADDAT
      *                                                                                       RADDAT
    * *signature_t     DS                  qualified   based(pDummy)   align                  RADDAT
    * * tmStmp                         Z                                                      RADDAT
    * * counter                      10U 0                                                    RADDAT
      *                                                                                       RADDAT
     D signature_t     DS                  qualified   based(pDummy)                          RADDAT
     D  time                         10U 0                                                    RADDAT
     D  millitm                      10U 0                                                    RADDAT
     D  counter                      10U 0                                                    RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
     D cTYPE_TEST...
     D                 C                   const('*TEST')
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RA_03')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                            inz
     D numE            S             10I 0                            inz
     D hList           S                   like(BasicList_handle_t )  inz
     D hClonedList     S                   like(BasicList_handle_t )  inz                     RADDAT
     D anArray         DS                  dim(10)   qualified                                RADDAT
     D  data                               like(aString      )        inz                     RADDAT
     D aString         S             32A   varying                    inz                     RADDAT
     D aString2        S             32A   varying                    inz                     RADDAT
      *                                                                                       RADDAT
     D handle1         DS                  likeds(hList_t ) based(hList       )               RADDAT
     D handle2         DS                  likeds(hList_t ) based(hClonedList )               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize Array                                                                //RADDAT
         anArray( 1).data = 'Donald Duck';
         anArray( 2).data = 'Dagobert Duck';
         anArray( 3).data = 'Tick';
         anArray( 4).data = 'Trick';
         anArray( 5).data = 'Track';
         anArray( 6).data = 'Daisy';
         anArray( 7).data = 'Klaas Klever';
         anArray( 8).data = 'Daniel Dsentrieb';
         anArray( 9).data = 'Micky Maus';
         anArray(10).data = 'Goofy';
                                                                                            //RADDAT
         // Create BasicList                                                                //RADDAT
         hList = BasicList_new(cTYPE_TEST);
                                                                                            //RADDAT
         // Add elements to list                                                            //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            BasicList_addString(hList: anArray(x).data);                                    //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Verify elements in list                                                         //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            aString = BasicList_getString(hList: x);                                        //RADDAT
            p_assert(aString = anArray(x).data
                     : 'Field contents do not match');                                      //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Add a NULL values
         x = BasicList_addNull(hList);
         p_assert(x = %elem(anArray) + 1
                  : 'Unexpected number of elements in BasicList');                          //RADDAT

         x = BasicList_getNumE(hList);
         p_assert(x = %elem(anArray) + 1
                  : 'Unexpected number of elements in BasicList');                          //RADDAT
                                                                                            //RADDAT
         // Test the latest element for a NULL value
         p_assert(BasicList_isNullValue(hList: x)
                  : 'BasicList_isNullValue returned invalid value');
                                                                                            //RADDAT
         // Clone the list                                                                  //RADDAT
         hClonedList = BasicList_clone(hList);                                              //RADDAT
                                                                                            //RADDAT
         // Compare handles                                                                 //RADDAT
         p_assert(handle1.intType        = handle2.intType        );                        //RADDAT
         p_assert(handle1.intSize        = handle2.intSize        );                        //RADDAT
         p_assert(handle1.extType        = handle2.extType        );                        //RADDAT
         p_assert(handle1.memSize        = handle2.memSize        );                        //RADDAT
         p_assert(handle1.numE           = handle2.numE           );                        //RADDAT
         p_assert(handle1.maxNumE        = handle2.maxNumE        );                        //RADDAT
         p_assert(handle1.totalMemSize   = handle2.totalMemSize   );                        //RADDAT
         p_assert(handle1.increment      = handle2.increment      );                        //RADDAT
         p_assert(handle1.signature     <> handle2.signature      );                        //RADDAT
         p_assert(handle1.sortSignature <> handle2.sortSignature  );                        //RADDAT
         p_assert(handle1.pBase         <> handle2.pBase          );                        //RADDAT
         p_assert(handle1.pAutoSortFnc   = handle2.pAutoSortFnc   );                        //RADDAT
                                                                                            //RADDAT
         // Check entries of cloned list                                                    //RADDAT
 B01     for x = 1 to BasicList_getNumE(hList);                                             //RADDAT
            aString  = BasicList_getString(hList: x);                                       //RADDAT
            aString2 = BasicList_getString(hClonedList: x);                                 //RADDAT
            p_assert(aString = aString2
                     : 'List entries do not match');                                        //RADDAT
            p_assert(BasicList_isNullValue(hList: x) =
                     BasicList_isNullValue(hClonedList: x)
                     : 'NULL values do not match');                                         //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Delete list                                                                     //RADDAT
         BasicList_delete(hList);                                                           //RADDAT
                                                                                            //RADDAT
         p_assert(hList = BasicList_null()
                  : 'List handle not set to NULL');                                         //RADDAT
                                                                                            //RADDAT
         // Delete cloned list                                                              //RADDAT
         BasicList_delete(hClonedList);                                                     //RADDAT
                                                                                            //RADDAT
         p_assert(hClonedList = BasicList_null()
                  : 'Cloned list handle not set to NULL');                                  //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RB_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RB_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicStack_*                                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RB_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RB_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                           inz
     D hStack          S                   like(BasicStack_handle_t) inz
     D nbrOfElm        S             10I 0                      inz                           RADDAT
     D aSize           S             10I 0                      inz                           RADDAT
     D aField          S             20A                             inz
     D aField1         S             20A                             inz
     D aField2         S                   like(aField1      )  based(paField2)
     D aPointer        S               *                             inz
     D anArray         DS                  dim(10)   qualified
     D  size                               like(aSize        )       inz
     D  trimSize                           like(aSize        )       inz
     D  data                               like(aField1      )       inz
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      )  inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize Array                                                                //RADDAT
         anArray( 1).data = 'Donald Duck';
         anArray( 2).data = 'Dagobert Duck';
         anArray( 3).data = 'Tick';
         anArray( 4).data = 'Trick';
         anArray( 5).data = 'Track';
         anArray( 6).data = 'Daisy';
         anArray( 7).data = 'Klaas Klever';
         anArray( 8).data = 'Daniel Dsentrieb';
         anArray( 9).data = 'Micky Maus';
         anArray(10).data = 'Goofy';
                                                                                            //RADDAT
         // Set size of trimmed field data                                                  //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            anArray(x).size     = %len(anArray(x).data);
            anArray(x).trimSize = %len(%trimR(anArray(x).data));
            p_assert(anArray(x).size <> anArray(x).trimSize
                     : 'Size and trimmed size must be different');
 E01     endfor;
                                                                                            //RADDAT
         // Create BasicStack                                                               //RADDAT
         hStack = BasicStack_new();
                                                                                            //RADDAT
         // Add elements to stack                                                           //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            BasicStack_push(hStack: anArray(x).data);
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Verify number of elements on stack
         nbrOfElm = BasicStack_getNumE(hStack);
         p_assert(nbrOfElm = %elem(anArray)
                  : 'Number of elements on stack does not match expected +
                     number of ' + %char(%elem(anArray)));
                                                                                            //RADDAT
         // Remove elements from stack and verify element data
 B01     for x = %elem(anArray) downto 1;
            aPointer = BasicStack_pop(hStack: %addr(aField1): %size(aField1));
            p_assert(%subst(aField1: 1: anArray(x).size) =
                     %subst(anArray(x).data : 1: anArray(x).trimSize)
                     : 'Entry data does not match');
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Add elements to stack                                                           //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            BasicStack_push(hStack: anArray(x).data);
 E01     endfor;                                                                            //RADDAT

         // Remove elements from stack and verify element data
         // (reallocate memory for aField2)
 B01     for x = %elem(anArray) downto 1;
            paField2 = %alloc(%size(aField2));
            aField2  = *all'=';
            aSize    = BasicStack_getSize(hStack);
            aPointer = BasicStack_pop(hStack: paField2: aSize);
            p_assert(%subst(aField2: 1: anArray(x).size) =
                     %subst(anArray(x).data : 1: anArray(x).trimSize)
                     : 'Entry data does not match');
 E01     endfor;
                                                                                            //RADDAT
         // Verify number of elements on stack
         nbrOfElm = BasicStack_getNumE(hStack);
         p_assert(nbrOfElm = 0
                  : 'Number of elements on stack does not match expected +
                     number of ' + %char(%elem(anArray)));
                                                                                            //RADDAT
         // Delete stack
         BasicStack_delete(hStack);
                                                                                            //RADDAT
         // Create a fresh BasicStack
         hStack = BasicStack_new();
                                                                                            //RADDAT
         // Check auto-extension of stack
         aField = 'auto-extension check';
         for x = 1 to 1000;
            BasicStack_push(hStack: %addr(aField): %size(aField));
         endfor;

         x = 0;
         dow (BasicStack_getNumE(hStack) > 0);
            BasicStack_pop(hStack: %addr(aField): %size(aField));
            x = x + 1;
         enddo;

         p_assert(x = 1000
                  : 'Did not remove expected number of elements from stack');
         p_assert(BasicStack_getNumE(hStack) = 0
                  : 'Stack should have been empty');
                                                                                            //RADDAT
         // Delete stack
         BasicStack_delete(hStack);
                                                                                            //RADDAT
         p_assert(hStack = BasicStack_null()
                  : 'Stack handle not set to NULL');
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RC_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RC_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicMap_*                                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RC_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RC_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                           inz
     D y               S             10I 0                           inz
     D hMap            S                   like(BasicMap_handle_t  ) inz
     D nbrOfElm        S             10I 0                      inz                           RADDAT
     D aSize           S             10I 0                      inz                           RADDAT
     D aField          S           3000A                             inz                      RADDAT
     D aPointer        S               *                             inz
     D isFound         S               N                             inz
     D anArray         DS                  dim(10)   qualified
     D  size                               like(aSize        )       inz
     D  trimSize                           like(aSize        )       inz
     D  data                               like(aField       )       inz
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      )  inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Initialize Array                                                                //RADDAT
         anArray( 1).data = 'Donald Duck';                                                  //RADDAT
         anArray( 2).data = 'Dagobert Duck';                                                //RADDAT
         anArray( 3).data = 'Tick';                                                         //RADDAT
         anArray( 4).data = 'Trick';                                                        //RADDAT
         anArray( 5).data = 'Track';                                                        //RADDAT
         anArray( 6).data = 'Daisy';                                                        //RADDAT
         anArray( 7).data = 'Klaas Klever';                                                 //RADDAT
         anArray( 8).data = 'Daniel Dsentrieb';                                            //RADDAT
         anArray( 9).data = 'Micky Maus';                                                   //RADDAT
         anArray(10).data = 'Goofy';                                                        //RADDAT
                                                                                            //RADDAT
         // Set size of trimmed field data                                                  //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            anArray(x).size     = %len(anArray(x).data);
            anArray(x).trimSize = %len(%trimR(anArray(x).data));
            p_assert(anArray(x).size <> anArray(x).trimSize                                 //RADDAT
                     : 'Size and trimmed size must be different');                          //RADDAT
 E01     endfor;
                                                                                            //RADDAT
         // Create BasicMap                                                                 //RADDAT
         hMap = BasicMap_new();
                                                                                            //RADDAT
         // Add elements to map                                                             //RADDAT
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            y = %elem(anArray) - x + 1;
            BasicMap_put(hMap: 'Element_' + %editc(y: 'X')
                             : %addr(anArray(x).data)
                             : anArray(x).trimSize   );
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Verify number of elements on stack
         nbrOfElm = BasicMap_getNumE(hMap);
         p_assert(nbrOfElm = %elem(anArray)
                  : 'Number of elements on stack does not match expected +
                     number of ' + %char(%elem(anArray)));
                                                                                            //RADDAT
         // Search map for key 'Element_0000000003'
         x = 3;
         aPointer = BasicMap_get(hMap: 'Element_' + %editc(x: 'X')
                                     : %addr(aField)
                                     : %size(aField));
                                                                                            //RADDAT
         p_assert(aPointer <> *NULL
                  : 'Entry not found: ' + 'Element_3');
                                                                                            //RADDAT
         // Check map for key 'Element_0000000007'
         x = 7;
         isFound = BasicMap_containsKey(hMap: 'Element_' + %editc(x: 'X'));
                                                                                            //RADDAT
         p_assert(isFound
                  : 'Entry not found: ' + 'Element_7');
                                                                                            //RADDAT
         // Check map for key 'Element_99'
         x = 99;
         isFound = BasicMap_containsKey(hMap: 'Element_' + %editc(x: 'X'));
                                                                                            //RADDAT
         p_assert(not isFound
                  : 'Entry found: ' + 'Element_99');
                                                                                            //RADDAT
         // Get element by index
 B01     for x = 1 to %elem(anArray);                                                       //RADDAT
            y = %elem(anArray) - x + 1;
            aPointer = BasicMap_getValueByIndex(hMap: x
                                                    : %addr(aField)
                                                    : %size(aField));
            p_assert(aPointer <> *NULL
                     : 'Entry not found: ' + 'index=4');
            p_assert(%str(aPointer) = anArray(y).data
                     : 'Element contains invalid data');
 E01     endfor;
                                                                                            //RADDAT
         // Change size of data                                                             //RADDAT
         BasicMap_put(hMap: 'ChangeSize': 'HelloWorld');                                    //RADDAT
         p_assert(BasicMap_getSize(hMap: 'ChangeSize') = 10);                               //RADDAT
                                                                                            //RADDAT
         BasicMap_put(hMap: 'ChangeSize': 'Hello World!');                                  //RADDAT
         p_assert(BasicMap_getSize(hMap: 'ChangeSize') = 12);                               //RADDAT
                                                                                            //RADDAT
         // Delete map
         BasicMap_delete(hMap);
                                                                                            //RADDAT
         p_assert(hMap = BasicMap_null()
                  : 'Map handle not set to NULL');
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RC_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RC_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicMap - Memory Leaks                     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RC_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RC_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
     D getOutstandingHeapAllocations...
     D                 PR            20I 0                                                    RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Returns the number of outstanding heap allocations.                                  RADDAT
      *===============================================================*                       RADDAT
     P getOutstandingHeapAllocations...                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D getOutstandingHeapAllocations...                                                       RADDAT
     D                 PI            20I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D outAllocs       S             20I 0 inz
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz
     D tplSize         S             10I 0 inz
     D MAGP_AG_Attr    DS                  likeds(MAGP_Template_t  ) inz                      RADDAT
     D heapIdTpl       DS                  likeds(heapIdTpl_t     ) inz
     D MAGP_AG_Heap_List...
     D                 DS                  likeds(MAGP_Template_t )
     D                                     based(pMAGP_AG_Heap_List)
     D Heap_List_Buffer...
     D                 S           1024A   inz(*ALLx'00')
     D MAGP_Heap_Space_Attr...
     D                 DS                  likeds(MAGP_Heap_Space_Attr_t) inz
     D Heap_List_Entry...
     D                 S                   like(MAGP_Template_t.Heap_List_1)
     D                                     based(pHeap_List_Entry)
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
     D MAGP_Template_t...                                                                     RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  bytPrv                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  reserved_1             9     16A                                                      RADDAT
      *  union:                                                                               RADDAT
     D  Basic_Attr                         likeds(MAGP_AG_Attr_t)                             RADDAT
     D  Heap_List_1                  10I 0 overlay(Basic_Attr)                                RADDAT
     D  Act_List_1                   20U 0 overlay(Basic_Attr)                                RADDAT
      *
     D MAGP_actGrpMark_t...                                                                   RADDAT
     D                 S             20U 0                         based(pDummy)              RADDAT
      *                                                                                       RADDAT
     D MAGP_AG_Attr_t...                                                                      RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  rootProgram            1     16*                                                      RADDAT
     D  reserved_1            17     32A                                                      RADDAT
     D  stgAdrRclKey          33     48*                                                      RADDAT
     D  actGrpName            49     78A                                                      RADDAT
     D  reserved_2            79     80A                                                      RADDAT
     D  actGrpMark            81     84U 0                                                    RADDAT
     D  reserved_3            85     88A                                                      RADDAT
     D  heapSpcCnt            89     92U 0                                                    RADDAT
     D  actCnt                93     96U 0                                                    RADDAT
     D  staticStgSize         97    100U 0                                                    RADDAT
     D  autoStgSize          101    104U 0                                                    RADDAT
     D  attrs                105    105A                                                      RADDAT
     D  pagMbrShpAdvA        106    106A                                                      RADDAT
     D  reserved_7           107    112A                                                      RADDAT
     D  actGrpMark2          113    120U 0                                                    RADDAT
      *
     D cMATAGPAT_ATTR_BASIC_ACTGRP_ATTR...                                                    RADDAT
     D                 C                   x'00'                                              RADDAT
     D cMATAGPAT_ATTR_BASIC_ACTGRP_HEAP_LIST...                                               RADDAT
     D                 C                   x'01'                                              RADDAT
      *                                                                                       RADDAT
      *  Materialize Activation Group Attributes (MATAGPAT)                                   RADDAT
     D matagpat2...                                                                           RADDAT
     D                 PR                  extproc('_MATAGPAT2')                              RADDAT
     D  o_rcvVar                       *   value                                              RADDAT
     D  i_actGrpMark                       const  like(MAGP_actGrpMark_t)                     RADDAT
     D  i_attrSlc                     3U 0 const                                              RADDAT
      *                                                                                       RADDAT
     D heapIdTpl_t     DS                  qualified   align       based(pDummy)              RADDAT
     D  actGrpMark                         like(MAGP_actGrpMark_t)                            RADDAT
     D  reserved_1                    4A                                                      RADDAT
     D  heapID                       10U 0                                                    RADDAT
      *                                                                                       RADDAT
     D MAGP_Heap_Space_Attr_t...                                                              RADDAT
     D                 DS                  qualified   align       based(pDummy)              RADDAT
     D  bytPrv                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  maxSnglAlc             9     12U 0                                                    RADDAT
     D  minBndryReq           13     16U 0                                                    RADDAT
     D  crtSize               17     20U 0                                                    RADDAT
     D  extSize               21     24U 0                                                    RADDAT
     D  domain                25     26I 0                                                    RADDAT
     D  heapCrtOpts           27     32A                                                      RADDAT
     D  reserved_1            33     96A                                                      RADDAT
     D  curNbrOutAlc          97    100U 0                                                    RADDAT
     D  totNbrRealloc        101    104U 0                                                    RADDAT
     D  totNbrFrees          105    108U 0                                                    RADDAT
     D  totNbrAllocs         109    112U 0                                                    RADDAT
     D  maxNbrOutAlc         113    116U 0                                                    RADDAT
     D  sizeHeapSpace        117    120U 0                                                    RADDAT
     D  nbrOutMarks          121    124U 0                                                    RADDAT
     D  totNbrExt            125    128U 0                                                    RADDAT
      *                                                                                       RADDAT
     D cMATHSAT_ATTR...                                                                       RADDAT
     D                 C                   x'00'                                              RADDAT
      *                                                                                       RADDAT
      *  Materialize Activation Group-Based Heap Space Attributes (MATHSAT)                   RADDAT
     D mathsat2...                                                                            RADDAT
     D                 PR                  EXTPROC('_MATHSAT2')                               RADDAT
     D  o_rcvVar                       *   value                                              RADDAT
     D  i_heapIdTpl                        const  likeds(heapIdTpl_t)                         RADDAT
     D  i_attrSlc                     3U 0 const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         MAGP_AG_Attr.bytPrv = %size(MAGP_AG_Attr);                                         //RADDAT
         matagpat2(%addr(MAGP_AG_Attr)
                   : 0
                   : cMATAGPAT_ATTR_BASIC_ACTGRP_ATTR);                                     //RADDAT

         // ... materialize activation group heap list
         tplSize = 16 + MAGP_AG_Attr.Basic_Attr.heapSpcCnt *
                        %size(MAGP_AG_Heap_List.Heap_List_1);
         pMAGP_AG_Heap_List = %addr(Heap_List_Buffer);
         MAGP_AG_Heap_List.bytPrv = tplSize;

         p_assert(tplSize <= %size(Heap_List_Buffer));

         matagpat2(%addr(MAGP_AG_Heap_List)
                   : MAGP_AG_Attr.Basic_Attr.actGrpMark2
                   : cMATAGPAT_ATTR_BASIC_ACTGRP_HEAP_LIST);

 B01     for x = 1 to MAGP_AG_Attr.Basic_Attr.heapSpcCnt;
            pHeap_List_Entry = %addr(MAGP_AG_Heap_List.Heap_List_1) +
                                (x-1) * %size(MAGP_AG_Heap_List.Heap_List_1);
            clear MAGP_Heap_Space_Attr;
            MAGP_Heap_Space_Attr.bytPrv = %size(MAGP_Heap_Space_Attr);
            clear heapIdTpl;
            heapIdTpl.actGrpMark = MAGP_AG_Attr.Basic_Attr.actGrpMark2;
            heapIdTpl.heapID     = Heap_List_Entry;
            mathsat2(%addr(MAGP_Heap_Space_Attr)
                     : heapIdTpl
                     : cMATHSAT_ATTR);
            outAllocs = outAllocs + MAGP_Heap_Space_Attr.curNbrOutAlc;
 E01     endfor;

         return outAllocs;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P getOutstandingHeapAllocations...                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                           inz
     D hMap            S                   like(BasicMap_handle_t  ) inz
     D startAllocs     S             20I 0 inz
     D endAllocs       S             20I 0 inz
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      )  inz                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         startAllocs = getOutstandingHeapAllocations();
                                                                                            //RADDAT
         hMap = BasicMap_new();
                                                                                            //RADDAT
 B01     for x = 1 to 20000;
            BasicMap_put(hMap: %char(x): 'Hello World!');
            BasicMap_remove(hMap: %char(x));
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         BasicMap_delete(hMap);
                                                                                            //RADDAT
         endAllocs = getOutstandingHeapAllocations();

         p_assert(startAllocs = endAllocs
                  : 'Out of expected memory utilization');
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RC_03  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RC_03"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicMap - KeySet                           "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RC_03)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RC_03')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
     D getOutstandingHeapAllocations...
     D                 PR            20I 0                                                    RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Returns the number of outstanding heap allocations.                                  RADDAT
      *===============================================================*                       RADDAT
     P getOutstandingHeapAllocations...                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D getOutstandingHeapAllocations...                                                       RADDAT
     D                 PI            20I 0                                                    RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D outAllocs       S             20I 0 inz
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz
     D tplSize         S             10I 0 inz
     D MAGP_AG_Attr    DS                  likeds(MAGP_Template_t  ) inz                      RADDAT
     D heapIdTpl       DS                  likeds(heapIdTpl_t     ) inz
     D MAGP_AG_Heap_List...
     D                 DS                  likeds(MAGP_Template_t )
     D                                     based(pMAGP_AG_Heap_List)
     D Heap_List_Buffer...
     D                 S           1024A   inz(*ALLx'00')
     D MAGP_Heap_Space_Attr...
     D                 DS                  likeds(MAGP_Heap_Space_Attr_t) inz
     D Heap_List_Entry...
     D                 S                   like(MAGP_Template_t.Heap_List_1)
     D                                     based(pHeap_List_Entry)
      *                                                                                       RADDAT
      *  Reference fields                                                                     RADDAT
     D MAGP_Template_t...                                                                     RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  bytPrv                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  reserved_1             9     16A                                                      RADDAT
      *  union:                                                                               RADDAT
     D  Basic_Attr                         likeds(MAGP_AG_Attr_t)                             RADDAT
     D  Heap_List_1                  10I 0 overlay(Basic_Attr)                                RADDAT
     D  Act_List_1                   20U 0 overlay(Basic_Attr)                                RADDAT
      *
     D MAGP_actGrpMark_t...                                                                   RADDAT
     D                 S             20U 0                         based(pDummy)              RADDAT
      *                                                                                       RADDAT
     D MAGP_AG_Attr_t...                                                                      RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  rootProgram            1     16*                                                      RADDAT
     D  reserved_1            17     32A                                                      RADDAT
     D  stgAdrRclKey          33     48*                                                      RADDAT
     D  actGrpName            49     78A                                                      RADDAT
     D  reserved_2            79     80A                                                      RADDAT
     D  actGrpMark            81     84U 0                                                    RADDAT
     D  reserved_3            85     88A                                                      RADDAT
     D  heapSpcCnt            89     92U 0                                                    RADDAT
     D  actCnt                93     96U 0                                                    RADDAT
     D  staticStgSize         97    100U 0                                                    RADDAT
     D  autoStgSize          101    104U 0                                                    RADDAT
     D  attrs                105    105A                                                      RADDAT
     D  pagMbrShpAdvA        106    106A                                                      RADDAT
     D  reserved_7           107    112A                                                      RADDAT
     D  actGrpMark2          113    120U 0                                                    RADDAT
      *
     D cMATAGPAT_ATTR_BASIC_ACTGRP_ATTR...                                                    RADDAT
     D                 C                   x'00'                                              RADDAT
     D cMATAGPAT_ATTR_BASIC_ACTGRP_HEAP_LIST...                                               RADDAT
     D                 C                   x'01'                                              RADDAT
      *                                                                                       RADDAT
      *  Materialize Activation Group Attributes (MATAGPAT)                                   RADDAT
     D matagpat2...                                                                           RADDAT
     D                 PR                  extproc('_MATAGPAT2')                              RADDAT
     D  o_rcvVar                       *   value                                              RADDAT
     D  i_actGrpMark                       const  like(MAGP_actGrpMark_t)                     RADDAT
     D  i_attrSlc                     3U 0 const                                              RADDAT
      *                                                                                       RADDAT
     D heapIdTpl_t     DS                  qualified   align       based(pDummy)              RADDAT
     D  actGrpMark                         like(MAGP_actGrpMark_t)                            RADDAT
     D  reserved_1                    4A                                                      RADDAT
     D  heapID                       10U 0                                                    RADDAT
      *                                                                                       RADDAT
     D MAGP_Heap_Space_Attr_t...                                                              RADDAT
     D                 DS                  qualified   align       based(pDummy)              RADDAT
     D  bytPrv                 1      4I 0                                                    RADDAT
     D  bytAvl                 5      8I 0                                                    RADDAT
     D  maxSnglAlc             9     12U 0                                                    RADDAT
     D  minBndryReq           13     16U 0                                                    RADDAT
     D  crtSize               17     20U 0                                                    RADDAT
     D  extSize               21     24U 0                                                    RADDAT
     D  domain                25     26I 0                                                    RADDAT
     D  heapCrtOpts           27     32A                                                      RADDAT
     D  reserved_1            33     96A                                                      RADDAT
     D  curNbrOutAlc          97    100U 0                                                    RADDAT
     D  totNbrRealloc        101    104U 0                                                    RADDAT
     D  totNbrFrees          105    108U 0                                                    RADDAT
     D  totNbrAllocs         109    112U 0                                                    RADDAT
     D  maxNbrOutAlc         113    116U 0                                                    RADDAT
     D  sizeHeapSpace        117    120U 0                                                    RADDAT
     D  nbrOutMarks          121    124U 0                                                    RADDAT
     D  totNbrExt            125    128U 0                                                    RADDAT
      *                                                                                       RADDAT
     D cMATHSAT_ATTR...                                                                       RADDAT
     D                 C                   x'00'                                              RADDAT
      *                                                                                       RADDAT
      *  Materialize Activation Group-Based Heap Space Attributes (MATHSAT)                   RADDAT
     D mathsat2...                                                                            RADDAT
     D                 PR                  EXTPROC('_MATHSAT2')                               RADDAT
     D  o_rcvVar                       *   value                                              RADDAT
     D  i_heapIdTpl                        const  likeds(heapIdTpl_t)                         RADDAT
     D  i_attrSlc                     3U 0 const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         MAGP_AG_Attr.bytPrv = %size(MAGP_AG_Attr);                                         //RADDAT
         matagpat2(%addr(MAGP_AG_Attr)
                   : 0
                   : cMATAGPAT_ATTR_BASIC_ACTGRP_ATTR);                                     //RADDAT

         // ... materialize activation group heap list
         tplSize = 16 + MAGP_AG_Attr.Basic_Attr.heapSpcCnt *
                        %size(MAGP_AG_Heap_List.Heap_List_1);
         pMAGP_AG_Heap_List = %addr(Heap_List_Buffer);
         MAGP_AG_Heap_List.bytPrv = tplSize;

         p_assert(tplSize <= %size(Heap_List_Buffer));

         matagpat2(%addr(MAGP_AG_Heap_List)
                   : MAGP_AG_Attr.Basic_Attr.actGrpMark2
                   : cMATAGPAT_ATTR_BASIC_ACTGRP_HEAP_LIST);

 B01     for x = 1 to MAGP_AG_Attr.Basic_Attr.heapSpcCnt;
            pHeap_List_Entry = %addr(MAGP_AG_Heap_List.Heap_List_1) +
                                (x-1) * %size(MAGP_AG_Heap_List.Heap_List_1);
            clear MAGP_Heap_Space_Attr;
            MAGP_Heap_Space_Attr.bytPrv = %size(MAGP_Heap_Space_Attr);
            clear heapIdTpl;
            heapIdTpl.actGrpMark = MAGP_AG_Attr.Basic_Attr.actGrpMark2;
            heapIdTpl.heapID     = Heap_List_Entry;
            mathsat2(%addr(MAGP_Heap_Space_Attr)
                     : heapIdTpl
                     : cMATHSAT_ATTR);
            outAllocs = outAllocs + MAGP_Heap_Space_Attr.curNbrOutAlc;
 E01     endfor;

         return outAllocs;                                                                  //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P getOutstandingHeapAllocations...                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                           inz
     D hMap            S                   like(BasicMap_handle_t  ) inz
     D startAllocs     S             20I 0 inz
     D endAllocs       S             20I 0 inz
     D tmpAllocs       S             20I 0 inz
      *                                                                                       RADDAT
     D hKeySet1        S                   like(BasicKeySet_handle_t) inz                     RADDAT
     D hKeySet2        S                   like(BasicKeySet_handle_t) inz                     RADDAT
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      )  inz                           RADDAT
      *
     D refArray        S             20A   varying dim(32)  ascend
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         startAllocs = getOutstandingHeapAllocations();
                                                                                            //RADDAT
         hMap = BasicMap_new();
                                                                                            //RADDAT
 B01     for x = 1 to 32;
            BasicMap_put(hMap: %char(x): 'Hello World!');
            refArray(x) = %char(x);
 E01     endfor;                                                                            //RADDAT

         sorta refArray;

         hKeySet1 = BasicMap_newKeySet(hMap);                                               //RADDAT
         hKeySet2 = BasicMap_newKeySet(hMap);                                               //RADDAT

 B01     for x = 1 to 5;
 B02        if (x = 1);
               p_assert(refArray(x) = BasicKeySet_getFirst(hKeySet1)
                        : 'Invalid return value from +
                           BasicKeySet_getFirst()');                                        //RADDAT
 X02        else;
               p_assert(refArray(x) = BasicKeySet_getNext(hKeySet1)
                        : 'Invalid return value from +
                           BasicKeySet_getNext()');                                         //RADDAT
 E02        endif;
 E01     endfor;

 B01     for x = 1 to 20;
 B02        if (x = 1);
               p_assert(refArray(x) = BasicKeySet_getFirst(hKeySet2)
                        : 'Invalid return value from +
                           BasicKeySet_getFirst()');                                        //RADDAT
 X02        else;
               p_assert(refArray(x) = BasicKeySet_getNext(hKeySet2)
                        : 'Invalid return value from +
                           BasicKeySet_getNext()');                                         //RADDAT
 E02        endif;
 E01     endfor;

 B01     for x = 6 to 32;
            p_assert(refArray(x) = BasicKeySet_getNext(hKeySet1)
                     : 'Invalid return value from +
                        BasicKeySet_getNext()');                                            //RADDAT
 E01     endfor;

 B01     for x = 21 to 32;
            p_assert(refArray(x) = BasicKeySet_getNext(hKeySet2)
                     : 'Invalid return value from +
                        BasicKeySet_getNext()');                                            //RADDAT
 E01     endfor;

         BasicKeySet_delete(hKeySet1);                                                      //RADDAT

         tmpAllocs = getOutstandingHeapAllocations();

         BasicKeySet_delete(hKeySet2);                                                      //RADDAT
                                                                                            //RADDAT
         BasicMap_delete(hMap);
                                                                                            //RADDAT
         endAllocs = getOutstandingHeapAllocations();

         p_assert(startAllocs = endAllocs
                  : 'Out of expected memory utilization');
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RC_04  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RC_04"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicMap_clone                              "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RC_04)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RC_04')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0                           inz
     D hMap            S                   like(BasicMap_handle_t  ) inz
     D hClonedMap      S                   like(BasicMap_handle_t  ) inz                      RADDAT
      *
     D value1          DS                  qualified
     D  key                                like(BasicMap_key_t ) inz
     D  size                         10I 0 inz
     D  pData                          *   inz
     D  string                       32A   inz
      *
     D value2          DS                  likeds(value1 ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create a BasicMap                                                               //RADDAT
         hMap = BasicMap_new();
                                                                                            //RADDAT
         // Add some entries to it                                                          //RADDAT
 B01     for x = 1 to 32;
            BasicMap_putString(hMap: %char(x): %char(x) + '. Hello World!');
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Add a NULL entry                                                                //RADDAT
         BasicMap_put(hMap: %char(x): *NULL);                                               //RADDAT
                                                                                            //RADDAT
         // Clone the BasicMap                                                              //RADDAT
         hClonedMap = BasicMap_clone(hMap);
                                                                                            //RADDAT
         // Check entries of cloned map                                                     //RADDAT
 B01     for x = 1 to BasicMap_getNumE(hMap);
            value1.key    = BasicMap_getKeyByIndex(hMap: x);
            value1.pData  = BasicMap_getValueByIndex(hMap: x);
            value1.size   = BasicMap_getSizeByIndex(hMap: x);
            value1.string = BasicMap_getString(hMap: value1.key);

            value2.key    = BasicMap_getKeyByIndex(hClonedMap: x);
            value2.pData  = BasicMap_getValueByIndex(hClonedMap: x);
            value2.size   = BasicMap_getSizeByIndex(hClonedMap: x);
            value2.string = BasicMap_getString(hClonedMap: value2.key);

            p_assert(value1.string = value2.string
                     : 'Map entries do not match');

 B02        if (value1.pData = *NULL);
               p_assert(value1.pData  = value2.pData
                        : 'Map NULL entries do not match');
 E02        endif;
 E01     endfor;
                                                                                            //RADDAT
         // Delete the BasicMap                                                             //RADDAT
         BasicMap_delete(hMap);
         p_assert(hMap = BasicMap_null()
                  : 'Map handle not set to NULL');                                          //RADDAT
                                                                                            //RADDAT
         // Delete the cloned BasicMap                                                      //RADDAT
         BasicMap_delete(hClonedMap);                                                       //RADDAT
         p_assert(hClonedMap = BasicMap_null()
                  : 'Cloned map handle not set to NULL');                                   //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RC_05  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RC_05"
mbrtype =  "RPGLE     "
mbrtext =  "Test: BasicMap_getKeys/getValues                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RC_05)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
     D key_t           S            256A   varying                 based(pDummy)              RADDAT
     D value_t...                                                                             RADDAT
     D                 DS                  qualified               based(pDummy)              RADDAT
     D  seq                          10I 0                                                    RADDAT
     D  data                         32A   varying                                            RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RC_05')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *  Comparator for comparing to 'key' values.                                            RADDAT
     D compareKeys...                                                                         RADDAT
     D                 PR            10I 0 extproc('compareKeys')                             RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *  Comparator for comparing to 'value' structures.                                      RADDAT
     D compareValues...                                                                       RADDAT
     D                 PR            10I 0 extproc('compareValues')                           RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Comparator for comparing to 'key' values.                                            RADDAT
      *===============================================================*                       RADDAT
     P compareKeys...                                                                         RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D compareKeys...                                                                         RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
     D key             S                   like(key_t     ) based(i_pKeyData )                RADDAT
     D elem            S                   like(key_t     ) based(i_pElemData)                RADDAT
     D null            S                   like(key_t     ) inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_pElemData = *NULL);                                                          //RADDAT
            i_pElemData = %addr(null);                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (i_pKeyData = *NULL);                                                           //RADDAT
            i_pKeyData = %addr(null);                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     select;                                                                            //RADDAT
         when (key < elem);                                                                 //RADDAT
            rc = -1;                                                                        //RADDAT
         when (key > elem);                                                                 //RADDAT
            rc = 1;                                                                         //RADDAT
 X01     other;                                                                             //RADDAT
            rc = 0;                                                                         //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc * -1;   // Sort descending                                               //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P compareKeys...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Comparator for comparing to 'value' structures.                                      RADDAT
      *===============================================================*                       RADDAT
     P compareValues...                                                                       RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D compareValues...                                                                       RADDAT
     D                 PI            10I 0                                                    RADDAT
     D  i_pKeyData                     *   value                                              RADDAT
     D  i_keySize                    10I 0 value                                              RADDAT
     D  i_pElemData                    *   value                                              RADDAT
     D  i_elemSize                   10I 0 value                                              RADDAT
      *                                                                                       RADDAT
     D rc              S             10I 0 inz                                                RADDAT
     D key             DS                  likeds(value_t ) based(i_pKeyData )                RADDAT
     D elem            DS                  likeds(value_t ) based(i_pElemData)                RADDAT
     D null            DS                  likeds(value_t ) inz                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (i_pElemData = *NULL);                                                          //RADDAT
            i_pElemData = %addr(null);                                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     if (i_pKeyData = *NULL);                                                           //RADDAT
            i_pKeyData = %addr(null);                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
 B01     select;                                                                            //RADDAT
         when (key.seq < elem.seq);                                                         //RADDAT
            rc = -1;                                                                        //RADDAT
         when (key.seq > elem.seq);                                                         //RADDAT
            rc = 1;                                                                         //RADDAT
 X01     other;                                                                             //RADDAT
            rc = 0;                                                                         //RADDAT
 E01     endsl;                                                                             //RADDAT
                                                                                            //RADDAT
         return rc * -1;   // Sort descending                                               //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P compareValues...                                                                       RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D x               S             10I 0 inz                                                RADDAT
     D lastKey         S             10I 0 inz                                                RADDAT
     D lastSeq         S             10I 0 inz                                                RADDAT
     D hMap            S                   like(BasicMap_handle_t  ) inz
     D key             S                   like(key_t     ) inz                               RADDAT
     D value           DS                  likeds(value_t ) inz                               RADDAT
     D hKeys           S                   like(BasicList_handle_t ) inz                      RADDAT
     D hValues         S                   like(BasicList_handle_t ) inz                      RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create a BasicMap                                                               //RADDAT
         hMap = BasicMap_new();
                                                                                            //RADDAT
         // Add some entries to it                                                          //RADDAT
 B01     for x = 1 to 32;
            clear value;                                                                    //RADDAT
            value.seq  = x;                                                                 //RADDAT
            value.data = %char(x) + '. Hello World!';                                       //RADDAT
            key = %editc(x: 'X');                                                           //RADDAT
            BasicMap_put(hMap: key: %addr(value): %size(value));                            //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Add a NULL entry                                                                //RADDAT
         key = %editc(x: 'X');                                                              //RADDAT
         BasicMap_put(hMap: key: *NULL);                                                    //RADDAT
                                                                                            //RADDAT
         // Get all keys that are in the map                                                //RADDAT
         hKeys = BasicMap_getKeys(hMap: %paddr('compareKeys'));                             //RADDAT
                                                                                            //RADDAT
         // Check keys                                                                      //RADDAT
         x = BasicList_getNumE(hKeys);                                                      //RADDAT
         lastKey = *HIVAL;                                                                  //RADDAT
 B01     for x = 1 to BasicList_getNumE(hKeys);                                             //RADDAT
            key = BasicList_getString(hKeys: x);                                            //RADDAT
            p_assert(lastKey > f_val(key)
                     : 'lastKey must be greater than key');                                 //RADDAT
            lastKey = f_val(key);                                                           //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Delete the list of keys                                                         //RADDAT
         BasicList_delete(hKeys);                                                           //RADDAT
                                                                                            //RADDAT
         // Get all values that are in the map                                              //RADDAT
         hValues = BasicMap_getValues(hMap: %paddr('compareValues'));                       //RADDAT
                                                                                            //RADDAT
         // Check values                                                                    //RADDAT
         x = BasicList_getNumE(hValues);                                                    //RADDAT
         lastSeq = *HIVAL;                                                                  //RADDAT
 B01     for x = 1 to BasicList_getNumE(hValues);                                           //RADDAT
            BasicList_get(hValues: x: %addr(value): %size(value));                          //RADDAT
            p_assert(lastSeq > value.seq
                     : 'lastSeq must be greater than value.seq');                           //RADDAT
            lastSeq = value.seq;                                                            //RADDAT
 E01     endfor;                                                                            //RADDAT
                                                                                            //RADDAT
         // Delete the list of values                                                       //RADDAT
         BasicList_delete(hValues);                                                         //RADDAT
                                                                                            //RADDAT
         // Delete the BasicMap                                                             //RADDAT
         BasicMap_delete(hMap);                                                             //RADDAT
         p_assert(hMap = BasicMap_null()
                  : 'Map handle not set to NULL');                                          //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RD_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RD_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: Url_*                                       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RD_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RD_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *  Sends a message to QCMD                                                              RADDAT
     D sndMsg...                                                                              RADDAT
     D                 PR                                                                     RADDAT
     D  i_text                      128A   value  varying                                     RADDAT
     D  i_doSendToExt                  N   VALUE  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Sends a message to the caller.                                                       RADDAT
      *===============================================================*                       RADDAT
     P sndMsg...                                                                              RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D sndMsg...                                                                              RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      128A   value  varying                                     RADDAT
     D  i_doSendToExt                  N   VALUE  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pBuffer         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D msgKey          S              4A                        inz                           RADDAT
      *                                                                                       RADDAT
     D qMsgF           DS                  qualified            inz                           RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
     D errCode         DS                  qualified            inz                           RADDAT
     D  bytPrv                       10I 0                                                    RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
     D  excID                         7A                                                      RADDAT
     D  reserved                      1A                                                      RADDAT
     D  excDta                      256A                                                      RADDAT
      *                                                                                       RADDAT
      *  Send Program Message (QMHSNDPM) API                                                  RADDAT
     D QMHSNDPM        PR                         extpgm('QMHSNDPM')                          RADDAT
     D   i_msgID                      7A   const                                              RADDAT
     D   i_qMsgF                     20A   const                                              RADDAT
     D   i_msgData                32767A   const  options(*varsize )                          RADDAT
     D   i_length                    10I 0 const                                              RADDAT
     D   i_msgType                   10A   const                                              RADDAT
     D   i_callStkE               32767A   const  options(*varsize )                          RADDAT
     D   i_callStkC                  10I 0 const                                              RADDAT
     D   o_msgKey                     4A                                                      RADDAT
     D   io_ErrCode               32767A          options(*varsize )                          RADDAT
     D   i_lenStkE                   10I 0 const  options(*nopass  )            | optGrp 1    RADDAT
     D   i_callStkEQ                 20A   const  options(*nopass  )            |             RADDAT
     D   i_wait                      10I 0 const  options(*nopass  )            |             RADDAT
     D   i_callStkEDT                10A   const  options(*nopass  )            | optGrp 2    RADDAT
     D   i_ccsid                     10I 0 const  options(*nopass  )            |             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         clear qMsgF;                                                                       //RADDAT
         qMsgF.name = 'QCPFMSG';                                                            //RADDAT
         qMsgF.lib  = '*LIBL';                                                              //RADDAT
                                                                                            //RADDAT
         clear errCode;                                                                     //RADDAT
         errCode.bytPrv = %size(errCode);                                                   //RADDAT
                                                                                            //RADDAT
 B01     if %parms() >= 2 and i_doSendToExt;                                                //RADDAT
            QMHSNDPM('CPF9897': qMsgF: i_text: %len(i_text): '*INFO'
                     : '*CTLBDY': 1
                     : msgKey: errCode);                                                    //RADDAT
 X01     else;                                                                              //RADDAT
            QMHSNDPM('CPF9897': qMsgF: i_text: %len(i_text): '*INFO'
                     : '*CTLBDY': 0
                     : msgKey: errCode);                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sndMsg...                                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
     D isSet           S               N   inz(cFalse)                                        RADDAT
     D isOK            S               N   inz(cFalse)                                        RADDAT
     D rc              S             10I 0 inz
     D url             S                   like(url_t )                                       RADDAT
     D stringUrl       S                   like(url_t )                                       RADDAT
     D integer         S             10I 0 inz                                                RADDAT
     D string          S            512A   varying inz                                        RADDAT
     D file            S             10A   inz                                                RADDAT
     D lib             S             10A   inz                                                RADDAT
     D mbr             S             10A   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create URL                                                                      //RADDAT
         stringUrl =
            'http://www.tools400.de:80/downloads/basics1.zip?fast=y;secure=n';              //RADDAT
                                                                                            //RADDAT
         url = Url_new(stringUrl);                                                          //RADDAT
                                                                                            //RADDAT
         // Check string representation                                                     //RADDAT
         string = Url_toString(url);                                                        //RADDAT
         p_assert(string = stringUrl:
                  'Invalid string representation: ' + string);                              //RADDAT
         sndMsg('Url_toString(): ' + string: cTrue);                                        //RADDAT
                                                                                            //RADDAT
         // Check protocol                                                                  //RADDAT
         string = Url_getProtocol(url);                                                     //RADDAT
         p_assert(string = 'http':
                  'Invalid protocol: ' + string + ' Expected ''http''');                    //RADDAT
         sndMsg('Url_getProtocol(): ' + string: cTrue);                                     //RADDAT
                                                                                            //RADDAT
         // Check host                                                                      //RADDAT
         string = Url_getHost(url);                                                         //RADDAT
         p_assert(string = 'www.tools400.de':
                  'Invalid host: ' + string + ' Expected ''www.tools400.de''');             //RADDAT
         sndMsg('Url_getHost(): ' + string: cTrue);                                         //RADDAT
                                                                                            //RADDAT
         // Check port                                                                      //RADDAT
         integer = Url_getPort(url);                                                        //RADDAT
         p_assert(integer = 80:
                  'Invalid port: ' + %char(integer) + ' Expected ''80''');                  //RADDAT
         sndMsg('Url_getPort(): ' + %char(integer): cTrue);                                 //RADDAT
                                                                                            //RADDAT
         // Check path                                                                      //RADDAT
         string = Url_getPath(url);                                                         //RADDAT
         p_assert(string = '/downloads/basics1.zip':
                  'Invalid path: ' + string +
                  ' Expected ''/downloads/basics1.zip''');                                  //RADDAT
         sndMsg('Url_getPath(): ' + string: cTrue);                                         //RADDAT
                                                                                            //RADDAT
         // Check file                                                                      //RADDAT
         string = Url_getFile(url);                                                         //RADDAT
         p_assert(string = '/downloads/basics1.zip?fast=y;secure=n':
                  'Invalid path: ' + string +
                  ' Expected ''/downloads/basics1.zip?fast=y;secure=n''');                  //RADDAT
         sndMsg('Url_getFile(): ' + string: cTrue);                                         //RADDAT
                                                                                            //RADDAT
         // Check query                                                                     //RADDAT
         string = Url_getQuery(url);                                                        //RADDAT
         p_assert(string = 'fast=y;secure=n':
                  'Invalid path: ' + string +
                  ' Expected ''fast=y;secure=n''');                                         //RADDAT
         sndMsg('Url_getQuery(): ' + string: cTrue);                                        //RADDAT
                                                                                            //RADDAT
         // Now change the URL
         // ... protocol
         isSet = Url_setProtocol(url: 'https': rc);
         p_assert(isSet = cTrue: 'Invalid return value: ' + isSet);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         string = Url_getProtocol(url);                                                     //RADDAT
         p_assert(string = 'https':
                  'Invalid protocol: ' + string + ' Expected ''https''');
                                                                                            //RADDAT
         // ... host
         isSet = Url_setHost(url: 'www.tools400.com': rc);
         p_assert(isSet = cTrue: 'Invalid return value: ' + isSet);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         string = Url_getHost(url);                                                         //RADDAT
         p_assert(string = 'www.tools400.com':
                  'Invalid host: ' + string + ' Expected ''www.tools400.com''');
                                                                                            //RADDAT
         // ... port
         isSet = Url_setPort(url: 8080: rc);
         p_assert(isSet = cTrue: 'Invalid return value: ' + isSet);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         integer = Url_getPort(url);                                                        //RADDAT
         p_assert(integer = 8080:
                  'Invalid port: ' + %char(integer) + ' Expected ''8080''');
                                                                                            //RADDAT
         // ... path
         isSet = Url_setPath(url: '/HelloWorld.zip': rc);
         p_assert(isSet = cTrue: 'Invalid return value: ' + isSet);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         string = Url_getPath(url);                                                         //RADDAT
         p_assert(string = '/HelloWorld.zip':
                  'Invalid path: ' + string +
                  ' Expected ''/HelloWorld.zip''');
         string = Url_getQuery(url);   // Query must have remained unchanged!               //RADDAT
         p_assert(string = 'fast=y;secure=n':
                  'Invalid path: ' + string +
                  ' Expected ''fast=y;secure=n''');                                         //RADDAT
                                                                                            //RADDAT
         // ... query
         isSet = Url_setQuery(url: '?blueSky=sure': rc);
         p_assert(isSet = cTrue: 'Invalid return value: ' + isSet);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         string = Url_getQuery(url);
         p_assert(string = 'blueSky=sure':
                  'Invalid path: ' + string +
                  ' Expected ''blueSky=sure''');
                                                                                            //RADDAT
         // ... file
         isSet = Url_setFile(url: '/Holiday.zip?forever=n': rc);
         p_assert(isSet = cTrue: 'Invalid return value: ' + isSet);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         string = Url_getFile(url);                                                         //RADDAT
         p_assert(string = '/Holiday.zip?forever=n':
                  'Invalid path: ' + string +
                  ' Expected ''/Holiday.zip?forever=n''');
                                                                                            //RADDAT
         // Test a special 'mbr' URL (FTP syntax)
         stringUrl = 'mbr:QUSRSYS/QBASICS1.A_README';
                                                                                            //RADDAT
         url = Url_new(stringUrl);                                                          //RADDAT
         isOK = Url_getMbr(url: file: lib:mbr: rc);
         p_assert(isOK = cTrue: 'Invalid return value: ' + isOK);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         p_assert(file = 'QBASICS1':
                  'Invalid return parameter ''file'': ' + file);
         p_assert(lib  = 'QUSRSYS':
                  'Invalid return parameter ''lib'': ' + lib);
         p_assert(mbr  = 'A_README':
                  'Invalid return parameter ''mbr'': ' + mbr);
                                                                                            //RADDAT
         // Test a special 'mbr' URL (Client Access syntax)
         stringUrl = 'mbr:QUSRSYS/QBASICS1(BASICS1C7)';
                                                                                            //RADDAT
         url = Url_new(stringUrl);                                                          //RADDAT
         isOK = Url_getMbr(url: file: lib:mbr: rc);
         p_assert(isOK = cTrue: 'Invalid return value: ' + isOK);
         p_assert(rc = 0: 'Invalid return parameter: ' + %char(rc));
         p_assert(file = 'QBASICS1':
                  'Invalid return parameter ''file'': ' + file);
         p_assert(lib  = 'QUSRSYS':
                  'Invalid return parameter ''lib'': ' + lib);
         p_assert(mbr  = 'BASICS1C7':
                  'Invalid return parameter ''mbr'': ' + mbr);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RE_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RE_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: dateSerial()                                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RE_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RE_01')                        RADDAT
     D  gi_year                      15P 5 const  options(*nopass)                            RADDAT
     D  gi_month                     15P 5 const  options(*nopass)                            RADDAT
     D  gi_day                       15P 5 const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_year                       10I 0 const                                              RADDAT
     D  i_month                      10I 0 const                                              RADDAT
     D  i_day                        10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Sends a message to QCMD                                                              RADDAT
     D sndMsg...                                                                              RADDAT
     D                 PR                                                                     RADDAT
     D  i_text                      128A   value  varying                                     RADDAT
     D  i_doSendToExt                  N   VALUE  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_year                      15P 5 const  options(*nopass)                            RADDAT
     D  gi_month                     15P 5 const  options(*nopass)                            RADDAT
     D  gi_day                       15P 5 const  options(*nopass)                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%parms() >= 3);                                                                //RADDAT
            main(gi_year: gi_month: gi_day);                                                //RADDAT
 X01     else;                                                                              //RADDAT
            main(1900: 1: 1);                                                               //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Sends a message to the caller.                                                       RADDAT
      *===============================================================*                       RADDAT
     P sndMsg...                                                                              RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D sndMsg...                                                                              RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                      128A   value  varying                                     RADDAT
     D  i_doSendToExt                  N   VALUE  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D pBuffer         S               *   inz                                                RADDAT
      *                                                                                       RADDAT
      *  Local fields                                                                         RADDAT
     D msgKey          S              4A                        inz                           RADDAT
      *                                                                                       RADDAT
     D qMsgF           DS                  qualified            inz                           RADDAT
     D  name                         10A                                                      RADDAT
     D  lib                          10A                                                      RADDAT
      *                                                                                       RADDAT
     D errCode         DS                  qualified            inz                           RADDAT
     D  bytPrv                       10I 0                                                    RADDAT
     D  bytAvl                       10I 0                                                    RADDAT
     D  excID                         7A                                                      RADDAT
     D  reserved                      1A                                                      RADDAT
     D  excDta                      256A                                                      RADDAT
      *                                                                                       RADDAT
      *  Send Program Message (QMHSNDPM) API                                                  RADDAT
     D QMHSNDPM        PR                         extpgm('QMHSNDPM')                          RADDAT
     D   i_msgID                      7A   const                                              RADDAT
     D   i_qMsgF                     20A   const                                              RADDAT
     D   i_msgData                32767A   const  options(*varsize )                          RADDAT
     D   i_length                    10I 0 const                                              RADDAT
     D   i_msgType                   10A   const                                              RADDAT
     D   i_callStkE               32767A   const  options(*varsize )                          RADDAT
     D   i_callStkC                  10I 0 const                                              RADDAT
     D   o_msgKey                     4A                                                      RADDAT
     D   io_ErrCode               32767A          options(*varsize )                          RADDAT
     D   i_lenStkE                   10I 0 const  options(*nopass  )            | optGrp 1    RADDAT
     D   i_callStkEQ                 20A   const  options(*nopass  )            |             RADDAT
     D   i_wait                      10I 0 const  options(*nopass  )            |             RADDAT
     D   i_callStkEDT                10A   const  options(*nopass  )            | optGrp 2    RADDAT
     D   i_ccsid                     10I 0 const  options(*nopass  )            |             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      *                                                                                       RADDAT
      /FREE
                                                                                            //RADDAT
         clear qMsgF;                                                                       //RADDAT
         qMsgF.name = 'QCPFMSG';                                                            //RADDAT
         qMsgF.lib  = '*LIBL';                                                              //RADDAT
                                                                                            //RADDAT
         clear errCode;                                                                     //RADDAT
         errCode.bytPrv = %size(errCode);                                                   //RADDAT
                                                                                            //RADDAT
 B01     if %parms() >= 2 and i_doSendToExt;                                                //RADDAT
            QMHSNDPM('CPF9897': qMsgF: i_text: %len(i_text): '*INFO'
                     : '*CTLBDY': 1
                     : msgKey: errCode);                                                    //RADDAT
 X01     else;                                                                              //RADDAT
            QMHSNDPM('CPF9897': qMsgF: i_text: %len(i_text): '*INFO'
                     : '*CTLBDY': 0
                     : msgKey: errCode);                                                    //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P sndMsg...                                                                              RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_year                       10I 0 const                                              RADDAT
     D  i_month                      10I 0 const                                              RADDAT
     D  i_day                        10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D days            S             10I 0 inz                                                RADDAT
     D months          S             10I 0 inz                                                RADDAT
     D years           S             10I 0 inz                                                RADDAT
     D today           S               D   inz                                                RADDAT
     D date            S               D   inz                                                RADDAT
     D inpDate         S               D   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         today = %date();                                                                   //RADDAT
                                                                                            //RADDAT
         // Produce todays's date                                                           //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)
                             : %subdt(today: *MONTHS)
                             : %subdt(today: *DAYS));                                       //RADDAT
         p_assert(date = today
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date - 10 days                                                 //RADDAT
         days = -10;                                                                        //RADDAT
         months = 0;                                                                        //RADDAT
         years  = 0;                                                                        //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date - 5 months                                                //RADDAT
         months = -5;                                                                       //RADDAT
         months = 0;                                                                        //RADDAT
         years  = 0;                                                                        //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date + 10 days                                                 //RADDAT
         days = 10;                                                                         //RADDAT
         months = 0;                                                                        //RADDAT
         years  = 0;                                                                        //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date + 5 months                                                //RADDAT
         months = 5;                                                                        //RADDAT
         months = 0;                                                                        //RADDAT
         years  = 0;                                                                        //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date + 7 days - 4 months                                       //RADDAT
         days   = 7;                                                                        //RADDAT
         months = -4;                                                                       //RADDAT
         years  = 0;                                                                        //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date + 7 days - 4 months + 10 years                            //RADDAT
         days   = 7;                                                                        //RADDAT
         months = -4;                                                                       //RADDAT
         years  = 10;                                                                       //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce todays's date - 7 days + 4 months - 10 years                            //RADDAT
         days   = -7;                                                                       //RADDAT
         months = 4;                                                                        //RADDAT
         years  = -10;                                                                      //RADDAT
         date = f_dateSerial(%subdt(today: *YEARS)    + years
                             : %subdt(today: *MONTHS) + months
                             : %subdt(today: *DAYS)   + days);                              //RADDAT
         p_assert(date = today + %years(years) + %months(months) + %days(days)
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(today) + '''');                             //RADDAT
                                                                                            //RADDAT
         // Produce date from passed values                                                 //RADDAT
         date = f_dateSerial(i_year: i_month: i_day);                                       //RADDAT
         inpDate = %date(%editc(%dec(i_year : 4: 0): 'X') + '-' +
                         %editc(%dec(i_month: 2: 0): 'X') + '-' +
                         %editc(%dec(i_day  : 2: 0): 'X'));                                 //RADDAT
         p_assert(date = inpDate
                  : 'Returned value ''' + %char(date) + ''' does not match +
                     expected value ''' + %char(inpDate) + '''');                           //RADDAT
         sndMsg('The specified date was: ' + %char(date): cTrue);                           //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_RH_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_RH_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: MemoryReader / MemoryWriter                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_RH_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_RH_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D hReader         S                   like(memRdr_handle_t) inz
     D hWriter         S                   like(memWtr_handle_t) inz
     D fromBuffer      S           1024A   inz
     D toBuffer        S           1024A   inz
     D tBuffer         S              3A   inz
     D nRead           S             10I 0 inz
     D nWrite          S             10I 0 inz
     D errno           S             10I 0 inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         fromBuffer = 'The quick brown fox jumps over the lazy dog.';
         toBuffer   = '';

         hReader = MemoryReader_new(%addr(fromBuffer):%len(%trimR(fromBuffer)));
         hWriter = MemoryWriter_new(%addr(toBuffer  ):%size(toBuffer  ));

         dou (nRead = 0 or nRead = RC_ERROR);
            nRead = MemoryReader_read(hReader: %addr(tBuffer): %size(tBuffer));
            if (nRead > 0);
               nWrite = MemoryWriter_write(hWriter: %addr(tBuffer): nRead);
               p_assert(nRead = nWrite
                        : 'nRead (' + %char(nRead) +
                          ') does not match nWrite (' + %char(nWrite) + ')');
            endif;
         enddo;

         MemoryReader_delete(hReader);
         MemoryWriter_delete(hWriter);

         p_assert(hReader = 0: 'hReader must be 0');
         p_assert(hWriter = 0: 'hWriter must be 0');

         p_assert(%trimR(fromBuffer) = %trimR(toBuffer)
                  : 'fromBuffer is not equal to toBuffer');

         // ------------------------------------------------
         // Test: toBuffer is too small.
         // ------------------------------------------------

         fromBuffer = 'The quick brown fox jumps over the lazy dog.';
         toBuffer   = '';

         hReader = MemoryReader_new(%addr(fromBuffer):%len(%trimR(fromBuffer)));
         hWriter = MemoryWriter_new(%addr(toBuffer  ): 17);

         dou (nRead = 0 or nRead = RC_ERROR);
            nRead = MemoryReader_read(hReader: %addr(tBuffer): %size(tBuffer));
            if (nRead > 0);
               nWrite = MemoryWriter_write(hWriter: %addr(tBuffer): nRead);
               select;
               when (nWrite = RC_ERROR);
                  errno = f_errno();
                  p_assert(errno = ENOBUFS_C
                           : 'errno does not match expected value: ENOBUFS');
                  leave;
               when (nWrite > 0);
                  p_assert(nRead = nWrite
                           : 'nRead (' + %char(nRead) +
                             ') does not match nWrite (' + %char(nWrite) + ')');
               endsl;
            endif;
         enddo;

         MemoryReader_delete(hReader);
         MemoryWriter_delete(hWriter);

         // ------------------------------------------------
         // Test: Bad handle: MemoryWriter
         // ------------------------------------------------
         f_clrErrno();
         nWrite = MemoryWriter_write(hWriter: %addr(tBuffer): nRead);
         p_assert(nWrite = RC_ERROR
                  : 'nWrite does not match expected value: RC_ERROR');
         p_assert(f_errno() = EBADF_C
                  : 'errno does not match expected value: EBADF');
         f_clrErrno();
         MemoryWriter_delete(hWriter);
         p_assert(f_errno() = EBADF_C
                  : 'errno does not match expected value: EBADF');

         f_clrErrno();
         hReader = MemoryReader_new(%addr(fromBuffer):%len(%trimR(fromBuffer)));
         f_clrErrno();
         nWrite = MemoryWriter_write(hReader: %addr(tBuffer): nRead);
         p_assert(nWrite = RC_ERROR
                  : 'nWrite does not match expected value: RC_ERROR');
         p_assert(f_errno() = EBADF_C
                  : 'errno does not match expected value: EBADF');
         f_clrErrno();
         MemoryReader_delete(hReader);

         // ------------------------------------------------
         // Test: Bad handle: MemoryReader
         // ------------------------------------------------
         f_clrErrno();
         nRead = MemoryReader_read(hReader: %addr(tBuffer): nRead);
         p_assert(nWrite = RC_ERROR
                  : 'nWrite does not match expected value: RC_ERROR');
         p_assert(f_errno() = EBADF_C
                  : 'errno does not match expected value: EBADF');
         f_clrErrno();
         MemoryReader_delete(hReader);
         p_assert(f_errno() = EBADF_C
                  : 'errno does not match expected value: EBADF');

         f_clrErrno();
         hWriter = MemoryWriter_new(%addr(fromBuffer):%len(%trimR(fromBuffer)));
         f_clrErrno();
         nRead = MemoryReader_read(hWriter: %addr(tBuffer): 10);
         p_assert(nRead = RC_ERROR
                  : 'nRead does not match expected value: RC_ERROR');
         p_assert(f_errno() = EBADF_C
                  : 'errno does not match expected value: EBADF');
         f_clrErrno();
         MemoryWriter_delete(hWriter);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R1_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R1_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_rtvMsgText/f_rtvMsgHelpText/f_newMsg      "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R1_01) PARM('CPF9897' 'Hello World!' '0')    *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R1_01')                        RADDAT
     D  gi_msgID                      7A   const                                              RADDAT
     D  gi_msgData                   32A   const                                              RADDAT
     D  gi_isMsgHelp                  1A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_msgID                       7A   const                                              RADDAT
     D  i_msgData                    32A   const                                              RADDAT
     D  i_isMsgHelp                    N   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_msgID                      7A   const                                              RADDAT
     D  gi_msgData                   32A   const                                              RADDAT
     D  gi_isMsgHelp                  1A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_msgID: gi_msgData: gi_isMsgHelp);                                          //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_msgID                       7A   const                                              RADDAT
     D  i_msgData                    32A   const                                              RADDAT
     D  i_isMsgHelp                    N   const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msgText         S           1024A   varying            inz                             RADDAT
     D rtvMsg          DS                  likeds(msg_t     ) inz                             RADDAT
     D infoMsg         DS                  likeds(msg_t     ) inz                             RADDAT
     D errMsg          DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create message to retrieve the text from                                        //RADDAT
         rtvMsg = f_newMsg(i_msgID: i_msgData);                                             //RADDAT
                                                                                            //RADDAT
         // Retrieve message text, Ignore Errors                                            //RADDAT
         infoMsg = f_newMsg('CPF9897': '*** Ignore Errors ***');                            //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         msgText = f_rtvMsgText(rtvMsg: *omit);
 B01     if   msgText <> '';                                                                //RADDAT
            infoMsg = f_newMsg('': 'MsgText: ' + msgText);                                  //RADDAT
 X01     else;                                                                              //RADDAT
            infoMsg = f_newMsg(
                         '': 'Error occured on retrieveing message text!');                 //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         // Retrieve message help text, Ignore Errors                                       //RADDAT
         msgText = f_rtvMsgHelpText(rtvMsg: '*NO': *omit);
 B01     if   msgText <> '';                                                                //RADDAT
            infoMsg = f_newMsg('': 'MsgHelp: ' + msgText);                                  //RADDAT
 X01     else;                                                                              //RADDAT
            infoMsg = f_newMsg(
                         '': 'Error occured on retrieveing message help text!');            //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         // Retrieve message text, Return error information                                 //RADDAT
         infoMsg = f_newMsg('CPF9897': '*** Return error information ***');                 //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         msgText = f_rtvMsgText(rtvMsg: errMsg);
 B01     if   msgText <> '';                                                                //RADDAT
            infoMsg = f_newMsg('': 'MsgText: ' + msgText);                                  //RADDAT
 X01     else;                                                                              //RADDAT
            infoMsg = errMsg;                                                               //RADDAT
            infoMsg.type = cMsg_Info;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         // Retrieve message help text, Return error information                            //RADDAT
         msgText = f_rtvMsgHelpText(rtvMsg: '*NO': errMsg);
 B01     if   msgText <> '';                                                                //RADDAT
            infoMsg = f_newMsg('': 'MsgHelp: ' + msgText);                                  //RADDAT
 X01     else;                                                                              //RADDAT
            infoMsg = errMsg;                                                               //RADDAT
            infoMsg.type = cMsg_Info;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         // Send *ESCAPE message to signal error                                            //RADDAT
         infoMsg = f_newMsg('CPF9897': '*** Send *ESCAPE message ***');                     //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
 B01     if   not i_isMsgHelp;                                                              //RADDAT
            msgText = f_rtvMsgText(rtvMsg);
            infoMsg = f_newMsg('': 'MsgText: ' + msgText);                                  //RADDAT
 X01     else;                                                                              //RADDAT
            msgText = f_rtvMsgHelpText(rtvMsg: '*NO');
            infoMsg = f_newMsg('': 'MsgHelp: ' + msgText);                                  //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(infoMsg: cMsg_Prv: cMsg_ToCtlBdy);                                     //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R1_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R1_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_newMsg/f_sndPgmMsg/f_rcvPgmMsg/f_rmvPgmMsg"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R1_02)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
     D cFILE_CREATE    C                   const(1)
     D cFILE_REPLACE   C                   const(2)
     D cFILE_APPEND    C                   const(4)
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R1_02')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
     D rcvm0200        DS                  likeds(rcvm0200_t) inz                             RADDAT
     D sndInf          DS                  likeds(sndInf_t  ) inz                             RADDAT
      *                                                                                       RADDAT
     D snd             DS                  qualified                                          RADDAT
     D  pgm                         256A   inz                                                RADDAT
     D  prc                         256A   inz                                                RADDAT
      *                                                                                       RADDAT
     D msgKey          S              4A   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create a message with no message ID, only message text                          //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Using cMSG_ID_NONE ***');                        //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'A message w/o a message ID');                        //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Create a NULL message (which can not be sent)                                   //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Using cMSG_ID_NULL ***');                        //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NULL);                                                      //RADDAT
         monitor;                                                                           //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
         on-error;                                                                          //RADDAT
            msg = f_newMsg(cMSG_ID_NONE:
                           'Error: A NULL message can not be sent.');                       //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
         endmon;                                                                            //RADDAT
                                                                                            //RADDAT
         // Create a OK message (which can not be sent)                                     //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Using cMSG_ID_OK ***');                          //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_OK);                                                        //RADDAT
         monitor;                                                                           //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
         on-error;                                                                          //RADDAT
            msg = f_newMsg(cMSG_ID_NONE:
                           'Error: A OK message can not be sent.');                         //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
         endmon;                                                                            //RADDAT
                                                                                            //RADDAT
         // Change the application message file to QTCPMSG                                  //RADDAT
         // and send a test message TCP1A0A: &1 ended abnormally.                           //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Changing message file ***');                     //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         p_setAppMsgFile('QTCPMSG': 'QSYS');                                                //RADDAT
         msg = f_newMsg('TCP1A0A': '*TEST_MSG *N  *N        ');                             //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Now send a QCPFMSG                                                              //RADDAT
         msg = f_newMsg('CPF9897': 'Hello World! (QCPFMSG)': cMsg_Info:
                        'QCPFMSG': '*LIBL');                                                //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Set the application message file back to the default values                     //RADDAT
         p_setAppMsgFile();                                                                 //RADDAT
                                                                                            //RADDAT
         // Try to use the default message file                                             //RADDAT
         msg = f_newMsg('CPF9897': 'Default message file is QCPFMSG.');                     //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Send a message to the most previous call stack entry                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Sending & receiving messages ***');              //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Hi, how are you?');                                  //RADDAT
         msgKey = f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToMyself);                                //RADDAT
                                                                                            //RADDAT
         rcvm0200 = f_rcvPgmMsg(cMsg_Any: msgKey: cMsg_Act_Same: 0:
                                cMsg_Prv: cMsg_ToMyself);                                   //RADDAT
                                                                                            //RADDAT
         sndInf = f_getSndInfOfRcvMsg(rcvm0200: snd.pgm: snd.prc);                          //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Received: ' + %trimR(rcvm0200.value) +
                                      ' Answer: Thanks''s I am fine.');                     //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Finally remove the message                                                      //RADDAT
         p_rmvPgmMsg(cMsg_Rmv_ByKey: msgKey: cMsg_Prv: cMsg_ToMyself);                      //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R1_03  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R1_03"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_rcvPgmMsgObj                              "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R1_03)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
      /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R1_03')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D lib             S             10A   inz
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
     D msgRcv          DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         lib = f_getObjLib('QCPFMSG': '*LIBL': '*MSGF');
                                                                                            //RADDAT
         // Create a message, send it to myself and then receive it                         //RADDAT
         msg = f_newMsg('CPF9897': 'Hello World: ' + %char(%timestamp())
                        : cMsg_Info: 'QCPFMSG': lib);
         f_sndPgmMsg(msg: cMsg_Same: cMsg_ToMyself);                                        //RADDAT
         msgRcv = f_rcvPgmMsgObj(cMsg_Last: *omit: cMsg_Act_Same: 0
                                 : cMsg_Same: cMsg_ToMyself);                               //RADDAT
         p_assert(msg.ID = msgRcv.ID
                  : 'msgRcv.ID und msg.ID drfen nicht voneinander abweichen');
         p_assert(msg.data = msgRcv.data
                  : 'msgRcv.data und msg.data drfen +
                     nicht voneinander abweichen');
         p_assert(msg.type = msgRcv.type
                  : 'msgRcv.type und msg.type drfen +
                     nicht voneinander abweichen');
         p_assert(msg.file = msgRcv.file
                  : 'msgRcv.file und msg.file drfen +
                     nicht voneinander abweichen');
         p_assert(msg.lib = msgRcv.lib
                  : 'msgRcv.lib und msg.lib drfen +
                     nicht voneinander abweichen');
                                                                                            //RADDAT
         // Create a message, send it to 'previous' and then receive it
         msg = f_newMsg('CPF9897': 'Hello World: ' + %char(%timestamp())
                        : cMsg_Info: 'QCPFMSG': lib);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToMyself);
         msgRcv = f_rcvPgmMsgObj(cMsg_Last: *omit: cMsg_Act_Same: 0
                                 : cMsg_Prv: cMsg_ToMyself);
         p_assert(msg.ID = msgRcv.ID
                  : 'msgRcv.ID und msg.ID drfen nicht voneinander abweichen');
         p_assert(msg.data = msgRcv.data
                  : 'msgRcv.data und msg.data drfen +
                     nicht voneinander abweichen');
         p_assert(msg.type = msgRcv.type
                  : 'msgRcv.type und msg.type drfen +
                     nicht voneinander abweichen');
         p_assert(msg.file = msgRcv.file
                  : 'msgRcv.file und msg.file drfen +
                     nicht voneinander abweichen');
         p_assert(msg.lib = msgRcv.lib
                  : 'msgRcv.lib und msg.lib drfen +
                     nicht voneinander abweichen');
                                                                                            //RADDAT
         // Create a message, send it to 'extern' and then receive it
         msg = f_newMsg('CPF9897': 'Hello World: ' + %char(%timestamp())
                        : cMsg_Info: 'QCPFMSG': lib);
         f_sndPgmMsg(msg: cMsg_Ext);
         msgRcv = f_rcvPgmMsgObj(cMsg_Last: *omit: cMsg_Act_Same: 0
                                 : cMsg_Ext);
         p_assert(msg.ID = msgRcv.ID
                  : 'msgRcv.ID und msg.ID drfen nicht voneinander abweichen');
         p_assert(msg.data = msgRcv.data
                  : 'msgRcv.data und msg.data drfen +
                     nicht voneinander abweichen');
         p_assert(msg.type = msgRcv.type
                  : 'msgRcv.type und msg.type drfen +
                     nicht voneinander abweichen');
         p_assert(msg.file = msgRcv.file
                  : 'msgRcv.file und msg.file drfen +
                     nicht voneinander abweichen');
         p_assert(msg.lib = msgRcv.lib
                  : 'msgRcv.lib und msg.lib drfen +
                     nicht voneinander abweichen');
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R2_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R2_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_errno/f_strerror/f_cvtErrnoToMsg          "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R2_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
     H BNDDIR('QC2LE')                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R2_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
     D fclose...                                                                              RADDAT
     D                 PR            10I 0        extproc('fclose')                           RADDAT
     D  i_pStreamF                     *   value                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         fClose(*NULL);                                                                     //RADDAT
 B01     if   f_errno <> 0;                                                                 //RADDAT
            msg = f_newMsg('CPF9897': f_strerror(f_errno));                                 //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
            msg = f_cvtErrnoToMsg(f_errno);
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_val                                       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_01) PARM('-123.456,789')                  *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_01')                        RADDAT
     D  gi_strVal                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_strVal                     32A   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_strVal                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_strVal);                                                                   //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_strVal                     32A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D numVal          S              8F                      inz                             RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         numVal = f_val('  $   1.605,25  ');                                                //RADDAT
         msg = f_newMsg('': %editc(%dec(numVal: 20: 5): 'N'));                              //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         numVal = f_val('-123,5');                                                          //RADDAT
         msg = f_newMsg('': %editc(%dec(numVal: 20: 5): 'N'));                              //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         numVal = f_val('123,5-');                                                          //RADDAT
         msg = f_newMsg('': %editc(%dec(numVal: 20: 5): 'N'));                              //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         numVal = f_val(i_strVal);                                                          //RADDAT
         msg = f_newMsg('': %editc(%dec(numVal: 30: 9): 'N'));                              //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_wordWrap                                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_02) PARM(65)                              *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_02')                        RADDAT
     D  gi_width                     15P 5 const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_width                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_width                     15P 5 const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_width);                                                                    //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_width                      10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D theText         S            512A   varying inz('Test wordWrap():&N+                   RADDAT
     D                                     ''The quick brown fox -                            RADDAT
     D                                     jumps over the lazy dog.'' is a -
     D                                     sentence that includes every letter -
     D                                     of the alphabet.&PThat is why it is -              RADDAT
     D                                     often found as a sample sentence -
     D                                     within font managing software. Of -
     D                                     course I know that the text I am -
     D                                     writing is somewhat silly.&BHowever -              RADDAT
     D                                     the only purpose of the text is to -
     D                                     show how the wordWrap-function -
     D                                     works.')
     D aLine           S             80A   inz
     D startPos        S             10U 0 inz
     D numLine         S              3I 0 inz                                                RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         p_assert(i_width >= 1 and i_width <= 80:
                  'i_width is out of range. It must be between 1 and 80');
                                                                                            //RADDAT
         // Perform word wrap without respect to end-of-paragraph markers:                  //RADDAT
         msg = f_newMsg('': '*** No EOP charcater: ***');                                   //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         numLine  = 0;                                                                      //RADDAT
         startPos = 1;
 B01     dow   startPos > 0;
            numLine = numLine + 1;                                                          //RADDAT
            aLine = f_wordWrap(theText: i_width: startPos) + '<';
            msg = f_newMsg('': 'Line ' + %char(numLine) + ': ' + aLine);                    //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
 E01     enddo;
                                                                                            //RADDAT
         // Perform word wrap with respect to end-of-paragraph markers                      //RADDAT
         // of message descriptions:                                                        //RADDAT
         msg = f_newMsg('': '*** EOP charcater of message description: ***');               //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         numLine  = 0;                                                                      //RADDAT
         startPos = 1;                                                                      //RADDAT
 B01     dow   startPos > 0;                                                                //RADDAT
            numLine = numLine + 1;                                                          //RADDAT
            aLine = f_wordWrap(theText: i_width: startPos:
                               cWORDWRAP_PARAGRAPH_MSGD) + '<';                             //RADDAT
            msg = f_newMsg('': 'Line ' + %char(numLine) + ': ' + aLine);                    //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Perform word wrap with respect to standard text                                 //RADDAT
         // end-of-paragraph markers:                                                       //RADDAT
         theText = f_replace('&N': '\n': theText);                                          //RADDAT
         theText = f_replace('&B': '\N': theText);                                          //RADDAT
         theText = f_replace('&P': '\n': theText);                                          //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg('': '*** Standard text EOP charcaters: ***');                       //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         numLine  = 0;                                                                      //RADDAT
         startPos = 1;                                                                      //RADDAT
 B01     dow   startPos > 0;                                                                //RADDAT
            numLine = numLine + 1;                                                          //RADDAT
            aLine = f_wordWrap(theText: i_width: startPos:
                               cWORDWRAP_PARAGRAPH_TEXT) + '<';                             //RADDAT
            msg = f_newMsg('': 'Line ' + %char(numLine) + ': ' + aLine);                    //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_03  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_03"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_left/f_right/f_space                      "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_03) PARM('Hello World!')                  *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_03')                        RADDAT
     D  gi_text                      32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_text                       32A   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_text                      32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_text);                                                                     //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_text                       32A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
     D aString         S            128A   inz varying
     D leftLen         S             10I 0 inz
     D rightLen        S             10I 0 inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         aString = f_space(5) + %trim(i_text) + f_space(5);
         msg = f_newMsg('': aString + '<');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);

         aString = f_space(5: '*') + %trim(i_text) + f_space(5: '*');
         msg = f_newMsg('': aString + '<');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);

         aString = f_space(5: '%') + %trim(i_text) + f_space(5: '%');
         msg = f_newMsg('': aString + '<');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         aString = f_space(5: '-') + %trim(i_text) + f_space(5: '-');
         leftLen  = %int(%len(aString) / 2);
         rightLen = %len(aString) - leftLen;
                                                                                            //RADDAT
         msg = f_newMsg('': f_left(aString: leftLen) + '<');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         msg = f_newMsg('': f_right(aString: rightLen) + '<');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_04  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_04"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_replace                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_04) PARM('CR+LF')                         *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_04')                        RADDAT
     D  gi_rplStr                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_rplStr                     32A   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_rplStr                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_rplStr);                                                                   //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_rplStr                     32A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
     D msgText         S           1024A   varying            inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         // Retrieve a message and replace &N with i_rplStr.                                //RADDAT
         msg = f_newMsg('CAE0009');                                                         //RADDAT
         msgText = f_rtvMsgHelpText(msg: cMsg_RtnCtrlChar_Yes: *omit);                      //RADDAT
                                                                                            //RADDAT
         msgText = f_replace('&N': %trimR(i_rplStr): msgText);                              //RADDAT
                                                                                            //RADDAT
         // Show the text with the replacements.                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: msgText);                                             //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_05  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_05"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_lcase/f_ucase                             "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_05) PARM('Hello World! ')           *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_05')                        RADDAT
     D  gi_string                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_string                     32A   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_string                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_string);                                                                   //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_string                     32A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D string          S             32A   varying inz                                        RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
     D msgText         S           1024A   varying            inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         // Convert i_string to lower case.                                                 //RADDAT
         msg = f_newMsg('CPF9897': 'Lower string is: ' + f_lcase(i_string));                //RADDAT
                                                                                            //RADDAT
         // Show converted string                                                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Convert i_string to upper case.                                                 //RADDAT
         msg = f_newMsg('CPF9897': 'Upper string is: ' + f_ucase(i_string));                //RADDAT
                                                                                            //RADDAT
         // Show converted string                                                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_06  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_06"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_getLengthEditCode/f_getLengthEditWord     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_06)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_06')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D digits          S              5U 0 inz                                                RADDAT
     D fraction        S              5U 0 inz                                                RADDAT
     D length          S              5U 0 inz                                                RADDAT
     D editCode        S              1A   inz                                                RADDAT
     D editWord        S             32A   inz varying                                        RADDAT
     D fmtString       S             64A   inz varying                                        RADDAT
     D num64           S              6S 4 inz(*LOVAL)                                        RADDAT
     D num74           S              7S 4 inz(*LOVAL)                                        RADDAT
     D num84           S              8S 4 inz(*LOVAL)                                        RADDAT
     D num94           S              9S 4 inz(*HIVAL)                                        RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Test a numeric 6,4 variable with edit code 'B'                                  //RADDAT
         digits    = %len(num64);                                                           //RADDAT
         fraction  = %decpos(num64);                                                        //RADDAT
         editCode  = 'B';                                                                   //RADDAT
         length    = f_getLengthEditCode(digits: fraction: editCode);                       //RADDAT
         fmtString = %editc(num64: 'B');                                                    //RADDAT
                                                                                            //RADDAT
         p_assert(length = %len(fmtString));                                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of edit code ''' + editCode +
                        ''' is: ' + %editc(length: 'Z') +
                        ' (' + fmtString + ')');                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Test a numeric 7,4 variable with edit code 'L'                                  //RADDAT
         digits    = %len(num74);                                                           //RADDAT
         fraction  = %decpos(num74);                                                        //RADDAT
         editCode  = 'L';                                                                   //RADDAT
         length    = f_getLengthEditCode(digits: fraction: editCode);                       //RADDAT
         fmtString = %editc(num74: 'L');                                                    //RADDAT
                                                                                            //RADDAT
         p_assert(length = %len(fmtString));                                                //RADDAT

         msg = f_newMsg(cMSG_ID_NONE: 'Length of edit code ''' + editCode +
                        ''' is: ' + %editc(length: 'Z') +
                        ' (' + fmtString + ')');                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Test a numeric 8,4 variable with edit code 'X' (negative value)                 //RADDAT
         digits    = %len(num84);                                                           //RADDAT
         fraction  = %decpos(num84);                                                        //RADDAT
         editCode  = 'X';                                                                   //RADDAT
         length    = f_getLengthEditCode(digits: fraction: editCode);                       //RADDAT
         fmtString = %editc(num84: 'X');                                                    //RADDAT
                                                                                            //RADDAT
         p_assert(length = %len(fmtString));                                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of edit code ''' + editCode +
                        ''' is: ' + %editc(length: 'Z') +
                        ' (' + fmtString + ')');                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Test a numeric 9,4 variable with edit code 'X' (positive value)                 //RADDAT
         digits    = %len(num94);                                                           //RADDAT
         fraction  = %decpos(num94);                                                        //RADDAT
         editCode  = 'X';                                                                   //RADDAT
         length    = f_getLengthEditCode(digits: fraction: editCode);                       //RADDAT
         fmtString = %editc(num94: 'X');                                                    //RADDAT
                                                                                            //RADDAT
         p_assert(length = %len(fmtString));                                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of edit code ''' + editCode +
                        ''' is: ' + %editc(length: 'Z') +
                        ' (' + fmtString + ')');                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Test a numeric 7,4 variable with edit word ' -  /    '                          //RADDAT
         digits    = %len(num74);                                                           //RADDAT
         fraction  = 0;                                                                     //RADDAT
         editWord  = ' -  /    ';                                                           //RADDAT
         length    = f_getLengthEditWord(digits: editWord);                                 //RADDAT
         fmtString = %editw(num74: ' -  /    ');                                            //RADDAT
                                                                                            //RADDAT
         p_assert(length = %len(fmtString));                                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of edit word ''' + editWord +
                        ''' is: ' + %editc(length: 'Z') +
                        ' (' + fmtString + ')');                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_07  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_07"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_rmvKeyword                                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_07)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_07')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D string          S            128A   inz   varying                                      RADDAT
     D kwdValue        S            128A   inz   varying                                      RADDAT
     D cCMD            C                   const('PGM(*LIBL/QCMDEXC')                         RADDAT
     D cKEYWORD_PGM    C                   const('PGM')                                       RADDAT
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         string   = cCMD;                                                                   //RADDAT
         kwdValue = f_rmvKeyword(cKEYWORD_PGM: string);                                     //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'The value of ' + cKEYWORD_PGM +
                        ' is: ' + kwdValue);                                                //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_08  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_08"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_center/f_alignR                           "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_08)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_08')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D string          S            128A   inz   varying                                      RADDAT
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Center a literal into a string
         string = f_space(40);
         string = '>' + f_center('Hello World': %len(string)) + '<';
         msg = f_newMsg(cMSG_ID_NONE: 'Centered (literal)  : ' + string);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Center a given string
         string = 'Hello World' + f_space(29);   // = 40 characters
         string = '>' + f_center(string) + '<';
         msg = f_newMsg(cMSG_ID_NONE: 'Centered (string)   : ' + string);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Center a given string, target too small
         string = f_space(5);
         string = '>' + f_center('Hello World': %len(string)) + '<';
         msg = f_newMsg(cMSG_ID_NONE: 'Centered (too small): ' + string);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Right align a literal into a string
         string = f_space(40);
         string = '>' + f_alignR('Hello World': %len(string)) + '<';
         msg = f_newMsg(cMSG_ID_NONE: 'Aligned  (literal)  : ' + string);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Right align a given string
         string = 'Hello World' + f_space(29);   // = 40 characters
         string = '>' + f_alignR(string) + '<';
         msg = f_newMsg(cMSG_ID_NONE: 'Aligned  (string)   : ' + string);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Right align a given string, target too small
         string = f_space(5);
         string = '>' + f_alignR('Hello World': %len(string)) + '<';
         msg = f_newMsg(cMSG_ID_NONE: 'Aligned  (too small): ' + string);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_09  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_09"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genStrCmp/f_genStrCmpIgnCase              "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_09)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_09')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D isEqual         S               N   inz                                                RADDAT
     D string          S            128A   inz   varying                                      RADDAT
     D mask            S            128A   inz   varying                                      RADDAT
     D wildcard        S              2A   inz                                                RADDAT
     D procedure       S             20A   inz   varying                                      RADDAT
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Compare strings without using wildcards                                         //RADDAT
         // ------------------------------------------------                                //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'hello world';                                                            //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'hello world';                                                            //RADDAT
         isEqual = f_genStrCmpIgnCase(string: mask);                                        //RADDAT
         procedure = 'f_genStrCmpIgnCase';                                                  //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Compare strings, using asterisk
         // ------------------------------------------------                                //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello*';                                                                 //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = '*World';                                                                 //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = '*llo Worl*';                                                             //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'He*ld';                                                                  //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Compare strings using question mark
         // ------------------------------------------------                                //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello ?o?ld';   // That is equal to 'Hello World' ...                    //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello ?o?ld?';  // ... but that is not equal to 'Hello World'            //RADDAT
                                   //     since the mask expects another character          //RADDAT
                                   //     right after 'World'.                              //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = '?Hello ?o?ld';  // ... That is also not equal to 'Hello World'           //RADDAT
                                   //     since the mask expects a character just           //RADDAT
                                   //     before 'Hello'.                                   //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = '*Hello ?o?ld';  // ... However that is equal to 'Hello World'            //RADDAT
                                   //     since the asterisk stands for any or              //RADDAT
                                   //     none character.                                   //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello ?o?ld*';  // ... However that is also equal to 'Hello World'       //RADDAT
                                   //     since the asterisk stands for any or              //RADDAT
                                   //     none character.                                   //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Compare strings: mask is longer than string                                     //RADDAT
         // ------------------------------------------------                                //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello World!';                                                           //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Compare strings: string is longer than mask                                     //RADDAT
         // ------------------------------------------------                                //RADDAT
         string = 'Hello World!';                                                           //RADDAT
         mask   = 'Hello World';                                                            //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Now using different wildcard characters                                         //RADDAT
         // Use % instead of *                                                              //RADDAT
         // Use _ instead of ?                                                              //RADDAT
         // ------------------------------------------------                                //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = '%ello Worl%';                                                            //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello _or_d';                                                            //RADDAT
         isEqual = f_genStrCmp(string: mask);                                               //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(not isEqual);
                                                                                            //RADDAT
         // Once the different wildcard characters are passed
         // to f_genStrCmp, the strings are equal:
         string = 'Hello World';                                                            //RADDAT
         mask   = '%ello Worl%';                                                            //RADDAT
         isEqual = f_genStrCmp(string: mask: '%_');
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         string = 'Hello World';                                                            //RADDAT
         mask   = 'Hello _or_d';                                                            //RADDAT
         isEqual = f_genStrCmp(string: mask: '%_');                                         //RADDAT
         procedure = 'f_genStrCmp';                                                         //RADDAT
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         // ------------------------------------------------                                //RADDAT
         // Test cases added with v1.12
         // ------------------------------------------------                                //RADDAT
         // Generic mask with asterisks and
         // multiple 'a' (first char in mask) in i_string.
         string = 'tagesAbgangSchnittstelle200904161547580098.xml';                         //RADDAT
         mask   = '*abg*';
         isEqual = f_genStrCmpIgnCase(string: mask);
         procedure = 'f_genStrCmpIgnCase';
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         // Multiple dots
         string = '2009-06-24-13.54.25.112000__urn_uuid_+
                   C9187B2F662BE0D2881245844464833__.png';
         mask   = '*.png';
         isEqual = f_genStrCmpIgnCase(string: mask);
         procedure = 'f_genStrCmpIgnCase';
         exsr sndMsg;                                                                       //RADDAT
         p_assert(isEqual);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
         begsr sndMsg;                                                                      //RADDAT
                                                                                            //RADDAT
 B01     if isEqual;                                                                        //RADDAT
            msg = f_newMsg(cMsg_ID_NONE: procedure + ': ' +
                     '''' + string + ''' and ''' + mask + ''' are equal.');                 //RADDAT
 X01     else;                                                                              //RADDAT
            msg = f_newMsg(cMsg_ID_NONE: procedure + ': ' +
                     '''' + string + ''' and ''' + mask + ''' are not equal.');             //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         endsr;                                                                             //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_10  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_10"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_scanR                                     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_09)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_09')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D isEqual         S               N   inz                                                RADDAT
     D text            C                   const('+
     D                                     A spaceman came travelling on his +
     D                                     ship from afar, +
     D                                     ''twas light years of time since +
     D                                     his mission did start, +
     D                                     And over a village he halted his +
     D                                     craft, +
     D                                     And it hung in the sky like a +
     D                                     star, just like a star...')
     D searchArg       S            256A   inz   varying
     D searchText      S             32A   inz   varying
     D startPos        S             10I 0 inz
     D position        S             10I 0 inz
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg(cMsg_ID_NONE: text);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         startPos  = %len(text);
         searchArg = 'star';
         position  = f_scanR(searchArg: text);
         exsr sndMsg;                                                                       //RADDAT
                                                                                            //RADDAT
         startPos  = 190;
         searchArg = 'star';
         position  = f_scanR(searchArg: text: startPos);
         exsr sndMsg;                                                                       //RADDAT
                                                                                            //RADDAT
         startPos  = 170;
         searchArg = 'star';
         position  = f_scanR(searchArg: text: startPos);
         exsr sndMsg;                                                                       //RADDAT
                                                                                            //RADDAT
         startPos  = 90;
         searchArg = 'star';
         position  = f_scanR(searchArg: text: startPos);
         exsr sndMsg;                                                                       //RADDAT
                                                                                            //RADDAT
         startPos  = %len(text);
         searchArg = text;
         position  = f_scanR(searchArg: text: startPos);
         exsr sndMsg;                                                                       //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMsg_ID_NONE: '- Search argument longer than text: -');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT

         startPos  = %len(text);
         searchArg = text + ' an extension';
         position  = f_scanR(searchArg: text: startPos);
         exsr sndMsg;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
         begsr sndMsg;                                                                      //RADDAT

 B01     if %len(searchArg) > 10;
            searchText = %subst(searchArg: 1: 10) + ' ...';
 X01     else;
            searchText = searchArg;
 E01     endif;
                                                                                            //RADDAT
 B01     if position = 0;                                                                   //RADDAT
            msg = f_newMsg(cMsg_ID_NONE: 'Search argument ''' +
                           searchText +
                           ''' was not found before position ' +
                           %char(startPos) + '.');
 X01     else;                                                                              //RADDAT
            msg = f_newMsg(cMsg_ID_NONE: 'Search argument ''' +
                                         searchText +
                                         ''' found at position ' +
                                         %char(position) + '. ' +
                                         'Start position: ' + %char(startPos));
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         endsr;                                                                             //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_11  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_11"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_cvtBufferToHexString/f_cvtHexStringToBuffe"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_11) PARM(x'C88593939640E696999384')       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_11')                        RADDAT
     D  gi_buffer                    32A   const
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_buffer                     32A   const
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_buffer                    32A   const
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_buffer);
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_buffer                     32A   const
      *                                                                                       RADDAT
      *  Helper fields
     D size            S              5I 0                inz
     D buffer          S                   like(i_buffer) inz
     D string          S             64A   varying        inz
     D msgText         S            128A                  inz
     D msg             DS                  likeds(msg_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         // Convert a buffer to a hex string.
         buffer = i_buffer;
         size   = %len(%trimR(buffer));
         string = f_cvtBufferToHexString(%addr(buffer): size);
                                                                                            //RADDAT
         msgText = 'Buffer: ''' + %trimR(buffer) + '''' +
                   ' ==> Hex-String: ''' + string + '''';
         msg = f_newMsg(cMsg_ID_NONE: msgText);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT

         // Convert a string of hex values to a buffer
         string = 'C140A297818385948195408381948540A39981A5859393899587';
         size = f_cvtHexStringToBuffer(string: %addr(buffer): %size(buffer));
                                                                                            //RADDAT
         msgText = 'Hex-String: ''' + string + '''' +
                   ' ==> Buffer: ''' + %subst(buffer: 1: size) + '''';
         msg = f_newMsg(cMsg_ID_NONE: msgText);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_12  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_12"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_objName                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_12) PARM('SYSPROCS' 'QSYS2')              *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_12')                        RADDAT
     D  gi_name                      10A   const  options(*nopass)
     D  gi_lib                       10A   const  options(*nopass)
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_name                       10A   const
     D  i_lib                        10A   const
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_name                      10A   const  options(*nopass)
     D  gi_lib                       10A   const  options(*nopass)
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%parms() >= 2);
            main(gi_name: gi_lib);
 X01     else;
            main('SYSPROCS': 'QSYS2');
 E01     endif;
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_name                       10A   const
     D  i_lib                        10A   const
      *                                                                                       RADDAT
      *  Helper fields
     D objName         S             21A   inz
     D qObj            DS                  likeds(qObj_t) inz
     D msg             DS                  likeds(msg_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

         qObj.name = i_name;
         qObj.lib  = i_lib;
         objName = f_objname(qObj);

         p_assert(objName = %trimR(i_lib) + '/' + %trimR(i_name)
                  : 'Fehler in Funktion f_objName()');

         msg = f_newMsg(cMsg_ID_NONE: 'Qualified object name 1 is: ' + objName);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT

         objName = f_objname(i_name: i_lib);

         p_assert(objName = %trimR(i_lib) + '/' + %trimR(i_name)
                  : 'Fehler in Funktion f_objName()');

         msg = f_newMsg(cMsg_ID_NONE: 'Qualified object name 2 is: ' + objName);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_13  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_13"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_parseDate / f_formatDate                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_13)                                       *                       RADDAT
      *         PARM('2009-01-23' 'YYYY-MM-DD' 'ZD Mmmmmmmmmz YYYY')  *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_13')                        RADDAT
     D  gi_date_str                  32A   const  options(*nopass)                            RADDAT
     D  gi_pic_str                   32A   const  options(*nopass)                            RADDAT
     D  gi_fmt_str                   32A   const  options(*nopass)                            RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_date_str                   32A   const  varying                                     RADDAT
     D  i_pic_str                    32A   const  varying                                     RADDAT
     D  i_fmt_str                    32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_date_str                  32A   const  options(*nopass)                            RADDAT
     D  gi_pic_str                   32A   const  options(*nopass)                            RADDAT
     D  gi_fmt_str                   32A   const  options(*nopass)                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if (%parms() >= 3);                                                                //RADDAT
            main(%trim(gi_date_str): %trim(gi_pic_str): %trim(gi_fmt_str));                 //RADDAT
 X01     else;
            main(%char(%date(): *ISO): 'YYYY-MM-DD': 'ZD. Mmmmmmmmmz YYYY');
 E01     endif;
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_date_str                   32A   const  varying                                     RADDAT
     D  i_pic_str                    32A   const  varying                                     RADDAT
     D  i_fmt_str                    32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D date            S               D   inz                                                RADDAT
     D date_str        S             64A   inz varying                                        RADDAT
     D msg             DS                  likeds(msg_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         date = f_parseDate(i_date_str: i_pic_str);                                         //RADDAT
                                                                                            //RADDAT
         date_str = f_formatDate(date: i_fmt_str);                                          //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMsg_ID_NONE: 'Converted ' + f_addQuotes(i_date_str) +
                        ' to date ' + %char(date: *EUR) + ' and string: ' +
                        date_str);                                                          //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R3_14  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R3_14"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_formatMemSize                             "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R3_14)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R3_14')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
     D displayMemSize...                                                                      RADDAT
     D                 PR                                                                     RADDAT
     D  i_memSize                    20I 0 value
     D  i_unit                        2A   value  options(*nopass)
     D  i_decPos                     10I 0 value  options(*nopass)
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Display result.                                                                      RADDAT
      *===============================================================*                       RADDAT
     P displayMemSize...                                                                      RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D displayMemSize...                                                                      RADDAT
     D                 PI                                                                     RADDAT
     D  i_memSize                    20I 0 value
     D  i_unit                        2A   value  options(*nopass)
     D  i_decPos                     10I 0 value  options(*nopass)
      *                                                                                       RADDAT
      *  Helper fields
     D memSize         S                   like(i_memSize) inz
     D unit            S                   like(i_unit   ) inz
     D decPos          S                   like(i_decPos ) inz
     D msgText         S            128A   varying inz
     D formatted       S             64A   varying inz
     D msg             DS                  likeds(msg_t ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE

 B01     if (%parms() >= 2);
            unit = i_unit;
 X01     else;
            unit = '';
 E01     endif;

 B01     if (%parms() >= 3);
            decPos = i_decPos;
 X01     else;
            decPos = 7;
 E01     endif;

 B01     if (%rem(i_memSize: 1024) <> 0);
            memSize = i_memSize * 1.3;
 X01     else;
            memSize = i_memSize;
 E01     endif;

         msgText = %editc(memSize: 'Z') + ' Bytes = ' +
                   f_formatMemSize(memSize: unit: decPos) + ' ' + unit;
                                                                                            //RADDAT
         msg = f_newMsg(cMsg_ID_NONE: msgText);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P displayMemSize...                                                                      RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         displayMemSize(1024);
         displayMemSize((1024**1) + 1);
                                                                                            //RADDAT
         displayMemSize(1024**2);
         displayMemSize((1024**2) + 1);
                                                                                            //RADDAT
         displayMemSize(600: '': 7);
         displayMemSize(600: cMEM_SIZE_KILO_BYTE: 7);
                                                                                            //RADDAT
         displayMemSize(60000000: '': 7);
         displayMemSize(60000000: cMEM_SIZE_KILO_BYTE: 7);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R4_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R4_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: p_assert/f_this/f_caller                    "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R4_01) PARM('1')                             *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
 CPY  *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R4_01')                        RADDAT
     D  gi_boolean                    1A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_boolean                      N   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_boolean                    1A   const                                              RADDAT
      *
      *  Local helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
     D procedure       S            256A   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         procedure = f_this();                                                              //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '=> ' + '*N/'
                                            + '*N' + '.'
                                            + %trimR(procedure));                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         main(gi_boolean);                                                                  //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_boolean                      N   const                                              RADDAT
      *                                                                                       RADDAT
      *  Local helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
     D procedure       S            256A   inz                                                RADDAT
     D module          S             10A   inz                                                RADDAT
     D program         S             10A   inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         procedure = f_this();                                                              //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '=> ' + '*N/'
                                            + '*N' + '.'
                                            + %trimR(procedure));                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         procedure = f_this(module);                                                        //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '=> ' + '*N/'
                                            + %trimR(module) + '.'
                                            + %trimR(procedure));                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         procedure = f_this(module: program);                                               //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '=> ' + %trimR(program) + '/'
                                            + %trimR(module) + '.'
                                            + %trimR(procedure));                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         procedure = f_caller(module: program);
         msg = f_newMsg(cMSG_ID_NONE: '=> ' + %trimR(program) + '/'
                                            + %trimR(module) + '.'
                                            + %trimR(procedure));                           //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         p_assert(i_boolean                        :                                        //RADDAT
                  'Error detected by p_assert()'   );                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R5_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R5_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_exist  (object)                           "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R5_01) PARM('CHKOB' 'QSYS' '*CMD')           *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R5_01')                        RADDAT
     D  gi_obj                       10A   const                                              RADDAT
     D  gi_lib                       10A   const                                              RADDAT
     D  gi_type                      10A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_obj                              const  like(gi_obj    )                            RADDAT
     D  i_lib                              const  like(gi_lib    )                            RADDAT
     D  i_type                             const  like(gi_type   )                            RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_obj                       10A   const                                              RADDAT
     D  gi_lib                       10A   const                                              RADDAT
     D  gi_type                      10A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_obj: gi_lib: gi_type);                                                     //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_obj                              const  like(gi_obj    )                            RADDAT
     D  i_lib                              const  like(gi_lib    )                            RADDAT
     D  i_type                             const  like(gi_type   )                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if   not f_exist(i_lib: *omit: '*LIB');                                            //RADDAT
            msg = f_newMsg('CPF9898': 'Library ' + %trim(i_lib)
                                      + ' does not exist');                                 //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   not f_exist(i_obj: i_lib: i_type);                                         //RADDAT
               msg = f_newMsg('CPF9898': 'Object ' + %trim(i_lib) + '/'
                                         + %trim(i_obj) + ' (' + %trim(i_type)
                                         + ') does not exist');                             //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                   //RADDAT
 X02        else;                                                                           //RADDAT
               msg = f_newMsg('CPF9897': 'Done');                                           //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R5_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R5_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_exist  (member)                           "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *  CALL PGM(TEST_R5_02) PARM('QRPGSRC' 'QGPL' '*FILE' '*FIRST') *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R5_02')                        RADDAT
     D  gi_file                      10A   const                                              RADDAT
     D  gi_lib                       10A   const                                              RADDAT
     D  gi_mbr                       10A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_file                             const  like(gi_file   )                            RADDAT
     D  i_lib                              const  like(gi_lib    )                            RADDAT
     D  i_mbr                              const  like(gi_mbr    )                            RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_file                      10A   const                                              RADDAT
     D  gi_lib                       10A   const                                              RADDAT
     D  gi_mbr                       10A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_file: gi_lib: gi_mbr);                                                     //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_file                             const  like(gi_file   )                            RADDAT
     D  i_lib                              const  like(gi_lib    )                            RADDAT
     D  i_mbr                              const  like(gi_mbr    )                            RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
 B01     if   not f_exist(i_lib: *omit: '*LIB');                                            //RADDAT
            msg = f_newMsg('CPF9898': 'Library ' + %trim(i_lib)
                                      + ' does not exist');                                 //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 X01     else;                                                                              //RADDAT
 B02        if   not f_exist(i_file: i_lib: '*FILE': i_mbr);                                //RADDAT
               msg = f_newMsg('CPF9898': 'Member ' + %trim(i_lib) + '/'
                                         + %trim(i_file) + ' (' + %trim(i_mbr)
                                         + ') does not exist');                             //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                   //RADDAT
 X02        else;                                                                           //RADDAT
               msg = f_newMsg('CPF9897': 'Done');                                           //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                   //RADDAT
 E02        endif;                                                                          //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R5_03  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R5_03"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_getTmpName/f_getUniqueName                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *  CALL PGM(TEST_R5_03)                                         *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R5_03')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D qTmpObj         DS                  likeds(qObj_t    ) inz                             RADDAT
     D qUnqObj         DS                  likeds(qObj_t    ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         qTmpObj = f_getTmpName();                                                          //RADDAT
         msg = f_newMsg('CPF9898': 'Temporary object name is: ' +
                         %trim(qTmpObj.lib) + '/' + %trim(qTmpObj.name));                   //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         qUnqObj = f_getUniqueName('*FILE': 'QGPL');                                        //RADDAT
         msg = f_newMsg('CPF9898': 'Unique object name is: ' +
                         %trim(qUnqObj.lib) + '/' + %trim(qUnqObj.name));                   //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R5_04  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R5_04"
mbrtype =  "RPGLE     "
mbrtext =  "Test: user space procedures                       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *  CALL PGM(TEST_R5_04)                                         *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R5_04')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *  Returns the user space size choosen by the i5/OS based on                            RADDAT
      *  an given size.                                                                       RADDAT
     D OS_getUsrSpcSize...                                                                    RADDAT
     D                 PR            10I 0                                                    RADDAT
     D i_size                        10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Returns the user space size choosen by the i5/OS based on                            RADDAT
      *  an given size.                                                                       RADDAT
      *===============================================================*                       RADDAT
     P OS_getUsrSpcSize...                                                                    RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D OS_getUsrSpcSize...                                                                    RADDAT
     D                 PI            10I 0                                                    RADDAT
     D i_size                        10I 0 const                                              RADDAT
      *                                                                                       RADDAT
      *  Return value                                                                         RADDAT
     D size            S             10I 0 inz                                                RADDAT
      *                                                                                       RADDAT
      *  Disk page size                                                                       RADDAT
     D cPAGE_SIZE      C                   4096                                               RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         size = %int(i_size / cPAGE_SIZE) * cPAGE_SIZE;                                     //RADDAT
                                                                                            //RADDAT
 B01     if (size <> i_size);                                                               //RADDAT
            size = size + cPAGE_SIZE;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         size = size - 512;   // User space administration attributes                       //RADDAT
                                                                                            //RADDAT
         return size;                                                                       //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P OS_getUsrSpcSize...                                                                    RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D size            S             10I 0 inz                                                RADDAT
     D isAutoExt       S               N   inz                                                RADDAT
     D initValue       S              1A   inz                                                RADDAT
     D qUsrSpc         DS                  likeds(qObj_t    ) inz
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
     D tmpMsg          DS                  likeds(msg_t     ) inz                             RADDAT
      *
     D cDEFAULT_SIZE   C                   512
     D cBIG_SIZE       C                   7200                                               RADDAT
     D cDEFAULT_AUTO_EXT...                                                                   RADDAT
     D                 C                   '0'                                                RADDAT
     D cDEFAULT_INIT_VALUE...                                                                 RADDAT
     D                 S              1A   inz(x'00')                                         RADDAT
     D cNEW_INIT_VALUE...                                                                     RADDAT
     D                 S              1A   inz('X')                                           RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_OK);                                                        //RADDAT
                                                                                            //RADDAT
         qUsrSpc = f_getTmpName();

 B01     dou '1';

            // create user space
 B02        if (not f_crtUsrSpc(qUsrSpc.name: qUsrSpc.lib
                                : 'Test BASICS1: user space'
                                : cDEFAULT_SIZE
                                : 'TEST'
                                : '*USE'
                                : msg));
               leave;                                                                       //RADDAT
 E02        endif;

            // check user space size
            size = f_getUsrSpcSize(qUsrSpc.name: qUsrSpc.lib: msg);                         //RADDAT
 B02        if (size < 0);                                                                  //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if (size <> OS_getUsrSpcSize(cDEFAULT_SIZE));                                   //RADDAT
               msg = f_newMsg('CPF9898': 'User space size ' + %char(size) +
                              ' does not match expected value ' +
                              %char(OS_getUsrSpcSize(cDEFAULT_SIZE)));                      //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;
                                                                                            //RADDAT
            // change user space size                                                       //RADDAT
            size = f_chgUsrSpcSize(qUsrSpc.name: qUsrSpc.lib: cBIG_SIZE: msg);              //RADDAT
 B02        if (size < 0);                                                                  //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // check new user space size which was returned by f_chgUsrSpcSize()            //RADDAT
 B02        if (size <> OS_getUsrSpcSize(cBIG_SIZE));                                       //RADDAT
               msg = f_newMsg('CPF9898': 'User space size ' + %char(size) +
                              ' does not match expected value ' +
                              %char(OS_getUsrSpcSize(cDEFAULT_SIZE)));                      //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // check user space automatic extendibility attribute                           //RADDAT
            isAutoExt = f_getUsrSpcAutoExt(qUsrSpc.name: qUsrSpc.lib: msg);                 //RADDAT
 B02        if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if (isAutoExt <> cDEFAULT_AUTO_EXT);                                            //RADDAT
               msg = f_newMsg('CPF9898'
                              : 'User space automatic extendibility ''' +
                                isAutoExt +
                                ''' does not match expected value ' +
                                cDEFAULT_AUTO_EXT);                                         //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // change user space automatic extendibility                                    //RADDAT
            isAutoExt = f_chgUsrSpcAutoExt(qUsrSpc.name: qUsrSpc.lib
                                           : not cDEFAULT_AUTO_EXT: msg);                   //RADDAT
                                                                                            //RADDAT
            // check new user space automatic extendibility which                           //RADDAT
            // was returned by f_chgUsrSpcAutoExt()                                         //RADDAT
 B02        if (isAutoExt <> not cDEFAULT_AUTO_EXT);                                        //RADDAT
               msg = f_newMsg('CPF9898'
                              : 'User space automatic extendibility ''' +
                                 isAutoExt +
                                 ''' does not match expected value ''' +
                                 not cDEFAULT_AUTO_EXT + '''');                             //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // check user space initial value                                               //RADDAT
            initValue = f_getUsrSpcInitValue(qUsrSpc.name: qUsrSpc.lib: msg);               //RADDAT
 B02        if (msg.ID <> cMSG_ID_OK);                                                      //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
 B02        if (initValue <> cDEFAULT_INIT_VALUE);                                          //RADDAT
               msg = f_newMsg('CPF9898'
                    : 'User space initial value x''' +
                      f_cvtBufferToHexString(%addr(initValue): 1) +
                      ''' does not match expected value x''' +
                      f_cvtBufferToHexString(%addr(cDEFAULT_INIT_VALUE): 1) +
                      '''');                                                                //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // change user space initial value                                              //RADDAT
            initValue = f_chgUsrSpcInitValue(qUsrSpc.name: qUsrSpc.lib
                                             : cNEW_INIT_VALUE: msg);                       //RADDAT
                                                                                            //RADDAT
            // check new user space initual value which                                     //RADDAT
            // was returned by f_chgUsrSpcInitValue()                                       //RADDAT
 B02        if (initValue <> cNEW_INIT_VALUE);                                              //RADDAT
               msg = f_newMsg('CPF9898'
                        : 'User space initial value x''' +
                          f_cvtBufferToHexString(%addr(initValue): 1) +
                          ''' does not match expected value x''' +
                          f_cvtBufferToHexString(%addr(cNEW_INIT_VALUE): 1) +
                          '''');                                                            //RADDAT
               leave;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT

 E01     enddo;

            // delete user space                                                            //RADDAT
 B01     if (f_exist(qUsrSpc.name: qUsrSpc.lib: '*USRSPC'));
 B02        if (not f_dltUsrSpc(qUsrSpc.name: qUsrSpc.lib: tmpMsg));                        //RADDAT
               tmpMsg.ID = cMSG_DIAG;                                                       //RADDAT
               f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
 E02        endif;
 E01     endif;
                                                                                            //RADDAT
 B01     if (msg.ID <> cMSG_ID_OK);                                                         //RADDAT
            msg.type = cMSG_ESCAPE;                                                         //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R5_05  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R5_05"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_cvtQSYSObjNameToPath/f_cvtPathToQSYSObjNam"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *  CALL PGM(TEST_R5_05)                                         *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
      /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R5_05')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *
     D kill...
     D                 PR                         extproc('kill')
     D  i_text                      128A   value  varying
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();                                                                            //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *
      *===============================================================*
      *  Kills the program.
      *===============================================================*
     P kill...
     P                 B
     D                 PI
     D  i_text                      128A   value  varying
      *
      *  Return value
     D pBuffer         S               *   inz
      *
      *  Local fields
     D msgKey          S              4A                        inz
      *
     D qMsgF           DS                  qualified            inz
     D  name                         10A
     D  lib                          10A
      *
     D errCode         DS                  qualified            inz
     D  bytPrv                       10I 0
     D  bytAvl                       10I 0
     D  excID                         7A
     D  reserved                      1A
     D  excDta                      256A
      *
      *  Send Program Message (QMHSNDPM) API
     D QMHSNDPM        PR                         extpgm('QMHSNDPM')
     D   i_msgID                      7A   const
     D   i_qMsgF                     20A   const
     D   i_msgData                32767A   const  options(*varsize )
     D   i_length                    10I 0 const
     D   i_msgType                   10A   const
     D   i_callStkE               32767A   const  options(*varsize )
     D   i_callStkC                  10I 0 const
     D   o_msgKey                     4A
     D   io_ErrCode               32767A          options(*varsize )
     D   i_lenStkE                   10I 0 const  options(*nopass  )
     D   i_callStkEQ                 20A   const  options(*nopass  )
     D   i_wait                      10I 0 const  options(*nopass  )
     D   i_callStkEDT                10A   const  options(*nopass  )
     D   i_ccsid                     10I 0 const  options(*nopass  )
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      /FREE

         clear qMsgF;
         qMsgF.name = 'QCPFMSG';
         qMsgF.lib  = '*LIBL';

         clear errCode;
         errCode.bytPrv = %size(errCode);

         QMHSNDPM('CPF9897': qMsgF: i_text: %len(i_text): '*ESCAPE'
                  : '*CTLBDY': 1
                  : msgKey: errCode);

         return;

      /END-FREE
     P                 E
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D qQSYSObj        ds                  likeds(qQSYSObj_t) inz
     D qFile           ds                  likeds(qFile_t) inz
     D qObj            ds                  likeds(qObj_t) inz
     D qQSYSObj2       ds                  likeds(qQSYSObj_t) inz
     D library         s             10a
     D object          s             10a
     D member          s             10a
     D path            s           5000a   varying
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         qQSYSObj.name = 'QBASICS1';
         qQSYSObj.lib = 'QGPL';
         qQSYSObj.mbr = 'PBASICS1';
         qQSYSObj.type = '*FILE';

         path = f_cvtQSYSObjNameToPath(qQSYSObj);
         if (path <> '/QSYS.LIB/QGPL.LIB/QBASICS1.FILE/PBASICS1.MBR');
            kill('Error with qQSYSObj (*FILE)');
         endif;
                                                                                            //RADDAT
         qQSYSObj.name = 'QMHSNDPM';
         qQSYSObj.lib = 'QSYS';
         qQSYSObj.mbr = '';
         qQSYSObj.type = '*PGM';

         path = f_cvtQSYSObjNameToPath(qQSYSObj);
         if (path <> '/QSYS.LIB/QMHSNDPM.PGM');
            kill('Error with qQSYSObj (*PGM)');
         endif;
                                                                                            //RADDAT
         qQSYSObj.name = 'BASICS1';
         qQSYSObj.lib = 'UBMSYS';
         qQSYSObj.mbr = '';
         qQSYSObj.type = '*SRVPGM';

         path = f_cvtQSYSObjNameToPath(qQSYSObj);
         if (path <> '/QSYS.LIB/UBMSYS.LIB/BASICS1.SRVPGM');
            kill('Error with qQSYSObj (*SRVPGM)');
         endif;
                                                                                            //RADDAT
         qFile.name = 'QBASICS1';
         qFile.lib = 'QGPL';
         qFile.mbr = 'PBASICS1';
                                                                                            //RADDAT
         qObj.name = 'QBASICS1';
         qObj.lib = 'QGPL';
                                                                                            //RADDAT
         object = 'QBASICS1';
         library = 'QGPL';
         member = 'PBASICS1';

         path = f_cvtQSYSObjNameToPath(qFile);
         if (path <> '/QSYS.LIB/QGPL.LIB/QBASICS1.FILE/PBASICS1.MBR');
            kill('Error with qFile');
         endif;

         qQSYSObj2 = f_cvtPathToQSYSObjName(path);
         if (qQSYSObj2.name <> object or
             qQSYSObj2.lib <> library or
             qQSYSObj2.mbr <> member or
             qQSYSObj2.type <> '*FILE');
            kill('Error with qQSYSObj2 from qFile');
         endif;

         path = f_cvtQSYSObjNameToPath(qFile: '*FILE');
         if (path <> '/QSYS.LIB/QGPL.LIB/QBASICS1.FILE/PBASICS1.MBR');
            kill('Error with qFile and object type *FILE');
         endif;

         qQSYSObj2 = f_cvtPathToQSYSObjName(path);
         if (qQSYSObj2.name <> object or
             qQSYSObj2.lib <> library or
             qQSYSObj2.mbr <> member or
             qQSYSObj2.type <> '*FILE');
            kill('Error with qQSYSObj2 from qFile');
         endif;

         monitor;
            path = f_cvtQSYSObjNameToPath(qFile: '*PGM');
            kill('Error with qFile and object type *PGM');
         on-error;
            // Exception seen
         endmon;

         path = f_cvtQSYSObjNameToPath(qObj: '*DTAARA');
         if (path <> '/QSYS.LIB/QGPL.LIB/QBASICS1.DTAARA');
            kill('Error with qObj and object type *DTAARA');
         endif;

         qQSYSObj2 = f_cvtPathToQSYSObjName(path);
         if (qQSYSObj2.name <> object or
             qQSYSObj2.lib <> library or
             qQSYSObj2.mbr <> '' or
             qQSYSObj2.type <> '*DTAARA');
            kill('Error with qQSYSObj2 from qObj and object type *DTAARA');
         endif;

         path = f_cvtQSYSObjNameToPath(library: '*LIB');
         if (path <> '/QSYS.LIB/QGPL.LIB');
            kill('Error with library and object type *LIB');
         endif;

         qQSYSObj2 = f_cvtPathToQSYSObjName(path);
         if (qQSYSObj2.name <> library or
             qQSYSObj2.lib <> '' or
             qQSYSObj2.mbr <> '' or
             qQSYSObj2.type <> '*LIB');
            kill('Error with qQSYSObj2 from library and object type *LIB');
         endif;

         path = f_cvtQSYSObjNameToPath(object: '*OUTQ');
         if (path <> '/QSYS.LIB/%LIBL%.LIB/QBASICS1.OUTQ');
            kill('Error with object and object type *OUTQ');
         endif;

         qQSYSObj2 = f_cvtPathToQSYSObjName(path);
         if (qQSYSObj2.name <> object or
             qQSYSObj2.lib <> '*LIBL' or
             qQSYSObj2.mbr <> '' or
             qQSYSObj2.type <> '*OUTQ');
            kill('Error with qQSYSObj2 from object and object type *OUTQ');
         endif;

         path = f_cvtQSYSObjNameToPath(object: library: '*MSGQ');
         if (path <> '/QSYS.LIB/QGPL.LIB/QBASICS1.MSGQ');
            kill('Error with object/library and object type *MSGQ');
         endif;

         qQSYSObj2 = f_cvtPathToQSYSObjName(path);
         if (qQSYSObj2.name <> object or
             qQSYSObj2.lib <> library or
             qQSYSObj2.mbr <> '' or
             qQSYSObj2.type <> '*MSGQ');
            kill('Error with qQSYSObj2 from object, library and +
                  object type *MSGQ');
         endif;

         path = f_cvtQSYSObjNameToPath(object: library: member: '*FILE');
         if (path <> '/QSYS.LIB/QGPL.LIB/QBASICS1.FILE/PBASICS1.MBR');
            kill('Error with object/library/member and object type *FILE');
         endif;

         monitor;
            path = f_cvtQSYSObjNameToPath(object: library: member: '*PGM');
            kill('Error with qFile and object type *PGM');
         on-error;
            // Exception seen
         endmon;
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R6_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R6_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_execute                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R6_01) PARM('CHKOBJ QSY *LIB')               *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R6_01')                        RADDAT
     D  gi_cmd                       32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_cmd                        32A   const                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_cmd                       32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(gi_cmd);                                                                      //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_cmd                        32A   const                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Ignore Errors                                                                   //RADDAT
         msg = f_newMsg('CPF9897': '*** Ignore Errors ***');                                //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
 B01     if   not f_execute(i_cmd: *omit: *omit);                                           //RADDAT
            msg = f_newMsg('CPF9898': 'Error on: ' + %trim(i_cmd));                         //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Return error information                                                        //RADDAT
         msg = f_newMsg('CPF9897': '*** Return error information ***');                     //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
 B01     if   not f_execute(i_cmd: *omit: msg);                                             //RADDAT
            // Do not let the program crash here                                            //RADDAT
            msg.type = cMsg_Diag;                                                           //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Send *ESCAPE message to signal error                                            //RADDAT
         msg = f_newMsg('CPF9897': '*** Send *ESCAPE message ***');                         //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         f_execute(i_cmd: *omit);                                                           //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R6_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R6_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_getNumEnvVar, f_getEnvVarByIndex ...      "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R6_02) PARM('de.tools400.test_r6_02.')       *
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R6_02')                        RADDAT
     D  gi_prefix                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_prefix                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_prefix                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trim(gi_prefix));
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_prefix                     32A   const varying                                      RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D isError         S               N                     inz(cFalse)
     D x               S             10I 0                   inz
     D numEnvVar       S             10I 0                   inz
     D envVar          DS                  likeds(envVar_t ) inz
     D msg             DS                  likeds(msg_t    ) inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Get number of environment variables                                             //RADDAT
         numEnvVar = f_getNumEnvVar();
                                                                                            //RADDAT
         // Check environment variables for prefix                                          //RADDAT
 B01     for x = 1 to numEnvVar;
            envVar = f_getEnvVarByIndex(x);

            // If an existing variable starts with the
            // given prefix ...
 B02        if %len(envVar.name) >= %len(i_prefix);
 B03           if f_left(envVar.name: %len(i_prefix)) =
                                               f_left(i_prefix: %len(i_prefix));
                  // ... then tell the user that we can't proceed.
                  msg = f_newMsg('CPF9897':
                                 'ERROR - Found variable starting with: ' +
                                 envVar.name + '. Can''t proceed!');
                  f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                  isError = cTrue;
 E03           endif;
 E02        endif;
 E01     endfor;

         // If there is no variable that starts with the
         // given prefix ...
 B01     if not isError;

            // ... add some variables to the environment
            f_setEnvVar(i_prefix + 'var1': 'Hello World');
            f_setEnvVar(i_prefix + 'var2': 'A Spaceman came travelling ...');

            // ... spinn through all of the variables
            numEnvVar = f_getNumEnvVar();

 B02        for x = 1 to numEnvVar;
               envVar = f_getEnvVarByIndex(x);
               // ... and show them
               msg = f_newMsg('CPF9897': 'Found variable: ' + envVar.name +
                                                      ' = ' + envVar.value);
               f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
 E02        endfor;

            // ... finally remove the environment variables we
            //     just added before.
            f_delEnvVar(i_prefix + 'var1');
            f_delEnvVar(i_prefix + 'var2');

 E01     endif;
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_isBitOn                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
     D cFILE_CREATE    C                   const(1)
     D cFILE_REPLACE   C                   const(2)
     D cFILE_APPEND    C                   const(4)
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
     D lf_openFile...                                                                         RADDAT
     D                 PR                                                                     RADDAT
     D  i_openFlags                  10U 0 const
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create file and replace data                                                    //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** CREATE + REPLACE ***');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
         lf_openFile(cFILE_CREATE + cFILE_REPLACE);
                                                                                            //RADDAT
         // Append data
         msg = f_newMsg(cMSG_ID_NONE: '*** APPEND ***');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
         lf_openFile(cFILE_APPEND);
                                                                                            //RADDAT
         // Append and replace data
         msg = f_newMsg(cMSG_ID_NONE: '*** APPEND + REPLACE ***');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
         lf_openFile(cFILE_APPEND + cFILE_REPLACE);
                                                                                            //RADDAT
         // Bits are zero. ==> Error
         msg = f_newMsg(cMSG_ID_NONE: '*** Bits are zero ***');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
         monitor;
            f_isBitOn(0: 5);
         on-error;
            msg = f_newMsg(cMSG_ID_NONE: 'Error monitored.');
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
         endmon;
                                                                                            //RADDAT
         // End message
         msg = f_newMsg(cMSG_ID_NONE: '*** END OF TEST ***');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Dummy: Open a file.                                                                  RADDAT
      *===============================================================*                       RADDAT
     P lf_openFile...                                                                         RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D lf_openFile...                                                                         RADDAT
     D                 PI                                                                     RADDAT
     D  i_openFlags                  10U 0 const
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Check CREATE flag                                                               //RADDAT
 B01     if   f_isBitOn(cFILE_CREATE: i_openFlags);
            msg = f_newMsg(cMSG_ID_NONE: 'If the file being opened does not +
                                          exist, it is created.');
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
 E01     endif;
                                                                                            //RADDAT
         // Check APPEND + REPLACE flag                                                     //RADDAT
 B01     if   f_isBitOn(cFILE_APPEND + cFILE_REPLACE: i_openFlags);
            msg = f_newMsg(cMSG_ID_NONE: 'APPEND + REPLACE must not be +
                                          specified together.');
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
            return;
 E01     endif;
                                                                                            //RADDAT
         // Check REPLACE flag
 B01     if   f_isBitOn(cFILE_REPLACE: i_openFlags);
            msg = f_newMsg(cMSG_ID_NONE: 'Replace existing data +
                                          if the file exists.');
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
 E01     endif;
                                                                                            //RADDAT
         // Check APPEND flag                                                               //RADDAT
 B01     if   f_isBitOn(cFILE_APPEND: i_openFlags);
            msg = f_newMsg(cMSG_ID_NONE: 'Append new data to the end of the +
                                          file.');
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
 E01     endif;
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P lf_openFile...                                                                         RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_log10, f_clcLengthOfRPGIntFieldFromBufSize"
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_02)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
     D cFILE_CREATE    C                   const(1)
     D cFILE_REPLACE   C                   const(2)
     D cFILE_APPEND    C                   const(4)
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_02')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      *                                                                                       RADDAT
     D rpgLEngth       S              5U 0 inz                                                RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Compute length of a 1-byte integer field ( 3 I 0)                               //RADDAT
         rpgLength = f_clcLengthOfRPGIntFieldFromBufSize(1);                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of 1-byte integer is: ' +
                        %editc(rpgLength: 'Z'));                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Compute length of a 2-byte integer field ( 5 I 0)                               //RADDAT
         rpgLength = f_clcLengthOfRPGIntFieldFromBufSize(2);                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of 2-byte integer is: ' +
                        %editc(rpgLength: 'Z'));                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Compute length of a 4-byte integer field (10 I 0)                               //RADDAT
         rpgLength = f_clcLengthOfRPGIntFieldFromBufSize(4);                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of 4-byte integer is: ' +
                        %editc(rpgLength: 'Z'));                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         // Compute length of a 8-byte integer field (20 I 0)                               //RADDAT
         rpgLength = f_clcLengthOfRPGIntFieldFromBufSize(8);                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: 'Length of 8-byte integer is: ' +
                        %editc(rpgLength: 'Z'));                                            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_03  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_03"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genUUID                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_03)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_03')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D uuidAsHex       DS                  likeds(uuid_t    ) inz                             RADDAT
     D uuidAsString    DS                  likeds(uuid_t    ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a hexadecimal UUID.
         // Note: Parameter 'cUUID_HEX' is                                                  //RADDAT
         //       are optional. Default is 'cUUID_HEX'.
         uuidAsHex = f_genUUID(cUUID_HEX);                                                  //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'UUID as ' + %char(uuidAsHex.length) +
                        '-byte hex value: ' + uuidAsHex.value);                             //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Generate a string UUID.
         uuidAsString = f_genUUID(cUUID_STRING);                                            //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'UUID as ' + %char(uuidAsString.length) +
                        '-byte string value: ' + uuidAsString.value);                       //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_04  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_04"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genMD5                                    "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_04) PARM('Hello World')                   *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_04')                        RADDAT
     D  gi_string                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_string                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_string                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trimR(gi_string));                                                           //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_string                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D buffer          S             64A                      inz                             RADDAT
     D md5AsHex        DS                  likeds(md5_t     ) inz                             RADDAT
     D md5AsString     DS                  likeds(md5_t     ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a hexadecimal MD5.                                                     //RADDAT
         // Note: Parameters 'cMD5_HEX' and 'length'                                        //RADDAT
         //       are optional. Default is 'cMD5_HEX'.                                      //RADDAT
         md5AsHex = f_genMD5(i_string: cMD5_HEX);                                           //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'MD5 as ' + %char(md5AsHex.length) +
                        '-byte hex value: ' + md5AsHex.value);                              //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Generate a string MD5.                                                          //RADDAT
         md5AsString = f_genMD5(i_string: cMD5_STRING);                                     //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'MD5 as ' + %char(md5AsString.length) +
                        '-byte string value: ' + md5AsString.value);                        //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Generate a string MD5 from a buffer.                                            //RADDAT
         buffer      = i_string;                                                            //RADDAT
         md5AsString = f_genMD5(%addr(buffer): cMD5_STRING: %size(buffer));                 //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'MD5 as ' + %char(md5AsString.length) +
                        '-byte string value: ' + md5AsString.value);                        //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_05  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_05"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genSHA1                                   "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_05) PARM('Hello World')                   *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_05')                        RADDAT
     D  gi_string                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_string                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_string                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trimR(gi_string));                                                           //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_string                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D buffer          S             64A                      inz                             RADDAT
     D sha1AsHex       DS                  likeds(sha1_t    ) inz                             RADDAT
     D sha1AsString    DS                  likeds(sha1_t    ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a hexadecimal SHA-1.                                                   //RADDAT
         // Note: Parameters 'cSHA1_HEX' and 'length'                                       //RADDAT
         //       are optional. Default is 'cSHA1_HEX'.                                     //RADDAT
         sha1AsHex = f_genSHA1(i_string: cSHA1_HEX);                                        //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'SHA-1 as ' + %char(sha1AsHex.length) +
                        '-byte hex value: ' + sha1AsHex.value);                             //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Generate a string SHA-1.                                                        //RADDAT
         sha1AsString = f_genSHA1(i_string: cSHA1_STRING);                                  //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'SHA-1 as ' + %char(sha1AsString.length) +
                        '-byte string value: ' + sha1AsString.value);                       //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         // Generate a string SHA-1 from a buffer.                                          //RADDAT
         buffer      = i_string;                                                            //RADDAT
         sha1AsString = f_genSHA1(%addr(buffer): cSHA1_STRING: %len(i_string));             //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'SHA-1 as ' + %char(sha1AsString.length) +
                        '-byte string value: ' + sha1AsString.value);                       //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_06  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_06"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genMD5 of IFS stream file                 "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_06) PARM('Hello World.txt')               *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,CLIB                                                                     RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_06')                        RADDAT
     D  gi_path                      32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_path                       32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_path                      32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trimR(gi_path));                                                             //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_path                       32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D is1Call         S               N                      inz(cFalse)                     RADDAT
     D md5Options      S              5U 0                    inz                             RADDAT
     D hFile           S             10I 0                    inz                             RADDAT
     D inBuff          DS                  qualified                                          RADDAT
     D  size                         10U 0                    inz                             RADDAT
     D  value                        64A                      inz                             RADDAT
     D bytesLeft       S             10U 0                    inz                             RADDAT
     D md5AsString     DS                  likeds(md5_t     ) inz                             RADDAT
     D st_stat         DS                  likeds(st_stat_t ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a string MD5 of a given stream file:                                   //RADDAT
                                                                                            //RADDAT
         // Open stream file                                                                //RADDAT
         hFile = open(i_path: O_RDONLY);                                                    //RADDAT
 B01     if hFile = RC_ERROR;                                                               //RADDAT
            return;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get size of stream file                                                         //RADDAT
 B01     if stat(i_path: %addr(st_stat)) = RC_ERROR;                                        //RADDAT
            callp close(hFile);                                                             //RADDAT
            return;                                                                         //RADDAT
 X01     else;                                                                              //RADDAT
            bytesLeft = st_stat.size;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Read 1. chunk of data                                                           //RADDAT
         inBuff.size = read(hFile: %addr(inBuff.value): %size(inBuff.value));               //RADDAT
                                                                                            //RADDAT
         is1Call = cTrue;   // First call to f_genMD5                                       //RADDAT
                                                                                            //RADDAT
 B01     dow inBuff.size > 0;                                                               //RADDAT
                                                                                            //RADDAT
            // Set MD5 options                                                              //RADDAT
 B02        if is1Call;                                                                     //RADDAT
 B03           if inBuff.size < bytesLeft;                                                  //RADDAT
                  md5Options = cMD5_FIRST;                                                  //RADDAT
 X03           else;                                                                        //RADDAT
                  md5Options = cMD5_ONLY;                                                   //RADDAT
 E03           endif;                                                                       //RADDAT
               is1Call = cFalse;                                                            //RADDAT
 X02        else;                                                                           //RADDAT
 B03           if inBuff.size < bytesLeft;                                                  //RADDAT
                  md5Options = cMD5_MIDDLE;                                                 //RADDAT
 X03           else;                                                                        //RADDAT
                  md5Options = cMD5_FINAL;                                                  //RADDAT
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            md5Options = md5Options + cMD5_STRING;                                          //RADDAT
                                                                                            //RADDAT
            // Call MD5 generation                                                          //RADDAT
            md5AsString = f_genMD5(%addr(inBuff.value):md5Options:inBuff.size);
                                                                                            //RADDAT
            // Decrease number of bytes left                                                //RADDAT
            bytesLeft = bytesLeft - inBuff.size;                                            //RADDAT
                                                                                            //RADDAT
            // Read next chunk of data                                                      //RADDAT
            inBuff.size = read(hFile: %addr(inBuff.value): %size(inBuff.value));            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Close stream file                                                               //RADDAT
         callp close(hFile);                                                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'MD5 as ' + %char(md5AsString.length) +
                        '-byte string value: ' + md5AsString.value);                        //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_07  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_07"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genSHA1 of IFS stream file                "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_07) PARM('Hello World.txt')               *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,CLIB                                                                     RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_07')                        RADDAT
     D  gi_path                      32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_path                       32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_path                      32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trimR(gi_path));                                                             //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_path                       32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D is1Call         S               N                      inz(cFalse)                     RADDAT
     D shaOptions      S              5U 0                    inz                             RADDAT
     D hFile           S             10I 0                    inz                             RADDAT
     D inBuff          DS                  qualified                                          RADDAT
     D  size                         10U 0                    inz                             RADDAT
     D  value                        64A                      inz                             RADDAT
     D bytesLeft       S             10U 0                    inz                             RADDAT
     D shaAsString     DS                  likeds(sha1_t    ) inz                             RADDAT
     D st_stat         DS                  likeds(st_stat_t ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a string SHA-1 of a given stream file:
                                                                                            //RADDAT
         // Open stream file                                                                //RADDAT
         hFile = open(i_path: O_RDONLY);                                                    //RADDAT
 B01     if hFile = RC_ERROR;                                                               //RADDAT
            return;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get size of stream file                                                         //RADDAT
 B01     if stat(i_path: %addr(st_stat)) = RC_ERROR;                                        //RADDAT
            callp close(hFile);                                                             //RADDAT
            return;                                                                         //RADDAT
 X01     else;                                                                              //RADDAT
            bytesLeft = st_stat.size;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Read 1. chunk of data                                                           //RADDAT
         inBuff.size = read(hFile: %addr(inBuff.value): %size(inBuff.value));               //RADDAT
                                                                                            //RADDAT
         is1Call = cTrue;   // First call to f_genSHA1                                      //RADDAT
                                                                                            //RADDAT
 B01     dow inBuff.size > 0;                                                               //RADDAT
                                                                                            //RADDAT
            // Set SHA-1 options
 B02        if is1Call;                                                                     //RADDAT
 B03           if inBuff.size < bytesLeft;                                                  //RADDAT
                  shaOptions = cSHA1_FIRST;
 X03           else;                                                                        //RADDAT
                  shaOptions = cSHA1_ONLY;
 E03           endif;                                                                       //RADDAT
               is1Call = cFalse;                                                            //RADDAT
 X02        else;                                                                           //RADDAT
 B03           if inBuff.size < bytesLeft;                                                  //RADDAT
                  shaOptions = cSHA1_MIDDLE;
 X03           else;                                                                        //RADDAT
                  shaOptions = cSHA1_FINAL;
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            shaOptions = shaOptions + cSHA1_STRING;
                                                                                            //RADDAT
            // Call SHA generation                                                          //RADDAT
            shaAsString = f_genSHA1(%addr(inBuff.value):shaOptions:inBuff.size);
                                                                                            //RADDAT
            // Decrease number of bytes left                                                //RADDAT
            bytesLeft = bytesLeft - inBuff.size;                                            //RADDAT
                                                                                            //RADDAT
            // Read next chunk of data                                                      //RADDAT
            inBuff.size = read(hFile: %addr(inBuff.value): %size(inBuff.value));            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Close stream file                                                               //RADDAT
         callp close(hFile);                                                                //RADDAT
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'SHA-1 as ' + %char(shaAsString.length) +
                        '-byte string value: ' + shaAsString.value);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_08  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_08"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genCRC32                                  "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_08) PARM('Hello World!')                  *
      *    CALL PGM(TEST_R7_08) PARM(x'48656C6C6F20576F726C6421')     *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_08')                        RADDAT
     D  gi_string                    32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_string                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_string                    32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trimR(gi_string));                                                           //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_string                     32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D crc32           DS                  likeds(crc32_t   ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a CRC32 checksum.
         crc32 = f_genCRC32(i_string);
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'CRC32 as ' + %char(crc32.length) +
                        '-byte hex value: ' + crc32.value);
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R7_09  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R7_09"
mbrtype =  "RPGLE     "
mbrtext =  "Test: f_genCRC32 of IFS stream file               "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R7_09) PARM('Hello World.txt')               *                       RADDAT
      *    CALL PGM(TEST_R7_09) PARM('20050731-019-i32.exe')          *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,CLIB                                                                     RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R7_09')                        RADDAT
     D  gi_path                      32A   const                                              RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
     D  i_path                       32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
     D  gi_path                      32A   const                                              RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main(%trimR(gi_path));                                                             //RADDAT
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
     D  i_path                       32A   const  varying                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D is1Call         S               N                      inz(cFalse)                     RADDAT
     D crc32Options    S              5U 0                    inz                             RADDAT
     D hFile           S             10I 0                    inz                             RADDAT
     D inBuff          DS                  qualified                                          RADDAT
     D  size                         10U 0                    inz                             RADDAT
     D  value                      8192A                      inz                             RADDAT
     D bytesLeft       S             10U 0                    inz                             RADDAT
     D crc32           DS                  likeds(crc32_t   ) inz                             RADDAT
     D st_stat         DS                  likeds(st_stat_t ) inz                             RADDAT
     D msg             DS                  likeds(msg_t     ) inz                             RADDAT
     D elapsedTime     DS                  qualified
     D  start                          Z   inz
     D  end                            Z   inz
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Generate a CRC32 checksum of a given stream file:
                                                                                            //RADDAT
         // Open stream file                                                                //RADDAT
         hFile = open(i_path: O_RDONLY);                                                    //RADDAT
 B01     if hFile = RC_ERROR;                                                               //RADDAT
            return;                                                                         //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         // Get size of stream file                                                         //RADDAT
 B01     if stat(i_path: %addr(st_stat)) = RC_ERROR;                                        //RADDAT
            callp close(hFile);                                                             //RADDAT
            return;                                                                         //RADDAT
 X01     else;                                                                              //RADDAT
            bytesLeft = st_stat.size;                                                       //RADDAT
 E01     endif;                                                                             //RADDAT

         elapsedTime.start = %timestamp();
                                                                                            //RADDAT
         // Read 1. chunk of data                                                           //RADDAT
         inBuff.size = read(hFile: %addr(inBuff.value): %size(inBuff.value));
                                                                                            //RADDAT
         is1Call = cTrue;   // First call to f_genCRC32                                     //RADDAT
                                                                                            //RADDAT
 B01     dow inBuff.size > 0;                                                               //RADDAT
                                                                                            //RADDAT
            // Set CRC32 options
 B02        if is1Call;                                                                     //RADDAT
 B03           if inBuff.size < bytesLeft;                                                  //RADDAT
                  crc32Options = cCRC32_FIRST;
 X03           else;                                                                        //RADDAT
                  crc32Options = cCRC32_ONLY;
 E03           endif;                                                                       //RADDAT
               is1Call = cFalse;                                                            //RADDAT
 X02        else;                                                                           //RADDAT
 B03           if inBuff.size < bytesLeft;                                                  //RADDAT
                  crc32Options = cCRC32_MIDDLE;
 X03           else;                                                                        //RADDAT
                  crc32Options = cCRC32_FINAL;
 E03           endif;                                                                       //RADDAT
 E02        endif;                                                                          //RADDAT
                                                                                            //RADDAT
            // Call CRC32 generation
            crc32 = f_genCRC32(%addr(inBuff.value): crc32Options: inBuff.size);
                                                                                            //RADDAT
            // Decrease number of bytes left                                                //RADDAT
            bytesLeft = bytesLeft - inBuff.size;                                            //RADDAT
                                                                                            //RADDAT
            // Read next chunk of data                                                      //RADDAT
            inBuff.size = read(hFile: %addr(inBuff.value): %size(inBuff.value));            //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         // Close stream file                                                               //RADDAT
         callp close(hFile);                                                                //RADDAT

         elapsedTime.end   = %timestamp();
                                                                                            //RADDAT
         msg = f_newMsg(cMSG_ID_NONE:
                        'CRC32 as ' + %char(crc32.length) +
                        '-byte string value: ' + %trimR(crc32.value) +
                        ' Elapsed time: ' +
                            %char(%diff(elapsedTime.end:
                                        elapsedTime.start: *mseconds)));
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R8_01  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R8_01"
mbrtype =  "RPGLE     "
mbrtext =  "Test: HANDLE_*                                    "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R8_01)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
     D handle1_t       DS                  qualified   based(pDummy)
     D  numE                         10I 0
     D  type                         20A
      *                                                                                       RADDAT
     D handle2_t       DS                  qualified   based(pDummy)
     D  type                         20A
     D  numE                         10I 0
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,CLIB                                                                     RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R8_01')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields
     D aHandle1        S                   like(HANDLE_handle_t) inz
     D aHandle2        S                   like(HANDLE_handle_t) inz
     D handle1         DS                  likeds(handle1_t    ) based(pHandle1)
     D handle2         DS                  likeds(handle2_t    ) based(pHandle2)
     D msg             DS                  likeds(msg_t        ) inz
      *                                                                                       RADDAT
      *  Constants
     D cTYPE1          C                   const('*HANDLE1')
     D cTYPE2          C                   const('*HANDLE2')
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create handles
         aHandle1 = HANDLE_new(cTYPE1: %size(handle1_t));
         aHandle2 = HANDLE_new(cTYPE2: %size(handle2_t));
                                                                                            //RADDAT
         // Check handle types
 B01     if not HANDLE_isTypeOf(aHandle1: cTYPE1);
            dsply 'Invalid type of handle 1' '*EXT';
 E01     endif;
                                                                                            //RADDAT
 B01     if not HANDLE_isTypeOf(aHandle2: cTYPE2);
            dsply 'Invalid type of handle 2' '*EXT';
 E01     endif;
                                                                                            //RADDAT
         // Change data of handle 1
         pHandle1 = HANDLE_getPointer(aHandle1);
         handle1.numE = 4;
         handle1.type = cTYPE1;
                                                                                            //RADDAT
         // Change data of handle 2
         pHandle2 = HANDLE_getPointer(aHandle2);
         handle2.numE = 8;
         handle2.type = cTYPE2;
                                                                                            //RADDAT
         // Change data of handle 1
         pHandle1 = HANDLE_getPointer(aHandle1);
         handle1.numE = handle1.numE * 2;
         handle1.type = cTYPE1 + cType1;
                                                                                            //RADDAT
         // Change data of handle 2
         pHandle2 = HANDLE_getPointer(aHandle2);
         handle2.numE = handle2.numE * 2;
         handle2.type = cTYPE2 + cTYPE2;
                                                                                            //RADDAT
         // Verify handle data
 B01     if handle1.numE <> 8 or handle1.type <> cTYPE1 + cType1;
            dsply 'Invalid data of handle 1' '*EXT';
 E01     endif;
                                                                                            //RADDAT
 B01     if handle2.numE <> 16 or handle2.type <> cTYPE2 + cType2;
            dsply 'Invalid data of handle 2' '*EXT';
 E01     endif;
                                                                                            //RADDAT
         // Delete handles
         HANDLE_delete(aHandle1);
         HANDLE_delete(aHandle2);
                                                                                            //RADDAT
         // Create a NULL Handle                                                            //RADDAT
         aHandle1 = HANDLE_null();                                                          //RADDAT
                                                                                            //RADDAT
         // Check for a NULL Handle                                                         //RADDAT
 B01     if not HANDLE_isNull(aHandle1);                                                    //RADDAT
            dsply 'Handle is not a NULL handle' '*EXT';                                     //RADDAT
 E01     endif;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing TEST_R8_02  type RPGLE - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "TEST_R8_02"
mbrtype =  "RPGLE     "
mbrtext =  "Test: MEMORY_*                                    "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
      *===============================================================*                       RADDAT
      *    CALL PGM(TEST_R8_02)                                       *                       RADDAT
      *===============================================================*                       RADDAT
      *   >>PRE-COMPILER<<                                            *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CRTCMD<<  CRTRPGMOD    MODULE(&LI/&OB) +                *                       RADDAT
      *                              SRCFILE(&SL/&SF) +               *                       RADDAT
      *                              SRCMBR(&SM);                     *                       RADDAT
      *                                                               *                       RADDAT
      *     >>COMPILE<<                                               *                       RADDAT
      *       >>PARM<< TRUNCNBR(*NO);                                 *                       RADDAT
      *       >>PARM<< DBGVIEW(*LIST);                                *                       RADDAT
      *       >>PARM<< TGTRLS(*CURRENT);                              *
      *     >>END-COMPILE<<                                           *                       RADDAT
      *                                                               *                       RADDAT
      *     >>EXECUTE<<                                               *                       RADDAT
      *                                                               *                       RADDAT
      *     >>CMD<<     CRTPGM       PGM(&LI/&OB) +                   *                       RADDAT
      *                              MODULE(&LI/&OB) +                *                       RADDAT
      *                              ACTGRP(*NEW) +                   *                       RADDAT
      *                              BNDSRVPGM(&LI/BASICS1) +         *                       RADDAT
      *                              BNDDIR(QC2LE) +                  *                       RADDAT
      *                              TGTRLS(*CURRENT) +               *
      *                              DETAIL(*BASIC);                  *                       RADDAT
      *                                                               *                       RADDAT
      *   >>END-PRE-COMPILER<<                                        *                       RADDAT
      *===============================================================*                       RADDAT
     H DEBUG                                                                                  RADDAT
     H OPTION(*SRCSTMT : *NODEBUGIO)                                                          RADDAT
     H DECEDIT('0,') DATEDIT(*DMY.)                                                           RADDAT
     H DATFMT(*ISO )  TIMFMT(*ISO )                                                           RADDAT
     H EXPROPTS(*RESDECPOS)                                                                   RADDAT
     H EXTBININT(*YES)                                                                        RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Type Definitions                                                                     RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  External Prototypes                                                                  RADDAT
      * ------------------------------------                                                  RADDAT
 CPY  /COPY QBASICS1,PBASICS1                                                                 RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Fields                                                                        RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Global Constants
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
      * ------------------------------------                                                  RADDAT
      *  Prototypes                                                                           RADDAT
      * ------------------------------------                                                  RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PR                         extpgm('TEST_R8_02')                        RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PR                                                                     RADDAT
      *                                                                                       RADDAT
      *  Show cells                                                                           RADDAT
     D showCells...                                                                           RADDAT
     D                 PR                                                                     RADDAT
     D  i_aMemList                     *   value                                              RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Program Entry Point                                                                  RADDAT
      *===============================================================*                       RADDAT
      *                                                                                       RADDAT
     D PGM_ENTRY_POINT...                                                                     RADDAT
     D                 PI                                                                     RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         main();
                                                                                            //RADDAT
         *inlr = *on;                                                                       //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Main procedure                                                                       RADDAT
      *===============================================================*                       RADDAT
     P main...                                                                                RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D main...                                                                                RADDAT
     D                 PI                                                                     RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D aMemList        S               *   inz                                                RADDAT
     D pTheMemCell     S               *   inz   dim(5)                                       RADDAT
     D aCellPayload    S             20A   based(pACellPayload)                               RADDAT
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         // Create first memory cell                                                        //RADDAT
         pTheMemCell(1) = MEMORY_allocate(aMemList: %size(aCellPayload));                   //RADDAT
         pACellPayload = pTheMemCell(1);                                                    //RADDAT
         aCellPayload  = 'first cell';                                                      //RADDAT
                                                                                            //RADDAT
         // Create second memory cell                                                       //RADDAT
         pTheMemCell(2) = MEMORY_allocate(aMemList: %size(aCellPayload));                   //RADDAT
         pACellPayload = pTheMemCell(2);                                                    //RADDAT
         aCellPayload  = 'second cell';                                                     //RADDAT
                                                                                            //RADDAT
         // Create third memory cell                                                        //RADDAT
         pTheMemCell(3) = MEMORY_allocate(aMemList: %size(aCellPayload));                   //RADDAT
         pACellPayload = pTheMemCell(3);                                                    //RADDAT
         aCellPayload  = 'third cell';                                                      //RADDAT
                                                                                            //RADDAT
         // Create fourth memory cell                                                       //RADDAT
         pTheMemCell(4) = MEMORY_allocate(aMemList: %size(aCellPayload));                   //RADDAT
         pACellPayload = pTheMemCell(4);                                                    //RADDAT
         aCellPayload  = 'fourth cell';                                                     //RADDAT
                                                                                            //RADDAT
         // Create fifth memory cell                                                        //RADDAT
         pTheMemCell(5) = MEMORY_allocate(aMemList: %size(aCellPayload));                   //RADDAT
         pACellPayload = pTheMemCell(5);                                                    //RADDAT
         aCellPayload  = 'fifth cell';                                                      //RADDAT
                                                                                            //RADDAT
         // Show cells:                                                                     //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Start list of memory cells ***');                //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         showCells(aMemList);                                                               //RADDAT
                                                                                            //RADDAT
         // Free third cell                                                                 //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '--> Free third cell');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         MEMORY_free(aMemList: pTheMemCell(3));                                             //RADDAT
                                                                                            //RADDAT
         // Show cells:                                                                     //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Start list of memory cells (4) ***');            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         showCells(aMemList);                                                               //RADDAT
                                                                                            //RADDAT
         // Free fith cell                                                                  //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '--> Free fifth cell');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         MEMORY_free(aMemList: pTheMemCell(5));                                             //RADDAT
                                                                                            //RADDAT
         // Show cells:                                                                     //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Start list of memory cells (3) ***');            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         showCells(aMemList);                                                               //RADDAT
                                                                                            //RADDAT
         // Free first cell                                                                 //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '--> Free first cell');
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         MEMORY_free(aMemList: pTheMemCell(1));                                             //RADDAT
                                                                                            //RADDAT
         // Show cells:                                                                     //RADDAT
         msg = f_newMsg(cMSG_ID_NONE: '*** Start list of memory cells (2) ***');            //RADDAT
         f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                         //RADDAT
         showCells(aMemList);                                                               //RADDAT
                                                                                            //RADDAT
         // Free memory                                                                     //RADDAT
         MEMORY_freeAll(aMemList);                                                          //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P main...                                                                                RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
      *===============================================================*                       RADDAT
      *  Show cells                                                                           RADDAT
      *===============================================================*                       RADDAT
     P showCells...                                                                           RADDAT
     P                 B                                                                      RADDAT
      *                                                                                       RADDAT
     D showCells...                                                                           RADDAT
     D                 PI                                                                     RADDAT
     D  i_aMemList                     *   value                                              RADDAT
      *                                                                                       RADDAT
      *  Helper fields                                                                        RADDAT
     D cellPayload     S             20A   based(pCellPayload)                                RADDAT
      *                                                                                       RADDAT
     D cell            DS                  qualified   based(pCell)                           RADDAT
     D  pPrvCell                       *                                                      RADDAT
     D  size                         10I 0                                                    RADDAT
      *                                                                                       RADDAT
     D msg             DS                  likeds(msg_t      ) inz                            RADDAT
      * - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -                         RADDAT
      /FREE
                                                                                            //RADDAT
         pCell = i_aMemList;                                                                //RADDAT
                                                                                            //RADDAT
 B01     dou pCell = *NULL;                                                                 //RADDAT
            pCellPayload = pCell - cell.size;                                               //RADDAT
                                                                                            //RADDAT
            msg = f_newMsg(cMSG_ID_NONE: cellPayload);                                      //RADDAT
            f_sndPgmMsg(msg: cMsg_Prv: cMsg_ToCtlBdy);                                      //RADDAT
                                                                                            //RADDAT
            pCell = cell.pPrvCell;                                                          //RADDAT
 E01     enddo;                                                                             //RADDAT
                                                                                            //RADDAT
         return;                                                                            //RADDAT
                                                                                            //RADDAT
      /END-FREE
      *                                                                                       RADDAT
     P showCells...                                                                           RADDAT
     P                 E                                                                      RADDAT
      *                                                                                       RADDAT
]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing ZCONF  type H - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "ZCONF     "
mbrtype =  "H         "
mbrtext =  "Configuration of the zlib compression library     "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
/* zconf.h -- configuration of the zlib compression library
 * Copyright (C) 1995-2003 Jean-loup Gailly.
 * For conditions of distribution and use, see copyright notice in zlib.h
 */

/* @(#) $Id: zconf.h,v 1.1 2004/01/27 13:39:46 re7 Exp $ */

#ifndef ZCONF_H
#define ZCONF_H

/*
 * If you *really* need a unique prefix for all types and library functions,
 * compile with -DZ_PREFIX. The "standard" zlib should be compiled without it.
 */
#ifdef Z_PREFIX
#  define deflateInit_  z_deflateInit_
#  define deflate       z_deflate
#  define deflateEnd    z_deflateEnd
#  define inflateInit_  z_inflateInit_
#  define inflate       z_inflate
#  define inflateEnd    z_inflateEnd
#  define deflateInit2_ z_deflateInit2_
#  define deflateSetDictionary z_deflateSetDictionary
#  define deflateCopy   z_deflateCopy
#  define deflateReset  z_deflateReset
#  define deflatePrime  z_deflatePrime
#  define deflateParams z_deflateParams
#  define deflateBound  z_deflateBound
#  define inflateInit2_ z_inflateInit2_
#  define inflateSetDictionary z_inflateSetDictionary
#  define inflateSync   z_inflateSync
#  define inflateSyncPoint z_inflateSyncPoint
#  define inflateCopy   z_inflateCopy
#  define inflateReset  z_inflateReset
#  define compress      z_compress
#  define compress2     z_compress2
#  define compressBound z_compressBound
#  define uncompress    z_uncompress
#  define adler32       z_adler32
#  define crc32         z_crc32
#  define get_crc_table z_get_crc_table

#  define Byte          z_Byte
#  define uInt          z_uInt
#  define uLong         z_uLong
#  define Bytef         z_Bytef
#  define charf         z_charf
#  define intf          z_intf
#  define uIntf         z_uIntf
#  define uLongf        z_uLongf
#  define voidpf        z_voidpf
#  define voidp         z_voidp
#endif

#if defined(__MSDOS__) && !defined(MSDOS)
#  define MSDOS
#endif
#if (defined(OS_2) || defined(__OS2__)) && !defined(OS2)
#  define OS2
#endif
#if defined(_WINDOWS) && !defined(WINDOWS)
#  define WINDOWS
#endif
#if (defined(_WIN32) || defined(__WIN32__)) && !defined(WIN32)
#  define WIN32
#endif
#if (defined(MSDOS) || defined(OS2) || defined(WINDOWS)) && !defined(WIN32)
#  if !defined(__GNUC__) && !defined(__FLAT__) && !defined(__386__)
#    ifndef SYS16BIT
#      define SYS16BIT
#    endif
#  endif
#endif

/*
 * Compile with -DMAXSEG_64K if the alloc function cannot allocate more
 * than 64k bytes at a time (needed on systems with 16-bit int).
 */
#ifdef SYS16BIT
#  define MAXSEG_64K
#endif
#ifdef MSDOS
#  define UNALIGNED_OK
#endif

#ifdef __STDC_VERSION__
#  ifndef STDC
#    define STDC
#  endif
#  if __STDC_VERSION__ >= 199901L
#    ifndef STDC99
#      define STDC99
#    endif
#  endif
#endif
#if !defined(STDC) && (defined(__STDC__) || defined(__cplusplus))
#  define STDC
#endif
#if !defined(STDC) && (defined(__GNUC__) || defined(__BORLANDC__))
#  define STDC
#endif
#if !defined(STDC) && (defined(MSDOS) || defined(WINDOWS) || defined(WIN32))
#  define STDC
#endif
#if !defined(STDC) && (defined(OS2) || defined(__HOS_AIX__))
#  define STDC
#endif

#if defined(__OS400__) && !defined(STDC)    /* iSeries (formerly AS/400). */
#  define STDC
#endif

#ifndef STDC
#  ifndef const /* cannot use !defined(STDC) && !defined(const) on Mac */
#    define const       /* note: need a more gentle solution here */
#  endif
#endif

/* Some Mac compilers merge all .h files incorrectly: */
#if defined(__MWERKS__)||defined(applec)||defined(THINK_C)||defined(__SC__)
#  define NO_DUMMY_DECL
#endif

/* Maximum value for memLevel in deflateInit2 */
#ifndef MAX_MEM_LEVEL
#  ifdef MAXSEG_64K
#    define MAX_MEM_LEVEL 8
#  else
#    define MAX_MEM_LEVEL 9
#  endif
#endif

/* Maximum value for windowBits in deflateInit2 and inflateInit2.
 * WARNING: reducing MAX_WBITS makes minigzip unable to extract .gz files
 * created by gzip. (Files created by minigzip can still be extracted by
 * gzip.)
 */
#ifndef MAX_WBITS
#  define MAX_WBITS   15 /* 32K LZ77 window */
#endif

/* The memory requirements for deflate are (in bytes):
            (1 << (windowBits+2)) +  (1 << (memLevel+9))
 that is: 128K for windowBits=15  +  128K for memLevel = 8  (default values)
 plus a few kilobytes for small objects. For example, if you want to reduce
 the default memory requirements from 256K to 128K, compile with
     make CFLAGS="-O -DMAX_WBITS=14 -DMAX_MEM_LEVEL=7"
 Of course this will generally degrade compression (there's no free lunch).

   The memory requirements for inflate are (in bytes) 1 << windowBits
 that is, 32K for windowBits=15 (default value) plus a few kilobytes
 for small objects.
*/

                        /* Type declarations */

#ifndef OF /* function prototypes */
#  ifdef STDC
#    define OF(args)  args
#  else
#    define OF(args)  ()
#  endif
#endif

/* The following definitions for FAR are needed only for MSDOS mixed
 * model programming (small or medium model with some far allocations).
 * This was tested only with MSC; for other MSDOS compilers you may have
 * to define NO_MEMCPY in zutil.h.  If you don't need the mixed model,
 * just define FAR to be empty.
 */
#ifdef SYS16BIT
#  if defined(M_I86SM) || defined(M_I86MM)
     /* MSC small or medium model */
#    define SMALL_MEDIUM
#    ifdef _MSC_VER
#      define FAR _far
#    else
#      define FAR far
#    endif
#  endif
#  if (defined(__SMALL__) || defined(__MEDIUM__))
     /* Turbo C small or medium model */
#    define SMALL_MEDIUM
#    ifdef __BORLANDC__
#      define FAR _far
#    else
#      define FAR far
#    endif
#  endif
#endif

#if defined(WINDOWS) || defined(WIN32)
   /* If building or using zlib as a DLL, define ZLIB_DLL.
    * This is not mandatory, but it offers a little performance increase.
    */
#  ifdef ZLIB_DLL
#    if defined(WIN32) && (!defined(__BORLANDC__) || (__BORLANDC__ >= 0x500))
#      ifdef ZLIB_INTERNAL
#        define ZEXTERN extern __declspec(dllexport)
#      else
#        define ZEXTERN extern __declspec(dllimport)
#      endif
#    endif
#  endif  /* ZLIB_DLL */
   /* If building or using zlib with the WINAPI/WINAPIV calling convention,
    * define ZLIB_WINAPI.
    * Caution: the standard ZLIB1.DLL is NOT compiled using ZLIB_WINAPI.
    */
#  ifdef ZLIB_WINAPI
#    ifdef FAR
#      undef FAR
#    endif
#    include <windows.h>
     /* No need for _export, use ZLIB.DEF instead. */
     /* For complete Windows compatibility, use WINAPI, not __stdcall. */
#    define ZEXPORT WINAPI
#    ifdef WIN32
#      define ZEXPORTVA WINAPIV
#    else
#      define ZEXPORTVA FAR CDECL
#    endif
#  endif
#endif

#if defined (__BEOS__)
#  ifdef ZLIB_DLL
#    ifdef ZLIB_INTERNAL
#      define ZEXPORT   __declspec(dllexport)
#      define ZEXPORTVA __declspec(dllexport)
#    else
#      define ZEXPORT   __declspec(dllimport)
#      define ZEXPORTVA __declspec(dllimport)
#    endif
#  endif
#endif

#ifndef ZEXTERN
#  define ZEXTERN extern
#endif
#ifndef ZEXPORT
#  define ZEXPORT
#endif
#ifndef ZEXPORTVA
#  define ZEXPORTVA
#endif

#ifndef FAR
#  define FAR
#endif

#if !defined(__MACTYPES__)
typedef unsigned char  Byte;  /* 8 bits */
#endif
typedef unsigned int   uInt;  /* 16 bits or more */
typedef unsigned long  uLong; /* 32 bits or more */

#ifdef SMALL_MEDIUM
   /* Borland C/C++ and some old MSC versions ignore FAR inside typedef */
#  define Bytef Byte FAR
#else
   typedef Byte  FAR Bytef;
#endif
typedef char  FAR charf;
typedef int   FAR intf;
typedef uInt  FAR uIntf;
typedef uLong FAR uLongf;

#ifdef STDC
   typedef void const *voidpc;
   typedef void FAR   *voidpf;
   typedef void       *voidp;
#else
   typedef Byte const *voidpc;
   typedef Byte FAR   *voidpf;
   typedef Byte       *voidp;
#endif

#if 0           /* HAVE_UNISTD_H -- this line is updated by ./configure */
#  include <sys/types.h> /* for off_t */
#  include <unistd.h>    /* for SEEK_* and off_t */
#  ifdef VMS
#    include <unixio.h>   /* for off_t */
#  endif
#  define z_off_t  off_t
#endif
#ifndef SEEK_SET
#  define SEEK_SET        0       /* Seek from beginning of file.  */
#  define SEEK_CUR        1       /* Seek from current position.  */
#  define SEEK_END        2       /* Set file pointer to EOF plus "offset" */
#endif
#ifndef z_off_t
#  define  z_off_t long
#endif

#if defined(__OS400__)
#define NO_vsnprintf
#endif

#if defined(__MVS__)
#  define NO_vsnprintf
#  ifdef FAR
#    undef FAR
#  endif
#endif

/* MVS linker does not support external names larger than 8 bytes */
#if defined(__MVS__)
#   pragma map(deflateInit_,"DEIN")
#   pragma map(deflateInit2_,"DEIN2")
#   pragma map(deflateEnd,"DEEND")
#   pragma map(deflateBound,"DEBND")
#   pragma map(inflateInit_,"ININ")
#   pragma map(inflateInit2_,"ININ2")
#   pragma map(inflateEnd,"INEND")
#   pragma map(inflateSync,"INSY")
#   pragma map(inflateSetDictionary,"INSEDI")
#   pragma map(compressBound,"CMBND")
#   pragma map(inflate_table,"INTABL")
#   pragma map(inflate_fast,"INFA")
#   pragma map(inflate_copyright,"INCOPY")
#endif

#endif /* ZCONF_H */

]]>  </copysrc>
</mbr>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*STATUS   "><![CDATA[
Installing ZLIB  type H - in progress.
]]>  </sendmsg>
<!-- START OF MEMBER  -->
<mbr
mbrname =  "ZLIB      "
mbrtype =  "H         "
mbrtext =  "Interface of the  zlib  compression library       "
srcfile =  "QBASICS1  "
srclib  =  "selected  "
srclen  =  "00112"
srccssid=  "00273">
<copysrc><![CDATA[
/* zlib.h -- interface of the 'zlib' general purpose compression library
  version 1.2.1, November 17th, 2003

  Copyright (C) 1995-2003 Jean-loup Gailly and Mark Adler

  This software is provided 'as-is', without any express or implied
  warranty.  In no event will the authors be held liable for any damages
  arising from the use of this software.

  Permission is granted to anyone to use this software for any purpose,
  including commercial applications, and to alter it and redistribute it
  freely, subject to the following restrictions:

  1. The origin of this software must not be misrepresented; you must not
     claim that you wrote the original software. If you use this software
     in a product, an acknowledgment in the product documentation would be
     appreciated but is not required.
  2. Altered source versions must be plainly marked as such, and must not be
     misrepresented as being the original software.
  3. This notice may not be removed or altered from any source distribution.

  Jean-loup Gailly        Mark Adler
  jloup@gzip.org          madler@alumni.caltech.edu


  The data format used by the zlib library is described by RFCs (Request for
  Comments) 1950 to 1952 in the files http://www.ietf.org/rfc/rfc1950.txt
  (zlib format), rfc1951.txt (deflate format) and rfc1952.txt (gzip format).
*/

#ifndef ZLIB_H
#define ZLIB_H

#include "zconf"

#ifdef __cplusplus
extern "C" {
#endif

#define ZLIB_VERSION "1.2.1"
#define ZLIB_VERNUM 0x1210

/*
     The 'zlib' compression library provides in-memory compression and
  decompression functions, including integrity checks of the uncompressed
  data.  This version of the library supports only one compression method
  (deflation) but other algorithms will be added later and will have the same
  stream interface.

     Compression can be done in a single step if the buffers are large
  enough (for example if an input file is mmap'ed), or can be done by
  repeated calls of the compression function.  In the latter case, the
  application must provide more input and/or consume the output
  (providing more output space) before each call.

     The compressed data format used by the in-memory functions is the zlib
  format, which is a zlib wrapper documented in RFC 1950, wrapped around a
  deflate stream, which is itself documented in RFC 1951.

     The library also supports reading and writing files in gzip (.gz) format
  with an interface similar to that of stdio using the functions that start
  with "gz".  The gzip format is different from the zlib format.  gzip is a
  gzip wrapper, documented in RFC 1952, wrapped around a deflate stream.

     The zlib format was designed to be compact and fast for use in memory
  and on communications channels.  The gzip format was designed for single-
  file compression on file systems, has a larger header than zlib to maintain
  directory information, and uses a different, slower check method than zlib.

     This library does not provide any functions to write gzip files in memory.
  However such functions could be easily written using zlib's deflate function,
  the documentation in the gzip RFC, and the examples in gzio.c.

     The library does not install any signal handler. The decoder checks
  the consistency of the compressed data, so the library should never
  crash even in case of corrupted input.
*/

typedef voidpf (*alloc_func) OF((voidpf opaque, uInt items, uInt size));
typedef void   (*free_func)  OF((voidpf opaque, voidpf address));

struct internal_state;

typedef struct z_stream_s {
    Bytef    *next_in;  /* next input byte */
    uInt     avail_in;  /* number of bytes available at next_in */
    uLong    total_in;  /* total nb of input bytes read so far */

    Bytef    *next_out; /* next output byte should be put there */
    uInt     avail_out; /* remaining free space at next_out */
    uLong    total_out; /* total nb of bytes output so far */

    char     *msg;      /* last error message, NULL if no error */
    struct internal_state FAR *state; /* not visible by applications */

    alloc_func zalloc;  /* used to allocate the internal state */
    free_func  zfree;   /* used to free the internal state */
    voidpf     opaque;  /* private data object passed to zalloc and zfree */

    int     data_type;  /* best guess about the data type: ascii or binary */
    uLong   adler;      /* adler32 value of the uncompressed data */
    uLong   reserved;   /* reserved for future use */
} z_stream;

typedef z_stream FAR *z_streamp;

/*
   The application must update next_in and avail_in when avail_in has
   dropped to zero. It must update next_out and avail_out when avail_out
   has dropped to zero. The application must initialize zalloc, zfree and
   opaque before calling the init function. All other fields are set by the
   compression library and must not be updated by the application.

   The opaque value provided by the application will be passed as the first
   parameter for calls of zalloc and zfree. This can be useful for custom
   memory management. The compression library attaches no meaning to the
   opaque value.

   zalloc must return Z_NULL if there is not enough memory for the object.
   If zlib is used in a multi-threaded application, zalloc and zfree must be
   thread safe.

   On 16-bit systems, the functions zalloc and zfree must be able to allocate
   exactly 65536 bytes, but will not be required to allocate more than this
   if the symbol MAXSEG_64K is defined (see zconf.h). WARNING: On MSDOS,
   pointers returned by zalloc for objects of exactly 65536 bytes *must*
   have their offset normalized to zero. The default allocation function
   provided by this library ensures this (see zutil.c). To reduce memory
   requirements and avoid any allocation of 64K objects, at the expense of
   compression ratio, compile the library with -DMAX_WBITS=14 (see zconf.h).

   The fields total_in and total_out can be used for statistics or
   progress reports. After compression, total_in holds the total size of
   the uncompressed data and may be saved for use in the decompressor
   (particularly if the decompressor wants to decompress everything in
   a single step).
*/

                        /* constants */

#define Z_NO_FLUSH      0
#define Z_PARTIAL_FLUSH 1 /* will be removed, use Z_SYNC_FLUSH instead */
#define Z_SYNC_FLUSH    2
#define Z_FULL_FLUSH    3
#define Z_FINISH        4
#define Z_BLOCK         5
/* Allowed flush values; see deflate() and inflate() below for details */

#define Z_OK            0
#define Z_STREAM_END    1
#define Z_NEED_DICT     2
#define Z_ERRNO        (-1)
#define Z_STREAM_ERROR (-2)
#define Z_DATA_ERROR   (-3)
#define Z_MEM_ERROR    (-4)
#define Z_BUF_ERROR    (-5)
#define Z_VERSION_ERROR (-6)
/* Return codes for the compression/decompression functions. Negative
 * values are errors, positive values are used for special but normal events.
 */

#define Z_NO_COMPRESSION         0
#define Z_BEST_SPEED             1
#define Z_BEST_COMPRESSION       9
#define Z_DEFAULT_COMPRESSION  (-1)
/* compression levels */

#define Z_FILTERED            1
#define Z_HUFFMAN_ONLY        2
#define Z_RLE                 3
#define Z_DEFAULT_STRATEGY    0
/* compression strategy; see deflateInit2() below for details */

#define Z_BINARY   0
#define Z_ASCII    1
#define Z_UNKNOWN  2
/* Possible values of the data_type field (though see inflate()) */

#define Z_DEFLATED   8
/* The deflate compression method (the only one supported in this version) */

#define Z_NULL  0  /* for initializing zalloc, zfree, opaque */

#define zlib_version zlibVersion()
/* for compatibility with versions < 1.0.2 */

                        /* basic functions */

ZEXTERN const char * ZEXPORT zlibVersion OF((void));
/* The application can compare zlibVersion and ZLIB_VERSION for consistency.
   If the first character differs, the library code actually used is
   not compatible with the zlib.h header file used by the application.
   This check is automatically made by deflateInit and inflateInit.
 */

/*
ZEXTERN int ZEXPORT deflateInit OF((z_streamp strm, int level));

     Initializes the internal stream state for compression. The fields
   zalloc, zfree and opaque must be initialized before by the caller.
   If zalloc and zfree are set to Z_NULL, deflateInit updates them to
   use default allocation functions.

     The compression level must be Z_DEFAULT_COMPRESSION, or between 0 and 9:
   1 gives best speed, 9 gives best compression, 0 gives no compression at
   all (the input data is simply copied a block at a time).
   Z_DEFAULT_COMPRESSION requests a default compromise between speed and
   compression (currently equivalent to level 6).

     deflateInit returns Z_OK if success, Z_MEM_ERROR if there was not
   enough memory, Z_STREAM_ERROR if level is not a valid compression level,
   Z_VERSION_ERROR if the zlib library version (zlib_version) is incompatible
   with the version assumed by the caller (ZLIB_VERSION).
   msg is set to null if there is no error message.  deflateInit does not
   perform any compression: this will be done by deflate().
*/


ZEXTERN int ZEXPORT deflate OF((z_streamp strm, int flush));
/*
    deflate compresses as much data as possible, and stops when the input
  buffer becomes empty or the output buffer becomes full. It may introduce some
  output latency (reading input without producing any output) except when
  forced to flush.

    The detailed semantics are as follows. deflate performs one or both of the
  following actions:

  - Compress more input starting at next_in and update next_in and avail_in
    accordingly. If not all input can be processed (because there is not
    enough room in the output buffer), next_in and avail_in are updated and
    processing will resume at this point for the next call of deflate().

  - Provide more output starting at next_out and update next_out and avail_out
    accordingly. This action is forced if the parameter flush is non zero.
    Forcing flush frequently degrades the compression ratio, so this parameter
    should be set only when necessary (in interactive applications).
    Some output may be provided even if flush is not set.

  Before the call of deflate(), the application should ensure that at least
  one of the actions is possible, by providing more input and/or consuming
  more output, and updating avail_in or avail_out accordingly; avail_out
  should never be zero before the call. The application can consume the
  compressed output when it wants, for example when the output buffer is full
  (avail_out == 0), or after each call of deflate(). If deflate returns Z_OK
  and with zero avail_out, it must be called again after making room in the
  output buffer because there might be more output pending.

    If the parameter flush is set to Z_SYNC_FLUSH, all pending output is
  flushed to the output buffer and the output is aligned on a byte boundary, so
  that the decompressor can get all input data available so far. (In particular
  avail_in is zero after the call if enough output space has been provided
  before the call.)  Flushing may degrade compression for some compression
  algorithms and so it should be used only when necessary.

    If flush is set to Z_FULL_FLUSH, all output is flushed as with
  Z_SYNC_FLUSH, and the compression state is reset so that decompression can
  restart from this point if previous compressed data has been damaged or if
  random access is desired. Using Z_FULL_FLUSH too often can seriously degrade
  the compression.

    If deflate returns with avail_out == 0, this function must be called again
  with the same value of the flush parameter and more output space (updated
  avail_out), until the flush is complete (deflate returns with non-zero
  avail_out). In the case of a Z_FULL_FLUSH or Z_SYNC_FLUSH, make sure that
  avail_out is greater than six to avoid repeated flush markers due to
  avail_out == 0 on return.

    If the parameter flush is set to Z_FINISH, pending input is processed,
  pending output is flushed and deflate returns with Z_STREAM_END if there
  was enough output space; if deflate returns with Z_OK, this function must be
  called again with Z_FINISH and more output space (updated avail_out) but no
  more input data, until it returns with Z_STREAM_END or an error. After
  deflate has returned Z_STREAM_END, the only possible operations on the
  stream are deflateReset or deflateEnd.

    Z_FINISH can be used immediately after deflateInit if all the compression
  is to be done in a single step. In this case, avail_out must be at least
  the value returned by deflateBound (see below). If deflate does not return
  Z_STREAM_END, then it must be called again as described above.

    deflate() sets strm->adler to the adler32 checksum of all input read
  so far (that is, total_in bytes).

    deflate() may update data_type if it can make a good guess about
  the input data type (Z_ASCII or Z_BINARY). In doubt, the data is considered
  binary. This field is only for information purposes and does not affect
  the compression algorithm in any manner.

    deflate() returns Z_OK if some progress has been made (more input
  processed or more output produced), Z_STREAM_END if all input has been
  consumed and all output has been produced (only when flush is set to
  Z_FINISH), Z_STREAM_ERROR if the stream state was inconsistent (for example
  if next_in or next_out was NULL), Z_BUF_ERROR if no progress is possible
  (for example avail_in or avail_out was zero). Note that Z_BUF_ERROR is not
  fatal, and deflate() can be called again with more input and more output
  space to continue compressing.
*/


ZEXTERN int ZEXPORT deflateEnd OF((z_streamp strm));
/*
     All dynamically allocated data structures for this stream are freed.
   This function discards any unprocessed input and does not flush any
   pending output.

     deflateEnd returns Z_OK if success, Z_STREAM_ERROR if the
   stream state was inconsistent, Z_DATA_ERROR if the stream was freed
   prematurely (some input or output was discarded). In the error case,
   msg may be set but then points to a static string (which must not be
   deallocated).
*/


/*
ZEXTERN int ZEXPORT inflateInit OF((z_streamp strm));

     Initializes the internal stream state for decompression. The fields
   next_in, avail_in, zalloc, zfree and opaque must be initialized before by
   the caller. If next_in is not Z_NULL and avail_in is large enough (the exact
   value depends on the compression method), inflateInit determines the
   compression method from the zlib header and allocates all data structures
   accordingly; otherwise the allocation will be deferred to the first call of
   inflate.  If zalloc and zfree are set to Z_NULL, inflateInit updates them to
   use default allocation functions.

     inflateInit returns Z_OK if success, Z_MEM_ERROR if there was not enough
   memory, Z_VERSION_ERROR if the zlib library version is incompatible with the
   version assumed by the caller.  msg is set to null if there is no error
   message. inflateInit does not perform any decompression apart from reading
   the zlib header if present: this will be done by inflate().  (So next_in and
   avail_in may be modified, but next_out and avail_out are unchanged.)
*/


ZEXTERN int ZEXPORT inflate OF((z_streamp strm, int flush));
/*
    inflate decompresses as much data as possible, and stops when the input
  buffer becomes empty or the output buffer becomes full. It may introduce
  some output latency (reading input without producing any output) except when
  forced to flush.

  The detailed semantics are as follows. inflate performs one or both of the
  following actions:

  - Decompress more input starting at next_in and update next_in and avail_in
    accordingly. If not all input can be processed (because there is not
    enough room in the output buffer), next_in is updated and processing
    will resume at this point for the next call of inflate().

  - Provide more output starting at next_out and update next_out and avail_out
    accordingly.  inflate() provides as much output as possible, until there
    is no more input data or no more space in the output buffer (see below
    about the flush parameter).

  Before the call of inflate(), the application should ensure that at least
  one of the actions is possible, by providing more input and/or consuming
  more output, and updating the next_* and avail_* values accordingly.
  The application can consume the uncompressed output when it wants, for
  example when the output buffer is full (avail_out == 0), or after each
  call of inflate(). If inflate returns Z_OK and with zero avail_out, it
  must be called again after making room in the output buffer because there
  might be more output pending.

    The flush parameter of inflate() can be Z_NO_FLUSH, Z_SYNC_FLUSH,
  Z_FINISH, or Z_BLOCK. Z_SYNC_FLUSH requests that inflate() flush as much
  output as possible to the output buffer. Z_BLOCK requests that inflate() stop
  if and when it get to the next deflate block boundary. When decoding the zlib
  or gzip format, this will cause inflate() to return immediately after the
  header and before the first block. When doing a raw inflate, inflate() will
  go ahead and process the first block, and will return when it gets to the end
  of that block, or when it runs out of data.

    The Z_BLOCK option assists in appending to or combining deflate streams.
  Also to assist in this, on return inflate() will set strm->data_type to the
  number of unused bits in the last byte taken from strm->next_in, plus 64
  if inflate() is currently decoding the last block in the deflate stream,
  plus 128 if inflate() returned immediately after decoding an end-of-block
  code or decoding the complete header up to just before the first byte of the
  deflate stream. The end-of-block will not be indicated until all of the
  uncompressed data from that block has been written to strm->next_out.  The
  number of unused bits may in general be greater than seven, except when
  bit 7 of data_type is set, in which case the number of unused bits will be
  less than eight.

    inflate() should normally be called until it returns Z_STREAM_END or an
  error. However if all decompression is to be performed in a single step
  (a single call of inflate), the parameter flush should be set to
  Z_FINISH. In this case all pending input is processed and all pending
  output is flushed; avail_out must be large enough to hold all the
  uncompressed data. (The size of the uncompressed data may have been saved
  by the compressor for this purpose.) The next operation on this stream must
  be inflateEnd to deallocate the decompression state. The use of Z_FINISH
  is never required, but can be used to inform inflate that a faster approach
  may be used for the single inflate() call.

     In this implementation, inflate() always flushes as much output as
  possible to the output buffer, and always uses the faster approach on the
  first call. So the only effect of the flush parameter in this implementation
  is on the return value of inflate(), as noted below, or when it returns early
  because Z_BLOCK is used.

     If a preset dictionary is needed after this call (see inflateSetDictionary
  below), inflate sets strm-adler to the adler32 checksum of the dictionary
  chosen by the compressor and returns Z_NEED_DICT; otherwise it sets
  strm->adler to the adler32 checksum of all output produced so far (that is,
  total_out bytes) and returns Z_OK, Z_STREAM_END or an error code as described
  below. At the end of the stream, inflate() checks that its computed adler32
  checksum is equal to that saved by the compressor and returns Z_STREAM_END
  only if the checksum is correct.

    inflate() will decompress and check either zlib-wrapped or gzip-wrapped
  deflate data.  The header type is detected automatically.  Any information
  contained in the gzip header is not retained, so applications that need that
  information should instead use raw inflate, see inflateInit2() below, or
  inflateBack() and perform their own processing of the gzip header and
  trailer.

    inflate() returns Z_OK if some progress has been made (more input processed
  or more output produced), Z_STREAM_END if the end of the compressed data has
  been reached and all uncompressed output has been produced, Z_NEED_DICT if a
  preset dictionary is needed at this point, Z_DATA_ERROR if the input data was
  corrupted (input stream not conforming to the zlib format or incorrect check
  value), Z_STREAM_ERROR if the stream structure was inconsistent (for example
  if next_in or next_out was NULL), Z_MEM_ERROR if there was not enough memory,
  Z_BUF_ERROR if no progress is possible or if there was not enough room in the
  output buffer when Z_FINISH is used. Note that Z_BUF_ERROR is not fatal, and
  inflate() can be called again with more input and more output space to
  continue decompressing. If Z_DATA_ERROR is returned, the application may then
  call inflateSync() to look for a good compression block if a partial recovery
  of the data is desired.
*/


ZEXTERN int ZEXPORT inflateEnd OF((z_streamp strm));
/*
     All dynamically allocated data structures for this stream are freed.
   This function discards any unprocessed input and does not flush any
   pending output.

     inflateEnd returns Z_OK if success, Z_STREAM_ERROR if the stream state
   was inconsistent. In the error case, msg may be set but then points to a
   static string (which must not be deallocated).
*/

                        /* Advanced functions */

/*
    The following functions are needed only in some special applications.
*/

/*
ZEXTERN int ZEXPORT deflateInit2 OF((z_streamp strm,
                                     int  level,
                                     int  method,
                                     int  windowBits,
                                     int  memLevel,
                                     int  strategy));

     This is another version of deflateInit with more compression options. The
   fields next_in, zalloc, zfree and opaque must be initialized before by
   the caller.

     The method parameter is the compression method. It must be Z_DEFLATED in
   this version of the library.

     The windowBits parameter is the base two logarithm of the window size
   (the size of the history buffer). It should be in the range 8..15 for this
   version of the library. Larger values of this parameter result in better
   compression at the expense of memory usage. The default value is 15 if
   deflateInit is used instead.

     windowBits can also be -8..-15 for raw deflate. In this case, -windowBits
   determines the window size. deflate() will then generate raw deflate data
   with no zlib header or trailer, and will not compute an adler32 check value.

     windowBits can also be greater than 15 for optional gzip encoding. Add
   16 to windowBits to write a simple gzip header and trailer around the
   compressed data instead of a zlib wrapper. The gzip header will have no
   file name, no extra data, no comment, no modification time (set to zero),
   no header crc, and the operating system will be set to 255 (unknown).

     The memLevel parameter specifies how much memory should be allocated
   for the internal compression state. memLevel=1 uses minimum memory but
   is slow and reduces compression ratio; memLevel=9 uses maximum memory
   for optimal speed. The default value is 8. See zconf.h for total memory
   usage as a function of windowBits and memLevel.

     The strategy parameter is used to tune the compression algorithm. Use the
   value Z_DEFAULT_STRATEGY for normal data, Z_FILTERED for data produced by a
   filter (or predictor), Z_HUFFMAN_ONLY to force Huffman encoding only (no
   string match), or Z_RLE to limit match distances to one (run-length
   encoding). Filtered data consists mostly of small values with a somewhat
   random distribution. In this case, the compression algorithm is tuned to
   compress them better. The effect of Z_FILTERED is to force more Huffman
   coding and less string matching; it is somewhat intermediate between
   Z_DEFAULT and Z_HUFFMAN_ONLY. Z_RLE is designed to be almost as fast as
   Z_HUFFMAN_ONLY, but give better compression for PNG image data. The strategy
   parameter only affects the compression ratio but not the correctness of the
   compressed output even if it is not set appropriately.

      deflateInit2 returns Z_OK if success, Z_MEM_ERROR if there was not enough
   memory, Z_STREAM_ERROR if a parameter is invalid (such as an invalid
   method). msg is set to null if there is no error message.  deflateInit2 does
   not perform any compression: this will be done by deflate().
*/

ZEXTERN int ZEXPORT deflateSetDictionary OF((z_streamp strm,
                                             const Bytef *dictionary,
                                             uInt  dictLength));
/*
     Initializes the compression dictionary from the given byte sequence
   without producing any compressed output. This function must be called
   immediately after deflateInit, deflateInit2 or deflateReset, before any
   call of deflate. The compressor and decompressor must use exactly the same
   dictionary (see inflateSetDictionary).

     The dictionary should consist of strings (byte sequences) that are likely
   to be encountered later in the data to be compressed, with the most commonly
   used strings preferably put towards the end of the dictionary. Using a
   dictionary is most useful when the data to be compressed is short and can be
   predicted with good accuracy; the data can then be compressed better than
   with the default empty dictionary.

     Depending on the size of the compression data structures selected by
   deflateInit or deflateInit2, a part of the dictionary may in effect be
   discarded, for example if the dictionary is larger than the window size in
   deflate or deflate2. Thus the strings most likely to be useful should be
   put at the end of the dictionary, not at the front.

     Upon return of this function, strm->adler is set to the adler32 value
   of the dictionary; the decompressor may later use this value to determine
   which dictionary has been used by the compressor. (The adler32 value
   applies to the whole dictionary even if only a subset of the dictionary is
   actually used by the compressor.) If a raw deflate was requested, then the
   adler32 value is not computed and strm->adler is not set.

     deflateSetDictionary returns Z_OK if success, or Z_STREAM_ERROR if a
   parameter is invalid (such as NULL dictionary) or the stream state is
   inconsistent (for example if deflate has already been called for this stream
   or if the compression method is bsort). deflateSetDictionary does not
   perform any compression: this will be done by deflate().
*/

ZEXTERN int ZEXPORT deflateCopy OF((z_streamp dest,
                                    z_streamp source));
/*
     Sets the destination stream as a complete copy of the source stream.

     This function can be useful when several compression strategies will be
   tried, for example when there are several ways of pre-processing the input
   data with a filter. The streams that will be discarded should then be freed
   by calling deflateEnd.  Note that deflateCopy duplicates the internal
   compression state which can be quite large, so this strategy is slow and
   can consume lots of memory.

     deflateCopy returns Z_OK if success, Z_MEM_ERROR if there was not
   enough memory, Z_STREAM_ERROR if the source stream state was inconsistent
   (such as zalloc being NULL). msg is left unchanged in both source and
   destination.
*/

ZEXTERN int ZEXPORT deflateReset OF((z_streamp strm));
/*
     This function is equivalent to deflateEnd followed by deflateInit,
   but does not free and reallocate all the internal compression state.
   The stream will keep the same compression level and any other attributes
   that may have been set by deflateInit2.

      deflateReset returns Z_OK if success, or Z_STREAM_ERROR if the source
   stream state was inconsistent (such as zalloc or state being NULL).
*/

ZEXTERN int ZEXPORT deflateParams OF((z_streamp strm,
                                      int level,
                                      int strategy));
/*
     Dynamically update the compression level and compression strategy.  The
   interpretation of level and strategy is as in deflateInit2.  This can be
   used to switch between compression and straight copy of the input data, or
   to switch to a different kind of input data requiring a different
   strategy. If the compression level is changed, the input available so far
   is compressed with the old level (and may be flushed); the new level will
   take effect only at the next call of deflate().

     Before the call of deflateParams, the stream state must be set as for
   a call of deflate(), since the currently available input may have to
   be compressed and flushed. In particular, strm->avail_out must be non-zero.

     deflateParams returns Z_OK if success, Z_STREAM_ERROR if the source
   stream state was inconsistent or if a parameter was invalid, Z_BUF_ERROR
   if strm->avail_out was zero.
*/

ZEXTERN uLong ZEXPORT deflateBound OF((z_streamp strm,
                                       uLong sourceLen));
/*
     deflateBound() returns an upper bound on the compressed size after
   deflation of sourceLen bytes.  It must be called after deflateInit()
   or deflateInit2().  This would be used to allocate an output buffer
   for deflation in a single pass, and so would be called before deflate().
*/

ZEXTERN int ZEXPORT deflatePrime OF((z_streamp strm,
                                     int bits,
                                     int value));
/*
     deflatePrime() inserts bits in the deflate output stream.  The intent
  is that this function is used to start off the deflate output with the
  bits leftover from a previous deflate stream when appending to it.  As such,
  this function can only be used for raw deflate, and must be used before the
  first deflate() call after a deflateInit2() or deflateReset().  bits must be
  less than or equal to 16, and that many of the least significant bits of
  value will be inserted in the output.

      deflatePrime returns Z_OK if success, or Z_STREAM_ERROR if the source
   stream state was inconsistent.
*/

/*
ZEXTERN int ZEXPORT inflateInit2 OF((z_streamp strm,
                                     int  windowBits));

     This is another version of inflateInit with an extra parameter. The
   fields next_in, avail_in, zalloc, zfree and opaque must be initialized
   before by the caller.

     The windowBits parameter is the base two logarithm of the maximum window
   size (the size of the history buffer).  It should be in the range 8..15 for
   this version of the library. The default value is 15 if inflateInit is used
   instead. windowBits must be greater than or equal to the windowBits value
   provided to deflateInit2() while compressing, or it must be equal to 15 if
   deflateInit2() was not used. If a compressed stream with a larger window
   size is given as input, inflate() will return with the error code
   Z_DATA_ERROR instead of trying to allocate a larger window.

     windowBits can also be -8..-15 for raw inflate. In this case, -windowBits
   determines the window size. inflate() will then process raw deflate data,
   not looking for a zlib or gzip header, not generating a check value, and not
   looking for any check values for comparison at the end of the stream. This
   is for use with other formats that use the deflate compressed data format
   such as zip.  Those formats provide their own check values. If a custom
   format is developed using the raw deflate format for compressed data, it is
   recommended that a check value such as an adler32 or a crc32 be applied to
   the uncompressed data as is done in the zlib, gzip, and zip formats.  For
   most applications, the zlib format should be used as is. Note that comments
   above on the use in deflateInit2() applies to the magnitude of windowBits.

     windowBits can also be greater than 15 for optional gzip decoding. Add
   32 to windowBits to enable zlib and gzip decoding with automatic header
   detection, or add 16 to decode only the gzip format (the zlib format will
   return a Z_DATA_ERROR).

     inflateInit2 returns Z_OK if success, Z_MEM_ERROR if there was not enough
   memory, Z_STREAM_ERROR if a parameter is invalid (such as a negative
   memLevel). msg is set to null if there is no error message.  inflateInit2
   does not perform any decompression apart from reading the zlib header if
   present: this will be done by inflate(). (So next_in and avail_in may be
   modified, but next_out and avail_out are unchanged.)
*/

ZEXTERN int ZEXPORT inflateSetDictionary OF((z_streamp strm,
                                             const Bytef *dictionary,
                                             uInt  dictLength));
/*
     Initializes the decompression dictionary from the given uncompressed byte
   sequence. This function must be called immediately after a call of inflate
   if this call returned Z_NEED_DICT. The dictionary chosen by the compressor
   can be determined from the adler32 value returned by this call of
   inflate. The compressor and decompressor must use exactly the same
   dictionary (see deflateSetDictionary).

     inflateSetDictionary returns Z_OK if success, Z_STREAM_ERROR if a
   parameter is invalid (such as NULL dictionary) or the stream state is
   inconsistent, Z_DATA_ERROR if the given dictionary doesn't match the
   expected one (incorrect adler32 value). inflateSetDictionary does not
   perform any decompression: this will be done by subsequent calls of
   inflate().
*/

ZEXTERN int ZEXPORT inflateSync OF((z_streamp strm));
/*
    Skips invalid compressed data until a full flush point (see above the
  description of deflate with Z_FULL_FLUSH) can be found, or until all
  available input is skipped. No output is provided.

    inflateSync returns Z_OK if a full flush point has been found, Z_BUF_ERROR
  if no more input was provided, Z_DATA_ERROR if no flush point has been found,
  or Z_STREAM_ERROR if the stream structure was inconsistent. In the success
  case, the application may save the current current value of total_in which
  indicates where valid compressed data was found. In the error case, the
  application may repeatedly call inflateSync, providing more input each time,
  until success or end of the input data.
*/

ZEXTERN int ZEXPORT inflateCopy OF((z_streamp dest,
                                    z_streamp source));
/*
     Sets the destination stream as a complete copy of the source stream.

     This function can be useful when randomly accessing a large stream.  The
   first pass through the stream can periodically record the inflate state,
   allowing restarting inflate at those points when randomly accessing the
   stream.

     inflateCopy returns Z_OK if success, Z_MEM_ERROR if there was not
   enough memory, Z_STREAM_ERROR if the source stream state was inconsistent
   (such as zalloc being NULL). msg is left unchanged in both source and
   destination.
*/

ZEXTERN int ZEXPORT inflateReset OF((z_streamp strm));
/*
     This function is equivalent to inflateEnd followed by inflateInit,
   but does not free and reallocate all the internal decompression state.
   The stream will keep attributes that may have been set by inflateInit2.

      inflateReset returns Z_OK if success, or Z_STREAM_ERROR if the source
   stream state was inconsistent (such as zalloc or state being NULL).
*/

/*
ZEXTERN int ZEXPORT inflateBackInit OF((z_stream FAR *strm, int windowBits,
                                        unsigned char FAR *window));

     Initialize the internal stream state for decompression using inflateBack()
   calls.  The fields zalloc, zfree and opaque in strm must be initialized
   before the call.  If zalloc and zfree are Z_NULL, then the default library-
   derived memory allocation routines are used.  windowBits is the base two
   logarithm of the window size, in the range 8..15.  window is a caller
   supplied buffer of that size.  Except for special applications where it is
   assured that deflate was used with small window sizes, windowBits must be 15
   and a 32K byte window must be supplied to be able to decompress general
   deflate streams.

     See inflateBack() for the usage of these routines.

     inflateBackInit will return Z_OK on success, Z_STREAM_ERROR if any of
   the paramaters are invalid, Z_MEM_ERROR if the internal state could not
   be allocated, or Z_VERSION_ERROR if the version of the library does not
   match the version of the header file.
*/

typedef unsigned (*in_func) OF((void FAR *, unsigned char FAR * FAR *));
typedef int (*out_func) OF((void FAR *, unsigned char FAR *, unsigned));

ZEXTERN int ZEXPORT inflateBack OF((z_stream FAR *strm,
                                    in_func in, void FAR *in_desc,
                                    out_func out, void FAR *out_desc));
/*
     inflateBack() does a raw inflate with a single call using a call-back
   interface for input and output.  This is more efficient than inflate() for
   file i/o applications in that it avoids copying between the output and the
   sliding window by simply making the window itself the output buffer.  This
   function trusts the application to not change the output buffer passed by
   the output function, at least until inflateBack() returns.

     inflateBackInit() must be called first to allocate the internal state
   and to initialize the state with the user-provided window buffer.
   inflateBack() may then be used multiple times to inflate a complete, raw
   deflate stream with each call.  inflateBackEnd() is then called to free
   the allocated state.

     A raw deflate stream is one with no zlib or gzip header or trailer.
   This routine would normally be used in a utility that reads zip or gzip
   files and writes out uncompressed files.  The utility would decode the
   header and process the trailer on its own, hence this routine expects
   only the raw deflate stream to decompress.  This is different from the
   normal behavior of inflate(), which expects either a zlib or gzip header and
   trailer around the deflate stream.

     inflateBack() uses two subroutines supplied by the caller that are then
   called by inflateBack() for input and output.  inflateBack() calls those
   routines until it reads a complete deflate stream and writes out all of the
   uncompressed data, or until it encounters an error.  The function's
   parameters and return types are defined above in the in_func and out_func
   typedefs.  inflateBack() will call in(in_desc, &buf) which should return the
   number of bytes of provided input, and a pointer to that input in buf.  If
   there is no input available, in() must return zero--buf is ignored in that
   case--and inflateBack() will return a buffer error.  inflateBack() will call
   out(out_desc, buf, len) to write the uncompressed data buf[0..len-1].  out()
   should return zero on success, or non-zero on failure.  If out() returns
   non-zero, inflateBack() will return with an error.  Neither in() nor out()
   are permitted to change the contents of the window provided to
   inflateBackInit(), which is also the buffer that out() uses to write from.
   The length written by out() will be at most the window size.  Any non-zero
   amount of input may be provided by in().

     For convenience, inflateBack() can be provided input on the first call by
   setting strm->next_in and strm->avail_in.  If that input is exhausted, then
   in() will be called.  Therefore strm->next_in must be initialized before
   calling inflateBack().  If strm->next_in is Z_NULL, then in() will be called
   immediately for input.  If strm->next_in is not Z_NULL, then strm->avail_in
   must also be initialized, and then if strm->avail_in is not zero, input will
   initially be taken from strm->next_in[0 .. strm->avail_in - 1].

     The in_desc and out_desc parameters of inflateBack() is passed as the
   first parameter of in() and out() respectively when they are called.  These
   descriptors can be optionally used to pass any information that the caller-
   supplied in() and out() functions need to do their job.

     On return, inflateBack() will set strm->next_in and strm->avail_in to
   pass back any unused input that was provided by the last in() call.  The
   return values of inflateBack() can be Z_STREAM_END on success, Z_BUF_ERROR
   if in() or out() returned an error, Z_DATA_ERROR if there was a format
   error in the deflate stream (in which case strm->msg is set to indicate the
   nature of the error), or Z_STREAM_ERROR if the stream was not properly
   initialized.  In the case of Z_BUF_ERROR, an input or output error can be
   distinguished using strm->next_in which will be Z_NULL only if in() returned
   an error.  If strm->next is not Z_NULL, then the Z_BUF_ERROR was due to
   out() returning non-zero.  (in() will always be called before out(), so
   strm->next_in is assured to be defined if out() returns non-zero.)  Note
   that inflateBack() cannot return Z_OK.
*/

ZEXTERN int ZEXPORT inflateBackEnd OF((z_stream FAR *strm));
/*
     All memory allocated by inflateBackInit() is freed.

     inflateBackEnd() returns Z_OK on success, or Z_STREAM_ERROR if the stream
   state was inconsistent.
*/

ZEXTERN uLong ZEXPORT zlibCompileFlags OF((void));
/* Return flags indicating compile-time options.

    Type sizes, two bits each, 00 = 16 bits, 01 = 32, 10 = 64, 11 = other:
     1.0: size of uInt
     3.2: size of uLong
     5.4: size of voidpf (pointer)
     7.6: size of z_off_t

    Compiler, assembler, and debug options:
     8: DEBUG
     9: ASMV or ASMINF -- use ASM code
     10: ZLIB_WINAPI -- exported functions use the WINAPI calling convention
     11: 0 (reserved)

    One-time table building (smaller code, but not thread-safe if true):
     12: BUILDFIXED -- build static block decoding tables when needed
     13: DYNAMIC_CRC_TABLE -- build CRC calculation tables when needed
     14,15: 0 (reserved)

    Library content (indicates missing functionality):
     16: NO_GZCOMPRESS -- gz* functions cannot compress (to avoid linking
                          deflate code when not needed)
     17: NO_GZIP -- deflate can't write gzip streams, and inflate can't detect
                    and decode gzip streams (to avoid linking crc code)
     18-19: 0 (reserved)

    Operation variations (changes in library functionality):
     20: PKZIP_BUG_WORKAROUND -- slightly more permissive inflate
     21: FASTEST -- deflate algorithm with only one, lowest compression level
     22,23: 0 (reserved)

    The sprintf variant used by gzprintf (zero is best):
     24: 0 = vs*, 1 = s* -- 1 means limited to 20 arguments after the format
     25: 0 = *nprintf, 1 = *printf -- 1 means gzprintf() not secure!
     26: 0 = returns value, 1 = void -- 1 means inferred string length returned

    Remainder:
     27-31: 0 (reserved)
 */


                        /* utility functions */

/*
     The following utility functions are implemented on top of the
   basic stream-oriented functions. To simplify the interface, some
   default options are assumed (compression level and memory usage,
   standard memory allocation functions). The source code of these
   utility functions can easily be modified if you need special options.
*/

ZEXTERN int ZEXPORT compress OF((Bytef *dest,   uLongf *destLen,
                                 const Bytef *source, uLong sourceLen));
/*
     Compresses the source buffer into the destination buffer.  sourceLen is
   the byte length of the source buffer. Upon entry, destLen is the total
   size of the destination buffer, which must be at least the value returned
   by compressBound(sourceLen). Upon exit, destLen is the actual size of the
   compressed buffer.
     This function can be used to compress a whole file at once if the
   input file is mmap'ed.
     compress returns Z_OK if success, Z_MEM_ERROR if there was not
   enough memory, Z_BUF_ERROR if there was not enough room in the output
   buffer.
*/

ZEXTERN int ZEXPORT compress2 OF((Bytef *dest,   uLongf *destLen,
                                  const Bytef *source, uLong sourceLen,
                                  int level));
/*
     Compresses the source buffer into the destination buffer. The level
   parameter has the same meaning as in deflateInit.  sourceLen is the byte
   length of the source buffer. Upon entry, destLen is the total size of the
   destination buffer, which must be at least the value returned by
   compressBound(sourceLen). Upon exit, destLen is the actual size of the
   compressed buffer.

     compress2 returns Z_OK if success, Z_MEM_ERROR if there was not enough
   memory, Z_BUF_ERROR if there was not enough room in the output buffer,
   Z_STREAM_ERROR if the level parameter is invalid.
*/

ZEXTERN uLong ZEXPORT compressBound OF((uLong sourceLen));
/*
     compressBound() returns an upper bound on the compressed size after
   compress() or compress2() on sourceLen bytes.  It would be used before
   a compress() or compress2() call to allocate the destination buffer.
*/

ZEXTERN int ZEXPORT uncompress OF((Bytef *dest,   uLongf *destLen,
                                   const Bytef *source, uLong sourceLen));
/*
     Decompresses the source buffer into the destination buffer.  sourceLen is
   the byte length of the source buffer. Upon entry, destLen is the total
   size of the destination buffer, which must be large enough to hold the
   entire uncompressed data. (The size of the uncompressed data must have
   been saved previously by the compressor and transmitted to the decompressor
   by some mechanism outside the scope of this compression library.)
   Upon exit, destLen is the actual size of the compressed buffer.
     This function can be used to decompress a whole file at once if the
   input file is mmap'ed.

     uncompress returns Z_OK if success, Z_MEM_ERROR if there was not
   enough memory, Z_BUF_ERROR if there was not enough room in the output
   buffer, or Z_DATA_ERROR if the input data was corrupted or incomplete.
*/


typedef voidp gzFile;

ZEXTERN gzFile ZEXPORT gzopen  OF((const char *path, const char *mode));
/*
     Opens a gzip (.gz) file for reading or writing. The mode parameter
   is as in fopen ("rb" or "wb") but can also include a compression level
   ("wb9") or a strategy: 'f' for filtered data as in "wb6f", 'h' for
   Huffman only compression as in "wb1h", or 'R' for run-length encoding
   as in "wb1R". (See the description of deflateInit2 for more information
   about the strategy parameter.)

     gzopen can be used to read a file which is not in gzip format; in this
   case gzread will directly read from the file without decompression.

     gzopen returns NULL if the file could not be opened or if there was
   insufficient memory to allocate the (de)compression state; errno
   can be checked to distinguish the two cases (if errno is zero, the
   zlib error is Z_MEM_ERROR).  */

ZEXTERN gzFile ZEXPORT gzdopen  OF((int fd, const char *mode));
/*
     gzdopen() associates a gzFile with the file descriptor fd.  File
   descriptors are obtained from calls like open, dup, creat, pipe or
   fileno (in the file has been previously opened with fopen).
   The mode parameter is as in gzopen.
     The next call of gzclose on the returned gzFile will also close the
   file descriptor fd, just like fclose(fdopen(fd), mode) closes the file
   descriptor fd. If you want to keep fd open, use gzdopen(dup(fd), mode).
     gzdopen returns NULL if there was insufficient memory to allocate
   the (de)compression state.
*/

ZEXTERN int ZEXPORT gzsetparams OF((gzFile file, int level, int strategy));
/*
     Dynamically update the compression level or strategy. See the description
   of deflateInit2 for the meaning of these parameters.
     gzsetparams returns Z_OK if success, or Z_STREAM_ERROR if the file was not
   opened for writing.
*/

ZEXTERN int ZEXPORT    gzread  OF((gzFile file, voidp buf, unsigned len));
/*
     Reads the given number of uncompressed bytes from the compressed file.
   If the input file was not in gzip format, gzread copies the given number
   of bytes into the buffer.
     gzread returns the number of uncompressed bytes actually read (0 for
   end of file, -1 for error). */

ZEXTERN int ZEXPORT    gzwrite OF((gzFile file,
                                   voidpc buf, unsigned len));
/*
     Writes the given number of uncompressed bytes into the compressed file.
   gzwrite returns the number of uncompressed bytes actually written
   (0 in case of error).
*/

ZEXTERN int ZEXPORTVA   gzprintf OF((gzFile file, const char *format, ...));
/*
     Converts, formats, and writes the args to the compressed file under
   control of the format string, as in fprintf. gzprintf returns the number of
   uncompressed bytes actually written (0 in case of error).  The number of
   uncompressed bytes written is limited to 4095. The caller should assure that
   this limit is not exceeded. If it is exceeded, then gzprintf() will return
   return an error (0) with nothing written. In this case, there may also be a
   buffer overflow with unpredictable consequences, which is possible only if
   zlib was compiled with the insecure functions sprintf() or vsprintf()
   because the secure snprintf() or vsnprintf() functions were not available.
*/

ZEXTERN int ZEXPORT gzputs OF((gzFile file, const char *s));
/*
      Writes the given null-terminated string to the compressed file, excluding
   the terminating null character.
      gzputs returns the number of characters written, or -1 in case of error.
*/

ZEXTERN char * ZEXPORT gzgets OF((gzFile file, char *buf, int len));
/*
      Reads bytes from the compressed file until len-1 characters are read, or
   a newline character is read and transferred to buf, or an end-of-file
   condition is encountered.  The string is then terminated with a null
   character.
      gzgets returns buf, or Z_NULL in case of error.
*/

ZEXTERN int ZEXPORT    gzputc OF((gzFile file, int c));
/*
      Writes c, converted to an unsigned char, into the compressed file.
   gzputc returns the value that was written, or -1 in case of error.
*/

ZEXTERN int ZEXPORT    gzgetc OF((gzFile file));
/*
      Reads one byte from the compressed file. gzgetc returns this byte
   or -1 in case of end of file or error.
*/

ZEXTERN int ZEXPORT    gzungetc OF((int c, gzFile file));
/*
      Push one character back onto the stream to be read again later.
   Only one character of push-back is allowed.  gzungetc() returns the
   character pushed, or -1 on failure.  gzungetc() will fail if a
   character has been pushed but not read yet, or if c is -1. The pushed
   character will be discarded if the stream is repositioned with gzseek()
   or gzrewind().
*/

ZEXTERN int ZEXPORT    gzflush OF((gzFile file, int flush));
/*
     Flushes all pending output into the compressed file. The parameter
   flush is as in the deflate() function. The return value is the zlib
   error number (see function gzerror below). gzflush returns Z_OK if
   the flush parameter is Z_FINISH and all output could be flushed.
     gzflush should be called only when strictly necessary because it can
   degrade compression.
*/

ZEXTERN z_off_t ZEXPORT    gzseek OF((gzFile file,
                                      z_off_t offset, int whence));
/*
      Sets the starting position for the next gzread or gzwrite on the
   given compressed file. The offset represents a number of bytes in the
   uncompressed data stream. The whence parameter is defined as in lseek(2);
   the value SEEK_END is not supported.
     If the file is opened for reading, this function is emulated but can be
   extremely slow. If the file is opened for writing, only forward seeks are
   supported; gzseek then compresses a sequence of zeroes up to the new
   starting position.

      gzseek returns the resulting offset location as measured in bytes from
   the beginning of the uncompressed stream, or -1 in case of error, in
   particular if the file is opened for writing and the new starting position
   would be before the current position.
*/

ZEXTERN int ZEXPORT    gzrewind OF((gzFile file));
/*
     Rewinds the given file. This function is supported only for reading.

   gzrewind(file) is equivalent to (int)gzseek(file, 0L, SEEK_SET)
*/

ZEXTERN z_off_t ZEXPORT    gztell OF((gzFile file));
/*
     Returns the starting position for the next gzread or gzwrite on the
   given compressed file. This position represents a number of bytes in the
   uncompressed data stream.

   gztell(file) is equivalent to gzseek(file, 0L, SEEK_CUR)
*/

ZEXTERN int ZEXPORT gzeof OF((gzFile file));
/*
     Returns 1 when EOF has previously been detected reading the given
   input stream, otherwise zero.
*/

ZEXTERN int ZEXPORT    gzclose OF((gzFile file));
/*
     Flushes all pending output if necessary, closes the compressed file
   and deallocates all the (de)compression state. The return value is the zlib
   error number (see function gzerror below).
*/

ZEXTERN const char * ZEXPORT gzerror OF((gzFile file, int *errnum));
/*
     Returns the error message for the last error which occurred on the
   given compressed file. errnum is set to zlib error number. If an
   error occurred in the file system and not in the compression library,
   errnum is set to Z_ERRNO and the application may consult errno
   to get the exact error code.
*/

ZEXTERN void ZEXPORT gzclearerr OF((gzFile file));
/*
     Clears the error and end-of-file flags for file. This is analogous to the
   clearerr() function in stdio. This is useful for continuing to read a gzip
   file that is being written concurrently.
*/

                        /* checksum functions */

/*
     These functions are not related to compression but are exported
   anyway because they might be useful in applications using the
   compression library.
*/

ZEXTERN uLong ZEXPORT adler32 OF((uLong adler, const Bytef *buf, uInt len));

/*
     Update a running Adler-32 checksum with the bytes buf[0..len-1] and
   return the updated checksum. If buf is NULL, this function returns
   the required initial value for the checksum.
   An Adler-32 checksum is almost as reliable as a CRC32 but can be computed
   much faster. Usage example:

     uLong adler = adler32(0L, Z_NULL, 0);

     while (read_buffer(buffer, length) != EOF) {
       adler = adler32(adler, buffer, length);
     }
     if (adler != original_adler) error();
*/

ZEXTERN uLong ZEXPORT crc32   OF((uLong crc, const Bytef *buf, uInt len));
/*
     Update a running crc with the bytes buf[0..len-1] and return the updated
   crc. If buf is NULL, this function returns the required initial value
   for the crc. Pre- and post-conditioning (one's complement) is performed
   within this function so it shouldn't be done by the application.
   Usage example:

     uLong crc = crc32(0L, Z_NULL, 0);

     while (read_buffer(buffer, length) != EOF) {
       crc = crc32(crc, buffer, length);
     }
     if (crc != original_crc) error();
*/


                        /* various hacks, don't look :) */

/* deflateInit and inflateInit are macros to allow checking the zlib version
 * and the compiler's view of z_stream:
 */
ZEXTERN int ZEXPORT deflateInit_ OF((z_streamp strm, int level,
                                     const char *version, int stream_size));
ZEXTERN int ZEXPORT inflateInit_ OF((z_streamp strm,
                                     const char *version, int stream_size));
ZEXTERN int ZEXPORT deflateInit2_ OF((z_streamp strm, int  level, int  method,
                                      int windowBits, int memLevel,
                                      int strategy, const char *version,
                                      int stream_size));
ZEXTERN int ZEXPORT inflateInit2_ OF((z_streamp strm, int  windowBits,
                                      const char *version, int stream_size));
ZEXTERN int ZEXPORT inflateBackInit_ OF((z_stream FAR *strm, int windowBits,
                                         unsigned char FAR *window,
                                         const char *version,
                                         int stream_size));
#define deflateInit(strm, level) \
        deflateInit_((strm), (level),       ZLIB_VERSION, sizeof(z_stream))
#define inflateInit(strm) \
        inflateInit_((strm),                ZLIB_VERSION, sizeof(z_stream))
#define deflateInit2(strm, level, method, windowBits, memLevel, strategy) \
        deflateInit2_((strm),(level),(method),(windowBits),(memLevel),\
                      (strategy),           ZLIB_VERSION, sizeof(z_stream))
#define inflateInit2(strm, windowBits) \
        inflateInit2_((strm), (windowBits), ZLIB_VERSION, sizeof(z_stream))
#define inflateBackInit(strm, windowBits, window) \
        inflateBackInit_((strm), (windowBits), (window), \
        ZLIB_VERSION, sizeof(z_stream))


#if !defined(ZUTIL_H) && !defined(NO_DUMMY_DECL)
    struct internal_state {int dummy;}; /* hack for buggy compilers */
#endif

ZEXTERN const char   * ZEXPORT zError           OF((int err));
ZEXTERN int            ZEXPORT inflateSyncPoint OF((z_streamp z));
ZEXTERN const uLongf * ZEXPORT get_crc_table    OF((void));

#ifdef __cplusplus
}
#endif

#endif /* ZLIB_H */

]]>  </copysrc>
</mbr>
<qcmdexc condition="C_YES" release="*CURRENT" dltsplf="BASICS1C7"><![CDATA[
CRTCMOD MODULE(&tolib/BASICS1C7) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) OUTPUT(*PRINT) OPTIMIZE(40
) DBGVIEW(*ALL) DEFINE(DYNAMIC_CRC_TABLE) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RA"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RA) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RB"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RB) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RC"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RC) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RD"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RD) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RE"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RE) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RF"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RF) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RG"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RG) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1RH"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1RH) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R1"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R1) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R2"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R2) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R3"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R3) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R4"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R4) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R5"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R5) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R6"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R6) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="C_NO" release="*CURRENT" dltsplf="BASICS1R7"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R7) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) OPTIMIZE(
*FULL) TRUNCNBR(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="C_YES" release="*CURRENT" dltsplf="BASICS1R7"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R7) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) OPTIMIZE(
*FULL) TRUNCNBR(*NO) TGTRLS(*CURRENT) DEFINE(C_COMPILER)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R8"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R8) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="BASICS1R9"><![CDATA[
CRTRPGMOD MODULE(&tolib/BASICS1R9) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR(
*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="C_NO" release="*CURRENT" dltsplf="BASICS1"><![CDATA[
CRTSRVPGM SRVPGM(&tolib/BASICS1) MODULE(&tolib/BASICS1R1 &tolib/BASICS1R2 &tolib/BASICS1R3 &tolib/BA
SICS1R4 &tolib/BASICS1R5 &tolib/BASICS1R6 &tolib/BASICS1R7 &tolib/BASICS1R8 &tolib/BASICS1R9 &tolib/
BASICS1RA &tolib/BASICS1RB &tolib/BASICS1RC &tolib/BASICS1RD &tolib/BASICS1RE &tolib/BASICS1RF &toli
b/BASICS1RG &tolib/BASICS1RH) EXPORT(*SRCFILE) SRCFILE(&tolib/QBASICS1) SRCMBR(BASICS1) TEXT('Tools/
400 - Runtime Library') BNDDIR(QC2LE) ACTGRP(*CALLER) DETAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="C_YES" release="*CURRENT" dltsplf="BASICS1"><![CDATA[
CRTSRVPGM SRVPGM(&tolib/BASICS1) MODULE(&tolib/BASICS1R1 &tolib/BASICS1R2 &tolib/BASICS1R3 &tolib/BA
SICS1R4 &tolib/BASICS1R5 &tolib/BASICS1R6 &tolib/BASICS1C7 &tolib/BASICS1R7 &tolib/BASICS1R8 &tolib/
BASICS1R9 &tolib/BASICS1RA &tolib/BASICS1RB &tolib/BASICS1RC &tolib/BASICS1RD &tolib/BASICS1RE &toli
b/BASICS1RF &tolib/BASICS1RG &tolib/BASICS1RH) EXPORT(*SRCFILE) SRCFILE(&tolib/QBASICS1) SRCMBR(BASI
CS1) TEXT('Tools/400 - Runtime Library') BNDDIR(QC2LE) ACTGRP(*CALLER) DETAIL(*BASIC) TGTRLS(*CURREN
T)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RA_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RA_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RA_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_RA_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RA_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RA_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RA_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_RA_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RA_03"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RA_03) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RA_03"><![CDATA[
CRTPGM PGM(&tolib/TEST_RA_03) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RB_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RB_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RB_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_RB_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RC_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RC_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RC_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_RC_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*GE V5R3M0" dltsplf="TEST_RC_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RC_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*GE V5R3M0" dltsplf="TEST_RC_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_RC_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*GE V5R3M0" dltsplf="TEST_RC_03"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RC_03) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*GE V5R3M0" dltsplf="TEST_RC_03"><![CDATA[
CRTPGM PGM(&tolib/TEST_RC_03) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RC_04"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RC_04) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RC_04"><![CDATA[
CRTPGM PGM(&tolib/TEST_RC_04) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RC_05"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RC_05) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RC_05"><![CDATA[
CRTPGM PGM(&tolib/TEST_RC_05) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RD_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RD_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RD_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_RD_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RE_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RE_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RE_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_RE_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RH_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_RH_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_RH_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_RH_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R1_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R1_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R1_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R1_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R1_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R1_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R1_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_R1_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R1_03"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R1_03) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R1_03"><![CDATA[
CRTPGM PGM(&tolib/TEST_R1_03) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R2_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R2_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R2_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R2_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_03"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_03) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_03"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_03) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_04"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_04) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_04"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_04) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_05"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_05) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_05"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_05) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_06"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_06) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_06"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_06) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_07"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_07) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_07"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_07) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_08"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_08) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_08"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_08) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_09"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_09) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_09"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_09) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_10"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_10) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_10"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_10) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_11"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_11) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_11"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_11) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_12"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_12) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_12"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_12) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_13"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_13) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_13"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_13) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_14"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R3_14) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R3_14"><![CDATA[
CRTPGM PGM(&tolib/TEST_R3_14) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R4_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R4_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R4_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R4_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R5_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R5_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R5_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_R5_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_03"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R5_03) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_03"><![CDATA[
CRTPGM PGM(&tolib/TEST_R5_03) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_04"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R5_04) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_04"><![CDATA[
CRTPGM PGM(&tolib/TEST_R5_04) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_05"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R5_05) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R5_05"><![CDATA[
CRTPGM PGM(&tolib/TEST_R5_05) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R6_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R6_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R6_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R6_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R6_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R6_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R6_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_R6_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_03"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_03) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_03"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_03) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_04"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_04) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_04"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_04) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_05"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_05) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_05"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_05) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_06"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_06) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_06"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_06) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_07"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_07) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_07"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_07) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_08"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_08) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_08"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_08) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_09"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R7_09) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R7_09"><![CDATA[
CRTPGM PGM(&tolib/TEST_R7_09) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R8_01"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R8_01) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R8_01"><![CDATA[
CRTPGM PGM(&tolib/TEST_R8_01) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R8_02"><![CDATA[
CRTRPGMOD MODULE(&tolib/TEST_R8_02) SRCFILE(&tolib/QBASICS1) SRCMBR(*MODULE) DBGVIEW(*LIST) TRUNCNBR
(*NO) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="YES" release="*CURRENT" dltsplf="TEST_R8_02"><![CDATA[
CRTPGM PGM(&tolib/TEST_R8_02) MODULE(*PGM) BNDSRVPGM((&tolib/BASICS1)) BNDDIR(QC2LE) ACTGRP(*NEW) DE
TAIL(*BASIC) TGTRLS(*CURRENT)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1C7)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RA)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RB)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RC)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RD)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RE)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RF)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RG)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1RH)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R1)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R2)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R3)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R4)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R5)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R6)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R7)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R8)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/BASICS1R9)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RA_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RA_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RA_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RB_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RC_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RD_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RE_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_RH_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R1_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R1_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R1_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R2_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_06)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_07)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_08)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_09)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_10)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_11)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_12)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_13)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R3_14)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R4_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R5_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R6_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R6_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_02)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_03)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_04)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_05)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_06)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_07)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_08)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R7_09)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R8_01)
]]>  </qcmdexc>
<qcmdexc condition="*NONE" release="*CURRENT" dltsplf="*NONE"><![CDATA[
DLTMOD MODULE(&tolib/TEST_R8_02)
]]>  </qcmdexc>
<sendmsg  sendmsgid="CPF9897" sendmsgtype = "*COMP     "><![CDATA[
Application BASICS1 successfully installed.
]]>  </sendmsg>
</upload>
