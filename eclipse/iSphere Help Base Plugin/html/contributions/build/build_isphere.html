<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link rel="stylesheet" type="text/css" href="../../stylesheet.css">
	<title>Build iSphere</title>
</head>

<body>
<h1>Build iSphere</h1>
<p>
<h2>Version Numbering</h2>
<p>
The iSphere version numbers must match the following pattern:
<p>
<table>
<tr><td colspan="2">major.minor.micro.qualifier</tr>
</table>
<p>
The qualifier must be set to <i>r</i> for a release version or <i>bnnn</i> for a beta version, where <i>n</i> is
any positive number between 0 and 9.
<p>
<u>Examples:</u>
<table>
<tr><td nowrap>2.6.0.r</td><td>-</td><td>Release version number.</td></tr>
<tr><td nowrap>2.6.0.b004</td><td>-</td><td>Version number of the fourth beta version.</td></tr>
</table>
<p>
The Eclipse version comparator treats the major, minor and micro part as integer values. But the
qualifier is compared using a string comparator. Therefore we chose the <i>r</i> for the release and the
<i>b</i> for the beta version to make sure that the release version number is higher than the beta version number.
<p>
<h2>Ant Plug-in Build</h2>
<p>
The iSphere build process is controlled by Ant build files. The main build file is "build.xml" of
the "iSphere Build" project. This files performs the following main steps:
<p>
<ul>
<li>Downloading the iSphere library from the host.</li>
<li>Building the iSphere plug-ins.</li>
<li>Creating the SourceForge files.</li>
<li>Uploading the SourceForge files.</li>
</ul>
<p>
The most current build instructions can be found at the top of the build script.
<p>
The second build file is "build.xml" of the "iSphere Help Builder" project. It is used to create the
iSphere Internet help pages from the iSphere help projects. This way we can use the same help pages 
for the Eclipse help as well as for the Internet help.
<p>
This build script is run from the main build script. But it can also be run stand-alone to execute
the following main build steps:
<p>
The build process is controlled by two configurations files. Both files are located in the "iSphere Build"
project.
<p>
<ul>
<li>Call the HelpBuilder Java class to create the Internet help.</li>
</ul>
<p>
<u>build.properties</u>
<p>
This properties file configures what is build and what projects are used to build the iSphere plug-in.
The properties file contains a detailed description of each property.
<p>
<u>ftp.properties</u>
<p>
This properties file describes the properties that are required to download the iSphere library from the
host and the properties used for uploading files to SourceForge. Each property is described in the
properties file.
<p>
<table>
<tr><td class="important" >Please also notice the "build.dryrun" property of the "build.properties" file. 
When set to <i>true</i> nothing is deleted or uploaded. It is just simulated.</td></tr>
</table>
<p>
<a id="object_build"></a>
<h2>Object Build</h2>
<p>
iSphere objects are compiled from the <i>i Projects</i>. But instead of the predefined IBM compile commands, we
use the STRPREPRC utility to compile iSphere objects. This way we can store object specific compile options 
in the source member instead of changing the compile command each time the object is created.
<p>
The STRPREPRC command can be created by the iSphere BUILD command, which is described below in section 
<i>Library Build</i>.
<p>
So whenever you want to compile a new object type, you first need to add the STRPREPRC compile command
to that object type. For that, open the context menu of the source member that you are going to compile.
Select <i>Remote Actions</i> and <i>Work With Compile Commands...</i>. Click <i>New command</i> 
underneath <i>Compile Commands</i> and add a label, e.g. <i>iSphere</i> and the <i>STRPREPRC</i> command:
<p>
<div class="codeCommand">STRPREPRC USESRCFILE(&L/&F) USESRCMBR(&N) CHGOBJD(*NO) OBJTYPE(*PGM) LIB(&O) OBJ(&N) SRCLIB(&L) SRCFILE(&F) SRCMBR(&N) TGTRLS(*CURRENT) USER0(&X)</div> 
<p>
Do not add line breaks to the command string! I does not work.
<p>
<img alt="Add iSphere compile command" src="./assets/add_compile_command.png">
<p>
Click the <i>Create</i> button to add the new compile option.
<p>
<img alt="Add iSphere compile command" src="./assets/add_compile_command.png">
<p>
Now use compile option <i>iSphere</i> each time you compile the object.
<p>
<img alt="Using the iSphere compile command" src="./assets/use_compile_command.png">
<p>
Do the same each time you compile an object type for the first time. The <i>STRPREPRC</i>
command is the same for all object types.
<p>
<a id="library_build"></a>
<h2>Library Build</h2>
<p>
The iSphere library is built from an IBM i command line with the iSphere BUILD command. If you did not yet 
check out the <i>iSphere</i> project from the repository, refer to
<a href="../setup/setup_rdp_svn.html#install_svn_adapter">Installing the SVN Adapter</a> to learn how to install the 
SVN adapter. Then open <a href="../setup/setup_isphere.html#connect_to_sourceforge">Connecting to SourceForge</a> 
to connect to SourceForge and eventually checkout the project, as described in 
<a href="../setup/setup_isphere.html#host_project">The iSphere Host Project</a>.
<p>
Switch to the <i>i Projects</i> perspective and select <i>Remote Actions -&gt; Push Selected</i> from the context
menu of the <i>iSphere</i> project to push the source code to your host:
<p>
<img alt="Push selected changes tot he host" src="./assets/push_selected.gif">
<p>
Now login to your host and compile the iSphere BUILD command like this:
<p>
<div class="codeCommand">CRTCMD CMD(ISPHEREDVP/BUILD) PGM(*REXX)<br>
SRCFILE(ISPHEREDVP/QBUILD) SRCMBR(BUILD)<br>
REXSRCFILE(QBUILD) REXSRCMBR(BUILD1) REXCMDENV(*COMMAND)<br>
HLPPNLGRP(ISPHEREDVP/BUILD_HLP) HLPID(BUILD)</div> 
<p>
<div class="codeCommand">CRTPNLGRP PNLGRP(ISPHEREDVP/BUILD_HLP)<br>
SRCFILE(ISPHEREDVP/QBUILD) SRCMBR(BUILD_HLP)</div> 
<p>
Add library ISPHEREDVP to your library list:
<p>
<div class="codeCommand">ADDLIBLE LIB(ISPHEREDVP)</div> 
<p>
And eventually execute the BUILD command:
<p>
<img alt="Executing the iSphere BUILD command" src="./assets/isphere_build_cmd.gif">
<p>
This way you create library <i>ISPHERE</i> from library <i>ISPHEREDVP</i>. But you can also use the command
to compile your iSphere library "in place" when you specify the same library name twice.
<p>
<iframe src="../../copyright.html" width="100%" frameborder="0" marginheight="0" marginwidth="0"></iframe>
</body>
</html>